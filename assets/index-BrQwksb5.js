(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function o(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=o(a);fetch(a.href,l)}})();/**
* @vue/shared v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function ua(t){const s=Object.create(null);for(const o of t.split(","))s[o]=1;return o=>o in s}const yt={},io=[],vs=()=>{},jl=()=>!1,bn=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),va=t=>t.startsWith("onUpdate:"),Ht=Object.assign,pa=(t,s)=>{const o=t.indexOf(s);o>-1&&t.splice(o,1)},kr=Object.prototype.hasOwnProperty,mt=(t,s)=>kr.call(t,s),qe=Array.isArray,ro=t=>No(t)==="[object Map]",go=t=>No(t)==="[object Set]",Ta=t=>No(t)==="[object Date]",tt=t=>typeof t=="function",At=t=>typeof t=="string",ws=t=>typeof t=="symbol",ht=t=>t!==null&&typeof t=="object",Pl=t=>(ht(t)||tt(t))&&tt(t.then)&&tt(t.catch),El=Object.prototype.toString,No=t=>El.call(t),xr=t=>No(t).slice(8,-1),Bl=t=>No(t)==="[object Object]",fa=t=>At(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,_o=ua(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),wn=t=>{const s=Object.create(null);return o=>s[o]||(s[o]=t(o))},Cr=/-\w/g,cs=wn(t=>t.replace(Cr,s=>s.slice(1).toUpperCase())),$r=/\B([A-Z])/g,Rs=wn(t=>t.replace($r,"-$1").toLowerCase()),kn=wn(t=>t.charAt(0).toUpperCase()+t.slice(1)),Hn=wn(t=>t?`on${kn(t)}`:""),Us=(t,s)=>!Object.is(t,s),Xo=(t,...s)=>{for(let o=0;o<t.length;o++)t[o](...s)},Vl=(t,s,o,n=!1)=>{Object.defineProperty(t,s,{configurable:!0,enumerable:!1,writable:n,value:o})},xn=t=>{const s=parseFloat(t);return isNaN(s)?t:s},_r=t=>{const s=At(t)?Number(t):NaN;return isNaN(s)?t:s};let ja;const Cn=()=>ja||(ja=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Re(t){if(qe(t)){const s={};for(let o=0;o<t.length;o++){const n=t[o],a=At(n)?Ar(n):Re(n);if(a)for(const l in a)s[l]=a[l]}return s}else if(At(t)||ht(t))return t}const Mr=/;(?![^(]*\))/g,Sr=/:([^]+)/,Ir=/\/\*[^]*?\*\//g;function Ar(t){const s={};return t.replace(Ir,"").split(Mr).forEach(o=>{if(o){const n=o.split(Sr);n.length>1&&(s[n[0].trim()]=n[1].trim())}}),s}function Ie(t){let s="";if(At(t))s=t;else if(qe(t))for(let o=0;o<t.length;o++){const n=Ie(t[o]);n&&(s+=n+" ")}else if(ht(t))for(const o in t)t[o]&&(s+=o+" ");return s.trim()}const Lr="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Tr=ua(Lr);function Hl(t){return!!t||t===""}function jr(t,s){if(t.length!==s.length)return!1;let o=!0;for(let n=0;o&&n<t.length;n++)o=eo(t[n],s[n]);return o}function eo(t,s){if(t===s)return!0;let o=Ta(t),n=Ta(s);if(o||n)return o&&n?t.getTime()===s.getTime():!1;if(o=ws(t),n=ws(s),o||n)return t===s;if(o=qe(t),n=qe(s),o||n)return o&&n?jr(t,s):!1;if(o=ht(t),n=ht(s),o||n){if(!o||!n)return!1;const a=Object.keys(t).length,l=Object.keys(s).length;if(a!==l)return!1;for(const i in t){const r=t.hasOwnProperty(i),c=s.hasOwnProperty(i);if(r&&!c||!r&&c||!eo(t[i],s[i]))return!1}}return String(t)===String(s)}function ma(t,s){return t.findIndex(o=>eo(o,s))}const Dl=t=>!!(t&&t.__v_isRef===!0),S=t=>At(t)?t:t==null?"":qe(t)||ht(t)&&(t.toString===El||!tt(t.toString))?Dl(t)?S(t.value):JSON.stringify(t,Fl,2):String(t),Fl=(t,s)=>Dl(s)?Fl(t,s.value):ro(s)?{[`Map(${s.size})`]:[...s.entries()].reduce((o,[n,a],l)=>(o[Dn(n,l)+" =>"]=a,o),{})}:go(s)?{[`Set(${s.size})`]:[...s.values()].map(o=>Dn(o))}:ws(s)?Dn(s):ht(s)&&!qe(s)&&!Bl(s)?String(s):s,Dn=(t,s="")=>{var o;return ws(t)?`Symbol(${(o=t.description)!=null?o:s})`:t};function Pr(t){return t==null?"initial":typeof t=="string"?t===""?" ":t:String(t)}/**
* @vue/reactivity v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Yt;class Er{constructor(s=!1){this.detached=s,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Yt,!s&&Yt&&(this.index=(Yt.scopes||(Yt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let s,o;if(this.scopes)for(s=0,o=this.scopes.length;s<o;s++)this.scopes[s].pause();for(s=0,o=this.effects.length;s<o;s++)this.effects[s].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let s,o;if(this.scopes)for(s=0,o=this.scopes.length;s<o;s++)this.scopes[s].resume();for(s=0,o=this.effects.length;s<o;s++)this.effects[s].resume()}}run(s){if(this._active){const o=Yt;try{return Yt=this,s()}finally{Yt=o}}}on(){++this._on===1&&(this.prevScope=Yt,Yt=this)}off(){this._on>0&&--this._on===0&&(Yt=this.prevScope,this.prevScope=void 0)}stop(s){if(this._active){this._active=!1;let o,n;for(o=0,n=this.effects.length;o<n;o++)this.effects[o].stop();for(this.effects.length=0,o=0,n=this.cleanups.length;o<n;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,n=this.scopes.length;o<n;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!s){const a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.parent=void 0}}}function Br(){return Yt}let xt;const Fn=new WeakSet;class Ul{constructor(s){this.fn=s,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Yt&&Yt.active&&Yt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Fn.has(this)&&(Fn.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ol(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Pa(this),Rl(this);const s=xt,o=ps;xt=this,ps=!0;try{return this.fn()}finally{zl(this),xt=s,ps=o,this.flags&=-3}}stop(){if(this.flags&1){for(let s=this.deps;s;s=s.nextDep)ya(s);this.deps=this.depsTail=void 0,Pa(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Fn.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Jn(this)&&this.run()}get dirty(){return Jn(this)}}let Nl=0,Mo,So;function Ol(t,s=!1){if(t.flags|=8,s){t.next=So,So=t;return}t.next=Mo,Mo=t}function ga(){Nl++}function ha(){if(--Nl>0)return;if(So){let s=So;for(So=void 0;s;){const o=s.next;s.next=void 0,s.flags&=-9,s=o}}let t;for(;Mo;){let s=Mo;for(Mo=void 0;s;){const o=s.next;if(s.next=void 0,s.flags&=-9,s.flags&1)try{s.trigger()}catch(n){t||(t=n)}s=o}}if(t)throw t}function Rl(t){for(let s=t.deps;s;s=s.nextDep)s.version=-1,s.prevActiveLink=s.dep.activeLink,s.dep.activeLink=s}function zl(t){let s,o=t.depsTail,n=o;for(;n;){const a=n.prevDep;n.version===-1?(n===o&&(o=a),ya(n),Vr(n)):s=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=a}t.deps=s,t.depsTail=o}function Jn(t){for(let s=t.deps;s;s=s.nextDep)if(s.dep.version!==s.version||s.dep.computed&&(Wl(s.dep.computed)||s.dep.version!==s.version))return!0;return!!t._dirty}function Wl(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Eo)||(t.globalVersion=Eo,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Jn(t))))return;t.flags|=2;const s=t.dep,o=xt,n=ps;xt=t,ps=!0;try{Rl(t);const a=t.fn(t._value);(s.version===0||Us(a,t._value))&&(t.flags|=128,t._value=a,s.version++)}catch(a){throw s.version++,a}finally{xt=o,ps=n,zl(t),t.flags&=-3}}function ya(t,s=!1){const{dep:o,prevSub:n,nextSub:a}=t;if(n&&(n.nextSub=a,t.prevSub=void 0),a&&(a.prevSub=n,t.nextSub=void 0),o.subs===t&&(o.subs=n,!n&&o.computed)){o.computed.flags&=-5;for(let l=o.computed.deps;l;l=l.nextDep)ya(l,!0)}!s&&!--o.sc&&o.map&&o.map.delete(o.key)}function Vr(t){const{prevDep:s,nextDep:o}=t;s&&(s.nextDep=o,t.prevDep=void 0),o&&(o.prevDep=s,t.nextDep=void 0)}let ps=!0;const Kl=[];function Ss(){Kl.push(ps),ps=!1}function Is(){const t=Kl.pop();ps=t===void 0?!0:t}function Pa(t){const{cleanup:s}=t;if(t.cleanup=void 0,s){const o=xt;xt=void 0;try{s()}finally{xt=o}}}let Eo=0;class Hr{constructor(s,o){this.sub=s,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class ba{constructor(s){this.computed=s,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(s){if(!xt||!ps||xt===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==xt)o=this.activeLink=new Hr(xt,this),xt.deps?(o.prevDep=xt.depsTail,xt.depsTail.nextDep=o,xt.depsTail=o):xt.deps=xt.depsTail=o,Gl(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const n=o.nextDep;n.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=n),o.prevDep=xt.depsTail,o.nextDep=void 0,xt.depsTail.nextDep=o,xt.depsTail=o,xt.deps===o&&(xt.deps=n)}return o}trigger(s){this.version++,Eo++,this.notify(s)}notify(s){ga();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{ha()}}}function Gl(t){if(t.dep.sc++,t.sub.flags&4){const s=t.dep.computed;if(s&&!t.dep.subs){s.flags|=20;for(let n=s.deps;n;n=n.nextDep)Gl(n)}const o=t.dep.subs;o!==t&&(t.prevSub=o,o&&(o.nextSub=t)),t.dep.subs=t}}const Yn=new WeakMap,Xs=Symbol(""),Xn=Symbol(""),Bo=Symbol("");function Nt(t,s,o){if(ps&&xt){let n=Yn.get(t);n||Yn.set(t,n=new Map);let a=n.get(o);a||(n.set(o,a=new ba),a.map=n,a.key=o),a.track()}}function $s(t,s,o,n,a,l){const i=Yn.get(t);if(!i){Eo++;return}const r=c=>{c&&c.trigger()};if(ga(),s==="clear")i.forEach(r);else{const c=qe(t),d=c&&fa(o);if(c&&o==="length"){const u=Number(n);i.forEach((v,b)=>{(b==="length"||b===Bo||!ws(b)&&b>=u)&&r(v)})}else switch((o!==void 0||i.has(void 0))&&r(i.get(o)),d&&r(i.get(Bo)),s){case"add":c?d&&r(i.get("length")):(r(i.get(Xs)),ro(t)&&r(i.get(Xn)));break;case"delete":c||(r(i.get(Xs)),ro(t)&&r(i.get(Xn)));break;case"set":ro(t)&&r(i.get(Xs));break}}ha()}function oo(t){const s=ut(t);return s===t?s:(Nt(s,"iterate",Bo),is(t)?s:s.map(fs))}function $n(t){return Nt(t=ut(t),"iterate",Bo),t}function Vs(t,s){return As(t)?Qs(t)?po(fs(s)):po(s):fs(s)}const Dr={__proto__:null,[Symbol.iterator](){return Un(this,Symbol.iterator,t=>Vs(this,t))},concat(...t){return oo(this).concat(...t.map(s=>qe(s)?oo(s):s))},entries(){return Un(this,"entries",t=>(t[1]=Vs(this,t[1]),t))},every(t,s){return ks(this,"every",t,s,void 0,arguments)},filter(t,s){return ks(this,"filter",t,s,o=>o.map(n=>Vs(this,n)),arguments)},find(t,s){return ks(this,"find",t,s,o=>Vs(this,o),arguments)},findIndex(t,s){return ks(this,"findIndex",t,s,void 0,arguments)},findLast(t,s){return ks(this,"findLast",t,s,o=>Vs(this,o),arguments)},findLastIndex(t,s){return ks(this,"findLastIndex",t,s,void 0,arguments)},forEach(t,s){return ks(this,"forEach",t,s,void 0,arguments)},includes(...t){return Nn(this,"includes",t)},indexOf(...t){return Nn(this,"indexOf",t)},join(t){return oo(this).join(t)},lastIndexOf(...t){return Nn(this,"lastIndexOf",t)},map(t,s){return ks(this,"map",t,s,void 0,arguments)},pop(){return yo(this,"pop")},push(...t){return yo(this,"push",t)},reduce(t,...s){return Ea(this,"reduce",t,s)},reduceRight(t,...s){return Ea(this,"reduceRight",t,s)},shift(){return yo(this,"shift")},some(t,s){return ks(this,"some",t,s,void 0,arguments)},splice(...t){return yo(this,"splice",t)},toReversed(){return oo(this).toReversed()},toSorted(t){return oo(this).toSorted(t)},toSpliced(...t){return oo(this).toSpliced(...t)},unshift(...t){return yo(this,"unshift",t)},values(){return Un(this,"values",t=>Vs(this,t))}};function Un(t,s,o){const n=$n(t),a=n[s]();return n!==t&&!is(t)&&(a._next=a.next,a.next=()=>{const l=a._next();return l.done||(l.value=o(l.value)),l}),a}const Fr=Array.prototype;function ks(t,s,o,n,a,l){const i=$n(t),r=i!==t&&!is(t),c=i[s];if(c!==Fr[s]){const v=c.apply(t,l);return r?fs(v):v}let d=o;i!==t&&(r?d=function(v,b){return o.call(this,Vs(t,v),b,t)}:o.length>2&&(d=function(v,b){return o.call(this,v,b,t)}));const u=c.call(i,d,n);return r&&a?a(u):u}function Ea(t,s,o,n){const a=$n(t);let l=o;return a!==t&&(is(t)?o.length>3&&(l=function(i,r,c){return o.call(this,i,r,c,t)}):l=function(i,r,c){return o.call(this,i,Vs(t,r),c,t)}),a[s](l,...n)}function Nn(t,s,o){const n=ut(t);Nt(n,"iterate",Bo);const a=n[s](...o);return(a===-1||a===!1)&&xa(o[0])?(o[0]=ut(o[0]),n[s](...o)):a}function yo(t,s,o=[]){Ss(),ga();const n=ut(t)[s].apply(t,o);return ha(),Is(),n}const Ur=ua("__proto__,__v_isRef,__isVue"),ql=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ws));function Nr(t){ws(t)||(t=String(t));const s=ut(this);return Nt(s,"has",t),s.hasOwnProperty(t)}class Zl{constructor(s=!1,o=!1){this._isReadonly=s,this._isShallow=o}get(s,o,n){if(o==="__v_skip")return s.__v_skip;const a=this._isReadonly,l=this._isShallow;if(o==="__v_isReactive")return!a;if(o==="__v_isReadonly")return a;if(o==="__v_isShallow")return l;if(o==="__v_raw")return n===(a?l?Yr:Ql:l?Xl:Yl).get(s)||Object.getPrototypeOf(s)===Object.getPrototypeOf(n)?s:void 0;const i=qe(s);if(!a){let c;if(i&&(c=Dr[o]))return c;if(o==="hasOwnProperty")return Nr}const r=Reflect.get(s,o,Rt(s)?s:n);if((ws(o)?ql.has(o):Ur(o))||(a||Nt(s,"get",o),l))return r;if(Rt(r)){const c=i&&fa(o)?r:r.value;return a&&ht(c)?an(c):c}return ht(r)?a?an(r):_n(r):r}}class Jl extends Zl{constructor(s=!1){super(!1,s)}set(s,o,n,a){let l=s[o];const i=qe(s)&&fa(o);if(!this._isShallow){const d=As(l);if(!is(n)&&!As(n)&&(l=ut(l),n=ut(n)),!i&&Rt(l)&&!Rt(n))return d||(l.value=n),!0}const r=i?Number(o)<s.length:mt(s,o),c=Reflect.set(s,o,n,Rt(s)?s:a);return s===ut(a)&&(r?Us(n,l)&&$s(s,"set",o,n):$s(s,"add",o,n)),c}deleteProperty(s,o){const n=mt(s,o);s[o];const a=Reflect.deleteProperty(s,o);return a&&n&&$s(s,"delete",o,void 0),a}has(s,o){const n=Reflect.has(s,o);return(!ws(o)||!ql.has(o))&&Nt(s,"has",o),n}ownKeys(s){return Nt(s,"iterate",qe(s)?"length":Xs),Reflect.ownKeys(s)}}class Or extends Zl{constructor(s=!1){super(!0,s)}set(s,o){return!0}deleteProperty(s,o){return!0}}const Rr=new Jl,zr=new Or,Wr=new Jl(!0);const Qn=t=>t,Ko=t=>Reflect.getPrototypeOf(t);function Kr(t,s,o){return function(...n){const a=this.__v_raw,l=ut(a),i=ro(l),r=t==="entries"||t===Symbol.iterator&&i,c=t==="keys"&&i,d=a[t](...n),u=o?Qn:s?po:fs;return!s&&Nt(l,"iterate",c?Xn:Xs),{next(){const{value:v,done:b}=d.next();return b?{value:v,done:b}:{value:r?[u(v[0]),u(v[1])]:u(v),done:b}},[Symbol.iterator](){return this}}}}function Go(t){return function(...s){return t==="delete"?!1:t==="clear"?void 0:this}}function Gr(t,s){const o={get(a){const l=this.__v_raw,i=ut(l),r=ut(a);t||(Us(a,r)&&Nt(i,"get",a),Nt(i,"get",r));const{has:c}=Ko(i),d=s?Qn:t?po:fs;if(c.call(i,a))return d(l.get(a));if(c.call(i,r))return d(l.get(r));l!==i&&l.get(a)},get size(){const a=this.__v_raw;return!t&&Nt(ut(a),"iterate",Xs),a.size},has(a){const l=this.__v_raw,i=ut(l),r=ut(a);return t||(Us(a,r)&&Nt(i,"has",a),Nt(i,"has",r)),a===r?l.has(a):l.has(a)||l.has(r)},forEach(a,l){const i=this,r=i.__v_raw,c=ut(r),d=s?Qn:t?po:fs;return!t&&Nt(c,"iterate",Xs),r.forEach((u,v)=>a.call(l,d(u),d(v),i))}};return Ht(o,t?{add:Go("add"),set:Go("set"),delete:Go("delete"),clear:Go("clear")}:{add(a){!s&&!is(a)&&!As(a)&&(a=ut(a));const l=ut(this);return Ko(l).has.call(l,a)||(l.add(a),$s(l,"add",a,a)),this},set(a,l){!s&&!is(l)&&!As(l)&&(l=ut(l));const i=ut(this),{has:r,get:c}=Ko(i);let d=r.call(i,a);d||(a=ut(a),d=r.call(i,a));const u=c.call(i,a);return i.set(a,l),d?Us(l,u)&&$s(i,"set",a,l):$s(i,"add",a,l),this},delete(a){const l=ut(this),{has:i,get:r}=Ko(l);let c=i.call(l,a);c||(a=ut(a),c=i.call(l,a)),r&&r.call(l,a);const d=l.delete(a);return c&&$s(l,"delete",a,void 0),d},clear(){const a=ut(this),l=a.size!==0,i=a.clear();return l&&$s(a,"clear",void 0,void 0),i}}),["keys","values","entries",Symbol.iterator].forEach(a=>{o[a]=Kr(a,t,s)}),o}function wa(t,s){const o=Gr(t,s);return(n,a,l)=>a==="__v_isReactive"?!t:a==="__v_isReadonly"?t:a==="__v_raw"?n:Reflect.get(mt(o,a)&&a in n?o:n,a,l)}const qr={get:wa(!1,!1)},Zr={get:wa(!1,!0)},Jr={get:wa(!0,!1)};const Yl=new WeakMap,Xl=new WeakMap,Ql=new WeakMap,Yr=new WeakMap;function Xr(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Qr(t){return t.__v_skip||!Object.isExtensible(t)?0:Xr(xr(t))}function _n(t){return As(t)?t:ka(t,!1,Rr,qr,Yl)}function ec(t){return ka(t,!1,Wr,Zr,Xl)}function an(t){return ka(t,!0,zr,Jr,Ql)}function ka(t,s,o,n,a){if(!ht(t)||t.__v_raw&&!(s&&t.__v_isReactive))return t;const l=Qr(t);if(l===0)return t;const i=a.get(t);if(i)return i;const r=new Proxy(t,l===2?n:o);return a.set(t,r),r}function Qs(t){return As(t)?Qs(t.__v_raw):!!(t&&t.__v_isReactive)}function As(t){return!!(t&&t.__v_isReadonly)}function is(t){return!!(t&&t.__v_isShallow)}function xa(t){return t?!!t.__v_raw:!1}function ut(t){const s=t&&t.__v_raw;return s?ut(s):t}function tc(t){return!mt(t,"__v_skip")&&Object.isExtensible(t)&&Vl(t,"__v_skip",!0),t}const fs=t=>ht(t)?_n(t):t,po=t=>ht(t)?an(t):t;function Rt(t){return t?t.__v_isRef===!0:!1}function h(t){return sc(t,!1)}function sc(t,s){return Rt(t)?t:new oc(t,s)}class oc{constructor(s,o){this.dep=new ba,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?s:ut(s),this._value=o?s:fs(s),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(s){const o=this._rawValue,n=this.__v_isShallow||is(s)||As(s);s=n?s:ut(s),Us(s,o)&&(this._rawValue=s,this._value=n?s:fs(s),this.dep.trigger())}}function Ue(t){return Rt(t)?t.value:t}const nc={get:(t,s,o)=>s==="__v_raw"?t:Ue(Reflect.get(t,s,o)),set:(t,s,o,n)=>{const a=t[s];return Rt(a)&&!Rt(o)?(a.value=o,!0):Reflect.set(t,s,o,n)}};function ei(t){return Qs(t)?t:new Proxy(t,nc)}class ac{constructor(s,o,n){this.fn=s,this.setter=o,this._value=void 0,this.dep=new ba(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Eo-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&xt!==this)return Ol(this,!0),!0}get value(){const s=this.dep.track();return Wl(this),s&&(s.version=this.dep.version),this._value}set value(s){this.setter&&this.setter(s)}}function lc(t,s,o=!1){let n,a;return tt(t)?n=t:(n=t.get,a=t.set),new ac(n,a,o)}const qo={},ln=new WeakMap;let Zs;function ic(t,s=!1,o=Zs){if(o){let n=ln.get(o);n||ln.set(o,n=[]),n.push(t)}}function rc(t,s,o=yt){const{immediate:n,deep:a,once:l,scheduler:i,augmentJob:r,call:c}=o,d=$=>a?$:is($)||a===!1||a===0?_s($,1):_s($);let u,v,b,y,M=!1,A=!1;if(Rt(t)?(v=()=>t.value,M=is(t)):Qs(t)?(v=()=>d(t),M=!0):qe(t)?(A=!0,M=t.some($=>Qs($)||is($)),v=()=>t.map($=>{if(Rt($))return $.value;if(Qs($))return d($);if(tt($))return c?c($,2):$()})):tt(t)?s?v=c?()=>c(t,2):t:v=()=>{if(b){Ss();try{b()}finally{Is()}}const $=Zs;Zs=u;try{return c?c(t,3,[y]):t(y)}finally{Zs=$}}:v=vs,s&&a){const $=v,T=a===!0?1/0:a;v=()=>_s($(),T)}const w=Br(),k=()=>{u.stop(),w&&w.active&&pa(w.effects,u)};if(l&&s){const $=s;s=(...T)=>{$(...T),k()}}let I=A?new Array(t.length).fill(qo):qo;const _=$=>{if(!(!(u.flags&1)||!u.dirty&&!$))if(s){const T=u.run();if(a||M||(A?T.some((q,oe)=>Us(q,I[oe])):Us(T,I))){b&&b();const q=Zs;Zs=u;try{const oe=[T,I===qo?void 0:A&&I[0]===qo?[]:I,y];I=T,c?c(s,3,oe):s(...oe)}finally{Zs=q}}}else u.run()};return r&&r(_),u=new Ul(v),u.scheduler=i?()=>i(_,!1):_,y=$=>ic($,!1,u),b=u.onStop=()=>{const $=ln.get(u);if($){if(c)c($,4);else for(const T of $)T();ln.delete(u)}},s?n?_(!0):I=u.run():i?i(_.bind(null,!0),!0):u.run(),k.pause=u.pause.bind(u),k.resume=u.resume.bind(u),k.stop=k,k}function _s(t,s=1/0,o){if(s<=0||!ht(t)||t.__v_skip||(o=o||new Map,(o.get(t)||0)>=s))return t;if(o.set(t,s),s--,Rt(t))_s(t.value,s,o);else if(qe(t))for(let n=0;n<t.length;n++)_s(t[n],s,o);else if(go(t)||ro(t))t.forEach(n=>{_s(n,s,o)});else if(Bl(t)){for(const n in t)_s(t[n],s,o);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&_s(t[n],s,o)}return t}/**
* @vue/runtime-core v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Oo(t,s,o,n){try{return n?t(...n):t()}catch(a){Mn(a,s,o)}}function ms(t,s,o,n){if(tt(t)){const a=Oo(t,s,o,n);return a&&Pl(a)&&a.catch(l=>{Mn(l,s,o)}),a}if(qe(t)){const a=[];for(let l=0;l<t.length;l++)a.push(ms(t[l],s,o,n));return a}}function Mn(t,s,o,n=!0){const a=s?s.vnode:null,{errorHandler:l,throwUnhandledErrorInProduction:i}=s&&s.appContext.config||yt;if(s){let r=s.parent;const c=s.proxy,d=`https://vuejs.org/error-reference/#runtime-${o}`;for(;r;){const u=r.ec;if(u){for(let v=0;v<u.length;v++)if(u[v](t,c,d)===!1)return}r=r.parent}if(l){Ss(),Oo(l,null,10,[t,c,d]),Is();return}}cc(t,o,a,n,i)}function cc(t,s,o,n=!0,a=!1){if(a)throw t;console.error(t)}const Zt=[];let ys=-1;const co=[];let Hs=null,ao=0;const ti=Promise.resolve();let rn=null;function zt(t){const s=rn||ti;return t?s.then(this?t.bind(this):t):s}function dc(t){let s=ys+1,o=Zt.length;for(;s<o;){const n=s+o>>>1,a=Zt[n],l=Vo(a);l<t||l===t&&a.flags&2?s=n+1:o=n}return s}function Ca(t){if(!(t.flags&1)){const s=Vo(t),o=Zt[Zt.length-1];!o||!(t.flags&2)&&s>=Vo(o)?Zt.push(t):Zt.splice(dc(s),0,t),t.flags|=1,si()}}function si(){rn||(rn=ti.then(ai))}function oi(t){qe(t)?co.push(...t):Hs&&t.id===-1?Hs.splice(ao+1,0,t):t.flags&1||(co.push(t),t.flags|=1),si()}function Ba(t,s,o=ys+1){for(;o<Zt.length;o++){const n=Zt[o];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;Zt.splice(o,1),o--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function ni(t){if(co.length){const s=[...new Set(co)].sort((o,n)=>Vo(o)-Vo(n));if(co.length=0,Hs){Hs.push(...s);return}for(Hs=s,ao=0;ao<Hs.length;ao++){const o=Hs[ao];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}Hs=null,ao=0}}const Vo=t=>t.id==null?t.flags&2?-1:1/0:t.id;function ai(t){try{for(ys=0;ys<Zt.length;ys++){const s=Zt[ys];s&&!(s.flags&8)&&(s.flags&4&&(s.flags&=-2),Oo(s,s.i,s.i?15:14),s.flags&4||(s.flags&=-2))}}finally{for(;ys<Zt.length;ys++){const s=Zt[ys];s&&(s.flags&=-2)}ys=-1,Zt.length=0,ni(),rn=null,(Zt.length||co.length)&&ai()}}let ts=null,li=null;function cn(t){const s=ts;return ts=t,li=t&&t.type.__scopeId||null,s}function ho(t,s=ts,o){if(!s||t._n)return t;const n=(...a)=>{n._d&&vn(-1);const l=cn(s);let i;try{i=t(...a)}finally{cn(l),n._d&&vn(1)}return i};return n._n=!0,n._c=!0,n._d=!0,n}function we(t,s){if(ts===null)return t;const o=jn(ts),n=t.dirs||(t.dirs=[]);for(let a=0;a<s.length;a++){let[l,i,r,c=yt]=s[a];l&&(tt(l)&&(l={mounted:l,updated:l}),l.deep&&_s(i),n.push({dir:l,instance:o,value:i,oldValue:void 0,arg:r,modifiers:c}))}return t}function Ks(t,s,o,n){const a=t.dirs,l=s&&s.dirs;for(let i=0;i<a.length;i++){const r=a[i];l&&(r.oldValue=l[i].value);let c=r.dir[n];c&&(Ss(),ms(c,o,8,[t.el,r,t,s]),Is())}}function uc(t,s){if(Ot){let o=Ot.provides;const n=Ot.parent&&Ot.parent.provides;n===o&&(o=Ot.provides=Object.create(n)),o[t]=s}}function Qo(t,s,o=!1){const n=Tn();if(n||uo){let a=uo?uo._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(a&&t in a)return a[t];if(arguments.length>1)return o&&tt(s)?s.call(n&&n.proxy):s}}const vc=Symbol.for("v-scx"),pc=()=>Qo(vc);function Pt(t,s,o){return ii(t,s,o)}function ii(t,s,o=yt){const{immediate:n,deep:a,flush:l,once:i}=o,r=Ht({},o),c=s&&n||!s&&l!=="post";let d;if(Fo){if(l==="sync"){const y=pc();d=y.__watcherHandles||(y.__watcherHandles=[])}else if(!c){const y=()=>{};return y.stop=vs,y.resume=vs,y.pause=vs,y}}const u=Ot;r.call=(y,M,A)=>ms(y,u,M,A);let v=!1;l==="post"?r.scheduler=y=>{qt(y,u&&u.suspense)}:l!=="sync"&&(v=!0,r.scheduler=(y,M)=>{M?y():Ca(y)}),r.augmentJob=y=>{s&&(y.flags|=4),v&&(y.flags|=2,u&&(y.id=u.uid,y.i=u))};const b=rc(t,s,r);return Fo&&(d?d.push(b):c&&b()),b}function fc(t,s,o){const n=this.proxy,a=At(t)?t.includes(".")?ri(n,t):()=>n[t]:t.bind(n,n);let l;tt(s)?l=s:(l=s.handler,o=s);const i=Ro(this),r=ii(a,l.bind(n),o);return i(),r}function ri(t,s){const o=s.split(".");return()=>{let n=t;for(let a=0;a<o.length&&n;a++)n=n[o[a]];return n}}const ci=Symbol("_vte"),di=t=>t.__isTeleport,Io=t=>t&&(t.disabled||t.disabled===""),Va=t=>t&&(t.defer||t.defer===""),Ha=t=>typeof SVGElement<"u"&&t instanceof SVGElement,Da=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,ea=(t,s)=>{const o=t&&t.to;return At(o)?s?s(o):null:o},ui={name:"Teleport",__isTeleport:!0,process(t,s,o,n,a,l,i,r,c,d){const{mc:u,pc:v,pbc:b,o:{insert:y,querySelector:M,createText:A,createComment:w}}=d,k=Io(s.props);let{shapeFlag:I,children:_,dynamicChildren:$}=s;if(t==null){const T=s.el=A(""),q=s.anchor=A("");y(T,o,n),y(q,o,n);const oe=(J,N)=>{I&16&&u(_,J,N,a,l,i,r,c)},se=()=>{const J=s.target=ea(s.props,M),N=vi(J,s,A,y);J&&(i!=="svg"&&Ha(J)?i="svg":i!=="mathml"&&Da(J)&&(i="mathml"),a&&a.isCE&&(a.ce._teleportTargets||(a.ce._teleportTargets=new Set)).add(J),k||(oe(J,N),en(s,!1)))};k&&(oe(o,q),en(s,!0)),Va(s.props)?(s.el.__isMounted=!1,qt(()=>{se(),delete s.el.__isMounted},l)):se()}else{if(Va(s.props)&&t.el.__isMounted===!1){qt(()=>{ui.process(t,s,o,n,a,l,i,r,c,d)},l);return}s.el=t.el,s.targetStart=t.targetStart;const T=s.anchor=t.anchor,q=s.target=t.target,oe=s.targetAnchor=t.targetAnchor,se=Io(t.props),J=se?o:q,N=se?T:oe;if(i==="svg"||Ha(q)?i="svg":(i==="mathml"||Da(q))&&(i="mathml"),$?(b(t.dynamicChildren,$,J,a,l,i,r),Ia(t,s,!0)):c||v(t,s,J,N,a,l,i,r,!1),k)se?s.props&&t.props&&s.props.to!==t.props.to&&(s.props.to=t.props.to):Zo(s,o,T,d,1);else if((s.props&&s.props.to)!==(t.props&&t.props.to)){const P=s.target=ea(s.props,M);P&&Zo(s,P,null,d,0)}else se&&Zo(s,q,oe,d,1);en(s,k)}},remove(t,s,o,{um:n,o:{remove:a}},l){const{shapeFlag:i,children:r,anchor:c,targetStart:d,targetAnchor:u,target:v,props:b}=t;if(v&&(a(d),a(u)),l&&a(c),i&16){const y=l||!Io(b);for(let M=0;M<r.length;M++){const A=r[M];n(A,s,o,y,!!A.dynamicChildren)}}},move:Zo,hydrate:mc};function Zo(t,s,o,{o:{insert:n},m:a},l=2){l===0&&n(t.targetAnchor,s,o);const{el:i,anchor:r,shapeFlag:c,children:d,props:u}=t,v=l===2;if(v&&n(i,s,o),(!v||Io(u))&&c&16)for(let b=0;b<d.length;b++)a(d[b],s,o,2);v&&n(r,s,o)}function mc(t,s,o,n,a,l,{o:{nextSibling:i,parentNode:r,querySelector:c,insert:d,createText:u}},v){function b(A,w,k,I){w.anchor=v(i(A),w,r(A),o,n,a,l),w.targetStart=k,w.targetAnchor=I}const y=s.target=ea(s.props,c),M=Io(s.props);if(y){const A=y._lpa||y.firstChild;if(s.shapeFlag&16)if(M)b(t,s,A,A&&i(A));else{s.anchor=i(t);let w=A;for(;w;){if(w&&w.nodeType===8){if(w.data==="teleport start anchor")s.targetStart=w;else if(w.data==="teleport anchor"){s.targetAnchor=w,y._lpa=s.targetAnchor&&i(s.targetAnchor);break}}w=i(w)}s.targetAnchor||vi(y,s,u,d),v(A&&i(A),s,y,o,n,a,l)}en(s,M)}else M&&s.shapeFlag&16&&b(t,s,t,i(t));return s.anchor&&i(s.anchor)}const gc=ui;function en(t,s){const o=t.ctx;if(o&&o.ut){let n,a;for(s?(n=t.el,a=t.anchor):(n=t.targetStart,a=t.targetAnchor);n&&n!==a;)n.nodeType===1&&n.setAttribute("data-v-owner",o.uid),n=n.nextSibling;o.ut()}}function vi(t,s,o,n){const a=s.targetStart=o(""),l=s.targetAnchor=o("");return a[ci]=l,t&&(n(a,t),n(l,t)),l}const Cs=Symbol("_leaveCb"),Jo=Symbol("_enterCb");function pi(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return nt(()=>{t.isMounted=!0}),xi(()=>{t.isUnmounting=!0}),t}const ns=[Function,Array],fi={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ns,onEnter:ns,onAfterEnter:ns,onEnterCancelled:ns,onBeforeLeave:ns,onLeave:ns,onAfterLeave:ns,onLeaveCancelled:ns,onBeforeAppear:ns,onAppear:ns,onAfterAppear:ns,onAppearCancelled:ns},mi=t=>{const s=t.subTree;return s.component?mi(s.component):s},hc={name:"BaseTransition",props:fi,setup(t,{slots:s}){const o=Tn(),n=pi();return()=>{const a=s.default&&$a(s.default(),!0);if(!a||!a.length)return;const l=gi(a),i=ut(t),{mode:r}=i;if(n.isLeaving)return On(l);const c=Fa(l);if(!c)return On(l);let d=Ho(c,i,n,o,v=>d=v);c.type!==Jt&&to(c,d);let u=o.subTree&&Fa(o.subTree);if(u&&u.type!==Jt&&!Js(u,c)&&mi(o).type!==Jt){let v=Ho(u,i,n,o);if(to(u,v),r==="out-in"&&c.type!==Jt)return n.isLeaving=!0,v.afterLeave=()=>{n.isLeaving=!1,o.job.flags&8||o.update(),delete v.afterLeave,u=void 0},On(l);r==="in-out"&&c.type!==Jt?v.delayLeave=(b,y,M)=>{const A=hi(n,u);A[String(u.key)]=u,b[Cs]=()=>{y(),b[Cs]=void 0,delete d.delayedLeave,u=void 0},d.delayedLeave=()=>{M(),delete d.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return l}}};function gi(t){let s=t[0];if(t.length>1){for(const o of t)if(o.type!==Jt){s=o;break}}return s}const yc=hc;function hi(t,s){const{leavingVNodes:o}=t;let n=o.get(s.type);return n||(n=Object.create(null),o.set(s.type,n)),n}function Ho(t,s,o,n,a){const{appear:l,mode:i,persisted:r=!1,onBeforeEnter:c,onEnter:d,onAfterEnter:u,onEnterCancelled:v,onBeforeLeave:b,onLeave:y,onAfterLeave:M,onLeaveCancelled:A,onBeforeAppear:w,onAppear:k,onAfterAppear:I,onAppearCancelled:_}=s,$=String(t.key),T=hi(o,t),q=(J,N)=>{J&&ms(J,n,9,N)},oe=(J,N)=>{const P=N[1];q(J,N),qe(J)?J.every(f=>f.length<=1)&&P():J.length<=1&&P()},se={mode:i,persisted:r,beforeEnter(J){let N=c;if(!o.isMounted)if(l)N=w||c;else return;J[Cs]&&J[Cs](!0);const P=T[$];P&&Js(t,P)&&P.el[Cs]&&P.el[Cs](),q(N,[J])},enter(J){let N=d,P=u,f=v;if(!o.isMounted)if(l)N=k||d,P=I||u,f=_||v;else return;let g=!1;const H=J[Jo]=K=>{g||(g=!0,K?q(f,[J]):q(P,[J]),se.delayedLeave&&se.delayedLeave(),J[Jo]=void 0)};N?oe(N,[J,H]):H()},leave(J,N){const P=String(t.key);if(J[Jo]&&J[Jo](!0),o.isUnmounting)return N();q(b,[J]);let f=!1;const g=J[Cs]=H=>{f||(f=!0,N(),H?q(A,[J]):q(M,[J]),J[Cs]=void 0,T[P]===t&&delete T[P])};T[P]=t,y?oe(y,[J,g]):g()},clone(J){const N=Ho(J,s,o,n,a);return a&&a(N),N}};return se}function On(t){if(Sn(t))return t=Ns(t),t.children=null,t}function Fa(t){if(!Sn(t))return di(t.type)&&t.children?gi(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:s,children:o}=t;if(o){if(s&16)return o[0];if(s&32&&tt(o.default))return o.default()}}function to(t,s){t.shapeFlag&6&&t.component?(t.transition=s,to(t.component.subTree,s)):t.shapeFlag&128?(t.ssContent.transition=s.clone(t.ssContent),t.ssFallback.transition=s.clone(t.ssFallback)):t.transition=s}function $a(t,s=!1,o){let n=[],a=0;for(let l=0;l<t.length;l++){let i=t[l];const r=o==null?i.key:String(o)+String(i.key!=null?i.key:l);i.type===Pe?(i.patchFlag&128&&a++,n=n.concat($a(i.children,s,r))):(s||i.type!==Jt)&&n.push(r!=null?Ns(i,{key:r}):i)}if(a>1)for(let l=0;l<n.length;l++)n[l].patchFlag=-2;return n}function yi(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const dn=new WeakMap;function Ao(t,s,o,n,a=!1){if(qe(t)){t.forEach((M,A)=>Ao(M,s&&(qe(s)?s[A]:s),o,n,a));return}if(Lo(n)&&!a){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Ao(t,s,o,n.component.subTree);return}const l=n.shapeFlag&4?jn(n.component):n.el,i=a?null:l,{i:r,r:c}=t,d=s&&s.r,u=r.refs===yt?r.refs={}:r.refs,v=r.setupState,b=ut(v),y=v===yt?jl:M=>mt(b,M);if(d!=null&&d!==c){if(Ua(s),At(d))u[d]=null,y(d)&&(v[d]=null);else if(Rt(d)){d.value=null;const M=s;M.k&&(u[M.k]=null)}}if(tt(c))Oo(c,r,12,[i,u]);else{const M=At(c),A=Rt(c);if(M||A){const w=()=>{if(t.f){const k=M?y(c)?v[c]:u[c]:c.value;if(a)qe(k)&&pa(k,l);else if(qe(k))k.includes(l)||k.push(l);else if(M)u[c]=[l],y(c)&&(v[c]=u[c]);else{const I=[l];c.value=I,t.k&&(u[t.k]=I)}}else M?(u[c]=i,y(c)&&(v[c]=i)):A&&(c.value=i,t.k&&(u[t.k]=i))};if(i){const k=()=>{w(),dn.delete(t)};k.id=-1,dn.set(t,k),qt(k,o)}else Ua(t),w()}}}function Ua(t){const s=dn.get(t);s&&(s.flags|=8,dn.delete(t))}Cn().requestIdleCallback;Cn().cancelIdleCallback;const Lo=t=>!!t.type.__asyncLoader,Sn=t=>t.type.__isKeepAlive;function bc(t,s){bi(t,"a",s)}function wc(t,s){bi(t,"da",s)}function bi(t,s,o=Ot){const n=t.__wdc||(t.__wdc=()=>{let a=o;for(;a;){if(a.isDeactivated)return;a=a.parent}return t()});if(In(s,n,o),o){let a=o.parent;for(;a&&a.parent;)Sn(a.parent.vnode)&&kc(n,s,o,a),a=a.parent}}function kc(t,s,o,n){const a=In(s,t,n,!0);Dt(()=>{pa(n[s],a)},o)}function In(t,s,o=Ot,n=!1){if(o){const a=o[t]||(o[t]=[]),l=s.__weh||(s.__weh=(...i)=>{Ss();const r=Ro(o),c=ms(s,o,t,i);return r(),Is(),c});return n?a.unshift(l):a.push(l),l}}const Ts=t=>(s,o=Ot)=>{(!Fo||t==="sp")&&In(t,(...n)=>s(...n),o)},xc=Ts("bm"),nt=Ts("m"),wi=Ts("bu"),ki=Ts("u"),xi=Ts("bum"),Dt=Ts("um"),Cc=Ts("sp"),$c=Ts("rtg"),_c=Ts("rtc");function Mc(t,s=Ot){In("ec",t,s)}const Sc="components",Ci=Symbol.for("v-ndc");function _a(t){return At(t)?Ic(Sc,t,!1)||t:t||Ci}function Ic(t,s,o=!0,n=!1){const a=ts||Ot;if(a){const l=a.type;{const r=vd(l,!1);if(r&&(r===s||r===cs(s)||r===kn(cs(s))))return l}const i=Na(a[t]||l[t],s)||Na(a.appContext[t],s);return!i&&n?l:i}}function Na(t,s){return t&&(t[s]||t[cs(s)]||t[kn(cs(s))])}function Fe(t,s,o,n){let a;const l=o,i=qe(t);if(i||At(t)){const r=i&&Qs(t);let c=!1,d=!1;r&&(c=!is(t),d=As(t),t=$n(t)),a=new Array(t.length);for(let u=0,v=t.length;u<v;u++)a[u]=s(c?d?po(fs(t[u])):fs(t[u]):t[u],u,void 0,l)}else if(typeof t=="number"){a=new Array(t);for(let r=0;r<t;r++)a[r]=s(r+1,r,void 0,l)}else if(ht(t))if(t[Symbol.iterator])a=Array.from(t,(r,c)=>s(r,c,void 0,l));else{const r=Object.keys(t);a=new Array(r.length);for(let c=0,d=r.length;c<d;c++){const u=r[c];a[c]=s(t[u],u,c,l)}}else a=[];return a}const ta=t=>t?Ni(t)?jn(t):ta(t.parent):null,To=Ht(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>ta(t.parent),$root:t=>ta(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>_i(t),$forceUpdate:t=>t.f||(t.f=()=>{Ca(t.update)}),$nextTick:t=>t.n||(t.n=zt.bind(t.proxy)),$watch:t=>fc.bind(t)}),Rn=(t,s)=>t!==yt&&!t.__isScriptSetup&&mt(t,s),Ac={get({_:t},s){if(s==="__v_skip")return!0;const{ctx:o,setupState:n,data:a,props:l,accessCache:i,type:r,appContext:c}=t;if(s[0]!=="$"){const b=i[s];if(b!==void 0)switch(b){case 1:return n[s];case 2:return a[s];case 4:return o[s];case 3:return l[s]}else{if(Rn(n,s))return i[s]=1,n[s];if(a!==yt&&mt(a,s))return i[s]=2,a[s];if(mt(l,s))return i[s]=3,l[s];if(o!==yt&&mt(o,s))return i[s]=4,o[s];sa&&(i[s]=0)}}const d=To[s];let u,v;if(d)return s==="$attrs"&&Nt(t.attrs,"get",""),d(t);if((u=r.__cssModules)&&(u=u[s]))return u;if(o!==yt&&mt(o,s))return i[s]=4,o[s];if(v=c.config.globalProperties,mt(v,s))return v[s]},set({_:t},s,o){const{data:n,setupState:a,ctx:l}=t;return Rn(a,s)?(a[s]=o,!0):n!==yt&&mt(n,s)?(n[s]=o,!0):mt(t.props,s)||s[0]==="$"&&s.slice(1)in t?!1:(l[s]=o,!0)},has({_:{data:t,setupState:s,accessCache:o,ctx:n,appContext:a,props:l,type:i}},r){let c;return!!(o[r]||t!==yt&&r[0]!=="$"&&mt(t,r)||Rn(s,r)||mt(l,r)||mt(n,r)||mt(To,r)||mt(a.config.globalProperties,r)||(c=i.__cssModules)&&c[r])},defineProperty(t,s,o){return o.get!=null?t._.accessCache[s]=0:mt(o,"value")&&this.set(t,s,o.value,null),Reflect.defineProperty(t,s,o)}};function Oa(t){return qe(t)?t.reduce((s,o)=>(s[o]=null,s),{}):t}let sa=!0;function Lc(t){const s=_i(t),o=t.proxy,n=t.ctx;sa=!1,s.beforeCreate&&Ra(s.beforeCreate,t,"bc");const{data:a,computed:l,methods:i,watch:r,provide:c,inject:d,created:u,beforeMount:v,mounted:b,beforeUpdate:y,updated:M,activated:A,deactivated:w,beforeDestroy:k,beforeUnmount:I,destroyed:_,unmounted:$,render:T,renderTracked:q,renderTriggered:oe,errorCaptured:se,serverPrefetch:J,expose:N,inheritAttrs:P,components:f,directives:g,filters:H}=s;if(d&&Tc(d,n,null),i)for(const x in i){const L=i[x];tt(L)&&(n[x]=L.bind(o))}if(a){const x=a.call(o,o);ht(x)&&(t.data=_n(x))}if(sa=!0,l)for(const x in l){const L=l[x],ae=tt(L)?L.bind(o,o):tt(L.get)?L.get.bind(o,o):vs,de=!tt(L)&&tt(L.set)?L.set.bind(o):vs,ue=ot({get:ae,set:de});Object.defineProperty(n,x,{enumerable:!0,configurable:!0,get:()=>ue.value,set:$e=>ue.value=$e})}if(r)for(const x in r)$i(r[x],n,o,x);if(c){const x=tt(c)?c.call(o):c;Reflect.ownKeys(x).forEach(L=>{uc(L,x[L])})}u&&Ra(u,t,"c");function F(x,L){qe(L)?L.forEach(ae=>x(ae.bind(o))):L&&x(L.bind(o))}if(F(xc,v),F(nt,b),F(wi,y),F(ki,M),F(bc,A),F(wc,w),F(Mc,se),F(_c,q),F($c,oe),F(xi,I),F(Dt,$),F(Cc,J),qe(N))if(N.length){const x=t.exposed||(t.exposed={});N.forEach(L=>{Object.defineProperty(x,L,{get:()=>o[L],set:ae=>o[L]=ae,enumerable:!0})})}else t.exposed||(t.exposed={});T&&t.render===vs&&(t.render=T),P!=null&&(t.inheritAttrs=P),f&&(t.components=f),g&&(t.directives=g),J&&yi(t)}function Tc(t,s,o=vs){qe(t)&&(t=oa(t));for(const n in t){const a=t[n];let l;ht(a)?"default"in a?l=Qo(a.from||n,a.default,!0):l=Qo(a.from||n):l=Qo(a),Rt(l)?Object.defineProperty(s,n,{enumerable:!0,configurable:!0,get:()=>l.value,set:i=>l.value=i}):s[n]=l}}function Ra(t,s,o){ms(qe(t)?t.map(n=>n.bind(s.proxy)):t.bind(s.proxy),s,o)}function $i(t,s,o,n){let a=n.includes(".")?ri(o,n):()=>o[n];if(At(t)){const l=s[t];tt(l)&&Pt(a,l)}else if(tt(t))Pt(a,t.bind(o));else if(ht(t))if(qe(t))t.forEach(l=>$i(l,s,o,n));else{const l=tt(t.handler)?t.handler.bind(o):s[t.handler];tt(l)&&Pt(a,l,t)}}function _i(t){const s=t.type,{mixins:o,extends:n}=s,{mixins:a,optionsCache:l,config:{optionMergeStrategies:i}}=t.appContext,r=l.get(s);let c;return r?c=r:!a.length&&!o&&!n?c=s:(c={},a.length&&a.forEach(d=>un(c,d,i,!0)),un(c,s,i)),ht(s)&&l.set(s,c),c}function un(t,s,o,n=!1){const{mixins:a,extends:l}=s;l&&un(t,l,o,!0),a&&a.forEach(i=>un(t,i,o,!0));for(const i in s)if(!(n&&i==="expose")){const r=jc[i]||o&&o[i];t[i]=r?r(t[i],s[i]):s[i]}return t}const jc={data:za,props:Wa,emits:Wa,methods:xo,computed:xo,beforeCreate:Gt,created:Gt,beforeMount:Gt,mounted:Gt,beforeUpdate:Gt,updated:Gt,beforeDestroy:Gt,beforeUnmount:Gt,destroyed:Gt,unmounted:Gt,activated:Gt,deactivated:Gt,errorCaptured:Gt,serverPrefetch:Gt,components:xo,directives:xo,watch:Ec,provide:za,inject:Pc};function za(t,s){return s?t?function(){return Ht(tt(t)?t.call(this,this):t,tt(s)?s.call(this,this):s)}:s:t}function Pc(t,s){return xo(oa(t),oa(s))}function oa(t){if(qe(t)){const s={};for(let o=0;o<t.length;o++)s[t[o]]=t[o];return s}return t}function Gt(t,s){return t?[...new Set([].concat(t,s))]:s}function xo(t,s){return t?Ht(Object.create(null),t,s):s}function Wa(t,s){return t?qe(t)&&qe(s)?[...new Set([...t,...s])]:Ht(Object.create(null),Oa(t),Oa(s??{})):s}function Ec(t,s){if(!t)return s;if(!s)return t;const o=Ht(Object.create(null),t);for(const n in s)o[n]=Gt(t[n],s[n]);return o}function Mi(){return{app:null,config:{isNativeTag:jl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Bc=0;function Vc(t,s){return function(n,a=null){tt(n)||(n=Ht({},n)),a!=null&&!ht(a)&&(a=null);const l=Mi(),i=new WeakSet,r=[];let c=!1;const d=l.app={_uid:Bc++,_component:n,_props:a,_container:null,_context:l,_instance:null,version:fd,get config(){return l.config},set config(u){},use(u,...v){return i.has(u)||(u&&tt(u.install)?(i.add(u),u.install(d,...v)):tt(u)&&(i.add(u),u(d,...v))),d},mixin(u){return l.mixins.includes(u)||l.mixins.push(u),d},component(u,v){return v?(l.components[u]=v,d):l.components[u]},directive(u,v){return v?(l.directives[u]=v,d):l.directives[u]},mount(u,v,b){if(!c){const y=d._ceVNode||Ge(n,a);return y.appContext=l,b===!0?b="svg":b===!1&&(b=void 0),t(y,u,b),c=!0,d._container=u,u.__vue_app__=d,jn(y.component)}},onUnmount(u){r.push(u)},unmount(){c&&(ms(r,d._instance,16),t(null,d._container),delete d._container.__vue_app__)},provide(u,v){return l.provides[u]=v,d},runWithContext(u){const v=uo;uo=d;try{return u()}finally{uo=v}}};return d}}let uo=null;const Hc=(t,s)=>s==="modelValue"||s==="model-value"?t.modelModifiers:t[`${s}Modifiers`]||t[`${cs(s)}Modifiers`]||t[`${Rs(s)}Modifiers`];function Dc(t,s,...o){if(t.isUnmounted)return;const n=t.vnode.props||yt;let a=o;const l=s.startsWith("update:"),i=l&&Hc(n,s.slice(7));i&&(i.trim&&(a=o.map(u=>At(u)?u.trim():u)),i.number&&(a=o.map(xn)));let r,c=n[r=Hn(s)]||n[r=Hn(cs(s))];!c&&l&&(c=n[r=Hn(Rs(s))]),c&&ms(c,t,6,a);const d=n[r+"Once"];if(d){if(!t.emitted)t.emitted={};else if(t.emitted[r])return;t.emitted[r]=!0,ms(d,t,6,a)}}const Fc=new WeakMap;function Si(t,s,o=!1){const n=o?Fc:s.emitsCache,a=n.get(t);if(a!==void 0)return a;const l=t.emits;let i={},r=!1;if(!tt(t)){const c=d=>{const u=Si(d,s,!0);u&&(r=!0,Ht(i,u))};!o&&s.mixins.length&&s.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!l&&!r?(ht(t)&&n.set(t,null),null):(qe(l)?l.forEach(c=>i[c]=null):Ht(i,l),ht(t)&&n.set(t,i),i)}function An(t,s){return!t||!bn(s)?!1:(s=s.slice(2).replace(/Once$/,""),mt(t,s[0].toLowerCase()+s.slice(1))||mt(t,Rs(s))||mt(t,s))}function Ka(t){const{type:s,vnode:o,proxy:n,withProxy:a,propsOptions:[l],slots:i,attrs:r,emit:c,render:d,renderCache:u,props:v,data:b,setupState:y,ctx:M,inheritAttrs:A}=t,w=cn(t);let k,I;try{if(o.shapeFlag&4){const $=a||n,T=$;k=bs(d.call(T,$,u,v,y,b,M)),I=r}else{const $=s;k=bs($.length>1?$(v,{attrs:r,slots:i,emit:c}):$(v,null)),I=s.props?r:Uc(r)}}catch($){Po.length=0,Mn($,t,1),k=Ge(Jt)}let _=k;if(I&&A!==!1){const $=Object.keys(I),{shapeFlag:T}=_;$.length&&T&7&&(l&&$.some(va)&&(I=Nc(I,l)),_=Ns(_,I,!1,!0))}return o.dirs&&(_=Ns(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(o.dirs):o.dirs),o.transition&&to(_,o.transition),k=_,cn(w),k}const Uc=t=>{let s;for(const o in t)(o==="class"||o==="style"||bn(o))&&((s||(s={}))[o]=t[o]);return s},Nc=(t,s)=>{const o={};for(const n in t)(!va(n)||!(n.slice(9)in s))&&(o[n]=t[n]);return o};function Oc(t,s,o){const{props:n,children:a,component:l}=t,{props:i,children:r,patchFlag:c}=s,d=l.emitsOptions;if(s.dirs||s.transition)return!0;if(o&&c>=0){if(c&1024)return!0;if(c&16)return n?Ga(n,i,d):!!i;if(c&8){const u=s.dynamicProps;for(let v=0;v<u.length;v++){const b=u[v];if(i[b]!==n[b]&&!An(d,b))return!0}}}else return(a||r)&&(!r||!r.$stable)?!0:n===i?!1:n?i?Ga(n,i,d):!0:!!i;return!1}function Ga(t,s,o){const n=Object.keys(s);if(n.length!==Object.keys(t).length)return!0;for(let a=0;a<n.length;a++){const l=n[a];if(s[l]!==t[l]&&!An(o,l))return!0}return!1}function Rc({vnode:t,parent:s},o){for(;s;){const n=s.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=s.vnode).el=o,s=s.parent;else break}}const Ii={},Ai=()=>Object.create(Ii),Li=t=>Object.getPrototypeOf(t)===Ii;function zc(t,s,o,n=!1){const a={},l=Ai();t.propsDefaults=Object.create(null),Ti(t,s,a,l);for(const i in t.propsOptions[0])i in a||(a[i]=void 0);o?t.props=n?a:ec(a):t.type.props?t.props=a:t.props=l,t.attrs=l}function Wc(t,s,o,n){const{props:a,attrs:l,vnode:{patchFlag:i}}=t,r=ut(a),[c]=t.propsOptions;let d=!1;if((n||i>0)&&!(i&16)){if(i&8){const u=t.vnode.dynamicProps;for(let v=0;v<u.length;v++){let b=u[v];if(An(t.emitsOptions,b))continue;const y=s[b];if(c)if(mt(l,b))y!==l[b]&&(l[b]=y,d=!0);else{const M=cs(b);a[M]=na(c,r,M,y,t,!1)}else y!==l[b]&&(l[b]=y,d=!0)}}}else{Ti(t,s,a,l)&&(d=!0);let u;for(const v in r)(!s||!mt(s,v)&&((u=Rs(v))===v||!mt(s,u)))&&(c?o&&(o[v]!==void 0||o[u]!==void 0)&&(a[v]=na(c,r,v,void 0,t,!0)):delete a[v]);if(l!==r)for(const v in l)(!s||!mt(s,v))&&(delete l[v],d=!0)}d&&$s(t.attrs,"set","")}function Ti(t,s,o,n){const[a,l]=t.propsOptions;let i=!1,r;if(s)for(let c in s){if(_o(c))continue;const d=s[c];let u;a&&mt(a,u=cs(c))?!l||!l.includes(u)?o[u]=d:(r||(r={}))[u]=d:An(t.emitsOptions,c)||(!(c in n)||d!==n[c])&&(n[c]=d,i=!0)}if(l){const c=ut(o),d=r||yt;for(let u=0;u<l.length;u++){const v=l[u];o[v]=na(a,c,v,d[v],t,!mt(d,v))}}return i}function na(t,s,o,n,a,l){const i=t[o];if(i!=null){const r=mt(i,"default");if(r&&n===void 0){const c=i.default;if(i.type!==Function&&!i.skipFactory&&tt(c)){const{propsDefaults:d}=a;if(o in d)n=d[o];else{const u=Ro(a);n=d[o]=c.call(null,s),u()}}else n=c;a.ce&&a.ce._setProp(o,n)}i[0]&&(l&&!r?n=!1:i[1]&&(n===""||n===Rs(o))&&(n=!0))}return n}const Kc=new WeakMap;function ji(t,s,o=!1){const n=o?Kc:s.propsCache,a=n.get(t);if(a)return a;const l=t.props,i={},r=[];let c=!1;if(!tt(t)){const u=v=>{c=!0;const[b,y]=ji(v,s,!0);Ht(i,b),y&&r.push(...y)};!o&&s.mixins.length&&s.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!l&&!c)return ht(t)&&n.set(t,io),io;if(qe(l))for(let u=0;u<l.length;u++){const v=cs(l[u]);qa(v)&&(i[v]=yt)}else if(l)for(const u in l){const v=cs(u);if(qa(v)){const b=l[u],y=i[v]=qe(b)||tt(b)?{type:b}:Ht({},b),M=y.type;let A=!1,w=!0;if(qe(M))for(let k=0;k<M.length;++k){const I=M[k],_=tt(I)&&I.name;if(_==="Boolean"){A=!0;break}else _==="String"&&(w=!1)}else A=tt(M)&&M.name==="Boolean";y[0]=A,y[1]=w,(A||mt(y,"default"))&&r.push(v)}}const d=[i,r];return ht(t)&&n.set(t,d),d}function qa(t){return t[0]!=="$"&&!_o(t)}const Ma=t=>t==="_"||t==="_ctx"||t==="$stable",Sa=t=>qe(t)?t.map(bs):[bs(t)],Gc=(t,s,o)=>{if(s._n)return s;const n=ho((...a)=>Sa(s(...a)),o);return n._c=!1,n},Pi=(t,s,o)=>{const n=t._ctx;for(const a in t){if(Ma(a))continue;const l=t[a];if(tt(l))s[a]=Gc(a,l,n);else if(l!=null){const i=Sa(l);s[a]=()=>i}}},Ei=(t,s)=>{const o=Sa(s);t.slots.default=()=>o},Bi=(t,s,o)=>{for(const n in s)(o||!Ma(n))&&(t[n]=s[n])},qc=(t,s,o)=>{const n=t.slots=Ai();if(t.vnode.shapeFlag&32){const a=s._;a?(Bi(n,s,o),o&&Vl(n,"_",a,!0)):Pi(s,n)}else s&&Ei(t,s)},Zc=(t,s,o)=>{const{vnode:n,slots:a}=t;let l=!0,i=yt;if(n.shapeFlag&32){const r=s._;r?o&&r===1?l=!1:Bi(a,s,o):(l=!s.$stable,Pi(s,a)),i=s}else s&&(Ei(t,s),i={default:1});if(l)for(const r in a)!Ma(r)&&i[r]==null&&delete a[r]},qt=ed;function Jc(t){return Yc(t)}function Yc(t,s){const o=Cn();o.__VUE__=!0;const{insert:n,remove:a,patchProp:l,createElement:i,createText:r,createComment:c,setText:d,setElementText:u,parentNode:v,nextSibling:b,setScopeId:y=vs,insertStaticContent:M}=t,A=(V,O,z,ee=null,ce=null,ye=null,Le=void 0,Ae=null,Me=!!O.dynamicChildren)=>{if(V===O)return;V&&!Js(V,O)&&(ee=Q(V),$e(V,ce,ye,!0),V=null),O.patchFlag===-2&&(Me=!1,O.dynamicChildren=null);const{type:be,ref:Ne,shapeFlag:Ee}=O;switch(be){case Ln:w(V,O,z,ee);break;case Jt:k(V,O,z,ee);break;case jo:V==null&&I(O,z,ee,Le);break;case Pe:f(V,O,z,ee,ce,ye,Le,Ae,Me);break;default:Ee&1?T(V,O,z,ee,ce,ye,Le,Ae,Me):Ee&6?g(V,O,z,ee,ce,ye,Le,Ae,Me):(Ee&64||Ee&128)&&be.process(V,O,z,ee,ce,ye,Le,Ae,Me,D)}Ne!=null&&ce?Ao(Ne,V&&V.ref,ye,O||V,!O):Ne==null&&V&&V.ref!=null&&Ao(V.ref,null,ye,V,!0)},w=(V,O,z,ee)=>{if(V==null)n(O.el=r(O.children),z,ee);else{const ce=O.el=V.el;O.children!==V.children&&d(ce,O.children)}},k=(V,O,z,ee)=>{V==null?n(O.el=c(O.children||""),z,ee):O.el=V.el},I=(V,O,z,ee)=>{[V.el,V.anchor]=M(V.children,O,z,ee,V.el,V.anchor)},_=({el:V,anchor:O},z,ee)=>{let ce;for(;V&&V!==O;)ce=b(V),n(V,z,ee),V=ce;n(O,z,ee)},$=({el:V,anchor:O})=>{let z;for(;V&&V!==O;)z=b(V),a(V),V=z;a(O)},T=(V,O,z,ee,ce,ye,Le,Ae,Me)=>{if(O.type==="svg"?Le="svg":O.type==="math"&&(Le="mathml"),V==null)q(O,z,ee,ce,ye,Le,Ae,Me);else{const be=V.el&&V.el._isVueCE?V.el:null;try{be&&be._beginPatch(),J(V,O,ce,ye,Le,Ae,Me)}finally{be&&be._endPatch()}}},q=(V,O,z,ee,ce,ye,Le,Ae)=>{let Me,be;const{props:Ne,shapeFlag:Ee,transition:De,dirs:We}=V;if(Me=V.el=i(V.type,ye,Ne&&Ne.is,Ne),Ee&8?u(Me,V.children):Ee&16&&se(V.children,Me,null,ee,ce,zn(V,ye),Le,Ae),We&&Ks(V,null,ee,"created"),oe(Me,V,V.scopeId,Le,ee),Ne){for(const ge in Ne)ge!=="value"&&!_o(ge)&&l(Me,ge,null,Ne[ge],ye,ee);"value"in Ne&&l(Me,"value",null,Ne.value,ye),(be=Ne.onVnodeBeforeMount)&&gs(be,ee,V)}We&&Ks(V,null,ee,"beforeMount");const Je=Xc(ce,De);Je&&De.beforeEnter(Me),n(Me,O,z),((be=Ne&&Ne.onVnodeMounted)||Je||We)&&qt(()=>{be&&gs(be,ee,V),Je&&De.enter(Me),We&&Ks(V,null,ee,"mounted")},ce)},oe=(V,O,z,ee,ce)=>{if(z&&y(V,z),ee)for(let ye=0;ye<ee.length;ye++)y(V,ee[ye]);if(ce){let ye=ce.subTree;if(O===ye||Di(ye.type)&&(ye.ssContent===O||ye.ssFallback===O)){const Le=ce.vnode;oe(V,Le,Le.scopeId,Le.slotScopeIds,ce.parent)}}},se=(V,O,z,ee,ce,ye,Le,Ae,Me=0)=>{for(let be=Me;be<V.length;be++){const Ne=V[be]=Ae?Ds(V[be]):bs(V[be]);A(null,Ne,O,z,ee,ce,ye,Le,Ae)}},J=(V,O,z,ee,ce,ye,Le)=>{const Ae=O.el=V.el;let{patchFlag:Me,dynamicChildren:be,dirs:Ne}=O;Me|=V.patchFlag&16;const Ee=V.props||yt,De=O.props||yt;let We;if(z&&Gs(z,!1),(We=De.onVnodeBeforeUpdate)&&gs(We,z,O,V),Ne&&Ks(O,V,z,"beforeUpdate"),z&&Gs(z,!0),(Ee.innerHTML&&De.innerHTML==null||Ee.textContent&&De.textContent==null)&&u(Ae,""),be?N(V.dynamicChildren,be,Ae,z,ee,zn(O,ce),ye):Le||L(V,O,Ae,null,z,ee,zn(O,ce),ye,!1),Me>0){if(Me&16)P(Ae,Ee,De,z,ce);else if(Me&2&&Ee.class!==De.class&&l(Ae,"class",null,De.class,ce),Me&4&&l(Ae,"style",Ee.style,De.style,ce),Me&8){const Je=O.dynamicProps;for(let ge=0;ge<Je.length;ge++){const le=Je[ge],He=Ee[le],ke=De[le];(ke!==He||le==="value")&&l(Ae,le,He,ke,ce,z)}}Me&1&&V.children!==O.children&&u(Ae,O.children)}else!Le&&be==null&&P(Ae,Ee,De,z,ce);((We=De.onVnodeUpdated)||Ne)&&qt(()=>{We&&gs(We,z,O,V),Ne&&Ks(O,V,z,"updated")},ee)},N=(V,O,z,ee,ce,ye,Le)=>{for(let Ae=0;Ae<O.length;Ae++){const Me=V[Ae],be=O[Ae],Ne=Me.el&&(Me.type===Pe||!Js(Me,be)||Me.shapeFlag&198)?v(Me.el):z;A(Me,be,Ne,null,ee,ce,ye,Le,!0)}},P=(V,O,z,ee,ce)=>{if(O!==z){if(O!==yt)for(const ye in O)!_o(ye)&&!(ye in z)&&l(V,ye,O[ye],null,ce,ee);for(const ye in z){if(_o(ye))continue;const Le=z[ye],Ae=O[ye];Le!==Ae&&ye!=="value"&&l(V,ye,Ae,Le,ce,ee)}"value"in z&&l(V,"value",O.value,z.value,ce)}},f=(V,O,z,ee,ce,ye,Le,Ae,Me)=>{const be=O.el=V?V.el:r(""),Ne=O.anchor=V?V.anchor:r("");let{patchFlag:Ee,dynamicChildren:De,slotScopeIds:We}=O;We&&(Ae=Ae?Ae.concat(We):We),V==null?(n(be,z,ee),n(Ne,z,ee),se(O.children||[],z,Ne,ce,ye,Le,Ae,Me)):Ee>0&&Ee&64&&De&&V.dynamicChildren&&V.dynamicChildren.length===De.length?(N(V.dynamicChildren,De,z,ce,ye,Le,Ae),(O.key!=null||ce&&O===ce.subTree)&&Ia(V,O,!0)):L(V,O,z,Ne,ce,ye,Le,Ae,Me)},g=(V,O,z,ee,ce,ye,Le,Ae,Me)=>{O.slotScopeIds=Ae,V==null?O.shapeFlag&512?ce.ctx.activate(O,z,ee,Le,Me):H(O,z,ee,ce,ye,Le,Me):K(V,O,Me)},H=(V,O,z,ee,ce,ye,Le)=>{const Ae=V.component=id(V,ee,ce);if(Sn(V)&&(Ae.ctx.renderer=D),rd(Ae,!1,Le),Ae.asyncDep){if(ce&&ce.registerDep(Ae,F,Le),!V.el){const Me=Ae.subTree=Ge(Jt);k(null,Me,O,z),V.placeholder=Me.el}}else F(Ae,V,O,z,ce,ye,Le)},K=(V,O,z)=>{const ee=O.component=V.component;if(Oc(V,O,z))if(ee.asyncDep&&!ee.asyncResolved){x(ee,O,z);return}else ee.next=O,ee.update();else O.el=V.el,ee.vnode=O},F=(V,O,z,ee,ce,ye,Le)=>{const Ae=()=>{if(V.isMounted){let{next:Ee,bu:De,u:We,parent:Je,vnode:ge}=V;{const vt=Vi(V);if(vt){Ee&&(Ee.el=ge.el,x(V,Ee,Le)),vt.asyncDep.then(()=>{V.isUnmounted||Ae()});return}}let le=Ee,He;Gs(V,!1),Ee?(Ee.el=ge.el,x(V,Ee,Le)):Ee=ge,De&&Xo(De),(He=Ee.props&&Ee.props.onVnodeBeforeUpdate)&&gs(He,Je,Ee,ge),Gs(V,!0);const ke=Ka(V),Be=V.subTree;V.subTree=ke,A(Be,ke,v(Be.el),Q(Be),V,ce,ye),Ee.el=ke.el,le===null&&Rc(V,ke.el),We&&qt(We,ce),(He=Ee.props&&Ee.props.onVnodeUpdated)&&qt(()=>gs(He,Je,Ee,ge),ce)}else{let Ee;const{el:De,props:We}=O,{bm:Je,m:ge,parent:le,root:He,type:ke}=V,Be=Lo(O);Gs(V,!1),Je&&Xo(Je),!Be&&(Ee=We&&We.onVnodeBeforeMount)&&gs(Ee,le,O),Gs(V,!0);{He.ce&&He.ce._def.shadowRoot!==!1&&He.ce._injectChildStyle(ke);const vt=V.subTree=Ka(V);A(null,vt,z,ee,V,ce,ye),O.el=vt.el}if(ge&&qt(ge,ce),!Be&&(Ee=We&&We.onVnodeMounted)){const vt=O;qt(()=>gs(Ee,le,vt),ce)}(O.shapeFlag&256||le&&Lo(le.vnode)&&le.vnode.shapeFlag&256)&&V.a&&qt(V.a,ce),V.isMounted=!0,O=z=ee=null}};V.scope.on();const Me=V.effect=new Ul(Ae);V.scope.off();const be=V.update=Me.run.bind(Me),Ne=V.job=Me.runIfDirty.bind(Me);Ne.i=V,Ne.id=V.uid,Me.scheduler=()=>Ca(Ne),Gs(V,!0),be()},x=(V,O,z)=>{O.component=V;const ee=V.vnode.props;V.vnode=O,V.next=null,Wc(V,O.props,ee,z),Zc(V,O.children,z),Ss(),Ba(V),Is()},L=(V,O,z,ee,ce,ye,Le,Ae,Me=!1)=>{const be=V&&V.children,Ne=V?V.shapeFlag:0,Ee=O.children,{patchFlag:De,shapeFlag:We}=O;if(De>0){if(De&128){de(be,Ee,z,ee,ce,ye,Le,Ae,Me);return}else if(De&256){ae(be,Ee,z,ee,ce,ye,Le,Ae,Me);return}}We&8?(Ne&16&&j(be,ce,ye),Ee!==be&&u(z,Ee)):Ne&16?We&16?de(be,Ee,z,ee,ce,ye,Le,Ae,Me):j(be,ce,ye,!0):(Ne&8&&u(z,""),We&16&&se(Ee,z,ee,ce,ye,Le,Ae,Me))},ae=(V,O,z,ee,ce,ye,Le,Ae,Me)=>{V=V||io,O=O||io;const be=V.length,Ne=O.length,Ee=Math.min(be,Ne);let De;for(De=0;De<Ee;De++){const We=O[De]=Me?Ds(O[De]):bs(O[De]);A(V[De],We,z,null,ce,ye,Le,Ae,Me)}be>Ne?j(V,ce,ye,!0,!1,Ee):se(O,z,ee,ce,ye,Le,Ae,Me,Ee)},de=(V,O,z,ee,ce,ye,Le,Ae,Me)=>{let be=0;const Ne=O.length;let Ee=V.length-1,De=Ne-1;for(;be<=Ee&&be<=De;){const We=V[be],Je=O[be]=Me?Ds(O[be]):bs(O[be]);if(Js(We,Je))A(We,Je,z,null,ce,ye,Le,Ae,Me);else break;be++}for(;be<=Ee&&be<=De;){const We=V[Ee],Je=O[De]=Me?Ds(O[De]):bs(O[De]);if(Js(We,Je))A(We,Je,z,null,ce,ye,Le,Ae,Me);else break;Ee--,De--}if(be>Ee){if(be<=De){const We=De+1,Je=We<Ne?O[We].el:ee;for(;be<=De;)A(null,O[be]=Me?Ds(O[be]):bs(O[be]),z,Je,ce,ye,Le,Ae,Me),be++}}else if(be>De)for(;be<=Ee;)$e(V[be],ce,ye,!0),be++;else{const We=be,Je=be,ge=new Map;for(be=Je;be<=De;be++){const te=O[be]=Me?Ds(O[be]):bs(O[be]);te.key!=null&&ge.set(te.key,be)}let le,He=0;const ke=De-Je+1;let Be=!1,vt=0;const pt=new Array(ke);for(be=0;be<ke;be++)pt[be]=0;for(be=We;be<=Ee;be++){const te=V[be];if(He>=ke){$e(te,ce,ye,!0);continue}let pe;if(te.key!=null)pe=ge.get(te.key);else for(le=Je;le<=De;le++)if(pt[le-Je]===0&&Js(te,O[le])){pe=le;break}pe===void 0?$e(te,ce,ye,!0):(pt[pe-Je]=be+1,pe>=vt?vt=pe:Be=!0,A(te,O[pe],z,null,ce,ye,Le,Ae,Me),He++)}const re=Be?Qc(pt):io;for(le=re.length-1,be=ke-1;be>=0;be--){const te=Je+be,pe=O[te],ze=O[te+1],Ce=te+1<Ne?ze.el||Hi(ze):ee;pt[be]===0?A(null,pe,z,Ce,ce,ye,Le,Ae,Me):Be&&(le<0||be!==re[le]?ue(pe,z,Ce,2):le--)}}},ue=(V,O,z,ee,ce=null)=>{const{el:ye,type:Le,transition:Ae,children:Me,shapeFlag:be}=V;if(be&6){ue(V.component.subTree,O,z,ee);return}if(be&128){V.suspense.move(O,z,ee);return}if(be&64){Le.move(V,O,z,D);return}if(Le===Pe){n(ye,O,z);for(let Ee=0;Ee<Me.length;Ee++)ue(Me[Ee],O,z,ee);n(V.anchor,O,z);return}if(Le===jo){_(V,O,z);return}if(ee!==2&&be&1&&Ae)if(ee===0)Ae.beforeEnter(ye),n(ye,O,z),qt(()=>Ae.enter(ye),ce);else{const{leave:Ee,delayLeave:De,afterLeave:We}=Ae,Je=()=>{V.ctx.isUnmounted?a(ye):n(ye,O,z)},ge=()=>{ye._isLeaving&&ye[Cs](!0),Ee(ye,()=>{Je(),We&&We()})};De?De(ye,Je,ge):ge()}else n(ye,O,z)},$e=(V,O,z,ee=!1,ce=!1)=>{const{type:ye,props:Le,ref:Ae,children:Me,dynamicChildren:be,shapeFlag:Ne,patchFlag:Ee,dirs:De,cacheIndex:We}=V;if(Ee===-2&&(ce=!1),Ae!=null&&(Ss(),Ao(Ae,null,z,V,!0),Is()),We!=null&&(O.renderCache[We]=void 0),Ne&256){O.ctx.deactivate(V);return}const Je=Ne&1&&De,ge=!Lo(V);let le;if(ge&&(le=Le&&Le.onVnodeBeforeUnmount)&&gs(le,O,V),Ne&6)he(V.component,z,ee);else{if(Ne&128){V.suspense.unmount(z,ee);return}Je&&Ks(V,null,O,"beforeUnmount"),Ne&64?V.type.remove(V,O,z,D,ee):be&&!be.hasOnce&&(ye!==Pe||Ee>0&&Ee&64)?j(be,O,z,!1,!0):(ye===Pe&&Ee&384||!ce&&Ne&16)&&j(Me,O,z),ee&&ne(V)}(ge&&(le=Le&&Le.onVnodeUnmounted)||Je)&&qt(()=>{le&&gs(le,O,V),Je&&Ks(V,null,O,"unmounted")},z)},ne=V=>{const{type:O,el:z,anchor:ee,transition:ce}=V;if(O===Pe){G(z,ee);return}if(O===jo){$(V);return}const ye=()=>{a(z),ce&&!ce.persisted&&ce.afterLeave&&ce.afterLeave()};if(V.shapeFlag&1&&ce&&!ce.persisted){const{leave:Le,delayLeave:Ae}=ce,Me=()=>Le(z,ye);Ae?Ae(V.el,ye,Me):Me()}else ye()},G=(V,O)=>{let z;for(;V!==O;)z=b(V),a(V),V=z;a(O)},he=(V,O,z)=>{const{bum:ee,scope:ce,job:ye,subTree:Le,um:Ae,m:Me,a:be}=V;Za(Me),Za(be),ee&&Xo(ee),ce.stop(),ye&&(ye.flags|=8,$e(Le,V,O,z)),Ae&&qt(Ae,O),qt(()=>{V.isUnmounted=!0},O)},j=(V,O,z,ee=!1,ce=!1,ye=0)=>{for(let Le=ye;Le<V.length;Le++)$e(V[Le],O,z,ee,ce)},Q=V=>{if(V.shapeFlag&6)return Q(V.component.subTree);if(V.shapeFlag&128)return V.suspense.next();const O=b(V.anchor||V.el),z=O&&O[ci];return z?b(z):O};let W=!1;const B=(V,O,z)=>{let ee;V==null?O._vnode&&($e(O._vnode,null,null,!0),ee=O._vnode.component):A(O._vnode||null,V,O,null,null,null,z),O._vnode=V,W||(W=!0,Ba(ee),ni(),W=!1)},D={p:A,um:$e,m:ue,r:ne,mt:H,mc:se,pc:L,pbc:N,n:Q,o:t};return{render:B,hydrate:void 0,createApp:Vc(B)}}function zn({type:t,props:s},o){return o==="svg"&&t==="foreignObject"||o==="mathml"&&t==="annotation-xml"&&s&&s.encoding&&s.encoding.includes("html")?void 0:o}function Gs({effect:t,job:s},o){o?(t.flags|=32,s.flags|=4):(t.flags&=-33,s.flags&=-5)}function Xc(t,s){return(!t||t&&!t.pendingBranch)&&s&&!s.persisted}function Ia(t,s,o=!1){const n=t.children,a=s.children;if(qe(n)&&qe(a))for(let l=0;l<n.length;l++){const i=n[l];let r=a[l];r.shapeFlag&1&&!r.dynamicChildren&&((r.patchFlag<=0||r.patchFlag===32)&&(r=a[l]=Ds(a[l]),r.el=i.el),!o&&r.patchFlag!==-2&&Ia(i,r)),r.type===Ln&&(r.patchFlag!==-1?r.el=i.el:r.__elIndex=l+(t.type===Pe?1:0)),r.type===Jt&&!r.el&&(r.el=i.el)}}function Qc(t){const s=t.slice(),o=[0];let n,a,l,i,r;const c=t.length;for(n=0;n<c;n++){const d=t[n];if(d!==0){if(a=o[o.length-1],t[a]<d){s[n]=a,o.push(n);continue}for(l=0,i=o.length-1;l<i;)r=l+i>>1,t[o[r]]<d?l=r+1:i=r;d<t[o[l]]&&(l>0&&(s[n]=o[l-1]),o[l]=n)}}for(l=o.length,i=o[l-1];l-- >0;)o[l]=i,i=s[i];return o}function Vi(t){const s=t.subTree.component;if(s)return s.asyncDep&&!s.asyncResolved?s:Vi(s)}function Za(t){if(t)for(let s=0;s<t.length;s++)t[s].flags|=8}function Hi(t){if(t.placeholder)return t.placeholder;const s=t.component;return s?Hi(s.subTree):null}const Di=t=>t.__isSuspense;function ed(t,s){s&&s.pendingBranch?qe(t)?s.effects.push(...t):s.effects.push(t):oi(t)}const Pe=Symbol.for("v-fgt"),Ln=Symbol.for("v-txt"),Jt=Symbol.for("v-cmt"),jo=Symbol.for("v-stc"),Po=[];let ss=null;function p(t=!1){Po.push(ss=t?null:[])}function td(){Po.pop(),ss=Po[Po.length-1]||null}let Do=1;function vn(t,s=!1){Do+=t,t<0&&ss&&s&&(ss.hasOnce=!0)}function Fi(t){return t.dynamicChildren=Do>0?ss||io:null,td(),Do>0&&ss&&ss.push(t),t}function m(t,s,o,n,a,l){return Fi(e(t,s,o,n,a,l,!0))}function st(t,s,o,n,a){return Fi(Ge(t,s,o,n,a,!0))}function pn(t){return t?t.__v_isVNode===!0:!1}function Js(t,s){return t.type===s.type&&t.key===s.key}const Ui=({key:t})=>t??null,tn=({ref:t,ref_key:s,ref_for:o})=>(typeof t=="number"&&(t=""+t),t!=null?At(t)||Rt(t)||tt(t)?{i:ts,r:t,k:s,f:!!o}:t:null);function e(t,s=null,o=null,n=0,a=null,l=t===Pe?0:1,i=!1,r=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:s,key:s&&Ui(s),ref:s&&tn(s),scopeId:li,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:l,patchFlag:n,dynamicProps:a,dynamicChildren:null,appContext:null,ctx:ts};return r?(Aa(c,o),l&128&&t.normalize(c)):o&&(c.shapeFlag|=At(o)?8:16),Do>0&&!i&&ss&&(c.patchFlag>0||l&6)&&c.patchFlag!==32&&ss.push(c),c}const Ge=sd;function sd(t,s=null,o=null,n=0,a=null,l=!1){if((!t||t===Ci)&&(t=Jt),pn(t)){const r=Ns(t,s,!0);return o&&Aa(r,o),Do>0&&!l&&ss&&(r.shapeFlag&6?ss[ss.indexOf(t)]=r:ss.push(r)),r.patchFlag=-2,r}if(pd(t)&&(t=t.__vccOpts),s){s=od(s);let{class:r,style:c}=s;r&&!At(r)&&(s.class=Ie(r)),ht(c)&&(xa(c)&&!qe(c)&&(c=Ht({},c)),s.style=Re(c))}const i=At(t)?1:Di(t)?128:di(t)?64:ht(t)?4:tt(t)?2:0;return e(t,s,o,n,a,i,l,!0)}function od(t){return t?xa(t)||Li(t)?Ht({},t):t:null}function Ns(t,s,o=!1,n=!1){const{props:a,ref:l,patchFlag:i,children:r,transition:c}=t,d=s?nd(a||{},s):a,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:d,key:d&&Ui(d),ref:s&&s.ref?o&&l?qe(l)?l.concat(tn(s)):[l,tn(s)]:tn(s):l,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:r,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:s&&t.type!==Pe?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Ns(t.ssContent),ssFallback:t.ssFallback&&Ns(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&n&&to(u,c.clone(u)),u}function Qe(t=" ",s=0){return Ge(Ln,null,t,s)}function dt(t,s){const o=Ge(jo,null,t);return o.staticCount=s,o}function U(t="",s=!1){return s?(p(),st(Jt,null,t)):Ge(Jt,null,t)}function bs(t){return t==null||typeof t=="boolean"?Ge(Jt):qe(t)?Ge(Pe,null,t.slice()):pn(t)?Ds(t):Ge(Ln,null,String(t))}function Ds(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Ns(t)}function Aa(t,s){let o=0;const{shapeFlag:n}=t;if(s==null)s=null;else if(qe(s))o=16;else if(typeof s=="object")if(n&65){const a=s.default;a&&(a._c&&(a._d=!1),Aa(t,a()),a._c&&(a._d=!0));return}else{o=32;const a=s._;!a&&!Li(s)?s._ctx=ts:a===3&&ts&&(ts.slots._===1?s._=1:(s._=2,t.patchFlag|=1024))}else tt(s)?(s={default:s,_ctx:ts},o=32):(s=String(s),n&64?(o=16,s=[Qe(s)]):o=8);t.children=s,t.shapeFlag|=o}function nd(...t){const s={};for(let o=0;o<t.length;o++){const n=t[o];for(const a in n)if(a==="class")s.class!==n.class&&(s.class=Ie([s.class,n.class]));else if(a==="style")s.style=Re([s.style,n.style]);else if(bn(a)){const l=s[a],i=n[a];i&&l!==i&&!(qe(l)&&l.includes(i))&&(s[a]=l?[].concat(l,i):i)}else a!==""&&(s[a]=n[a])}return s}function gs(t,s,o,n=null){ms(t,s,7,[o,n])}const ad=Mi();let ld=0;function id(t,s,o){const n=t.type,a=(s?s.appContext:t.appContext)||ad,l={uid:ld++,vnode:t,type:n,parent:s,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Er(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:s?s.provides:Object.create(a.provides),ids:s?s.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ji(n,a),emitsOptions:Si(n,a),emit:null,emitted:null,propsDefaults:yt,inheritAttrs:n.inheritAttrs,ctx:yt,data:yt,props:yt,attrs:yt,slots:yt,refs:yt,setupState:yt,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return l.ctx={_:l},l.root=s?s.root:l,l.emit=Dc.bind(null,l),t.ce&&t.ce(l),l}let Ot=null;const Tn=()=>Ot||ts;let fn,aa;{const t=Cn(),s=(o,n)=>{let a;return(a=t[o])||(a=t[o]=[]),a.push(n),l=>{a.length>1?a.forEach(i=>i(l)):a[0](l)}};fn=s("__VUE_INSTANCE_SETTERS__",o=>Ot=o),aa=s("__VUE_SSR_SETTERS__",o=>Fo=o)}const Ro=t=>{const s=Ot;return fn(t),t.scope.on(),()=>{t.scope.off(),fn(s)}},Ja=()=>{Ot&&Ot.scope.off(),fn(null)};function Ni(t){return t.vnode.shapeFlag&4}let Fo=!1;function rd(t,s=!1,o=!1){s&&aa(s);const{props:n,children:a}=t.vnode,l=Ni(t);zc(t,n,l,s),qc(t,a,o||s);const i=l?cd(t,s):void 0;return s&&aa(!1),i}function cd(t,s){const o=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Ac);const{setup:n}=o;if(n){Ss();const a=t.setupContext=n.length>1?ud(t):null,l=Ro(t),i=Oo(n,t,0,[t.props,a]),r=Pl(i);if(Is(),l(),(r||t.sp)&&!Lo(t)&&yi(t),r){if(i.then(Ja,Ja),s)return i.then(c=>{Ya(t,c)}).catch(c=>{Mn(c,t,0)});t.asyncDep=i}else Ya(t,i)}else Oi(t)}function Ya(t,s,o){tt(s)?t.type.__ssrInlineRender?t.ssrRender=s:t.render=s:ht(s)&&(t.setupState=ei(s)),Oi(t)}function Oi(t,s,o){const n=t.type;t.render||(t.render=n.render||vs);{const a=Ro(t);Ss();try{Lc(t)}finally{Is(),a()}}}const dd={get(t,s){return Nt(t,"get",""),t[s]}};function ud(t){const s=o=>{t.exposed=o||{}};return{attrs:new Proxy(t.attrs,dd),slots:t.slots,emit:t.emit,expose:s}}function jn(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(ei(tc(t.exposed)),{get(s,o){if(o in s)return s[o];if(o in To)return To[o](t)},has(s,o){return o in s||o in To}})):t.proxy}function vd(t,s=!0){return tt(t)?t.displayName||t.name:t.name||s&&t.__name}function pd(t){return tt(t)&&"__vccOpts"in t}const ot=(t,s)=>lc(t,s,Fo);function mn(t,s,o){try{vn(-1);const n=arguments.length;return n===2?ht(s)&&!qe(s)?pn(s)?Ge(t,null,[s]):Ge(t,s):Ge(t,null,s):(n>3?o=Array.prototype.slice.call(arguments,2):n===3&&pn(o)&&(o=[o]),Ge(t,s,o))}finally{vn(1)}}const fd="3.5.26";/**
* @vue/runtime-dom v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let la;const Xa=typeof window<"u"&&window.trustedTypes;if(Xa)try{la=Xa.createPolicy("vue",{createHTML:t=>t})}catch{}const Ri=la?t=>la.createHTML(t):t=>t,md="http://www.w3.org/2000/svg",gd="http://www.w3.org/1998/Math/MathML",xs=typeof document<"u"?document:null,Qa=xs&&xs.createElement("template"),hd={insert:(t,s,o)=>{s.insertBefore(t,o||null)},remove:t=>{const s=t.parentNode;s&&s.removeChild(t)},createElement:(t,s,o,n)=>{const a=s==="svg"?xs.createElementNS(md,t):s==="mathml"?xs.createElementNS(gd,t):o?xs.createElement(t,{is:o}):xs.createElement(t);return t==="select"&&n&&n.multiple!=null&&a.setAttribute("multiple",n.multiple),a},createText:t=>xs.createTextNode(t),createComment:t=>xs.createComment(t),setText:(t,s)=>{t.nodeValue=s},setElementText:(t,s)=>{t.textContent=s},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>xs.querySelector(t),setScopeId(t,s){t.setAttribute(s,"")},insertStaticContent(t,s,o,n,a,l){const i=o?o.previousSibling:s.lastChild;if(a&&(a===l||a.nextSibling))for(;s.insertBefore(a.cloneNode(!0),o),!(a===l||!(a=a.nextSibling)););else{Qa.innerHTML=Ri(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const r=Qa.content;if(n==="svg"||n==="mathml"){const c=r.firstChild;for(;c.firstChild;)r.appendChild(c.firstChild);r.removeChild(c)}s.insertBefore(r,o)}return[i?i.nextSibling:s.firstChild,o?o.previousSibling:s.lastChild]}},js="transition",bo="animation",fo=Symbol("_vtc"),zi={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Wi=Ht({},fi,zi),yd=t=>(t.displayName="Transition",t.props=Wi,t),Ki=yd((t,{slots:s})=>mn(yc,Gi(t),s)),qs=(t,s=[])=>{qe(t)?t.forEach(o=>o(...s)):t&&t(...s)},el=t=>t?qe(t)?t.some(s=>s.length>1):t.length>1:!1;function Gi(t){const s={};for(const f in t)f in zi||(s[f]=t[f]);if(t.css===!1)return s;const{name:o="v",type:n,duration:a,enterFromClass:l=`${o}-enter-from`,enterActiveClass:i=`${o}-enter-active`,enterToClass:r=`${o}-enter-to`,appearFromClass:c=l,appearActiveClass:d=i,appearToClass:u=r,leaveFromClass:v=`${o}-leave-from`,leaveActiveClass:b=`${o}-leave-active`,leaveToClass:y=`${o}-leave-to`}=t,M=bd(a),A=M&&M[0],w=M&&M[1],{onBeforeEnter:k,onEnter:I,onEnterCancelled:_,onLeave:$,onLeaveCancelled:T,onBeforeAppear:q=k,onAppear:oe=I,onAppearCancelled:se=_}=s,J=(f,g,H,K)=>{f._enterCancelled=K,Bs(f,g?u:r),Bs(f,g?d:i),H&&H()},N=(f,g)=>{f._isLeaving=!1,Bs(f,v),Bs(f,y),Bs(f,b),g&&g()},P=f=>(g,H)=>{const K=f?oe:I,F=()=>J(g,f,H);qs(K,[g,F]),tl(()=>{Bs(g,f?c:l),hs(g,f?u:r),el(K)||sl(g,n,A,F)})};return Ht(s,{onBeforeEnter(f){qs(k,[f]),hs(f,l),hs(f,i)},onBeforeAppear(f){qs(q,[f]),hs(f,c),hs(f,d)},onEnter:P(!1),onAppear:P(!0),onLeave(f,g){f._isLeaving=!0;const H=()=>N(f,g);hs(f,v),f._enterCancelled?(hs(f,b),ia(f)):(ia(f),hs(f,b)),tl(()=>{f._isLeaving&&(Bs(f,v),hs(f,y),el($)||sl(f,n,w,H))}),qs($,[f,H])},onEnterCancelled(f){J(f,!1,void 0,!0),qs(_,[f])},onAppearCancelled(f){J(f,!0,void 0,!0),qs(se,[f])},onLeaveCancelled(f){N(f),qs(T,[f])}})}function bd(t){if(t==null)return null;if(ht(t))return[Wn(t.enter),Wn(t.leave)];{const s=Wn(t);return[s,s]}}function Wn(t){return _r(t)}function hs(t,s){s.split(/\s+/).forEach(o=>o&&t.classList.add(o)),(t[fo]||(t[fo]=new Set)).add(s)}function Bs(t,s){s.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const o=t[fo];o&&(o.delete(s),o.size||(t[fo]=void 0))}function tl(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let wd=0;function sl(t,s,o,n){const a=t._endId=++wd,l=()=>{a===t._endId&&n()};if(o!=null)return setTimeout(l,o);const{type:i,timeout:r,propCount:c}=qi(t,s);if(!i)return n();const d=i+"end";let u=0;const v=()=>{t.removeEventListener(d,b),l()},b=y=>{y.target===t&&++u>=c&&v()};setTimeout(()=>{u<c&&v()},r+1),t.addEventListener(d,b)}function qi(t,s){const o=window.getComputedStyle(t),n=M=>(o[M]||"").split(", "),a=n(`${js}Delay`),l=n(`${js}Duration`),i=ol(a,l),r=n(`${bo}Delay`),c=n(`${bo}Duration`),d=ol(r,c);let u=null,v=0,b=0;s===js?i>0&&(u=js,v=i,b=l.length):s===bo?d>0&&(u=bo,v=d,b=c.length):(v=Math.max(i,d),u=v>0?i>d?js:bo:null,b=u?u===js?l.length:c.length:0);const y=u===js&&/\b(?:transform|all)(?:,|$)/.test(n(`${js}Property`).toString());return{type:u,timeout:v,propCount:b,hasTransform:y}}function ol(t,s){for(;t.length<s.length;)t=t.concat(t);return Math.max(...s.map((o,n)=>nl(o)+nl(t[n])))}function nl(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function ia(t){return(t?t.ownerDocument:document).body.offsetHeight}function kd(t,s,o){const n=t[fo];n&&(s=(s?[s,...n]:[...n]).join(" ")),s==null?t.removeAttribute("class"):o?t.setAttribute("class",s):t.className=s}const gn=Symbol("_vod"),Zi=Symbol("_vsh"),vo={name:"show",beforeMount(t,{value:s},{transition:o}){t[gn]=t.style.display==="none"?"":t.style.display,o&&s?o.beforeEnter(t):wo(t,s)},mounted(t,{value:s},{transition:o}){o&&s&&o.enter(t)},updated(t,{value:s,oldValue:o},{transition:n}){!s!=!o&&(n?s?(n.beforeEnter(t),wo(t,!0),n.enter(t)):n.leave(t,()=>{wo(t,!1)}):wo(t,s))},beforeUnmount(t,{value:s}){wo(t,s)}};function wo(t,s){t.style.display=s?t[gn]:"none",t[Zi]=!s}const Ji=Symbol("");function xd(t){const s=Tn();if(!s)return;const o=s.ut=(a=t(s.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${s.uid}"]`)).forEach(l=>hn(l,a))},n=()=>{const a=t(s.proxy);s.ce?hn(s.ce,a):ra(s.subTree,a),o(a)};wi(()=>{oi(n)}),nt(()=>{Pt(n,vs,{flush:"post"});const a=new MutationObserver(n);a.observe(s.subTree.el.parentNode,{childList:!0}),Dt(()=>a.disconnect())})}function ra(t,s){if(t.shapeFlag&128){const o=t.suspense;t=o.activeBranch,o.pendingBranch&&!o.isHydrating&&o.effects.push(()=>{ra(o.activeBranch,s)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)hn(t.el,s);else if(t.type===Pe)t.children.forEach(o=>ra(o,s));else if(t.type===jo){let{el:o,anchor:n}=t;for(;o&&(hn(o,s),o!==n);)o=o.nextSibling}}function hn(t,s){if(t.nodeType===1){const o=t.style;let n="";for(const a in s){const l=Pr(s[a]);o.setProperty(`--${a}`,l),n+=`--${a}: ${l};`}o[Ji]=n}}const Cd=/(?:^|;)\s*display\s*:/;function $d(t,s,o){const n=t.style,a=At(o);let l=!1;if(o&&!a){if(s)if(At(s))for(const i of s.split(";")){const r=i.slice(0,i.indexOf(":")).trim();o[r]==null&&sn(n,r,"")}else for(const i in s)o[i]==null&&sn(n,i,"");for(const i in o)i==="display"&&(l=!0),sn(n,i,o[i])}else if(a){if(s!==o){const i=n[Ji];i&&(o+=";"+i),n.cssText=o,l=Cd.test(o)}}else s&&t.removeAttribute("style");gn in t&&(t[gn]=l?n.display:"",t[Zi]&&(n.display="none"))}const al=/\s*!important$/;function sn(t,s,o){if(qe(o))o.forEach(n=>sn(t,s,n));else if(o==null&&(o=""),s.startsWith("--"))t.setProperty(s,o);else{const n=_d(t,s);al.test(o)?t.setProperty(Rs(n),o.replace(al,""),"important"):t[n]=o}}const ll=["Webkit","Moz","ms"],Kn={};function _d(t,s){const o=Kn[s];if(o)return o;let n=cs(s);if(n!=="filter"&&n in t)return Kn[s]=n;n=kn(n);for(let a=0;a<ll.length;a++){const l=ll[a]+n;if(l in t)return Kn[s]=l}return s}const il="http://www.w3.org/1999/xlink";function rl(t,s,o,n,a,l=Tr(s)){n&&s.startsWith("xlink:")?o==null?t.removeAttributeNS(il,s.slice(6,s.length)):t.setAttributeNS(il,s,o):o==null||l&&!Hl(o)?t.removeAttribute(s):t.setAttribute(s,l?"":ws(o)?String(o):o)}function cl(t,s,o,n,a){if(s==="innerHTML"||s==="textContent"){o!=null&&(t[s]=s==="innerHTML"?Ri(o):o);return}const l=t.tagName;if(s==="value"&&l!=="PROGRESS"&&!l.includes("-")){const r=l==="OPTION"?t.getAttribute("value")||"":t.value,c=o==null?t.type==="checkbox"?"on":"":String(o);(r!==c||!("_value"in t))&&(t.value=c),o==null&&t.removeAttribute(s),t._value=o;return}let i=!1;if(o===""||o==null){const r=typeof t[s];r==="boolean"?o=Hl(o):o==null&&r==="string"?(o="",i=!0):r==="number"&&(o=0,i=!0)}try{t[s]=o}catch{}i&&t.removeAttribute(a||s)}function Ms(t,s,o,n){t.addEventListener(s,o,n)}function Md(t,s,o,n){t.removeEventListener(s,o,n)}const dl=Symbol("_vei");function Sd(t,s,o,n,a=null){const l=t[dl]||(t[dl]={}),i=l[s];if(n&&i)i.value=n;else{const[r,c]=Id(s);if(n){const d=l[s]=Td(n,a);Ms(t,r,d,c)}else i&&(Md(t,r,i,c),l[s]=void 0)}}const ul=/(?:Once|Passive|Capture)$/;function Id(t){let s;if(ul.test(t)){s={};let n;for(;n=t.match(ul);)t=t.slice(0,t.length-n[0].length),s[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Rs(t.slice(2)),s]}let Gn=0;const Ad=Promise.resolve(),Ld=()=>Gn||(Ad.then(()=>Gn=0),Gn=Date.now());function Td(t,s){const o=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=o.attached)return;ms(jd(n,o.value),s,5,[n])};return o.value=t,o.attached=Ld(),o}function jd(t,s){if(qe(s)){const o=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{o.call(t),t._stopped=!0},s.map(n=>a=>!a._stopped&&n&&n(a))}else return s}const vl=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Pd=(t,s,o,n,a,l)=>{const i=a==="svg";s==="class"?kd(t,n,i):s==="style"?$d(t,o,n):bn(s)?va(s)||Sd(t,s,o,n,l):(s[0]==="."?(s=s.slice(1),!0):s[0]==="^"?(s=s.slice(1),!1):Ed(t,s,n,i))?(cl(t,s,n),!t.tagName.includes("-")&&(s==="value"||s==="checked"||s==="selected")&&rl(t,s,n,i,l,s!=="value")):t._isVueCE&&(/[A-Z]/.test(s)||!At(n))?cl(t,cs(s),n,l,s):(s==="true-value"?t._trueValue=n:s==="false-value"&&(t._falseValue=n),rl(t,s,n,i))};function Ed(t,s,o,n){if(n)return!!(s==="innerHTML"||s==="textContent"||s in t&&vl(s)&&tt(o));if(s==="spellcheck"||s==="draggable"||s==="translate"||s==="autocorrect"||s==="sandbox"&&t.tagName==="IFRAME"||s==="form"||s==="list"&&t.tagName==="INPUT"||s==="type"&&t.tagName==="TEXTAREA")return!1;if(s==="width"||s==="height"){const a=t.tagName;if(a==="IMG"||a==="VIDEO"||a==="CANVAS"||a==="SOURCE")return!1}return vl(s)&&At(o)?!1:s in t}const Yi=new WeakMap,Xi=new WeakMap,yn=Symbol("_moveCb"),pl=Symbol("_enterCb"),Bd=t=>(delete t.props.mode,t),Vd=Bd({name:"TransitionGroup",props:Ht({},Wi,{tag:String,moveClass:String}),setup(t,{slots:s}){const o=Tn(),n=pi();let a,l;return ki(()=>{if(!a.length)return;const i=t.moveClass||`${t.name||"v"}-move`;if(!Nd(a[0].el,o.vnode.el,i)){a=[];return}a.forEach(Dd),a.forEach(Fd);const r=a.filter(Ud);ia(o.vnode.el),r.forEach(c=>{const d=c.el,u=d.style;hs(d,i),u.transform=u.webkitTransform=u.transitionDuration="";const v=d[yn]=b=>{b&&b.target!==d||(!b||b.propertyName.endsWith("transform"))&&(d.removeEventListener("transitionend",v),d[yn]=null,Bs(d,i))};d.addEventListener("transitionend",v)}),a=[]}),()=>{const i=ut(t),r=Gi(i);let c=i.tag||Pe;if(a=[],l)for(let d=0;d<l.length;d++){const u=l[d];u.el&&u.el instanceof Element&&(a.push(u),to(u,Ho(u,r,n,o)),Yi.set(u,{left:u.el.offsetLeft,top:u.el.offsetTop}))}l=s.default?$a(s.default()):[];for(let d=0;d<l.length;d++){const u=l[d];u.key!=null&&to(u,Ho(u,r,n,o))}return Ge(c,null,l)}}}),Hd=Vd;function Dd(t){const s=t.el;s[yn]&&s[yn](),s[pl]&&s[pl]()}function Fd(t){Xi.set(t,{left:t.el.offsetLeft,top:t.el.offsetTop})}function Ud(t){const s=Yi.get(t),o=Xi.get(t),n=s.left-o.left,a=s.top-o.top;if(n||a){const l=t.el.style;return l.transform=l.webkitTransform=`translate(${n}px,${a}px)`,l.transitionDuration="0s",t}}function Nd(t,s,o){const n=t.cloneNode(),a=t[fo];a&&a.forEach(r=>{r.split(/\s+/).forEach(c=>c&&n.classList.remove(c))}),o.split(/\s+/).forEach(r=>r&&n.classList.add(r)),n.style.display="none";const l=s.nodeType===1?s:s.parentNode;l.appendChild(n);const{hasTransform:i}=qi(n);return l.removeChild(n),i}const Os=t=>{const s=t.props["onUpdate:modelValue"]||!1;return qe(s)?o=>Xo(s,o):s};function Od(t){t.target.composing=!0}function fl(t){const s=t.target;s.composing&&(s.composing=!1,s.dispatchEvent(new Event("input")))}const rs=Symbol("_assign");function ml(t,s,o){return s&&(t=t.trim()),o&&(t=xn(t)),t}const Te={created(t,{modifiers:{lazy:s,trim:o,number:n}},a){t[rs]=Os(a);const l=n||a.props&&a.props.type==="number";Ms(t,s?"change":"input",i=>{i.target.composing||t[rs](ml(t.value,o,l))}),(o||l)&&Ms(t,"change",()=>{t.value=ml(t.value,o,l)}),s||(Ms(t,"compositionstart",Od),Ms(t,"compositionend",fl),Ms(t,"change",fl))},mounted(t,{value:s}){t.value=s??""},beforeUpdate(t,{value:s,oldValue:o,modifiers:{lazy:n,trim:a,number:l}},i){if(t[rs]=Os(i),t.composing)return;const r=(l||t.type==="number")&&!/^0\d/.test(t.value)?xn(t.value):t.value,c=s??"";r!==c&&(document.activeElement===t&&t.type!=="range"&&(n&&s===o||a&&t.value.trim()===c)||(t.value=c))}},es={deep:!0,created(t,s,o){t[rs]=Os(o),Ms(t,"change",()=>{const n=t._modelValue,a=mo(t),l=t.checked,i=t[rs];if(qe(n)){const r=ma(n,a),c=r!==-1;if(l&&!c)i(n.concat(a));else if(!l&&c){const d=[...n];d.splice(r,1),i(d)}}else if(go(n)){const r=new Set(n);l?r.add(a):r.delete(a),i(r)}else i(Qi(t,l))})},mounted:gl,beforeUpdate(t,s,o){t[rs]=Os(o),gl(t,s,o)}};function gl(t,{value:s,oldValue:o},n){t._modelValue=s;let a;if(qe(s))a=ma(s,n.props.value)>-1;else if(go(s))a=s.has(n.props.value);else{if(s===o)return;a=eo(s,Qi(t,!0))}t.checked!==a&&(t.checked=a)}const Rd={created(t,{value:s},o){t.checked=eo(s,o.props.value),t[rs]=Os(o),Ms(t,"change",()=>{t[rs](mo(t))})},beforeUpdate(t,{value:s,oldValue:o},n){t[rs]=Os(n),s!==o&&(t.checked=eo(s,n.props.value))}},Ls={deep:!0,created(t,{value:s,modifiers:{number:o}},n){const a=go(s);Ms(t,"change",()=>{const l=Array.prototype.filter.call(t.options,i=>i.selected).map(i=>o?xn(mo(i)):mo(i));t[rs](t.multiple?a?new Set(l):l:l[0]),t._assigning=!0,zt(()=>{t._assigning=!1})}),t[rs]=Os(n)},mounted(t,{value:s}){hl(t,s)},beforeUpdate(t,s,o){t[rs]=Os(o)},updated(t,{value:s}){t._assigning||hl(t,s)}};function hl(t,s){const o=t.multiple,n=qe(s);if(!(o&&!n&&!go(s))){for(let a=0,l=t.options.length;a<l;a++){const i=t.options[a],r=mo(i);if(o)if(n){const c=typeof r;c==="string"||c==="number"?i.selected=s.some(d=>String(d)===String(r)):i.selected=ma(s,r)>-1}else i.selected=s.has(r);else if(eo(mo(i),s)){t.selectedIndex!==a&&(t.selectedIndex=a);return}}!o&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function mo(t){return"_value"in t?t._value:t.value}function Qi(t,s){const o=s?"_trueValue":"_falseValue";return o in t?t[o]:s}const zd={created(t,s,o){Yo(t,s,o,null,"created")},mounted(t,s,o){Yo(t,s,o,null,"mounted")},beforeUpdate(t,s,o,n){Yo(t,s,o,n,"beforeUpdate")},updated(t,s,o,n){Yo(t,s,o,n,"updated")}};function Wd(t,s){switch(t){case"SELECT":return Ls;case"TEXTAREA":return Te;default:switch(s){case"checkbox":return es;case"radio":return Rd;default:return Te}}}function Yo(t,s,o,n,a){const i=Wd(t.tagName,o.props&&o.props.type)[a];i&&i(t,s,o,n)}const Kd=["ctrl","shift","alt","meta"],Gd={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,s)=>Kd.some(o=>t[`${o}Key`]&&!s.includes(o))},je=(t,s)=>{const o=t._withMods||(t._withMods={}),n=s.join(".");return o[n]||(o[n]=(a,...l)=>{for(let i=0;i<s.length;i++){const r=Gd[s[i]];if(r&&r(a,s))return}return t(a,...l)})},qd={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Xt=(t,s)=>{const o=t._withKeys||(t._withKeys={}),n=s.join(".");return o[n]||(o[n]=a=>{if(!("key"in a))return;const l=Rs(a.key);if(s.some(i=>i===l||qd[i]===l))return t(a)})},Zd=Ht({patchProp:Pd},hd);let yl;function Jd(){return yl||(yl=Jc(Zd))}const Yd=(...t)=>{const s=Jd().createApp(...t),{mount:o}=s;return s.mount=n=>{const a=Qd(n);if(!a)return;const l=s._component;!tt(l)&&!l.render&&!l.template&&(l.template=a.innerHTML),a.nodeType===1&&(a.textContent="");const i=o(a,!1,Xd(a));return a instanceof Element&&(a.removeAttribute("v-cloak"),a.setAttribute("data-v-app","")),i},s};function Xd(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Qd(t){return At(t)?document.querySelector(t):t}class eu{constructor(){this.dbName="MyPhoneDB",this.version=10,this.db=null}emitChange(s){try{typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("idb-change",{detail:s}))}catch(o){console.warn("IndexedDB change event failed:",o)}}async init(){return this.db?this.db:new Promise((s,o)=>{const n=indexedDB.open(this.dbName,this.version);n.onerror=()=>o(n.error),n.onsuccess=()=>{this.db=n.result,s(this.db)},n.onupgradeneeded=a=>{const l=a.target.result;if(l.objectStoreNames.contains("settings")||l.createObjectStore("settings",{keyPath:"key"}),l.objectStoreNames.contains("chatRecords")||l.createObjectStore("chatRecords",{keyPath:"id",autoIncrement:!0}),l.objectStoreNames.contains("apiKeys")||l.createObjectStore("apiKeys",{keyPath:"key"}),l.objectStoreNames.contains("characterCards")||l.createObjectStore("characterCards",{keyPath:"id",autoIncrement:!0}),l.objectStoreNames.contains("contacts")||l.createObjectStore("contacts",{keyPath:"id",autoIncrement:!0}),l.objectStoreNames.contains("chatList")||l.createObjectStore("chatList",{keyPath:"id",autoIncrement:!0}).createIndex("lastMessageTime","lastMessageTime",{unique:!1}),!l.objectStoreNames.contains("chatMessages")){const i=l.createObjectStore("chatMessages",{keyPath:"id",autoIncrement:!0});i.createIndex("chatId","chatId",{unique:!1}),i.createIndex("time","time",{unique:!1})}if(l.objectStoreNames.contains("userSettings")||l.createObjectStore("userSettings",{keyPath:"id",autoIncrement:!0}),!l.objectStoreNames.contains("diaries")){const i=l.createObjectStore("diaries",{keyPath:"id",autoIncrement:!0});i.createIndex("contactId","contactId",{unique:!1}),i.createIndex("date","date",{unique:!1})}if(l.objectStoreNames.contains("momentPosts")||l.createObjectStore("momentPosts",{keyPath:"id"}).createIndex("createdAt","createdAt",{unique:!1}),!l.objectStoreNames.contains("worldBooks")){const i=l.createObjectStore("worldBooks",{keyPath:"id",autoIncrement:!0});i.createIndex("bookName","bookName",{unique:!1}),i.createIndex("characterId","characterId",{unique:!1})}if(l.objectStoreNames.contains("groups")||l.createObjectStore("groups",{keyPath:"id",autoIncrement:!0}),!l.objectStoreNames.contains("groupMessages")){const i=l.createObjectStore("groupMessages",{keyPath:"id",autoIncrement:!0});i.createIndex("groupId","groupId",{unique:!1}),i.createIndex("time","time",{unique:!1})}if(!l.objectStoreNames.contains("customEmojis")){const i=l.createObjectStore("customEmojis",{keyPath:"id",autoIncrement:!0});i.createIndex("name","name",{unique:!1}),i.createIndex("createdAt","createdAt",{unique:!1})}l.objectStoreNames.contains("emails")||l.createObjectStore("emails",{keyPath:"id",autoIncrement:!0}).createIndex("timestamp","timestamp",{unique:!1}),l.objectStoreNames.contains("liveContents")||l.createObjectStore("liveContents",{keyPath:"title"}).createIndex("timestamp","timestamp",{unique:!1})}})}async set(s,o){return await this.init(),new Promise((n,a)=>{const i=this.db.transaction([s],"readwrite").objectStore(s),r=JSON.parse(JSON.stringify(o)),c=i.put(r);c.onsuccess=()=>{this.emitChange({storeName:s,action:"put",key:c.result,data:r,ts:Date.now()}),n()},c.onerror=()=>a(c.error)})}async get(s,o){return await this.init(),new Promise((n,a)=>{const r=this.db.transaction([s],"readonly").objectStore(s).get(o);r.onsuccess=()=>n(r.result),r.onerror=()=>a(r.error)})}async getAll(s){return await this.init(),new Promise((o,n)=>{const i=this.db.transaction([s],"readonly").objectStore(s).getAll();i.onsuccess=()=>o(i.result||[]),i.onerror=()=>n(i.error)})}async delete(s,o){return await this.init(),new Promise((n,a)=>{const r=this.db.transaction([s],"readwrite").objectStore(s).delete(o);r.onsuccess=()=>{this.emitChange({storeName:s,action:"delete",key:o,ts:Date.now()}),n()},r.onerror=()=>a(r.error)})}async clear(s){return await this.init(),new Promise((o,n)=>{const i=this.db.transaction([s],"readwrite").objectStore(s).clear();i.onsuccess=()=>{this.emitChange({storeName:s,action:"clear",ts:Date.now()}),o()},i.onerror=()=>n(i.error)})}}const _e=new eu,C={async setSetting(t,s){return _e.set("settings",{key:t,value:s})},async getSetting(t){const s=await _e.get("settings",t);return s==null?void 0:s.value},async setApiKey(t,s){return _e.set("apiKeys",{key:t,value:s})},async getApiKey(t){const s=await _e.get("apiKeys",t);return s==null?void 0:s.value},async addChatRecord(t){return _e.set("chatRecords",t)},async getChatRecords(){return _e.getAll("chatRecords")},async deleteChatRecord(t){return _e.delete("chatRecords",t)},async addCharacterCard(t){return _e.set("characterCards",t)},async getCharacterCards(){return _e.getAll("characterCards")},async deleteCharacterCard(t){return _e.delete("characterCards",t)},async addContact(t){return _e.set("contacts",t)},async getContacts(){return _e.getAll("contacts")},async getContact(t){return _e.get("contacts",t)},async getContactByName(t){return(await _e.getAll("contacts")).find(o=>o.name===t)},async updateContact(t){return _e.set("contacts",t)},async deleteContact(t){return _e.delete("contacts",t)},async addChatListItem(t){return _e.set("chatList",t)},async getChatList(){return _e.getAll("chatList")},async getChatListItem(t){return _e.get("chatList",t)},async updateChatListItem(t){return _e.set("chatList",t)},async deleteChatListItem(t){return _e.delete("chatList",t)},async addChatMessage(t){return t.isSummarized===void 0&&(t.isSummarized=!1),t.processedForMoment===void 0&&(t.processedForMoment=!1),_e.set("chatMessages",t)},async getChatMessages(t){return(await _e.getAll("chatMessages")).filter(o=>o.chatId===t).sort((o,n)=>o.time-n.time)},async getUnprocessedForMomentMessages(t,s=50){const n=(await _e.getAll("chatMessages")).filter(a=>a.chatId===t&&(a.processedForMoment===!1||a.processedForMoment===void 0)).sort((a,l)=>a.time-l.time);return s?n.slice(0,s):n},async markMessagesAsProcessedForMoment(t){const s=await _e.getAll("chatMessages");for(const o of s)t.includes(o.id)&&(o.processedForMoment=!0,await _e.set("chatMessages",o))},async markAllMessagesAsProcessedForMoment(t){const s=await _e.getAll("chatMessages");for(const o of s)o.chatId===t&&(o.processedForMoment=!0,await _e.set("chatMessages",o))},async getUnsummarizedMessages(t,s=50){const n=(await _e.getAll("chatMessages")).filter(a=>a.chatId===t&&a.isSummarized===!1).sort((a,l)=>a.time-l.time);return s?n.slice(0,s):n},async markMessagesAsSummarized(t){const s=await _e.getAll("chatMessages");for(const o of s)t.includes(o.id)&&(o.isSummarized=!0,await _e.set("chatMessages",o))},async markAllMessagesAsSummarized(t){const s=await _e.getAll("chatMessages");for(const o of s)o.chatId===t&&(o.isSummarized=!0,await _e.set("chatMessages",o))},async deleteChatMessage(t){return _e.delete("chatMessages",t)},async clearChatMessages(t){const o=(await _e.getAll("chatMessages")).filter(n=>n.chatId===t);for(const n of o)await _e.delete("chatMessages",n.id)},async markMessagesAsRead(t){const o=(await _e.getAll("chatMessages")).filter(n=>n.chatId===t&&!n.sent);for(const n of o)n.read=!0,await _e.set("chatMessages",n)},async setUserSetting(t,s,o){const n=`user_${t}_${s}`;return _e.set("userSettings",{id:n,contactId:t,key:s,value:o})},async getUserSetting(t,s){const o=`user_${t}_${s}`,n=await _e.get("userSettings",o);return n==null?void 0:n.value},async getUserSettings(t){return(await _e.getAll("userSettings")).filter(o=>o.contactId===t)},async deleteUserSettings(t){const o=(await _e.getAll("userSettings")).filter(n=>n.contactId===t);for(const n of o)await _e.delete("userSettings",n.id)},async addDiary(t){return _e.set("diaries",t)},async getDiaries(t){return(await _e.getAll("diaries")).filter(o=>o.contactId===t).sort((o,n)=>new Date(n.date)-new Date(o.date))},async getDiary(t){return _e.get("diaries",t)},async updateDiary(t){return _e.set("diaries",t)},async deleteDiary(t){return _e.delete("diaries",t)},async deleteDiaries(t){const o=(await _e.getAll("diaries")).filter(n=>n.contactId===t);for(const n of o)await _e.delete("diaries",n.id)},async upsertMomentPost(t){return _e.set("momentPosts",t)},async getMomentPost(t){return _e.get("momentPosts",t)},async getMomentPosts(){return(await _e.getAll("momentPosts")).sort((s,o)=>(o.createdAt||0)-(s.createdAt||0))},async deleteMomentPost(t){return _e.delete("momentPosts",t)},async clearMomentPosts(){return _e.clear("momentPosts")},async addWorldBookEntry(t){return _e.set("worldBooks",t)},async getWorldBookEntries(t){return(await _e.getAll("worldBooks")).filter(o=>o.bookName===t)},async getAllWorldBooks(){return _e.getAll("worldBooks")},async getWorldBookNames(){const t=await _e.getAll("worldBooks");return[...new Set(t.map(o=>o.bookName))].filter(Boolean)},async updateWorldBookEntry(t){return _e.set("worldBooks",t)},async deleteWorldBookEntry(t){return _e.delete("worldBooks",t)},async deleteWorldBook(t){const o=(await _e.getAll("worldBooks")).filter(n=>n.bookName===t);for(const n of o)await _e.delete("worldBooks",n.id)},async matchWorldBookEntries(t,s){var a;if(console.log(" [] "),console.log("   - :",t),console.log("   - :",s),!t)return console.warn(" [] "),[];const o=await this.getWorldBookEntries(t);console.log(" [] ",o.length,"");const n=[];for(const l of o){if(console.log("   :",{id:l.id,keys:l.keys,enabled:l.enabled,constant:l.constant,content:((a=l.content)==null?void 0:a.substring(0,30))+"..."}),!l.enabled){console.log("    ");continue}if(l.constant===!0){console.log("    "),n.push(l);continue}const i=l.keys||[];if(i.length===0){console.log("    ");continue}if(!s){console.log("    ");continue}for(const r of i)if(s.includes(r)){console.log("    :",r),n.push(l);break}}return console.log(" [] ",n.length,""),n},async createGroup(t){return _e.set("groups",t)},async getGroups(){return _e.getAll("groups")},async getGroup(t){return _e.get("groups",t)},async updateGroup(t){return _e.set("groups",t)},async deleteGroup(t){return _e.delete("groups",t)},async getGroupMembers(t){return!t||t.length===0?[]:(await this.getContacts()).filter(o=>t.includes(o.id))},async addGroupMessage(t){return _e.set("groupMessages",t)},async getGroupMessages(t){return(await _e.getAll("groupMessages")).filter(o=>o.groupId===t).sort((o,n)=>o.time-n.time)},async deleteGroupMessage(t){return _e.delete("groupMessages",t)},async clearGroupMessages(t){const o=(await _e.getAll("groupMessages")).filter(n=>n.groupId===t);for(const n of o)await _e.delete("groupMessages",n.id)},async addCustomEmoji(t){return _e.set("customEmojis",t)},async getCustomEmojis(){return(await _e.getAll("customEmojis")).sort((s,o)=>(o.createdAt||0)-(s.createdAt||0))},async getCustomEmojiByName(t){return(await _e.getAll("customEmojis")).find(o=>o.name===t)},async deleteCustomEmoji(t){return _e.delete("customEmojis",t)},async clearCustomEmojis(){return _e.clear("customEmojis")},async addEmail(t){return _e.set("emails",t)},async getEmails(){return(await _e.getAll("emails")).sort((s,o)=>(o.timestamp||0)-(s.timestamp||0))},async getEmail(t){return _e.get("emails",t)},async deleteEmail(t){return _e.delete("emails",t)},async clearEmails(){return _e.clear("emails")},async saveLiveContent(t){console.log(" [IndexedDB] saveLiveContent "),console.log("   - :",t);const s={title:t.title,username:t.username,viewers:t.viewers,cover:t.cover,contactId:t.contactId,content:t.content,danmus:t.danmus||[],timestamp:t.timestamp||Date.now()};console.log("   - :",s),console.log("   -  key (title):",s.title);try{await _e.set("liveContents",s),console.log("    ");const o=await _e.get("liveContents",s.title);return console.log("   - :",o),o}catch(o){throw console.error("    :",o),o}},async getLiveContent(t){var s,o;console.log(" [IndexedDB] getLiveContent "),console.log("   -  key (title):",t);try{const n=await _e.get("liveContents",t);return console.log("   - :",n),n?(console.log("    "),console.log("   - :",((s=n.content)==null?void 0:s.length)||0),console.log("   - :",((o=n.danmus)==null?void 0:o.length)||0)):console.log("    "),n}catch(n){throw console.error("    :",n),n}},async getAllLiveContents(){return(await _e.getAll("liveContents")).sort((s,o)=>(o.timestamp||0)-(s.timestamp||0))},async deleteLiveContent(t){return _e.delete("liveContents",t)}},Fs=Object.freeze(Object.defineProperty({__proto__:null,db:C,dbManager:_e},Symbol.toStringTag,{value:"Module"})),Ze=(t,s)=>{const o=t.__vccOpts||t;for(const[n,a]of s)o[n]=a;return o},tu=["src","alt"],su={__name:"AppIcon",props:{name:{type:String,required:!0},iconSrc:{type:String,required:!0},isBottomBar:{type:Boolean,default:!1}},emits:["click"],setup(t,{emit:s}){const o=s,n=h(!0),a=()=>{o("click")},l=async()=>{try{const r=await C.getSetting("iconBackdropFilter");r!==void 0&&(n.value=r)}catch(r){console.error(":",r)}},i=r=>{n.value=r.detail.enabled};return nt(()=>{l(),window.addEventListener("icon-backdrop-filter-changed",i)}),Dt(()=>{window.removeEventListener("icon-backdrop-filter-changed",i)}),(r,c)=>(p(),m("div",{class:Ie(["app-icon",{"app-block":!t.isBottomBar,"bottom-bar-app":t.isBottomBar,"no-backdrop":!t.isBottomBar&&!n.value}]),onClick:a},[e("img",{src:t.iconSrc,alt:t.name},null,8,tu),e("span",null,S(t.name),1)],2))}},us=Ze(su,[["__scopeId","data-v-c782a7c7"]]),ou={class:"phone-container"},nu={class:"dialog-content"},au={class:"dialog-content"},lu={class:"status-bar"},iu={class:"status-bar-left"},ru={class:"desktop-page"},cu={class:"widget-container"},du={class:"time"},uu={class:"date"},vu=["innerHTML"],pu={class:"desktop-page"},fu={class:"pagination-dots"},mu={class:"bottom-bar"},gu=2,hu={__name:"Desktop",emits:["open-messages","open-settings","open-moments","open-worldbook","open-pornhub","open-music","open-forum","open-live","open-mail"],setup(t,{emit:s}){xd(z=>({v152fcd44:u.value}));const o=s,n=h(!1),a=h(!1),l=h(""),i=h(""),r=h("12:00"),c=h("Sunday, Dec 15"),d=h(null),u=h("url(/src/assets/wallpaper.jpg)"),v=h(!0),b=h({Messages:"https://files.catbox.moe/14op6b.jpg",Moments:"https://files.catbox.moe/gvs6a5.jpg",Mori:"https://files.catbox.moe/f0p41u.png",Forum:"https://files.catbox.moe/jpd1lk.jpg",Music:"https://img.wjwj.top/2026/02/18/f6486d844bff10d88a0514db5f710875.md.png",Pornhub:"https://upload.wikimedia.org/wikipedia/commons/f/f1/Pornhub-logo.svg",Live:"https://files.catbox.moe/mg3qg0.jpg",Phone:"https://files.catbox.moe/7ji6fb.png",Mail:"https://files.catbox.moe/edai70.png",World:"https://files.catbox.moe/it221m.png",Settings:"https://files.catbox.moe/2khrtz.png"}),y=h(""),M=h(""),A=h(0),w=h(null),k=h(!1),I=h(0),_=h(0),$=h(0);h(null);const T=h(!1),q=ot(()=>k.value?{transform:`translateX(${_.value}px)`,transition:"none",cursor:"grabbing"}:{transform:`translateX(${-A.value*100}%)`,transition:"transform 0.3s ease-out",cursor:"grab"}),oe=z=>z.type.includes("mouse")?z.pageX:z.touches[0].clientX,se=z=>{k.value=!0,T.value=!1,I.value=oe(z),$.value=-A.value*window.innerWidth},J=z=>{se(z)},N=z=>{se(z)},P=z=>{if(k.value){const ce=oe(z)-I.value;Math.abs(ce)>5&&(T.value=!0),_.value=$.value+ce}},f=z=>{k.value&&P(z)},g=z=>{k.value&&(z.preventDefault(),P(z))},H=()=>{if(T.value){const z=_.value-$.value,ee=50;z<-ee&&A.value<gu-1?A.value+=1:z>ee&&A.value>0&&(A.value-=1)}k.value=!1,T.value=!1,_.value=0},K=()=>H(),F=()=>H(),x=()=>{k.value&&H()},L=z=>{A.value=z,ae()},ae=()=>{d.value&&(d.value.currentTime=0,d.value.play().catch(z=>console.log(":",z)))},de=()=>{const z=new Date,ee=String(z.getHours()).padStart(2,"0"),ce=String(z.getMinutes()).padStart(2,"0");r.value=`${ee}:${ce}`;const ye=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Le=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.value=`${ye[z.getDay()]}, ${Le[z.getMonth()]} ${z.getDate()}`},ue=()=>{ae(),n.value=!0},$e=()=>{n.value=!1,l.value=""},ne=()=>{a.value=!1,i.value=""},G=()=>{const z=l.value.trim();z&&(typeof window.triggerSlash=="function"?window.triggerSlash(`/send ${z}|/trigger`):console.log(":",z),$e())},he=()=>{const z=i.value.trim();z&&(typeof window.triggerSlash=="function"?window.triggerSlash(`/send ${z}|/trigger`):console.log(":",z),ne())},j=z=>{console.log(":",z),ae();const ee={Messages:()=>o("open-messages"),Moments:()=>o("open-moments"),Mori:()=>{typeof window.triggerSlash=="function"&&window.triggerSlash("/send  Mori|/trigger")},Live:()=>{console.log(" Live emit"),o("open-live")},Forum:()=>{console.log(" Forum emit"),o("open-forum")},Mail:()=>{console.log(" Mail emit"),o("open-mail")},Settings:()=>o("open-settings"),World:()=>o("open-worldbook"),Music:()=>{console.log(" Music emit"),o("open-music")},Pornhub:()=>{console.log(" Pornhub emit"),o("open-pornhub")}};ee[z]?ee[z]():console.log(":",z)},Q=async()=>{try{const z=await C.getSetting("wallpaper");z&&(u.value=`url(${z})`);const ee=await C.getSetting("iconBackdropFilter");ee!==void 0&&(v.value=ee);const ce=await C.getSetting("appIcons");ce&&Array.isArray(ce)&&ce.forEach(Ae=>{b.value[Ae.name]=Ae.iconSrc});const ye=await C.getSetting("desktopCustomCSS"),Le=await C.getSetting("desktopCustomHTML");ye&&(y.value=ye),Le&&(M.value=Le)}catch(z){console.error(":",z)}},W=z=>{u.value=`url(${z.detail.wallpaper})`},B=z=>{v.value=z.detail.enabled},D=z=>{b.value[z.detail.appName]=z.detail.iconSrc},xe=z=>{y.value=z.detail.css,M.value=z.detail.html},V=z=>{y.value=z.detail.css,M.value=z.detail.html};let O=null;return nt(()=>{de(),O=setInterval(de,1e3),Q(),window.addEventListener("wallpaper-changed",W),window.addEventListener("icon-backdrop-filter-changed",B),window.addEventListener("app-icon-changed",D),window.addEventListener("desktop-customization-preview",xe),window.addEventListener("desktop-customization-apply",V)}),Dt(()=>{O&&clearInterval(O),window.removeEventListener("wallpaper-changed",W),window.removeEventListener("icon-backdrop-filter-changed",B),window.removeEventListener("app-icon-changed",D),window.removeEventListener("desktop-customization-preview",xe),window.removeEventListener("desktop-customization-apply",V)}),(z,ee)=>(p(),m("div",ou,[y.value?(p(),st(_a("style"),{key:0},{default:ho(()=>[Qe(S(y.value),1)]),_:1})):U("",!0),e("div",{id:"phoneDialog",class:Ie(["dialog",{show:n.value}]),onClick:je($e,["self"])},[e("div",nu,[ee[18]||(ee[18]=e("h3",null,"",-1)),we(e("input",{type:"text","onUpdate:modelValue":ee[0]||(ee[0]=ce=>l.value=ce),placeholder:"",onKeyup:Xt(G,["enter"])},null,544),[[Te,l.value]]),e("div",{class:"dialog-buttons"},[e("button",{onClick:G},""),e("button",{onClick:$e},"")])])],2),e("div",{id:"searchDialog",class:Ie(["dialog",{show:a.value}]),onClick:je(ne,["self"])},[e("div",au,[ee[19]||(ee[19]=e("h3",null,"",-1)),we(e("input",{type:"text","onUpdate:modelValue":ee[1]||(ee[1]=ce=>i.value=ce),placeholder:"",onKeyup:Xt(he,["enter"])},null,544),[[Te,i.value]]),e("div",{class:"dialog-buttons"},[e("button",{onClick:he},""),e("button",{onClick:ne},"")])])],2),e("div",lu,[e("div",iu,[e("span",null,S(r.value),1)]),ee[20]||(ee[20]=dt('<div class="status-bar-right" data-v-d70fbd14><svg class="status-icon-svg" viewBox="0 0 24 24" data-v-d70fbd14><path d="M20,20h2v-2h-2V20z M18,20h-2v-4h2V20z M14,20h-2v-6h2V20z M10,20H8v-8h2V20z M6,20H4v-10h2V20z" data-v-d70fbd14></path></svg><svg class="status-icon-svg" viewBox="0 0 24 24" data-v-d70fbd14><path d="M12,3C7.41,3,3.86,4.53,0.96,7.03L2.37,8.44C4.89,6.31,8.06,5,12,5s7.11,1.31,9.63,3.44l1.41-1.41C20.14,4.53,16.59,3,12,3z M12,7C9.3,7,6.81,7.89,4.8,9.4l1.4,1.4C7.6,9.67,9.69,9,12,9s4.4,0.67,5.8,1.8l1.4-1.4C17.19,7.89,14.7,7,12,7z M12,11c-1.94,0-3.5,0.5-4.7,1.3l1.4,1.4c0.8-0.5,2-0.7,3.3-0.7s2.5,0.2,3.3,0.7l1.4-1.4C15.5,11.5,13.94,11,12,11z M12,15c-0.85,0-1.5,0.15-2,0.4l2,2l2-2C13.5,15.15,12.85,15,12,15z" data-v-d70fbd14></path></svg><svg class="status-icon-svg" viewBox="0 0 24 24" data-v-d70fbd14><path d="M15.67,4H14V2h-4v2H8.33C7.6,4,7,4.6,7,5.33v15.33C7,21.4,7.6,22,8.33,22h7.33c0.74,0,1.33-0.6,1.33-1.33V5.33C17,4.6,16.4,4,15.67,4z M15,20H9V6h6V20z" data-v-d70fbd14></path></svg></div>',1))]),e("div",{class:"desktop-slider",ref_key:"desktopSlider",ref:w,style:Re(q.value),onTouchstart:J,onTouchmove:f,onTouchend:K,onMousedown:N,onMousemove:g,onMouseup:F,onMouseleave:x},[e("div",ru,[e("div",cu,[e("div",{class:"widget widget-clock",onClick:ae},[e("div",du,S(r.value),1),e("div",uu,S(c.value),1)]),e("div",{class:"widget widget-weather",onClick:ae},[...ee[21]||(ee[21]=[e("div",{class:"temp"},"23C",-1),e("div",{class:"condition"},"Sunny",-1)])])]),M.value?(p(),m("div",{key:0,class:"custom-html-container",innerHTML:M.value},null,8,vu)):U("",!0),e("div",{class:"app-grid",onMousedown:ee[6]||(ee[6]=je(()=>{},["stop"])),onTouchstart:ee[7]||(ee[7]=je(()=>{},["stop"]))},[Ge(us,{name:"Messages","icon-src":b.value.Messages,onClick:ee[2]||(ee[2]=ce=>j("Messages"))},null,8,["icon-src"]),Ge(us,{name:"Moments","icon-src":b.value.Moments,onClick:ee[3]||(ee[3]=ce=>j("Moments"))},null,8,["icon-src"]),Ge(us,{name:"Mori","icon-src":b.value.Mori,onClick:ee[4]||(ee[4]=ce=>j("Mori"))},null,8,["icon-src"]),Ge(us,{name:"Forum","icon-src":b.value.Forum,onClick:ee[5]||(ee[5]=ce=>j("Forum"))},null,8,["icon-src"])],32)]),e("div",pu,[e("div",{class:"app-grid",onMousedown:ee[11]||(ee[11]=je(()=>{},["stop"])),onTouchstart:ee[12]||(ee[12]=je(()=>{},["stop"]))},[Ge(us,{name:"Music","icon-src":b.value.Music,onClick:ee[8]||(ee[8]=ce=>j("Music"))},null,8,["icon-src"]),Ge(us,{name:"Pornhub","icon-src":b.value.Pornhub,onClick:ee[9]||(ee[9]=ce=>j("Pornhub"))},null,8,["icon-src"]),Ge(us,{name:"Live","icon-src":b.value.Live,onClick:ee[10]||(ee[10]=ce=>j("Live"))},null,8,["icon-src"])],32)])],36),e("div",fu,[e("div",{class:Ie(["dot",{active:A.value===0}]),onClick:ee[13]||(ee[13]=ce=>L(0))},null,2),e("div",{class:Ie(["dot",{active:A.value===1}]),onClick:ee[14]||(ee[14]=ce=>L(1))},null,2)]),e("div",mu,[Ge(us,{name:"Phone","icon-src":b.value.Phone,"is-bottom-bar":"",onClick:ue},null,8,["icon-src"]),Ge(us,{name:"Mail","icon-src":b.value.Mail,"is-bottom-bar":"",onClick:ee[15]||(ee[15]=ce=>j("Mail"))},null,8,["icon-src"]),Ge(us,{name:"World","icon-src":b.value.World,"is-bottom-bar":"",onClick:ee[16]||(ee[16]=ce=>j("World"))},null,8,["icon-src"]),Ge(us,{name:"Settings","icon-src":b.value.Settings,"is-bottom-bar":"",onClick:ee[17]||(ee[17]=ce=>j("Settings"))},null,8,["icon-src"])]),e("audio",{ref_key:"clickSound",ref:d,preload:"auto"},[...ee[22]||(ee[22]=[e("source",{src:"https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3",type:"audio/mpeg"},null,-1)])],512)]))}},yu=Ze(hu,[["__scopeId","data-v-d70fbd14"]]);function bu(){const t=h([]),s=h([]),o=h(!1),n=ot(()=>s.value.reduce((A,w)=>A+(w.unreadCount||0),0)),a=async()=>{try{o.value=!0,t.value=await C.getContacts()}catch(A){console.error(":",A)}finally{o.value=!1}},l=async()=>{try{o.value=!0;const A=await C.getChatList();s.value=A.sort((w,k)=>{if(w.isPinned&&!k.isPinned)return-1;if(!w.isPinned&&k.isPinned)return 1;const I=w.lastMessageTime||0;return(k.lastMessageTime||0)-I})}catch(A){console.error(":",A)}finally{o.value=!1}},i=async A=>{try{const w={...A,createdAt:Date.now(),updatedAt:Date.now()};return await C.addContact(w),await a(),t.value.find(I=>I.name===w.name&&Math.abs(I.createdAt-w.createdAt)<1e3)||w}catch(w){throw console.error(":",w),w}},r=async A=>{try{const w={...A,updatedAt:Date.now()};return await C.updateContact(w),await a(),w}catch(w){throw console.error(":",w),w}},c=async A=>{try{await C.deleteContact(A),await a()}catch(w){throw console.error(":",w),w}},d=async(A,w,k,I="")=>{try{const _=s.value.find(T=>T.type==="single"&&T.contactId===A);if(_)return _;const $={type:"single",contactId:A,name:w,avatar:k,bio:I,lastMessage:"",lastMessageTime:Date.now(),unreadCount:0,createdAt:Date.now()};return await C.addChatListItem($),await l(),$}catch(_){throw console.error(":",_),_}},u=async A=>{try{const w=Array.isArray(A.members)?[...A.members]:[],k={name:A.name,avatar:A.avatar,memberIds:w,announcement:"",createdAt:Date.now(),updatedAt:Date.now()};await C.createGroup(k);const _=(await C.getGroups()).find(T=>T.name===k.name&&Math.abs(T.createdAt-k.createdAt)<1e3);if(!_)throw new Error("ID");const $={type:"group",groupId:_.id,name:A.name,avatar:A.avatar,members:w,bio:A.bio||"",lastMessage:"",lastMessageTime:Date.now(),unreadCount:0,createdAt:Date.now()};return await C.addChatListItem($),await l(),$}catch(w){throw console.error(":",w),w}},v=async(A,w)=>{try{const k=await C.getChatListItem(A);if(!k)return;const I={...k,...w,updatedAt:Date.now()};return await C.updateChatListItem(I),await l(),I}catch(k){throw console.error(":",k),k}};return{contacts:t,chatList:s,loading:o,totalUnread:n,loadContacts:a,loadChatList:l,addContact:i,updateContact:r,deleteContact:c,addSingleChat:d,addGroupChat:u,updateChatListItem:v,deleteChatListItem:async A=>{try{await C.deleteChatListItem(A),await l()}catch(w){throw console.error(":",w),w}},markAsRead:async A=>{await v(A,{unreadCount:0})},togglePin:async A=>{try{const w=await C.getChatListItem(A);if(!w)return;const k={...w,isPinned:!w.isPinned,updatedAt:Date.now()};return await C.updateChatListItem(k),await l(),k}catch(w){throw console.error(":",w),w}}}}const wu={class:"importer-container"},ku={class:"importer-body"},xu={class:"upload-text"},Cu={key:0,class:"preview-section"},$u={class:"preview-item"},_u={class:"preview-value"},Mu={class:"preview-item"},Su={class:"preview-value"},Iu={class:"worldbook-info"},Au={key:0,class:"preview-item worldbook-found"},Lu={class:"preview-value success"},Tu={key:1,class:"preview-item worldbook-not-found"},ju={key:2,class:"worldbook-hint"},Pu={key:3,class:"worldbook-hint"},Eu={key:1,class:"error-message"},Bu={class:"importer-actions"},Vu=["disabled"],Hu={__name:"CharacterImporter",emits:["success","cancel"],setup(t,{emit:s}){const o=s,n=h(null),a=h(null),l=h(null),i=h(""),r=h(!1),c=()=>{var b;(b=n.value)==null||b.click()},d=async b=>{var M,A,w,k;const y=b.target.files[0];if(y){a.value=y,i.value="",l.value=null;try{const I=await y.text(),_=JSON.parse(I);console.log(" ...",_);const $={name:_.name||_.char_name||((M=_.data)==null?void 0:M.name)||"",description:_.description||_.char_persona||_.personality||((A=_.data)==null?void 0:A.description)||"",avatar:_.avatar||((w=_.data)==null?void 0:w.avatar)||"https://via.placeholder.com/100",prompt:_.description||_.char_persona||_.personality||((k=_.data)==null?void 0:k.description)||"",worldBookEntries:0,characterBook:null};let T=null;const q=["character_book","characterBook","lorebook","loreBook","world_book","worldBook","data.character_book","data.extensions.world"];for(const oe of q){const se=oe.split(".");let J=_;for(const N of se)if(J=J==null?void 0:J[N],!J)break;if(J&&(J.entries||J.data)){T=J,console.log(`  "${oe}" `,T);break}}if(T){const oe=T.entries||T.data||[],se=Array.isArray(oe)?oe.filter(J=>(J.content||J.value||J.text||"").trim().length>0):[];$.worldBookEntries=se.length,$.characterBook={...T,entries:se},console.log(`  ${se.length} `)}else console.log(" ");l.value=$}catch(I){console.error(" :",I),i.value=" JSON "}}},u=async()=>{if(l.value){r.value=!0,i.value="";try{let b=!1,y=0;if(l.value.characterBook&&l.value.worldBookEntries>0){console.log("  IndexedDB...");const A=l.value.characterBook.entries||[];for(const w of A){let k=[];Array.isArray(w.keys)?k=w.keys:typeof w.keys=="string"?k=w.keys.split(",").map(_=>_.trim()).filter(_=>_):w.key&&(k=[w.key]);const I=w.content||w.value||w.text||w.description||"";if(I.trim()){const _={bookName:l.value.name,keys:k,content:I,enabled:w.enabled!==!1,priority:w.priority||w.order||0,createdAt:Date.now()};await C.addWorldBookEntry(_),y++,console.log(`  ${y}:`,{keys:k,content:I.substring(0,50)+"..."})}}b=!0,console.log(`  ${y} `)}else console.log(" ");o("success",{name:l.value.name,avatar:l.value.avatar,bio:l.value.description,prompt:l.value.prompt,hasWorldBook:b,linkedBookName:b?l.value.name:null,worldBookEntriesCount:y}),alert(b?` 

${l.value.name}
${y} 

 World `:` 

${l.value.name}

 World `)}catch(b){console.error(" :",b),i.value=""+b.message,alert(" "+b.message)}finally{r.value=!1}}},v=()=>{o("cancel")};return(b,y)=>{var M,A;return p(),m("div",wu,[y[6]||(y[6]=e("div",{class:"importer-header"},[e("h3",null,""),e("p",{class:"importer-desc"}," JSON ")],-1)),e("div",ku,[e("div",{class:"file-upload-area",onClick:c},[e("input",{ref_key:"fileInput",ref:n,type:"file",accept:".json",onChange:d,style:{display:"none"}},null,544),y[0]||(y[0]=e("div",{class:"upload-icon"},"",-1)),e("div",xu,S(a.value?a.value.name:" JSON "),1)]),l.value?(p(),m("div",Cu,[y[5]||(y[5]=e("h4",null," ",-1)),e("div",$u,[y[1]||(y[1]=e("span",{class:"preview-label"},"",-1)),e("span",_u,S(l.value.name),1)]),e("div",Mu,[y[2]||(y[2]=e("span",{class:"preview-label"},"",-1)),e("span",Su,S((M=l.value.description)==null?void 0:M.substring(0,100))+S(((A=l.value.description)==null?void 0:A.length)>100?"...":""),1)]),e("div",Iu,[l.value.worldBookEntries>0?(p(),m("div",Au,[y[3]||(y[3]=e("span",{class:"preview-label"}," ",-1)),e("span",Lu,"  "+S(l.value.worldBookEntries)+" ",1)])):(p(),m("div",Tu,[...y[4]||(y[4]=[e("span",{class:"preview-label"}," ",-1),e("span",{class:"preview-value warning"}," ",-1)])])),l.value.worldBookEntries>0?(p(),m("div",ju,'  "'+S(l.value.name)+'" World  ',1)):(p(),m("div",Pu,"   World  "))])])):U("",!0),i.value?(p(),m("div",Eu,S(i.value),1)):U("",!0)]),e("div",Bu,[e("button",{class:"btn btn-cancel",onClick:v},""),e("button",{class:"btn btn-confirm",onClick:u,disabled:!l.value||r.value},S(r.value?"...":""),9,Vu)])])}}},Du=Ze(Hu,[["__scopeId","data-v-845bf5c3"]]),Fu={class:"status-bar"},Uu={class:"status-bar-left"},Nu={class:"nav-header"},Ou={class:"nav-profile-group"},Ru=["src"],zu={key:1,class:"nav-back-avatar-placeholder","aria-hidden":"true"},Wu={class:"chat-list-container"},Ku=["onClick","onContextmenu","onTouchstart"],Gu=["src","alt"],qu={class:"chat-info"},Zu={class:"chat-header"},Ju={class:"chat-name"},Yu={class:"chat-header-right"},Xu={class:"chat-time"},Qu={class:"chat-preview-wrapper"},e1={class:"chat-preview"},t1={class:"modal nav-customizer-modal"},s1={class:"modal-body"},o1={class:"form-group"},n1=["src"],a1=["src"],l1={key:2},i1={class:"form-group"},r1={class:"form-group"},c1=["src"],d1=["src"],u1={key:2},v1={class:"modal"},p1={class:"tabs"},f1={class:"modal-body"},m1={class:"form-group"},g1=["src"],h1={key:1,id:"uploadHint"},y1={class:"form-group"},b1={class:"form-group"},w1={class:"form-group"},k1=["src"],x1={key:1,id:"groupUploadHint"},C1={class:"form-group"},$1={class:"form-group"},_1={class:"contact-selection"},M1=["onClick"],S1=["src"],I1={style:{"font-size":"14px",color:"#333"}},A1={key:0,style:{padding:"15px",color:"#999","font-size":"12px","text-align":"center"}},L1={class:"modal importer-modal"},bl="https://files.catbox.moe/3ehyu8.jpg",T1={__name:"MessageList",emits:["back","open-chat"],setup(t,{emit:s}){const o=s,{contacts:n,chatList:a,loadContacts:l,loadChatList:i,addContact:r,addSingleChat:c,addGroupChat:d,deleteChatListItem:u,togglePin:v,updateChatListItem:b}=bu(),y=h(!1),M=h("contact"),A=h({name:"",bio:"",avatar:""}),w=h({name:"",avatar:"",members:[]}),k=h(null),I=h(null),_=h(null),$=h({show:!1,x:0,y:0,item:null}),T=h(null);h(null);const q=h(!1),oe=()=>{ue(),q.value=!0},se=()=>{q.value=!1},J=async ge=>{ue(),A.value={name:ge.name||"",bio:ge.bio||ge.prompt||"",avatar:ge.avatar||""},se(),alert(`
${ge.name}
${ge.hasWorldBook?" World ":""}

""`)},N=h(!1),P=h(""),f=h(""),g=h(""),H=h(""),K=h(null),F=h(null),x=h({avatar:"",moodText:"",wallpaper:""});let L=null;const ae=()=>{const ge=new Date,le=String(ge.getHours()).padStart(2,"0"),He=String(ge.getMinutes()).padStart(2,"0");H.value=`${le}:${He}`},de=ot(()=>g.value?{backgroundImage:`url(${g.value})`}:{}),ue=()=>{_.value&&(_.value.currentTime=0,_.value.play().catch(()=>{}))},$e=()=>{ue(),o("back")},ne=()=>{ue(),x.value={avatar:"",moodText:f.value||"",wallpaper:""},N.value=!0},G=()=>{N.value=!1},he=ge=>new Promise((le,He)=>{const ke=new FileReader;ke.onload=Be=>{var vt;return le(((vt=Be==null?void 0:Be.target)==null?void 0:vt.result)||"")},ke.onerror=()=>He(ke.error),ke.readAsDataURL(ge)}),j=async ge=>{var He,ke;const le=(ke=(He=ge==null?void 0:ge.target)==null?void 0:He.files)==null?void 0:ke[0];if(le)try{x.value.avatar=await he(le)}catch(Be){console.error(":",Be),alert("")}},Q=async ge=>{var He,ke;const le=(ke=(He=ge==null?void 0:ge.target)==null?void 0:He.files)==null?void 0:ke[0];if(le)try{x.value.wallpaper=await he(le)}catch(Be){console.error(":",Be),alert("")}},W=async()=>{try{ue();const ge=(x.value.moodText||"").trim();f.value=ge,await C.setSetting("navMoodText",ge),x.value.avatar&&(P.value=x.value.avatar,await C.setSetting("navAvatar",P.value)),x.value.wallpaper&&(g.value=x.value.wallpaper,await C.setSetting("phoneContainerWallpaper",g.value)),G()}catch(ge){console.error(":",ge),alert("")}},B=()=>{ue(),y.value=!0,M.value==="group"&&l()},D=()=>{y.value=!1,O()},xe=async ge=>{ue(),M.value=ge,ge==="group"&&await l()},V=(ge,le)=>{const He=ge.target;if(He.files&&He.files[0]){const ke=new FileReader;ke.onload=Be=>{le==="contact"?A.value.avatar=Be.target.result:w.value.avatar=Be.target.result},ke.readAsDataURL(He.files[0])}},O=()=>{A.value={name:"",bio:"",avatar:""},w.value={name:"",avatar:"",members:[]},M.value="contact"},z=async()=>{const ge=A.value.name.trim(),le=A.value.bio.trim(),He=A.value.avatar||bl;if(!ge){alert("");return}try{ue();const Be=await r({name:ge,bio:le,avatar:He,prompt:le,type:"contact"});await c(Be.id,Be.name,Be.avatar,Be.bio||Be.prompt||""),await Promise.all([l(),i()]),D()}catch(ke){console.error(":",ke),alert("")}},ee=ge=>{ue();const le=w.value.members.indexOf(ge);le>-1?w.value.members.splice(le,1):w.value.members.push(ge)},ce=ge=>w.value.members.includes(ge),ye=async()=>{const ge=w.value.name.trim(),le=w.value.avatar||bl;if(!ge){alert("");return}if(w.value.members.length===0){alert("");return}try{ue(),n.value.length===0&&await l();const He=n.value.filter(pt=>w.value.members.includes(pt.id));if(He.length===0){alert("");return}const ke=He.map(pt=>pt.name).join(""),Be={name:ge,avatar:le,members:w.value.members,bio:`: ${ke}`};if(!await d(Be))throw new Error("");await i(),D()}catch(He){console.error(":",He),console.error(":",He),alert(`: ${He.message||""}`)}},Le=async ge=>{if(console.log(" :",ge.name,":",ge.unreadCount),$.value.show){console.log(" ");return}if(ue(),ge.type==="single"&&ge.contactId){console.log(" contactId:",ge.contactId);const le=await C.getChatMessages(ge.contactId);console.log(" :",le.map(ke=>{var Be;return{id:ke.id,sent:ke.sent,read:ke.read,text:(Be=ke.text)==null?void 0:Be.substring(0,20)}})),await C.markMessagesAsRead(ge.contactId),console.log("  markMessagesAsRead");const He=await C.getChatMessages(ge.contactId);console.log(" :",He.map(ke=>{var Be;return{id:ke.id,sent:ke.sent,read:ke.read,text:(Be=ke.text)==null?void 0:Be.substring(0,20)}})),console.log("  unreadCount = 0"),await b(ge.id,{unreadCount:0}),console.log(" "),await i(),console.log(" ")}ge.type==="single"?(console.log(" "),o("open-chat",{contactId:ge.contactId,contactName:ge.name,contactAvatar:ge.avatar,isGroup:!1})):ge.type==="group"&&(console.log(" "),o("open-chat",{groupId:ge.groupId,isGroup:!0}))},Ae=ge=>{if(!ge)return"";const le=new Date(ge),ke=new Date-le,Be=Math.floor(ke/(1e3*60*60*24));return Be===0?"":Be===1?"":Be<7?`${Be}`:`${le.getMonth()+1}/${le.getDate()}`},Me=(ge,le)=>{T.value=setTimeout(()=>{Ne(ge,le)},500)},be=()=>{T.value&&(clearTimeout(T.value),T.value=null)},Ne=(ge,le)=>{var Be,vt,pt,re;T.value&&(clearTimeout(T.value),T.value=null),ue();const He=ge.clientX||((vt=(Be=ge.touches)==null?void 0:Be[0])==null?void 0:vt.clientX)||0,ke=ge.clientY||((re=(pt=ge.touches)==null?void 0:pt[0])==null?void 0:re.clientY)||0;$.value={show:!0,x:He,y:ke,item:le},setTimeout(()=>{document.addEventListener("click",Ee,{once:!0})},0)},Ee=()=>{$.value.show=!1},De=async ge=>{try{await v(ge.id),Ee(),ue()}catch(le){console.error(":",le),alert("")}},We=async ge=>{if(confirm(`"${ge.name}"`))try{await u(ge.id),Ee(),ue()}catch(le){console.error(":",le),alert("")}},Je=async()=>{console.log(" ");for(const ge of a.value)if(ge.type==="single"&&ge.contactId){console.log(`
 : ${ge.name} (contactId: ${ge.contactId})`);const le=await C.getChatMessages(ge.contactId);if(console.log(`   : ${le.length}`),le.length>0){const He=le[le.length-1];let ke="";He.type==="text"?ke=He.text:He.type==="image"?ke="[]":He.type==="transfer"?ke="[]":He.type==="voice"?ke="[]":He.type==="file"&&(ke="[]");const Be=le.filter(pt=>pt.sent===!1&&(pt.read===!1||pt.read===void 0)),vt=Be.length;console.log("   :"),console.log(`   - : ${le.filter(pt=>pt.sent===!1).length}`),console.log(`   - : ${vt}`),console.log("   - :",Be.map(pt=>{var re;return{id:pt.id,sent:pt.sent,read:pt.read,text:(re=pt.text)==null?void 0:re.substring(0,20)}})),await b(ge.id,{lastMessage:ke,lastMessageTime:He.time,unreadCount:vt}),console.log(`    : ${vt}`)}}console.log(" ..."),await i(),console.log(` 
`)};return nt(async()=>{console.log(" MessageList "),await Promise.all([l(),i()]),console.log(" "),await Je(),console.log(" "),P.value=await C.getSetting("navAvatar")||"",f.value=await C.getSetting("navMoodText")||"",g.value=await C.getSetting("phoneContainerWallpaper")||"",ae(),L=setInterval(ae,6e4);const ge=async()=>{console.log(" "),await i(),console.log(" ")};window.addEventListener("refresh-message-list",ge),console.log(" "),window.__messageListRefreshCleanup=()=>{window.removeEventListener("refresh-message-list",ge)},console.log(" MessageList ")}),Dt(()=>{L&&clearInterval(L),L=null,window.__messageListRefreshCleanup&&(window.__messageListRefreshCleanup(),delete window.__messageListRefreshCleanup)}),(ge,le)=>{var He;return p(),m("div",{class:"phone-container",style:Re(de.value)},[e("div",Fu,[e("div",Uu,[e("span",null,S(H.value),1)]),le[18]||(le[18]=dt('<div class="status-bar-right" data-v-7ce53b9f><svg class="status-icon-svg" viewBox="0 0 24 24" data-v-7ce53b9f><path d="M20,20h2v-2h-2V20z M18,20h-2v-4h2V20z M14,20h-2v-6h2V20z M10,20H8v-8h2V20z M6,20H4v-10h2V20z" data-v-7ce53b9f></path></svg><svg class="status-icon-svg" viewBox="0 0 24 24" data-v-7ce53b9f><path d="M12,3C7.41,3,3.86,4.53,0.96,7.03L2.37,8.44C4.89,6.31,8.06,5,12,5s7.11,1.31,9.63,3.44l1.41-1.41C20.14,4.53,16.59,3,12,3z M12,7C9.3,7,6.81,7.89,4.8,9.4l1.4,1.4C7.6,9.67,9.69,9,12,9s4.4,0.67,5.8,1.8l1.4-1.4C17.19,7.89,14.7,7,12,7z M12,11c-1.94,0-3.5,0.5-4.7,1.3l1.4,1.4c0.8-0.5,2-0.7,3.3-0.7s2.5,0.2,3.3,0.7l1.4-1.4C15.5,11.5,13.94,11,12,11z M12,15c-0.85,0-1.5,0.15-2,0.4l2,2l2-2C13.5,15.15,12.85,15,12,15z" data-v-7ce53b9f></path></svg><svg class="status-icon-svg" viewBox="0 0 24 24" data-v-7ce53b9f><path d="M15.67,4H14V2h-4v2H8.33C7.6,4,7,4.6,7,5.33v15.33C7,21.4,7.6,22,8.33,22h7.33c0.74,0,1.33-0.6,1.33-1.33V5.33C17,4.6,16.4,4,15.67,4z M15,20H9V6h6V20z" data-v-7ce53b9f></path></svg></div>',1))]),e("div",Nu,[e("div",Ou,[e("button",{class:"nav-back-avatar",type:"button",onClick:$e,"aria-label":""},[P.value?(p(),m("img",{key:0,src:P.value,alt:""},null,8,Ru)):(p(),m("span",zu))]),e("button",{class:"nav-status-text",type:"button",onClick:ne},S(f.value||""),1)])]),e("div",Wu,[(p(!0),m(Pe,null,Fe(Ue(a),ke=>(p(),m("div",{key:ke.id,class:Ie(["chat-list-item",{pinned:ke.isPinned}]),onClick:Be=>Le(ke),onContextmenu:je(Be=>Ne(Be,ke),["prevent"]),onTouchstart:Be=>Me(Be,ke),onTouchend:be},[e("img",{src:ke.avatar,class:"chat-avatar",alt:ke.name},null,8,Gu),e("div",qu,[e("div",Zu,[e("span",Ju,S(ke.name)+S(ke.type==="group"?" ()":""),1),e("div",Yu,[e("span",Xu,S(Ae(ke.lastMessageTime)),1)])]),e("div",Qu,[e("span",e1,S(ke.lastMessage||ke.bio||""),1)])])],42,Ku))),128)),$.value.show?(p(),m("div",{key:0,class:"context-menu",style:Re({left:$.value.x+"px",top:$.value.y+"px"}),onClick:le[2]||(le[2]=je(()=>{},["stop"]))},[e("div",{class:"menu-item",onClick:le[0]||(le[0]=ke=>De($.value.item))},[le[19]||(le[19]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})],-1)),e("span",null,S((He=$.value.item)!=null&&He.isPinned?"":""),1)]),e("div",{class:"menu-item delete",onClick:le[1]||(le[1]=ke=>We($.value.item))},[...le[20]||(le[20]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1),e("span",null,"",-1)])])],4)):U("",!0)]),e("button",{class:"new-chat-btn",onClick:B},[...le[21]||(le[21]=[e("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[e("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])]),N.value?(p(),m("div",{key:0,class:"modal-overlay",onClick:je(G,["self"])},[e("div",t1,[le[25]||(le[25]=e("div",{class:"modal-title"},"",-1)),e("div",s1,[e("div",o1,[le[22]||(le[22]=e("label",null,"",-1)),e("div",{class:"avatar-upload nav-avatar-upload",onClick:le[4]||(le[4]=()=>{var ke;return(ke=K.value)==null?void 0:ke.click()})},[x.value.avatar?(p(),m("img",{key:0,src:x.value.avatar},null,8,n1)):P.value?(p(),m("img",{key:1,src:P.value},null,8,a1)):(p(),m("span",l1,"")),e("input",{ref_key:"navAvatarInputRef",ref:K,type:"file",accept:"image/*",onClick:le[3]||(le[3]=je(()=>{},["stop"])),onChange:j,style:{display:"none"}},null,544)])]),e("div",i1,[le[23]||(le[23]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":le[5]||(le[5]=ke=>x.value.moodText=ke),type:"text",class:"form-input",placeholder:"..."},null,512),[[Te,x.value.moodText]])]),e("div",r1,[le[24]||(le[24]=e("label",null,"",-1)),e("div",{class:"wallpaper-upload",onClick:le[6]||(le[6]=()=>{var ke;return(ke=F.value)==null?void 0:ke.click()})},[x.value.wallpaper?(p(),m("img",{key:0,src:x.value.wallpaper,class:"wallpaper-preview"},null,8,c1)):g.value?(p(),m("img",{key:1,src:g.value,class:"wallpaper-preview"},null,8,d1)):(p(),m("span",u1,"")),e("input",{ref_key:"navWallpaperInputRef",ref:F,type:"file",accept:"image/*",onChange:Q,style:{display:"none"}},null,544)])])]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:G},""),e("button",{class:"btn btn-confirm",onClick:W},"")])])])):U("",!0),y.value?(p(),m("div",{key:1,class:"modal-overlay",onClick:je(D,["self"])},[e("div",v1,[e("div",p1,[e("div",{class:Ie(["tab",{active:M.value==="contact"}]),onClick:le[7]||(le[7]=ke=>xe("contact"))},"  ",2),e("div",{class:Ie(["tab",{active:M.value==="group"}]),onClick:le[8]||(le[8]=ke=>xe("group"))},"  ",2)]),e("div",f1,[we(e("div",null,[e("div",m1,[le[26]||(le[26]=e("label",null,"",-1)),e("div",{class:"avatar-upload",onClick:le[11]||(le[11]=()=>{var ke;return(ke=k.value)==null?void 0:ke.click()})},[A.value.avatar?(p(),m("img",{key:0,src:A.value.avatar,id:"contactAvatarPreview"},null,8,g1)):(p(),m("span",h1,"")),e("input",{ref_key:"contactAvatarInputRef",ref:k,type:"file",id:"contactAvatarInput",accept:"image/*",onClick:le[9]||(le[9]=je(()=>{},["stop"])),onChange:le[10]||(le[10]=ke=>V(ke,"contact")),style:{display:"none"}},null,544)])]),e("div",y1,[le[27]||(le[27]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":le[12]||(le[12]=ke=>A.value.name=ke),type:"text",id:"contactName",class:"form-input",placeholder:""},null,512),[[Te,A.value.name]])]),e("div",b1,[le[28]||(le[28]=e("label",null,"",-1)),we(e("textarea",{"onUpdate:modelValue":le[13]||(le[13]=ke=>A.value.bio=ke),id:"contactBio",class:"form-textarea",placeholder:"..."},null,512),[[Te,A.value.bio]])]),e("div",{class:"form-group"},[e("button",{class:"btn-import-character",onClick:oe},"   (JSON) ")]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:D},""),e("button",{class:"btn btn-confirm",onClick:z},"  ")])],512),[[vo,M.value==="contact"]]),we(e("div",null,[e("div",w1,[le[29]||(le[29]=e("label",null,"",-1)),e("div",{class:"avatar-upload",onClick:le[16]||(le[16]=()=>{var ke;return(ke=I.value)==null?void 0:ke.click()})},[w.value.avatar?(p(),m("img",{key:0,src:w.value.avatar,id:"groupAvatarPreview"},null,8,k1)):(p(),m("span",x1,"")),e("input",{ref_key:"groupAvatarInputRef",ref:I,type:"file",id:"groupAvatarInput",accept:"image/*",onClick:le[14]||(le[14]=je(()=>{},["stop"])),onChange:le[15]||(le[15]=ke=>V(ke,"group")),style:{display:"none"}},null,544)])]),e("div",C1,[le[30]||(le[30]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":le[17]||(le[17]=ke=>w.value.name=ke),type:"text",id:"groupName",class:"form-input",placeholder:""},null,512),[[Te,w.value.name]])]),e("div",$1,[le[32]||(le[32]=e("label",null,"",-1)),e("div",_1,[(p(!0),m(Pe,null,Fe(Ue(n),ke=>(p(),m("div",{key:ke.id,class:Ie(["selectable-contact",{selected:ce(ke.id)}]),onClick:Be=>ee(ke.id)},[le[31]||(le[31]=e("div",{class:"checkbox-custom"},null,-1)),e("img",{src:ke.avatar,style:{width:"28px",height:"28px","border-radius":"50%","object-fit":"cover"}},null,8,S1),e("span",I1,S(ke.name),1)],10,M1))),128)),Ue(n).length===0?(p(),m("div",A1,' "" ')):U("",!0)])]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:D},""),e("button",{class:"btn btn-confirm",onClick:ye},"  ")])],512),[[vo,M.value==="group"]])])])])):U("",!0),q.value?(p(),m("div",{key:2,class:"modal-overlay",onClick:je(se,["self"])},[e("div",L1,[Ge(Du,{onSuccess:J,onCancel:se})])])):U("",!0),e("audio",{ref_key:"clickSound",ref:_,preload:"auto"},[...le[33]||(le[33]=[e("source",{src:"https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3",type:"audio/mpeg"},null,-1)])],512)],4)}}},j1=Ze(T1,[["__scopeId","data-v-7ce53b9f"]]),P1={key:0,class:"mori-badge"},E1=["innerHTML"],B1={__name:"ChatBubble",props:{content:{type:String,required:!0},isSent:{type:Boolean,default:!1},type:{type:String,default:"text"},isMoriSent:{type:Boolean,default:!1}},setup(t){return(s,o)=>(p(),m("div",{class:Ie(["chat-bubble",[t.type,{sent:t.isSent,received:!t.isSent,"mori-sent":t.isMoriSent}]])},[t.isMoriSent?(p(),m("div",P1,[...o[0]||(o[0]=[e("img",{src:"https://files.catbox.moe/f0p41u.png",class:"mori-icon",alt:"Mori"},null,-1),e("span",null,"Mori ",-1)])])):U("",!0),e("div",{class:"bubble-content",innerHTML:t.content},null,8,E1)],2))}},V1=Ze(B1,[["__scopeId","data-v-d645f373"]]),H1={key:0,class:"chat-add-menu"},D1={class:"modal modal-higher"},F1={class:"modal-body"},U1={class:"modal-hint"},N1={class:"modal modal-higher"},O1={class:"modal-body"},R1={class:"modal-hint"},z1={__name:"ChatAddMenu",props:{show:{type:Boolean,default:!1}},emits:["send-image","send-voice","send-call","send-video","send-file","send-location","send-takeout","send-transfer","send-emoji","open-emoji-manager"],setup(t,{expose:s,emit:o}){const n=o,a=h(null),l=h(null),i=h(null),r=h(null),c=h(!1),d=h(""),u=h(!1),v=h(!1),b=h(""),y=()=>{u.value=!0},M=f=>{const g=f.target.files[0];if(g){const H=new FileReader;H.onload=K=>{n("send-image",{file:g,url:K.target.result,name:g.name})},H.readAsDataURL(g)}f.target.value="",u.value=!1},A=()=>{var f;(f=l.value)==null||f.click()},w=()=>{u.value=!1,v.value=!0},k=()=>{v.value=!1,b.value=""},I=()=>{if(!b.value.trim()){alert("");return}const f=["https://files.catbox.moe/0g3kqu.jpg","https://files.catbox.moe/d5b7k6.jpg","https://files.catbox.moe/0yrhh6.jpg","https://files.catbox.moe/8mjvdg.jpg","https://files.catbox.moe/fvidas.jpg","https://files.catbox.moe/q6so2i.jpg","https://files.catbox.moe/5a96cp.jpg","https://files.catbox.moe/0mp6h0.jpg","https://files.catbox.moe/epcn03.jpg","https://files.catbox.moe/7jzdp7.jpg","https://files.catbox.moe/jrmu6w.jpg","https://files.catbox.moe/c0bwhn.jpg","https://files.catbox.moe/0blxme.jpg","https://files.catbox.moe/qicobr.jpg","https://files.catbox.moe/n94ztu.jpg"],g=f[Math.floor(Math.random()*f.length)];n("send-image",{url:g,name:"",isAiGenerated:!0,prompt:b.value.trim()}),k()},_=()=>{u.value=!1},$=()=>{var f;(f=i.value)==null||f.click()},T=f=>{const g=f.target.files[0];if(g){const H=new FileReader;H.onload=K=>{n("send-video",{file:g,url:K.target.result,name:g.name})},H.readAsDataURL(g)}f.target.value=""},q=()=>{var f;(f=r.value)==null||f.click()},oe=f=>{const g=f.target.files[0];g&&n("send-file",{file:g,name:g.name,size:se(g.size)}),f.target.value=""},se=f=>f<1024?f+" B":f<1024*1024?(f/1024).toFixed(2)+" KB":(f/(1024*1024)).toFixed(2)+" MB",J=()=>{c.value=!1,d.value=""},N=()=>{c.value=!0},P=()=>{if(!d.value.trim()){alert("");return}const f=Math.max(1,Math.ceil(d.value.length/3));n("send-voice",{text:d.value.trim(),duration:f}),J()};return s({openVoiceModal:N}),(f,g)=>t.show?(p(),m("div",H1,[e("div",{class:"add-menu-scroll",ref_key:"menuScroll",ref:a},[e("div",{class:"add-menu-item",onClick:g[0]||(g[0]=H=>f.$emit("open-emoji-manager"))},[...g[7]||(g[7]=[e("div",{class:"add-menu-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M12,2C6.477,2,2,6.477,2,12c0,5.523,4.477,10,10,10s10-4.477,10-10C22,6.477,17.523,2,12,2z M12,20c-4.418,0-8-3.582-8-8 s3.582-8,8-8s8,3.582,8,8S16.418,20,12,20z M15.5,11c0.828,0,1.5-0.672,1.5-1.5S16.328,8,15.5,8S14,8.672,14,9.5S14.672,11,15.5,11z M8.5,11c0.828,0,1.5-0.672,1.5-1.5S9.328,8,8.5,8S7,8.672,7,9.5S7.672,11,8.5,11z M12,17.5c2.33,0,4.31-1.46,5.11-3.5H6.89 C7.69,16.04,9.67,17.5,12,17.5z"})])],-1),e("span",null,"",-1)])]),e("div",{class:"add-menu-item",onClick:g[1]||(g[1]=H=>f.$emit("send-transfer"))},[...g[8]||(g[8]=[e("div",{class:"add-menu-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,17L7,12L8.41,10.59L12,14.17L15.59,10.59L17,12M12,7L17,12L15.59,13.41L12,9.83L8.41,13.41L7,12L12,7Z"})])],-1),e("span",null,"",-1)])]),e("div",{class:"add-menu-item",onClick:y},[g[9]||(g[9]=e("div",{class:"add-menu-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19M8.5,13.5L11,16.5L14.5,12L19,18H5L8.5,13.5Z"})])],-1)),g[10]||(g[10]=e("span",null,"",-1)),e("input",{ref_key:"imageInput",ref:l,type:"file",accept:"image/*",onChange:M,style:{display:"none"}},null,544)]),e("div",{class:"add-menu-item",onClick:g[2]||(g[2]=H=>f.$emit("send-call"))},[...g[11]||(g[11]=[e("div",{class:"add-menu-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M20.01 15.38c-1.23 0-2.42-.2-3.53-.56a.977.977 0 0 0-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02c-.37-1.11-.56-2.3-.56-3.53c0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99C3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"})])],-1),e("span",null,"",-1)])]),e("div",{class:"add-menu-item",onClick:N},[...g[12]||(g[12]=[e("div",{class:"add-menu-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z"})])],-1),e("span",null,"",-1)])]),e("div",{class:"add-menu-item",onClick:$},[g[13]||(g[13]=e("div",{class:"add-menu-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z"})])],-1)),g[14]||(g[14]=e("span",null,"",-1)),e("input",{ref_key:"videoInput",ref:i,type:"file",accept:"video/*",onChange:T,style:{display:"none"}},null,544)]),e("div",{class:"add-menu-item",onClick:q},[g[15]||(g[15]=e("div",{class:"add-menu-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})])],-1)),g[16]||(g[16]=e("span",null,"",-1)),e("input",{ref_key:"fileInput",ref:r,type:"file",onChange:oe,style:{display:"none"}},null,544)]),e("div",{class:"add-menu-item",onClick:g[3]||(g[3]=H=>f.$emit("send-location"))},[...g[17]||(g[17]=[e("div",{class:"add-menu-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9A7,7 0 0,0 12,2Z"})])],-1),e("span",null,"",-1)])]),e("div",{class:"add-menu-item",onClick:g[4]||(g[4]=H=>f.$emit("send-takeout"))},[...g[18]||(g[18]=[e("div",{class:"add-menu-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M18.06 23H19.72C20.56 23 21.25 22.35 21.35 21.53L23 5.05H18V1H16.03V5.05H11.06L11.36 7.39C13.07 7.86 14.67 8.71 15.63 9.65C17.07 11.07 18.06 12.54 18.06 14.94V23M1 22V21H16.03V22C16.03 22.54 15.58 23 15 23H2C1.45 23 1 22.54 1 22M16.03 15C16.03 7 1 7 1 15H16.03M1 17H16V19H1V17Z"})])],-1),e("span",null,"",-1)])])],512),u.value?(p(),m("div",{key:0,class:"modal-overlay",onClick:je(_,["self"])},[e("div",{class:"modal"},[g[21]||(g[21]=e("div",{class:"modal-title"},"",-1)),e("div",{class:"modal-body"},[e("button",{class:"option-btn",onClick:A},[...g[19]||(g[19]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"})],-1),e("span",null,"",-1)])]),e("button",{class:"option-btn",onClick:w},[...g[20]||(g[20]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z"})],-1),e("span",null,"",-1)])])])])])):U("",!0),v.value?(p(),m("div",{key:1,class:"modal-overlay",onClick:je(k,["self"])},[e("div",D1,[g[22]||(g[22]=e("div",{class:"modal-title"},"",-1)),e("div",F1,[we(e("textarea",{"onUpdate:modelValue":g[5]||(g[5]=H=>b.value=H),class:"modal-textarea",placeholder:"...",rows:"4",maxlength:"200"},null,512),[[Te,b.value]]),e("div",U1,S(b.value.length)+"/200 ",1)]),e("div",{class:"modal-actions"},[e("button",{class:"modal-btn modal-btn-cancel",onClick:k},""),e("button",{class:"modal-btn modal-btn-confirm",onClick:I},"")])])])):U("",!0),c.value?(p(),m("div",{key:2,class:"modal-overlay",onClick:je(J,["self"])},[e("div",N1,[g[23]||(g[23]=e("div",{class:"modal-title"},"",-1)),e("div",O1,[we(e("textarea",{"onUpdate:modelValue":g[6]||(g[6]=H=>d.value=H),class:"modal-textarea",placeholder:"...",rows:"4",maxlength:"200"},null,512),[[Te,d.value]]),e("div",R1,S(d.value.length)+"/200 ",1)]),e("div",{class:"modal-actions"},[e("button",{class:"modal-btn modal-btn-cancel",onClick:J},""),e("button",{class:"modal-btn modal-btn-confirm",onClick:P},"")])])])):U("",!0)])):U("",!0)}},W1=Ze(z1,[["__scopeId","data-v-773a0fd5"]]),K1={class:"modal contact-settings-modal"},G1={class:"settings-tabs"},q1={key:0,class:"modal-body settings-scrollable"},Z1={class:"form-group"},J1={key:1},Y1={class:"form-group"},X1={class:"form-group"},Q1={class:"form-group"},ev=["value"],tv={class:"settings-section"},sv={viewBox:"0 0 24 24",width:"20",height:"20",style:{color:"#999"}},ov={class:"form-group"},nv={class:"context-length-selector"},av={class:"slider-container"},lv={class:"slider-value"},iv={class:"context-presets"},rv=["onClick"],cv={class:"form-group"},dv={class:"bubble-theme-selector"},uv=["onClick"],vv={class:"form-group"},pv=["src"],fv={key:1},mv={class:"settings-section danger"},gv={key:1,class:"modal-body settings-scrollable"},hv={class:"form-group"},yv={key:1},bv={class:"form-group"},wv={key:1,class:"emoji-manager-fullscreen"},kv={class:"emoji-manager-container"},xv={class:"manager-header"},Cv={class:"emoji-grid-fullscreen"},$v=["onClick"],_v=["src","alt"],Mv={class:"emoji-name-large"},Sv={key:0,class:"emoji-selected-mark"},Iv={key:0,class:"empty-state-large"},Av={class:"manager-footer-large"},Lv={class:"modal"},Tv={class:"modal-body"},jv={class:"form-group"},Pv={key:0,class:"image-preview"},Ev=["src"],Bv={class:"form-group"},Vv={class:"modal modal-large"},Hv={class:"modal-body"},Dv={class:"form-group"},Fv={__name:"ContactSettings",props:{show:{type:Boolean,default:!1},contactId:{type:Number,required:!0},contactInfo:{type:Object,required:!0}},emits:["close","save-character","save-user","clear-history","block-contact","delete-contact"],setup(t,{emit:s}){const o=t,n=s,a=h("contact"),l=h({avatar:"",nickname:"",prompt:"",linkedWorldBook:"",bubbleTheme:"default",contextLength:20}),i=h({avatar:"",prompt:""}),r=h([]),c=h(""),d=h(""),u=h([]);h([]),h(!1);const v=h(!1),b=h(null),y=h(!1),M=h(!1),A=h(""),w=h(""),k=h(null),I=h(""),_=h(null),$=[{id:"default",name:"",gradient:"linear-gradient(135deg, #6c8cd5, #4a6fbf)"},{id:"pink",name:"",gradient:"linear-gradient(135deg, #ff6b9d, #c44569)"},{id:"green",name:"",gradient:"linear-gradient(135deg, #56ab2f, #a8e063)"},{id:"purple",name:"",gradient:"linear-gradient(135deg, #667eea, #764ba2)"},{id:"orange",name:"",gradient:"linear-gradient(135deg, #f093fb, #f5576c)"},{id:"cyan",name:"",gradient:"linear-gradient(135deg, #4facfe, #00f2fe)"},{id:"sunset",name:"",gradient:"linear-gradient(135deg, #fa709a, #fee140)"},{id:"forest",name:"",gradient:"linear-gradient(135deg, #134e5e, #71b280)"}],T=[{label:"",value:10},{label:"",value:15},{label:"",value:20},{label:"",value:30},{label:"",value:50}],q=h(null),oe=h(null),se=h(null);Pt(()=>o.show,async B=>{B?(await J(),await N(),await P(),await x(),a.value="contact"):c.value=""});const J=async()=>{try{const B=await C.getContact(o.contactId);B&&(l.value.avatar=B.avatar,l.value.nickname=B.name,l.value.prompt=B.prompt||B.bio||"",l.value.linkedWorldBook=B.linkedWorldBook||"",l.value.bubbleTheme=B.bubbleTheme||"default",l.value.contextLength=B.contextLength||20)}catch(B){console.error(":",B)}},N=async()=>{try{r.value=await C.getWorldBookNames()}catch(B){console.error(":",B)}},P=async()=>{try{const B=await C.getUserSetting(o.contactId,"chatBackground");B&&(d.value=B)}catch(B){console.error(":",B)}},f=async()=>{a.value="user";try{const B=await C.getUserSetting(o.contactId,"avatar"),D=await C.getUserSetting(o.contactId,"prompt");B&&(i.value.avatar=B),D&&(i.value.prompt=D)}catch(B){console.error(":",B)}},g=(B,D)=>{const xe=B.target;if(xe.files&&xe.files[0]){const V=new FileReader;V.onload=O=>{D==="character"?l.value.avatar=O.target.result:D==="user"&&(i.value.avatar=O.target.result)},V.readAsDataURL(xe.files[0])}},H=B=>{const D=B.target;if(D.files&&D.files[0]){const xe=new FileReader;xe.onload=V=>{c.value=V.target.result},xe.readAsDataURL(D.files[0])}},K=()=>{n("close")},F=async()=>{a.value==="contact"?n("save-character",{...l.value,backgroundPreview:c.value,customEmojis:u.value}):n("save-user",i.value)},x=async()=>{try{const B=await C.getContact(o.contactId);B&&B.customEmojis?u.value=B.customEmojis:u.value=[]}catch(B){console.error(":",B)}},L=()=>{v.value=!0,b.value=null},ae=()=>{v.value=!1,b.value=null},de=B=>{var D;((D=b.value)==null?void 0:D.id)===B.id?b.value=null:b.value=B},ue=()=>{b.value&&(u.value=u.value.filter(B=>B.id!==b.value.id),b.value=null)},$e=()=>{y.value=!0},ne=()=>{y.value=!1,A.value="",w.value="",k.value=null},G=B=>{const D=B.target.files[0];if(!D)return;k.value=D;const xe=new FileReader;xe.onload=V=>{w.value=V.target.result},xe.readAsDataURL(D)},he=()=>{if(!A.value.trim()){alert("");return}if(!w.value){alert("");return}const B={id:Date.now(),name:A.value.trim(),url:w.value,type:"base64",createdAt:Date.now()};u.value.push(B),ne(),alert("")},j=()=>{M.value=!0},Q=()=>{M.value=!1,I.value=""},W=()=>{if(!I.value.trim()){alert("");return}const B=I.value.trim().split(`
`);let D=0,xe=0;for(const V of B){const O=V.trim();if(!O)continue;let z,ee;if(O.includes("")||O.includes(":")){const ce=O.split(/[:]/);z=ce[0].trim(),ee=ce[1].trim()}else{const ce=O.split(/\s+/);if(ce.length>=2)ee=ce[0].trim(),z=ce.slice(1).join(" ").trim();else{xe++;continue}}if(z&&ee){const ce={id:Date.now()+D,name:z,url:ee,type:"link",createdAt:Date.now()};u.value.push(ce),D++}else xe++}Q(),alert(`
${D} 
${xe} `)};return(B,D)=>(p(),m(Pe,null,[t.show?(p(),m("div",{key:0,class:"modal-overlay",onClick:je(K,["self"])},[e("div",K1,[D[34]||(D[34]=e("div",{class:"modal-title"},"",-1)),e("div",G1,[e("div",{class:Ie(["tab-item",{active:a.value==="contact"}]),onClick:D[0]||(D[0]=xe=>a.value="contact")},"  ",2),e("div",{class:Ie(["tab-item",{active:a.value==="user"}]),onClick:f},"  ",2)]),a.value==="contact"?(p(),m("div",q1,[e("div",Z1,[D[16]||(D[16]=e("label",null,"",-1)),e("div",{class:"avatar-upload-circle",onClick:D[2]||(D[2]=()=>{var xe;return(xe=q.value)==null?void 0:xe.click()})},[l.value.avatar?(p(),m("div",{key:0,class:"avatar-preview",style:Re({backgroundImage:`url(${l.value.avatar})`})},null,4)):(p(),m("span",J1,"")),e("input",{ref_key:"characterAvatarInputRef",ref:q,type:"file",accept:"image/*",onChange:D[1]||(D[1]=xe=>g(xe,"character")),style:{display:"none"}},null,544)])]),e("div",Y1,[D[17]||(D[17]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":D[3]||(D[3]=xe=>l.value.nickname=xe),type:"text",class:"form-input",placeholder:""},null,512),[[Te,l.value.nickname]])]),e("div",X1,[D[18]||(D[18]=e("label",null,"",-1)),we(e("textarea",{"onUpdate:modelValue":D[4]||(D[4]=xe=>l.value.prompt=xe),class:"form-textarea",placeholder:"...",rows:"4"},null,512),[[Te,l.value.prompt]])]),e("div",Q1,[D[20]||(D[20]=e("label",null,"",-1)),we(e("select",{"onUpdate:modelValue":D[5]||(D[5]=xe=>l.value.linkedWorldBook=xe),class:"form-input"},[D[19]||(D[19]=e("option",{value:""},"",-1)),(p(!0),m(Pe,null,Fe(r.value,xe=>(p(),m("option",{key:xe,value:xe},S(xe),9,ev))),128))],512),[[Ls,l.value.linkedWorldBook]]),D[21]||(D[21]=e("div",{class:"form-hint"},"",-1))]),e("div",tv,[e("div",{class:"settings-item",onClick:L},[D[23]||(D[23]=e("span",null,"",-1)),(p(),m("svg",sv,[...D[22]||(D[22]=[e("path",{fill:"currentColor",d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"},null,-1)])]))])]),e("div",ov,[D[24]||(D[24]=e("label",null," ",-1)),e("div",nv,[e("div",av,[we(e("input",{type:"range","onUpdate:modelValue":D[6]||(D[6]=xe=>l.value.contextLength=xe),min:"5",max:"50",step:"5",class:"context-slider"},null,512),[[Te,l.value.contextLength,void 0,{number:!0}]]),e("div",lv,S(l.value.contextLength)+" ",1)]),e("div",iv,[(p(),m(Pe,null,Fe(T,xe=>e("button",{key:xe.value,class:Ie(["preset-btn",{active:l.value.contextLength===xe.value}]),onClick:V=>l.value.contextLength=xe.value},S(xe.label),11,rv)),64))])]),D[25]||(D[25]=e("div",{class:"form-hint"},[Qe("  AI  AI  "),e("br"),e("span",{style:{color:"#ff6b6b"}},"  AI ")],-1))]),e("div",cv,[D[26]||(D[26]=e("label",null,"",-1)),e("div",dv,[(p(),m(Pe,null,Fe($,xe=>e("div",{key:xe.id,class:Ie(["bubble-theme-item",{active:l.value.bubbleTheme===xe.id}]),onClick:V=>l.value.bubbleTheme=xe.id},[e("div",{class:"theme-preview",style:Re({background:xe.gradient})},[e("span",null,S(xe.name),1)],4)],10,uv)),64))]),D[27]||(D[27]=e("div",{class:"form-hint"},"",-1))]),e("div",vv,[D[28]||(D[28]=e("label",null,"",-1)),e("div",{class:"wallpaper-upload-small",onClick:D[7]||(D[7]=()=>{var xe;return(xe=se.value)==null?void 0:xe.click()})},[c.value||d.value?(p(),m("img",{key:0,src:c.value||d.value,class:"wallpaper-preview-small"},null,8,pv)):(p(),m("span",fv,"")),e("input",{ref_key:"backgroundInputRef",ref:se,type:"file",accept:"image/*",onChange:H,style:{display:"none"}},null,544)])]),e("div",mv,[e("div",{class:"settings-item danger",onClick:D[8]||(D[8]=xe=>B.$emit("clear-history"))},[...D[29]||(D[29]=[e("span",null,"",-1)])]),e("div",{class:"settings-item danger",onClick:D[9]||(D[9]=xe=>B.$emit("block-contact"))},[...D[30]||(D[30]=[e("span",null,"",-1)])]),e("div",{class:"settings-item danger",onClick:D[10]||(D[10]=xe=>B.$emit("delete-contact"))},[...D[31]||(D[31]=[e("span",null,"",-1)])])])])):U("",!0),a.value==="user"?(p(),m("div",gv,[e("div",hv,[D[32]||(D[32]=e("label",null,"",-1)),e("div",{class:"avatar-upload-circle",onClick:D[12]||(D[12]=()=>{var xe;return(xe=oe.value)==null?void 0:xe.click()})},[i.value.avatar?(p(),m("div",{key:0,class:"avatar-preview",style:Re({backgroundImage:`url(${i.value.avatar})`})},null,4)):(p(),m("span",yv,"")),e("input",{ref_key:"userAvatarInputRef",ref:oe,type:"file",accept:"image/*",onChange:D[11]||(D[11]=xe=>g(xe,"user")),style:{display:"none"}},null,544)])]),e("div",bv,[D[33]||(D[33]=e("label",null,"",-1)),we(e("textarea",{"onUpdate:modelValue":D[13]||(D[13]=xe=>i.value.prompt=xe),class:"form-textarea",placeholder:"...",rows:"4"},null,512),[[Te,i.value.prompt]])])])):U("",!0),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:K},"  "),e("button",{class:"btn btn-confirm",onClick:F},"  ")])])])):U("",!0),v.value?(p(),m("div",wv,[e("div",kv,[e("div",xv,[e("button",{class:"back-btn",onClick:ae},[...D[35]||(D[35]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})],-1)])]),e("h3",null,S(t.contactInfo.name)+" ",1),D[36]||(D[36]=e("div",{style:{width:"40px"}},null,-1))]),e("div",Cv,[(p(!0),m(Pe,null,Fe(u.value,xe=>{var V;return p(),m("div",{key:xe.id,class:"emoji-card-large",onClick:O=>de(xe)},[e("img",{src:xe.url,alt:xe.name,class:"emoji-image-large"},null,8,_v),e("div",Mv,S(xe.name),1),((V=b.value)==null?void 0:V.id)===xe.id?(p(),m("div",Sv,[...D[37]||(D[37]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"white",d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})],-1)])])):U("",!0)],8,$v)}),128)),u.value.length===0?(p(),m("div",Iv,[...D[38]||(D[38]=[e("div",{class:"empty-icon"},"",-1),e("div",{class:"empty-text"},"",-1),e("div",{class:"empty-hint"},"",-1)])])):U("",!0)]),e("div",Av,[b.value?(p(),m("button",{key:0,class:"action-btn-large danger",onClick:ue},[...D[39]||(D[39]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"})],-1),e("span",null,"",-1)])])):(p(),m("button",{key:1,class:"action-btn-large",onClick:$e},[...D[40]||(D[40]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"})],-1),e("span",null,"",-1)])])),b.value?U("",!0):(p(),m("button",{key:2,class:"action-btn-large primary",onClick:j},[...D[41]||(D[41]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})],-1),e("span",null,"",-1)])]))]),y.value?(p(),m("div",{key:0,class:"modal-overlay",onClick:je(ne,["self"])},[e("div",Lv,[D[44]||(D[44]=e("div",{class:"modal-title"},"",-1)),e("div",Tv,[e("div",jv,[D[42]||(D[42]=e("label",null,"",-1)),e("input",{ref_key:"fileInputRef",ref:_,type:"file",accept:"image/*",onChange:G,class:"file-input"},null,544),w.value?(p(),m("div",Pv,[e("img",{src:w.value,alt:""},null,8,Ev)])):U("",!0)]),e("div",Bv,[D[43]||(D[43]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":D[14]||(D[14]=xe=>A.value=xe),type:"text",class:"form-input",placeholder:""},null,512),[[Te,A.value]])])]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:ne},""),e("button",{class:"btn btn-confirm",onClick:he},"")])])])):U("",!0),M.value?(p(),m("div",{key:1,class:"modal-overlay",onClick:je(Q,["self"])},[e("div",Vv,[D[47]||(D[47]=e("div",{class:"modal-title"},"",-1)),e("div",Hv,[e("div",Dv,[D[45]||(D[45]=e("label",null,"",-1)),we(e("textarea",{"onUpdate:modelValue":D[15]||(D[15]=xe=>I.value=xe),class:"form-textarea",rows:"10",placeholder:`


https://img.58sb.cn/file/img/jktb7oi4.jpg
https://img.58sb.cn/file/img/8hlgSoU0.jpg`},null,512),[[Te,I.value]]),D[46]||(D[46]=e("div",{class:"hint-text"},"",-1))])]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:Q},""),e("button",{class:"btn btn-confirm",onClick:W},"")])])])):U("",!0)])])):U("",!0)],64))}},Uv=Ze(Fv,[["__scopeId","data-v-164fd98b"]]),Nv={class:"modal forward-modal"},Ov={class:"modal-body"},Rv={class:"contact-list"},zv=["onClick"],Wv=["src","alt"],Kv={class:"contact-name"},Gv={__name:"ForwardModal",props:{show:{type:Boolean,default:!1},selectedMessages:{type:Array,required:!0},currentContactInfo:{type:Object,required:!0},userAvatar:{type:String,required:!0}},emits:["close","forward-complete"],setup(t,{emit:s}){const o=t,n=s,a=h([]);Pt(()=>o.show,async d=>{d&&await l()});const l=async()=>{try{const d=await C.getContacts();a.value=d.filter(u=>u.id!==o.currentContactInfo.id)}catch(d){console.error(":",d)}},i=async d=>{try{const u=r(o.selectedMessages),v={id:Date.now(),type:"text",text:u.text,html:u.html,sent:!0,time:Date.now(),chatId:`chat_${d.id}`,isForwarded:!0};await C.addChatMessage(v);const y=(await C.getChatList()).find(M=>M.type==="single"&&M.contactId===d.id);y&&await C.updateChatListItem({...y,lastMessage:`[${o.selectedMessages.length}]`,lastMessageTime:Date.now()}),alert(` ${o.selectedMessages.length}  ${d.name}`),n("forward-complete")}catch(u){console.error(":",u),alert("")}},r=d=>{const u=[...d].sort((k,I)=>k.time-I.time),b=`[]
${u.map(k=>{const I=k.sent?"":o.currentContactInfo.name;let _="";return k.type==="text"?_=k.text:k.type==="image"?_="[]":k.type==="voice"?_="[]":k.type==="transfer"?_=`[${k.amount}]`:k.type==="file"&&(_=`[${k.fileName}]`),`${I}: ${_}`}).join(`
`)}`,y=u.map(k=>{const I=k.sent?"":o.currentContactInfo.name,_=k.sent?o.userAvatar:o.currentContactInfo.avatar;let $="";return k.type==="text"?$=k.text:k.type==="image"?$="[]":k.type==="voice"?$="[]":k.type==="transfer"?$=`[${k.amount}]`:k.type==="file"&&($=`[${k.fileName}]`),{sender:I,avatar:_,content:$}}),A=`showForwardDetail_${Date.now()}`;window[A]=function(){const k=`
      <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; z-index: 10000;" onclick="this.remove()">
        <div style="background: white; border-radius: 16px; width: 85%; max-width: 400px; max-height: 70vh; display: flex; flex-direction: column; overflow: hidden;" onclick="event.stopPropagation()">
          <div style="padding: 16px; border-bottom: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div style="font-size: 16px; font-weight: 600; color: #333;"></div>
              <div style="font-size: 12px; color: #666; margin-top: 2px;"> ${o.currentContactInfo.name}</div>
            </div>
            <button onclick="this.closest('[style*=\\'position: fixed\\']').remove()" style="width: 32px; height: 32px; border: none; background: #f5f5f5; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 20px; color: #666;"></button>
          </div>
          <div style="flex: 1; overflow-y: auto; padding: 16px;">
            ${y.map(I=>`
              <div style="display: flex; gap: 10px; align-items: flex-start; margin-bottom: 16px;">
                <img src="${I.avatar}" style="width: 32px; height: 32px; border-radius: 50%; flex-shrink: 0; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);" />
                <div style="flex: 1; min-width: 0;">
                  <div style="font-size: 12px; color: #6c8cd5; font-weight: 600; margin-bottom: 4px;">${I.sender}</div>
                  <div style="background: #f5f5f5; padding: 8px 12px; border-radius: 8px; font-size: 13px; color: #333; word-wrap: break-word;">${I.content}</div>
                </div>
              </div>
            `).join("")}
          </div>
        </div>
      </div>
    `;document.body.insertAdjacentHTML("beforeend",k)};const w=`
    <div class="forward-chat-card" onclick="window.${A}()" style="
      background: white;
      border-radius: 8px;
      padding: 12px;
      border: 1px solid #e5e5e5;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
      cursor: pointer;
      transition: all 0.2s;
      max-width: 240px;
    " onmouseover="this.style.boxShadow='0 2px 8px rgba(0, 0, 0, 0.12)'" onmouseout="this.style.boxShadow='0 1px 3px rgba(0, 0, 0, 0.08)'">
      <div style="display: flex; align-items: center; gap: 10px;">
        <div style="width: 36px; height: 36px; background: #6c8cd5; border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="white">
            <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
          </svg>
        </div>
        <div style="flex: 1; min-width: 0;">
          <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 2px;"></div>
          <div style="font-size: 11px; color: #999;">${o.currentContactInfo.name}${d.length}</div>
        </div>
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#999" stroke-width="2">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </div>
    </div>
  `;return{text:b,html:w}},c=()=>{n("close")};return(d,u)=>t.show?(p(),m("div",{key:0,class:"modal-overlay",onClick:je(c,["self"])},[e("div",Nv,[u[0]||(u[0]=e("div",{class:"modal-title"},"",-1)),e("div",Ov,[e("div",Rv,[(p(!0),m(Pe,null,Fe(a.value,v=>(p(),m("div",{key:v.id,class:"contact-item",onClick:b=>i(v)},[e("img",{src:v.avatar,class:"contact-avatar",alt:v.name},null,8,Wv),e("span",Kv,S(v.name),1)],8,zv))),128))])]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:c},"  ")])])])):U("",!0)}},qv=Ze(Gv,[["__scopeId","data-v-2c050574"]]),Zv={class:"emoji-manager"},Jv={class:"manager-header"},Yv=["onClick","onContextmenu"],Xv=["src","alt"],Qv={class:"emoji-name"},ep={key:0,class:"empty-state"},tp={class:"modal modal-large"},sp={class:"modal-body"},op={class:"form-group"},np={key:0,class:"emoji-preview-list"},ap={class:"preview-image-wrapper"},lp=["src","alt"],ip=["onClick"],rp=["onUpdate:modelValue","placeholder"],cp={key:1,class:"empty-upload-state"},dp={class:"modal-actions"},up=["disabled"],vp={class:"modal modal-large"},pp={class:"modal-body"},fp={class:"form-group"},mp={__name:"EmojiManager",props:{show:{type:Boolean,default:!1}},emits:["close","select"],setup(t,{emit:s}){const o=s,n=h([]),a=h(null),l=h(null),i=h(!1),r=h([]),c=h(!1),d=h(""),u=h(!1),v=h({x:0,y:0}),b=h(null),y=async()=>{try{const P=await C.getCustomEmojis();n.value=P||[]}catch(P){console.error(":",P)}},M=P=>{o("select",P),o("close")},A=()=>{i.value=!0},w=()=>{i.value=!1,r.value=[],l.value&&(l.value.value="")},k=()=>{var P;(P=l.value)==null||P.click()},I=P=>{const f=Array.from(P.target.files);f.length!==0&&f.forEach((g,H)=>{const K=new FileReader;K.onload=F=>{const x=g.name.replace(/\.[^/.]+$/,"");r.value.push({name:x,preview:F.target.result,file:g})},K.readAsDataURL(g)})},_=P=>{r.value.splice(P,1)},$=async()=>{if(r.value.length===0){alert("");return}const P=r.value.filter(f=>!f.name.trim()).length;if(!(P>0&&!confirm(` ${P} `)))try{let f=0,g=0;for(let H=0;H<r.value.length;H++){const K=r.value[H],F=K.name.trim()||`_${Date.now()}_${H}`;try{await C.addCustomEmoji({name:F,url:K.preview,type:"base64",createdAt:Date.now()}),f++}catch(x){console.error(":",F,x),g++}}await y(),w(),alert(g===0?` ${f} `:`
${f} 
${g} `)}catch(f){console.error(":",f),alert("")}},T=()=>{c.value=!0},q=()=>{c.value=!1,d.value=""},oe=async()=>{if(!d.value.trim()){alert("");return}try{const P=d.value.trim().split(`
`);let f=0,g=0;for(const H of P){const K=H.trim();if(!K)continue;let F,x;if(K.includes("")||K.includes(":")){const L=K.split(/[:]/);F=L[0].trim(),x=L[1].trim()}else{const L=K.split(/\s+/);if(L.length>=2)x=L[0].trim(),F=L.slice(1).join(" ").trim();else{g++;continue}}if(F&&x)try{await C.addCustomEmoji({name:F,url:x,type:"link",createdAt:Date.now()}),f++}catch(L){console.error(":",F,L),g++}else g++}await y(),q(),alert(`
${f} 
${g} `)}catch(P){console.error(":",P),alert("")}},se=(P,f)=>{b.value=f,v.value={x:Math.min(P.clientX,window.innerWidth-150),y:Math.min(P.clientY,window.innerHeight-100)},u.value=!0},J=async()=>{if(b.value&&confirm(`"${b.value.name}"`))try{await C.deleteCustomEmoji(b.value.id),await y(),u.value=!1}catch(P){console.error(":",P),alert("")}},N=()=>{u.value=!1,b.value=null};return nt(()=>{y(),document.addEventListener("click",P=>{u.value&&!P.target.closest(".emoji-menu")&&N()})}),(P,f)=>t.show?(p(),m("div",{key:0,class:"emoji-manager-overlay",onClick:f[2]||(f[2]=je(g=>P.$emit("close"),["self"]))},[e("div",Zv,[e("div",Jv,[f[3]||(f[3]=e("h3",null,"",-1)),e("button",{class:"close-btn",onClick:f[0]||(f[0]=g=>P.$emit("close"))},"")]),e("div",{class:"emoji-grid",ref_key:"emojiGridRef",ref:a},[(p(!0),m(Pe,null,Fe(n.value,g=>(p(),m("div",{key:g.id,class:"emoji-card",onClick:H=>M(g),onContextmenu:je(H=>se(H,g),["prevent"])},[e("img",{src:g.url,alt:g.name,class:"emoji-image"},null,8,Xv),e("div",Qv,S(g.name),1)],40,Yv))),128)),n.value.length===0?(p(),m("div",ep,[...f[4]||(f[4]=[e("div",{class:"empty-icon"},"",-1),e("div",{class:"empty-text"},"",-1)])])):U("",!0)],512),e("div",{class:"manager-footer"},[e("button",{class:"action-btn",onClick:A},[...f[5]||(f[5]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"})],-1),e("span",null,"",-1)])]),e("button",{class:"action-btn primary",onClick:T},[...f[6]||(f[6]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})],-1),e("span",null,"",-1)])])]),i.value?(p(),m("div",{key:0,class:"modal-overlay",onClick:je(w,["self"])},[e("div",tp,[f[11]||(f[11]=e("div",{class:"modal-title"},"",-1)),e("div",sp,[e("div",op,[e("button",{class:"select-files-btn",onClick:k},[...f[7]||(f[7]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"})],-1),e("span",null,"",-1)])]),e("input",{ref_key:"fileInputRef",ref:l,type:"file",accept:"image/*",multiple:"",onChange:I,style:{display:"none"}},null,544),f[8]||(f[8]=e("div",{class:"hint-text"},"",-1))]),r.value.length>0?(p(),m("div",np,[(p(!0),m(Pe,null,Fe(r.value,(g,H)=>(p(),m("div",{key:H,class:"emoji-preview-item"},[e("div",ap,[e("img",{src:g.preview,alt:g.name,class:"preview-image"},null,8,lp),e("button",{class:"remove-btn",onClick:K=>_(H)},[...f[9]||(f[9]=[e("svg",{viewBox:"0 0 24 24",width:"16",height:"16"},[e("path",{fill:"currentColor",d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})],-1)])],8,ip)]),we(e("input",{"onUpdate:modelValue":K=>g.name=K,type:"text",class:"emoji-name-input",placeholder:` ${H+1}`},null,8,rp),[[Te,g.name]])]))),128))])):(p(),m("div",cp,[...f[10]||(f[10]=[e("div",{class:"empty-icon"},"",-1),e("div",{class:"empty-text"},"",-1)])]))]),e("div",dp,[e("button",{class:"btn btn-cancel",onClick:w},""),e("button",{class:"btn btn-confirm",onClick:$,disabled:r.value.length===0},"  ("+S(r.value.length)+") ",9,up)])])])):U("",!0),c.value?(p(),m("div",{key:1,class:"modal-overlay",onClick:je(q,["self"])},[e("div",vp,[f[14]||(f[14]=e("div",{class:"modal-title"},"",-1)),e("div",pp,[e("div",fp,[f[12]||(f[12]=e("label",null,"",-1)),we(e("textarea",{"onUpdate:modelValue":f[1]||(f[1]=g=>d.value=g),class:"form-textarea",rows:"10",placeholder:`


https://img.58sb.cn/file/img/jktb7oi4.jpg
https://img.58sb.cn/file/img/8hlgSoU0.jpg
https://img.58sb.cn/file/img/C5o7L9vf.jpg`},null,512),[[Te,d.value]]),f[13]||(f[13]=e("div",{class:"hint-text"},"",-1))])]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:q},""),e("button",{class:"btn btn-confirm",onClick:oe},"")])])])):U("",!0),u.value?(p(),m("div",{key:2,class:"emoji-menu",style:Re({top:v.value.y+"px",left:v.value.x+"px"})},[e("div",{class:"menu-item",onClick:J},[...f[15]||(f[15]=[e("svg",{viewBox:"0 0 24 24",width:"18",height:"18"},[e("path",{fill:"currentColor",d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"})],-1),e("span",null,"",-1)])])],4)):U("",!0)])])):U("",!0)}},gp=Ze(mp,[["__scopeId","data-v-dd5eed6c"]]),hp="modulepreload",yp=function(t){return"/"+t},wl={},ls=function(s,o,n){let a=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),r=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(o.map(c=>{if(c=yp(c),c in wl)return;wl[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const v=document.createElement("link");if(v.rel=d?"stylesheet":hp,d||(v.as="script"),v.crossOrigin="",v.href=c,r&&v.setAttribute("nonce",r),document.head.appendChild(v),d)return new Promise((b,y)=>{v.addEventListener("load",b),v.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function l(i){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=i,window.dispatchEvent(r),!r.defaultPrevented)throw i}return a.then(i=>{for(const r of i||[])r.status==="rejected"&&l(r.reason);return s().catch(l)})};class bp{constructor(){this.isBackgroundRunning=!1,this.backgroundInterval=null}normalizeBaseUrl(s){return s?s.endsWith("/v1")?s.slice(0,-3):s.endsWith("/")?s.slice(0,-1):s:""}buildApiUrl(s,o,n){return s?`${this.normalizeBaseUrl(s)}${n}`:`${{deepseek:"https://api.deepseek.com",gemini:"https://generativelanguage.googleapis.com",openai:"https://api.openai.com"}[o]}${n}`}async getApiConfig(){return await C.getSetting("apiConfig")||{provider:"deepseek",apiKey:"",baseUrl:"",model:""}}async saveApiConfig(s){try{await C.setSetting("apiConfig",s),console.log("API :",s)}catch(o){throw console.error(" API :",o),o}}async fetchModels(s,o,n){var l;const a=this.buildApiUrl(n,s,"/v1/models");console.log(" ..."),console.log(" URL:",a),console.log(" Provider:",s),console.log(" BaseUrl:",n);try{const i=await fetch(a,{method:"GET",headers:{Authorization:`Bearer ${o}`}});if(console.log(" :",i.status,i.statusText),!i.ok){const c=await i.text().catch(()=>"");throw console.error(" :",{status:i.status,statusText:i.statusText,url:a,errorText:c}),i.status===0||c.includes("CORS")?new Error(`
1. 
2. ${a}
3. `):i.status===404?new Error(`
${a}
`):i.status===401||i.status===403?new Error(`
API Key 
${i.status}`):new Error(`HTTP ${i.status}: ${c||i.statusText}`)}const r=await i.json();return console.log(" :",((l=r.data)==null?void 0:l.length)||0),r.data||[]}catch(i){throw console.error(" :",{error:i.message,url:a,provider:s,baseUrl:n}),i.message.includes("Failed to fetch")||i.message.includes("NetworkError")?new Error(` 

${a}


1. 
2.  127.0.0.1
3. 

 
-  127.0.0.1  IP
- http://192.168.1.100:8888`):i}}extractValidContent(s){if(!s)return"";if(!s.includes("[")&&!s.includes("{"))return s.trim();const o=s.match(/\[[\s\S]*\]/);if(o)try{const a=JSON.parse(o[0]);if(Array.isArray(a))return a.join(`
`)}catch{}const n=s.match(/\{[\s\S]*\}/);if(n)try{const a=JSON.parse(n[0]);if(a.content)return a.content;if(a.text)return a.text;if(a.message)return a.message}catch{}return s=s.replace(/```json\s*/g,"").replace(/```\s*/g,""),s=s.replace(/\\n/g,`
`).replace(/\\"/g,'"'),s.trim()}async sendWithRetry(s,o,n,a=3){var i,r,c,d;let l=null;for(let u=1;u<=a;u++)try{console.log(`  ( ${u}/${a} )...`);const v=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.apiKey}`},body:JSON.stringify({model:o.model,messages:n,temperature:.8,max_tokens:2e3,stream:!1,top_p:.9})}),b=await v.text();if(console.log(`  (: ${v.status}):`,b.substring(0,200)),!v.ok)throw new Error(`HTTP ${v.status}: ${b}`);let y;try{y=JSON.parse(b)}catch(A){console.warn(" JSON ...");const w=this.extractValidContent(b);if(w)return w;throw new Error(`: ${A.message}`)}let M=null;if(y.choices&&y.choices[0]&&(M=((i=y.choices[0].message)==null?void 0:i.content)||y.choices[0].text),!M&&y.candidates&&y.candidates[0]&&(M=(d=(c=(r=y.candidates[0].content)==null?void 0:r.parts)==null?void 0:c[0])==null?void 0:d.text),!M&&y.content&&(M=y.content),!M&&y.text&&(M=y.text),M||(console.warn(" ..."),M=this.extractValidContent(JSON.stringify(y))),!M)throw new Error("");return console.log(" :",M.substring(0,100)),M}catch(v){if(l=v,console.error(`  ${u} :`,v.message),u<a){const b=u*1e3;console.log(`  ${b}ms ...`),await new Promise(y=>setTimeout(y,b))}}throw new Error(` ${a} : ${l.message}`)}async sendMessage(s,o,n){const a=await this.getApiConfig();if(!a.apiKey||!a.model)throw new Error(" API ");const l=this.buildApiUrl(a.baseUrl,a.provider,"/v1/chat/completions"),i=await C.getUserSetting(o,"prompt"),r=await this.getWorldBookContext(o,s),c=await this.getAvailableEmojis(o),u=[{role:"system",content:await this.buildEnhancedSystemPrompt(n,i,r,c)},...s];try{const v=await this.sendWithRetry(l,a,u);return this.extractValidContent(v)}catch(v){throw console.error(" :",v),v}}async buildEnhancedSystemPrompt(s,o,n,a){const l=await this.getMusicPlaylistInfo();return this.buildSystemPrompt(s,o,n,a,l)+`

 AI
- 
- 
- 
- 

 AI `}async getMusicPlaylistInfo(){try{const s=(await ls(async()=>{const{default:i}=await Promise.resolve().then(()=>xp);return{default:i}},void 0)).default,o=await s.getAllPlaylists();if(!o||o.length===0)return null;let n=[];for(const i of o){const r=await s.getSongsInPlaylist(i.id);n=n.concat(r.map(c=>({title:c.title,artist:c.artist,playlistName:i.name,hasLyrics:!!c.lyrics,lyrics:c.lyrics||""})))}const a=o.map(i=>{var r;return`${i.name}${((r=i.songs)==null?void 0:r.length)||0}`}).join(""),l=n.map(i=>`${i.title}- ${i.artist}`).join("");return{playlistInfo:a,songList:l,allSongs:n,totalSongs:n.length}}catch(s){return console.error(":",s),null}}async findSongLyrics(s){try{const o=await this.getMusicPlaylistInfo();if(!o||!o.allSongs)return null;const n=o.allSongs.find(a=>a.title.includes(s)||s.includes(a.title));return(n==null?void 0:n.lyrics)||null}catch(o){return console.error(":",o),null}}async getAvailableEmojis(s){try{const o=await C.getContact(s);let n=[];o&&o.customEmojis&&o.customEmojis.length>0&&(n=[...o.customEmojis]);const a=await C.getCustomEmojis();if(a&&a.length>0){const l=new Set(n.map(i=>i.name));for(const i of a)l.has(i.name)||n.push(i)}return n}catch(o){return console.error(":",o),[]}}async getWorldBookContext(s,o){try{const n=await C.getContact(s);if(console.log(" [] :",n),!n||!n.linkedWorldBook)return console.warn(" [] "),console.log("   - ID:",s),console.log("   - :",n==null?void 0:n.name),console.log("   - :",n==null?void 0:n.linkedWorldBook),null;console.log(" [] :",n.linkedWorldBook);const a=o.slice(-5).map(c=>c.content).join(" ");console.log(" [] :",a);const l=await C.matchWorldBookEntries(n.linkedWorldBook,a);if(console.log(" [] :",l.length),l.length>0)console.log(" [] :",l.map(c=>({keys:c.keys,content:c.content.substring(0,50)+"...",enabled:c.enabled})));else{console.warn(" [] ");const c=await C.getWorldBookEntries(n.linkedWorldBook);console.log(" [] :",c.map(d=>({keys:d.keys,enabled:d.enabled,content:d.content.substring(0,30)+"..."})))}if(l.length===0)return null;const r=l.map(c=>c.content).join(`

`);return console.log(" [] :",r.length,""),r}catch(n){return console.error(" [] :",n),null}}buildSystemPrompt(s,o,n,a,l){let r=`
1) "//"[]()**
2) 
3) 1-201-3
4) 1-2
5) AI
6) 7
7) 
8) 
   - []
   - []
   - [||]
   - []
   - [|]
   - []
   - []
   - [||]
   - [||]
   - []
   - [|]
   
   
   []
   []
   [|25.8|]
   []
   [100|]
   []
   []
   [.docx|2.5MB|]
   [|22C|]
   []
   [|   ]
   
   
   - []
   - []
   - []
   - [||][|]
   - [||]
   - []
   - [||]
   - []
   - []
   - [|]
   
   
   - [xxx][xxx][xxx]
   - 
   - 
   - 
   - 
   - "[]""[]""["`;if(a&&a.length>0){const c=a.map(d=>d.name).join("");r+=`

[]
${c}

`}if(l&&l.totalSongs>0&&(r+=`

${l.totalSongs}
${l.songList}

[][|]`),n&&(r+=`


${n}`),s)if(s.prompt)r+=`


${s.prompt}

`;else{const c=s.name||"",d=s.personality||"",u=s.description||s.bio||"",v=s.speakingStyle||"";(d||u||v)&&(r+=`


`,r+=`${c}
`,d&&(r+=`${d}
`),u&&(r+=`/${u}
`),v&&(r+=`${v}
`),r+=`
`)}return o&&(r+=`


${o}`),r}splitMessages(s){if(!s||typeof s!="string")return[""];s=s.trim();const o=[],n=/\[(||||||||||)[^\]]+\]/g,l=s.replace(n,r=>{const c=o.length;return o.push(r),`__SPECIAL_${c}__`}).split(new RegExp("(?<=[])\\s*","g")),i=[];for(let r of l){if(r=r.trim(),!r)continue;const c=r.split(/(__SPECIAL_\d+__)/g);for(let d of c)if(d=d.trim(),!!d)if(d.startsWith("__SPECIAL_")){const u=d.match(/__SPECIAL_(\d+)__/);if(u){const v=o[parseInt(u[1])];v&&i.push(v)}}else i.push(d)}return i.length===0?[s]:i}async startBackgroundMessages(){if(this.isBackgroundRunning)return;this.isBackgroundRunning=!0,await C.setSetting("backgroundMessagesEnabled",!0);const s=()=>{const o=Math.random()*10*60*1e3+3e5;this.backgroundInterval=setTimeout(async()=>{await this.sendBackgroundMessage(),this.isBackgroundRunning&&s()},o)};s()}async stopBackgroundMessages(){this.isBackgroundRunning=!1,await C.setSetting("backgroundMessagesEnabled",!1),this.backgroundInterval&&(clearTimeout(this.backgroundInterval),this.backgroundInterval=null)}async sendBackgroundMessage(){console.log("...")}async getBackgroundStatus(){return await C.getSetting("backgroundMessagesEnabled")}}const Ut=new bp,ca=Object.freeze(Object.defineProperty({__proto__:null,aiService:Ut},Symbol.toStringTag,{value:"Module"}));class wp{constructor(){this.notifications=[],this.listeners=[],this.maxNotifications=1,this.currentPage="home",this.currentChatId=null}setCurrentPage(s){this.currentPage=s}setCurrentChatId(s){this.currentChatId=s}addNotification(s){if(this.currentPage==="chat"&&this.currentChatId===s.contactId)return;const o={id:Date.now(),...s,timestamp:Date.now()};this.notifications=[o],this.notifyListeners(),setTimeout(()=>{this.removeNotification(o.id)},5e3),this.playNotificationSound()}removeNotification(s){const o=this.notifications.findIndex(n=>n.id===s);o>-1&&(this.notifications.splice(o,1),this.notifyListeners())}clearAll(){this.notifications=[],this.notifyListeners()}addListener(s){this.listeners.push(s)}removeListener(s){const o=this.listeners.indexOf(s);o>-1&&this.listeners.splice(o,1)}notifyListeners(){this.listeners.forEach(s=>{s(this.notifications)})}playNotificationSound(){try{const s=new Audio("https://assets.mixkit.co/active_storage/sfx/2354/2354-preview.mp3");s.volume=.3,s.play().catch(()=>{})}catch{console.log("")}}formatMessageContent(s){if(!s)return"";switch(s.type||"text"){case"text":const n=s.text||s.content||"";return n.length>30?n.substring(0,30)+"...":n;case"image":return" []";case"voice":return" []";case"video":return" []";case"file":return" []";case"location":return" []";case"takeout":return" []";case"transfer":return" []";default:return s.text||"[]"}}formatTime(s){const n=Date.now()-s;if(n<6e4)return"";if(n<36e5)return`${Math.floor(n/6e4)}`;if(n<864e5)return`${Math.floor(n/36e5)}`;{const a=new Date(s);return`${a.getMonth()+1}${a.getDate()}`}}}const Lt=new wp,gt=new Audio;gt.preload="auto";const Se=_n({currentSong:null,playlist:[],currentIndex:-1,isPlaying:!1,currentTime:0,duration:0,volume:1,loopMode:"list",isFavorite:!1,listenTogether:{active:!1,character:null,friendAvatar:null,startTime:null,elapsedTime:0},showGlobalLyrics:!1});gt.addEventListener("loadedmetadata",()=>{Se.duration=gt.duration});gt.addEventListener("timeupdate",()=>{if(Se.currentTime=gt.currentTime,Se.listenTogether.active&&Se.isPlaying){const t=Date.now();Se.listenTogether.startTime&&(Se.listenTogether.elapsedTime=Math.floor((t-Se.listenTogether.startTime)/1e3))}});gt.addEventListener("ended",()=>{$t.next()});gt.addEventListener("play",()=>{Se.isPlaying=!0});gt.addEventListener("pause",()=>{Se.isPlaying=!1});gt.addEventListener("error",t=>{console.error(":",t),Se.isPlaying=!1});const $t={playSong(t,s=null){t&&(Se.currentSong=t,s&&Array.isArray(s)?(Se.playlist=s,Se.currentIndex=s.findIndex(o=>o.id===t.id)):Se.playlist.length===0&&(Se.playlist=[t],Se.currentIndex=0),t.url?(gt.src=t.url,gt.load(),gt.play().catch(o=>{console.error(":",o)})):console.error("URL:",t))},togglePlay(){Se.currentSong&&(Se.isPlaying?gt.pause():gt.play().catch(t=>{console.error(":",t)}))},pause(){gt.pause()},play(){Se.currentSong&&gt.play().catch(t=>{console.error(":",t)})},previous(){if(Se.playlist.length===0)return;let t;Se.loopMode==="random"?t=Math.floor(Math.random()*Se.playlist.length):(t=Se.currentIndex-1,t<0&&(t=Se.playlist.length-1)),Se.currentIndex=t,this.playSong(Se.playlist[t])},next(){if(Se.playlist.length===0)return;let t;if(Se.loopMode==="single"){gt.currentTime=0,gt.play();return}else Se.loopMode==="random"?t=Math.floor(Math.random()*Se.playlist.length):(t=Se.currentIndex+1,t>=Se.playlist.length&&(t=0));Se.currentIndex=t,this.playSong(Se.playlist[t])},seek(t){gt.duration&&(gt.currentTime=Math.max(0,Math.min(t,gt.duration)))},setVolume(t){Se.volume=Math.max(0,Math.min(1,t)),gt.volume=Se.volume},toggleLoopMode(){const t=["list","random","single"],s=t.indexOf(Se.loopMode);return Se.loopMode=t[(s+1)%t.length],Se.loopMode},setPlaylist(t,s=0){Se.playlist=t,Se.currentIndex=s,t.length>0&&this.playSong(t[s],t)},addToPlaylist(t){Se.playlist.find(s=>s.id===t.id)||Se.playlist.push(t)},removeFromPlaylist(t){if(t>=0&&t<Se.playlist.length)if(Se.playlist.splice(t,1),t===Se.currentIndex)if(Se.playlist.length>0){const s=Math.min(t,Se.playlist.length-1);Se.currentIndex=s,this.playSong(Se.playlist[s])}else Se.currentSong=null,Se.currentIndex=-1,gt.pause(),gt.src="";else t<Se.currentIndex&&Se.currentIndex--},removeFromPlaylistById(t){const s=Se.playlist.findIndex(o=>o.id===t);s!==-1&&this.removeFromPlaylist(s)},clearPlaylist(){Se.playlist=[],Se.currentIndex=-1,Se.currentSong=null,gt.pause(),gt.src=""},playAtIndex(t){t>=0&&t<Se.playlist.length&&(Se.currentIndex=t,this.playSong(Se.playlist[t]))},_removeFromPlaylistOld(t){const s=Se.playlist.findIndex(o=>o.id===t);s!==-1&&this.removeFromPlaylist(s)},stop(){gt.pause(),gt.currentTime=0,Se.currentSong=null,Se.isPlaying=!1},toggleFavorite(){return Se.isFavorite=!Se.isFavorite,Se.isFavorite},startListenTogether(t,s=null){Se.listenTogether.isActive=!0,Se.listenTogether.roomId=Math.random().toString(36).substr(2,6).toUpperCase(),Se.listenTogether.startTime=Date.now(),Se.listenTogether.elapsedTime=0,Se.listenTogether.character=t,s&&this.playSong(s)},startListenTogether(t){Se.listenTogether.active=!0,Se.listenTogether.character=t,Se.listenTogether.friendAvatar=t.avatar,Se.listenTogether.startTime=Date.now(),Se.listenTogether.elapsedTime=0},endListenTogether(){Se.listenTogether.active=!1,Se.listenTogether.character=null,Se.listenTogether.friendAvatar=null,Se.listenTogether.startTime=null,Se.listenTogether.elapsedTime=0},updateListenTogetherTime(){if(Se.listenTogether.active&&Se.listenTogether.startTime){const t=Date.now();Se.listenTogether.elapsedTime=Math.floor((t-Se.listenTogether.startTime)/1e3)}},formatTime(t){if(!t||isNaN(t))return"0:00";const s=Math.floor(t/60),o=Math.floor(t%60);return`${s}:${o.toString().padStart(2,"0")}`},toggleGlobalLyrics(){return Se.showGlobalLyrics=!Se.showGlobalLyrics,Se.showGlobalLyrics}},zo=an(Se);Pt(()=>Se.loopMode,t=>{localStorage.setItem("musicLoopMode",t)});Pt(()=>Se.volume,t=>{localStorage.setItem("musicVolume",t.toString())});const kl=localStorage.getItem("musicLoopMode");kl&&(Se.loopMode=kl);const xl=localStorage.getItem("musicVolume");if(xl){const t=parseFloat(xl);Se.volume=t,gt.volume=t}class kp{async getUserConfig(){return await C.getSetting("musicUserConfig")||{wallpaper:"https://picsum.photos/1080/1920?random=33",uiColor:"#000000",opacity:.4,textColor:"#ffffff"}}async saveUserConfig(s){await C.setSetting("musicUserConfig",s)}async getPlaylist(s){return(await C.getSetting("musicPlaylists")||[]).find(n=>n.id===s)}async getSongsInPlaylist(s){return(await C.getSetting("musicSongs")||[]).filter(n=>n.playlistId===s)}async updatePlaylist(s,o){const n=await C.getSetting("musicPlaylists")||[],a=n.findIndex(l=>l.id===s);a!==-1&&(n[a]={...n[a],...o},await C.setSetting("musicPlaylists",n))}async deletePlaylist(s){const n=(await C.getSetting("musicPlaylists")||[]).filter(i=>i.id!==s);await C.setSetting("musicPlaylists",n);const l=(await C.getSetting("musicSongs")||[]).filter(i=>i.playlistId!==s);await C.setSetting("musicSongs",l)}async incrementPlayCount(s){const o=await C.getSetting("musicPlaylists")||[],n=o.findIndex(a=>a.id===s);n!==-1&&(o[n].playCount=(o[n].playCount||0)+1,await C.setSetting("musicPlaylists",o))}async deleteSongFromPlaylist(s){const n=(await C.getSetting("musicSongs")||[]).filter(a=>a.id!==s);await C.setSetting("musicSongs",n)}async addSongToPlaylist(s,o){const n=await C.getSetting("musicSongs")||[],a={...o,id:Date.now(),playlistId:s};return n.push(a),await C.setSetting("musicSongs",n),a}async getAllPlaylists(){return await C.getSetting("musicPlaylists")||[]}async createPlaylist(s){const o=await C.getSetting("musicPlaylists")||[],n={...s,id:Date.now(),playCount:0,isCollected:!1,songs:[]};return o.push(n),await C.setSetting("musicPlaylists",o),n}}const Ct=new kp,xp=Object.freeze(Object.defineProperty({__proto__:null,default:Ct},Symbol.toStringTag,{value:"Module"})),Cp={class:"chat-window-fullscreen"},$p={key:0,class:"voice-call-modal"},_p={class:"modal-content"},Mp=["src","alt"],Sp={class:"caller-name"},Ip={class:"chat-container"},Ap={class:"chat-header"},Lp=["src","alt"],Tp={class:"header-text"},jp={class:"header-icons"},Pp={key:0,class:"load-more-container"},Ep={key:0,class:"loading-indicator"},Bp={key:1,class:"load-more-hint"},Vp={key:0,class:"system-message"},Hp=["onClick"],Dp={key:0,viewBox:"0 0 24 24",width:"16",height:"16"},Fp=["onDblclick"],Up=["onTouchstart","onContextmenu"],Np={key:0,class:"forwarded-moment-bubble"},Op={class:"moment-content"},Rp={class:"message-time"},zp={key:1,class:"message received typing-message"},Wp={class:"modal"},Kp={class:"modal-body"},Gp={class:"form-group"},qp={class:"form-group"},Zp={class:"modal"},Jp={class:"modal-body"},Yp={class:"form-group"},Xp={class:"modal"},Qp={class:"modal-body"},ef={class:"form-group"},tf={class:"form-group"},sf={class:"form-group"},of={class:"modal"},nf={class:"modal-body"},af={class:"form-group"},lf={class:"form-group"},rf={class:"form-group"},cf={class:"modal"},df={class:"modal-body",style:{"text-align":"center",padding:"24px 16px"}},uf={style:{"font-size":"28px","font-weight":"600",color:"#333","margin-bottom":"8px"}},vf={style:{"font-size":"14px",color:"#666"}},pf={class:"modal"},ff={class:"modal-body"},mf={key:7,class:"multi-select-toolbar"},gf={key:8,class:"chat-input"},hf=["disabled"],yf={key:0,viewBox:"0 0 24 24",width:"20",height:"20"},bf={key:1,viewBox:"0 0 24 24",width:"20",height:"20",class:"loading-icon"},wf=500,Cl=10,kf={__name:"ChatWindow",props:{contactId:{type:Number,required:!0},contactName:{type:String,required:!0},contactAvatar:{type:String,required:!0}},emits:["back","open-diary"],setup(t,{emit:s}){const o=t,n=s,a=h({id:o.contactId,name:o.contactName,avatar:o.contactAvatar});h([]);const l=h([]),i=h([]),r=h(15),c=h(!1),d=h(!0),u=h(""),v=h(!1),b=h(!1),y=h(!1),M=h(null),A=h(null),w=h("https://via.placeholder.com/36");h(null);const k=h(null),I=h(!1),_=h([]),$=h(!1),T=h(!1),q=h(!1),oe=h({x:0,y:0}),se=h(null),J=h(-1),N=h(!1),P=h([]),f=h(!1),g=h(""),H=h(null),K=h(!1);let F=null,x=0,L=0;ot(()=>_.value.length>0);const ae=ot(()=>`chat_${o.contactId}`),de={click:new Audio("https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"),send:new Audio("https://assets.mixkit.co/active_storage/sfx/2570/2570-preview.mp3"),emoji:new Audio("https://files.catbox.moe/gb0so5.mp3"),bubble:new Audio("https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"),avatar:new Audio("https://assets.mixkit.co/active_storage/sfx/2575/2575-preview.mp3")},ue=(Z="click")=>{const R=de[Z];R&&(R.currentTime=0,R.play().catch(()=>{}))},$e=async Z=>{try{const R=await Ct.getAllPlaylists();for(const Ke of R){const It=(await Ct.getSongsInPlaylist(Ke.id)).find(Oe=>Oe.title===Z||Oe.title.includes(Z));if(It){$t.playSong(It),ue("send");return}}alert(`${Z}`)}catch(R){console.error(":",R),alert("")}};typeof window<"u"&&(window.playSongFromChat=$e);const ne=async Z=>{if(!Z)return{text:Z,html:Z,type:"text"};const R=Z.match(/^\[(.+)\]$/);if(R){const lt=R[1],_t=await C.getContact(o.contactId);let Bt=null;return _t&&_t.customEmojis&&_t.customEmojis.length>0&&(Bt=_t.customEmojis.find(wr=>wr.name===lt)),Bt||(Bt=await C.getCustomEmojiByName(lt)),Bt?{text:`[${lt}]`,html:`<img src="${Bt.url}" alt="${lt}" style="width: 90px; height: 90px; object-fit: contain; border-radius: 8px;" />`,type:"emoji"}:{text:`[${lt}]`,html:`<span style="color: #999; font-size: 13px;">[${lt}]</span>`,type:"text"}}const Ke=Z.match(/^\[(.+)\]$/);if(Ke){const lt=Ke[1],_t=Math.max(1,Math.ceil(lt.length/3));return{text:`[] ${lt}`,html:`<div class="voice-message-wrapper" style="display: flex; flex-direction: column; align-items: flex-start; gap: 8px;">
        <div style="display: flex; align-items: center; gap: 8px;">
          <div class="voice-bubble" style="display: flex; align-items: center; background: white; padding: 8px 12px; border-radius: 20px; border-top-left-radius: 4px; cursor: pointer; min-width: 85px; box-shadow: 0 1px 2px rgba(0,0,0,0.1);">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="#5c7cd1" style="margin-right: 8px;">
              <path d="M8 5v14l11-7z"/>
            </svg>
            <div style="display: flex; align-items: center; gap: 2px; height: 12px; margin-right: 12px;">
              <div style="width: 2px; height: 45%; background: rgba(92,124,209,0.5); border-radius: 2px;"></div>
              <div style="width: 2px; height: 90%; background: rgba(92,124,209,0.5); border-radius: 2px;"></div>
              <div style="width: 2px; height: 60%; background: rgba(92,124,209,0.5); border-radius: 2px;"></div>
              <div style="width: 2px; height: 100%; background: rgba(92,124,209,0.5); border-radius: 2px;"></div>
              <div style="width: 2px; height: 75%; background: rgba(92,124,209,0.5); border-radius: 2px;"></div>
            </div>
            <span style="color: #5c7cd1; font-size: 11px; font-weight: bold; font-style: italic;">${_t}"</span>
          </div>
          <button onclick="const wrapper = this.closest('.voice-message-wrapper'); const textEl = wrapper.querySelector('.voice-text'); const isHidden = textEl.style.display === 'none' || !textEl.style.display; textEl.style.display = isHidden ? 'flex' : 'none'; this.style.background = isHidden ? '#5c7cd1' : 'white'; this.style.color = isHidden ? 'white' : '#5c7cd1';" style="width: 24px; height: 24px; border-radius: 50%; background: white; color: #5c7cd1; border: 1px solid rgba(92,124,209,0.2); font-size: 10px; font-weight: bold; cursor: pointer; box-shadow: 0 1px 2px rgba(0,0,0,0.05);"></button>
        </div>
        <div class="voice-text" style="display: none; padding: 6px 12px; background: white; border-radius: 20px; border-top-left-radius: 4px; font-size: 13px; color: #333; max-width: 200px; word-wrap: break-word; box-shadow: 0 1px 2px rgba(0,0,0,0.05); border: 1px solid #f0f0f0;">${lt}</div>
      </div>`,type:"voice"}}const Xe=Z.match(/^\[([^|]+)\|([^|]+)(?:\|(.+))?\]$/);if(Xe){const[,lt,_t,Bt]=Xe;return{text:`[] ${lt}`,html:`<div style="display: inline-flex; align-items: center; gap: 12px; padding: 12px; background: #fff; border-radius: 12px; border: 1px solid #e0e0e0; max-width: 260px;">
        <div style="font-size: 36px; flex-shrink: 0;"></div>
        <div style="flex: 1; min-width: 0;">
          <div style="font-weight: 600; font-size: 14px; color: #333; margin-bottom: 4px;">${lt}</div>
          <div style="font-size: 15px; color: #ff6b6b; font-weight: 600; margin-bottom: 2px;">${_t}</div>
          ${Bt?`<div style="font-size: 12px; color: #999;">${Bt}</div>`:""}
        </div>
      </div>`,type:"takeout"}}const It=Z.match(/^\[(.+)\]$/);if(It){const lt=It[1],_t=["https://img.wjwj.top/2026/02/14/618ba7726d83280c55ac2cd72ad77c48.md.png","https://img.wjwj.top/2026/02/14/e2bf1bd411e4938d461fdb93734d0ba8.md.png","https://img.wjwj.top/2026/02/14/513c5e9eea4829323a5d4b40349b5037.md.png","https://img.wjwj.top/2026/02/14/6f9080ad44c879ae0f5eb3e01bc77fcf.md.png","https://img.wjwj.top/2026/02/14/db59081b9ab226d8c2c07b3d2defda29.md.png","https://img.wjwj.top/2026/02/14/7111d2e400f6ee5d072105f4421f5b10.md.png","https://img.wjwj.top/2026/02/14/9d771362701465ecade9da8eccc9c317.md.png","https://img.wjwj.top/2026/02/14/4f4286a6d3170b8910b6866830864e3d.md.png","https://img.wjwj.top/2026/02/14/2e01f4619d5140622c1adc1d0cb10f37.md.png","https://img.wjwj.top/2026/02/14/23aa94b79868c8daa814933079b8398f.md.png"],Bt=_t[Math.floor(Math.random()*_t.length)];return{text:`[] ${lt}`,html:`<div style="background: white; padding: 10px; border-radius: 32px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); border: 1px solid #f0f0f0; width: 256px;">
        <div style="padding: 8px 12px;"><h3 style="color: #333; font-size: 15px; font-weight: bold; margin: 0;">${lt}</h3></div>
        <div style="position: relative; height: 176px; border-radius: 24px; overflow: hidden; background: #f5f5f5;">
          <img src="${Bt}" style="width: 100%; height: 100%; object-fit: cover; opacity: 0.9;">
          <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
            <div style="position: relative; background: white; width: 40px; height: 40px; border-radius: 50%; box-shadow: 0 4px 6px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center;">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="#5c7cd1" fill-opacity="0.15" stroke="#5c7cd1" stroke-width="2">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                <circle cx="12" cy="10" r="3"></circle>
              </svg>
            </div>
          </div>
        </div>
      </div>`,type:"location"}}const Oe=Z.match(/^\[([^|]+)(?:\|(.+))?\]$/);if(Oe){const[,lt,_t]=Oe,Bt=Date.now();return{text:`[] ${lt}`,html:`<div onclick="window.handleTransferClick && window.handleTransferClick(${Bt}, '${lt}', '${_t||""}')" style="background: #f8f8f8; border-radius: 12px; padding: 10px; width: 125px; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f0f0f0'" onmouseout="this.style.background='#f8f8f8'">
        <div style="display: flex; align-items: center; gap: 8px;">
          <div style="width: 28px; height: 28px; background: #6C8CD5; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
              <path d="M12 2v20M2 12h20"/>
            </svg>
          </div>
          <div style="flex: 1;">
            <div style="font-size: 15px; font-weight: 600; color: #333;">${lt}</div>
            <div style="font-size: 11px; color: #666;">${_t||""}</div>
          </div>
        </div>
      </div>`,type:"transfer",transferData:{amount:lt,note:_t||"",id:Bt}}}const St=Z.match(/^\[([^|]+)(?:\|([^|]+))?(?:\|(.+))?\]$/);if(St){const[,lt,_t,Bt]=St;return{text:`[] ${lt}`,html:`<div style="display: inline-flex; align-items: center; gap: 10px; padding: 12px; background: #f5f5f5; border-radius: 12px; border: 1px solid #e0e0e0; max-width: 240px;">
        <div style="width: 40px; height: 40px; background: #6c8cd5; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
          </svg>
        </div>
        <div style="flex: 1;">
          <div style="font-weight: 600; font-size: 14px; color: #333;">${lt}</div>
          ${_t?`<div style="font-size: 12px; color: #999; margin-top: 2px;">${_t}</div>`:""}
          ${Bt?`<div style="font-size: 12px; color: #666; margin-top: 4px;">${Bt}</div>`:""}
        </div>
      </div>`,type:"file"}}const os=Z.match(/^\[(.+)\]$/);if(os){const lt=os[1],_t=["https://files.catbox.moe/0g3kqu.jpg","https://files.catbox.moe/d5b7k6.jpg","https://files.catbox.moe/0yrhh6.jpg","https://files.catbox.moe/8mjvdg.jpg","https://files.catbox.moe/fvidas.jpg","https://files.catbox.moe/q6so2i.jpg","https://files.catbox.moe/5a96cp.jpg","https://files.catbox.moe/0mp6h0.jpg","https://files.catbox.moe/epcn03.jpg","https://files.catbox.moe/7jzdp7.jpg","https://files.catbox.moe/jrmu6w.jpg","https://files.catbox.moe/c0bwhn.jpg","https://files.catbox.moe/0blxme.jpg","https://files.catbox.moe/qicobr.jpg","https://files.catbox.moe/n94ztu.jpg"],Bt=_t[Math.floor(Math.random()*_t.length)];return{text:`[] ${lt}`,html:`<div class="random-image-container" style="display: inline-block; position: relative; min-width: 100px; max-width: 100%; min-height: 100px; max-height: 130px; border: 2px solid transparent; border-radius: 15px; margin: 0 0 -6px 0; overflow-y: auto; box-shadow: 0 4px 8px rgba(255, 182, 193, 0.4); background: url('${Bt}') center/cover; background-color: rgba(255, 255, 255, 0.8); backdrop-filter: blur(5px);">
        <details style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: pointer;">
          <summary style="list-style: none; width: 100%; height: 100%;"></summary>
          <div style="position: absolute; top: 2px; left: 2px; right: 2px; background: linear-gradient(135deg, rgba(255, 192, 203, 0.4), rgba(255, 182, 193, 0.4)); color: #333333; padding: 8px; border-radius: 12px; text-align: center; z-index: 0; box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.5);">
            <div style="border: 1px solid rgba(255, 192, 203, 0.3); padding: 12px 8px; width: calc(100% - 3px); text-align: center; word-wrap: break-word; border-radius: 10px; background: rgba(255, 255, 255, 0.98); box-shadow: inset 0 0 8px rgba(255, 192, 203, 0.2);">
              <p style="margin: 0; font-family: 'Comic Sans MS', cursive; font-size: 11px; text-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);">${lt}</p>
            </div>
          </div>
        </details>
      </div>`,type:"image"}}const zs=Z.match(/^\[(.+)\]$/);if(zs){const lt=zs[1];return{text:`[] ${lt}`,html:`<div class="random-image-container" style="display: inline-block; position: relative; min-width: 100px; max-width: 100%; min-height: 100px; max-height: 130px; border: 2px solid transparent; border-radius: 15px; margin: 0 0 -6px 0; overflow-y: auto; box-shadow: 0 4px 8px rgba(92, 124, 209, 0.4); background: url('https://via.placeholder.com/200x130/5c7cd1/ffffff?text=Video') center/cover; background-color: rgba(255, 255, 255, 0.8); backdrop-filter: blur(5px);">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40px; height: 40px; background: rgba(255,255,255,0.9); border-radius: 50%; display: flex; align-items: center; justify-content: center; pointer-events: none;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="#5c7cd1">
            <path d="M8 5v14l11-7z"/>
          </svg>
        </div>
        <details style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: pointer;">
          <summary style="list-style: none; width: 100%; height: 100%;"></summary>
          <div style="position: absolute; top: 2px; left: 2px; right: 2px; background: linear-gradient(135deg, rgba(92, 124, 209, 0.4), rgba(108, 140, 213, 0.4)); color: #333333; padding: 8px; border-radius: 12px; text-align: center; z-index: 0; box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.5);">
            <div style="border: 1px solid rgba(92, 124, 209, 0.3); padding: 12px 8px; width: calc(100% - 3px); text-align: center; word-wrap: break-word; border-radius: 10px; background: rgba(255, 255, 255, 0.98); box-shadow: inset 0 0 8px rgba(92, 124, 209, 0.2);">
              <p style="margin: 0; font-family: 'Comic Sans MS', cursive; font-size: 11px; text-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);">${lt}</p>
            </div>
          </div>
        </details>
      </div>`,type:"video"}}const Ws=Z.match(/^\[(.+)\]$/);if(Ws){const lt=Ws[1];return{text:`[] ${lt}`,html:`<div onclick="window.playSongFromChat && window.playSongFromChat('${lt.replace(/'/g,"\\'")}');" style="display: inline-flex; flex-direction: column; gap: 0; padding: 0; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border-radius: 16px; max-width: 280px; cursor: pointer; box-shadow: 0 2px 8px rgba(33, 150, 243, 0.15); transition: all 0.3s; overflow: hidden; border: 1px solid rgba(33, 150, 243, 0.1);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(33, 150, 243, 0.25)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(33, 150, 243, 0.15)';">
        <div style="display: flex; align-items: center; gap: 12px; padding: 14px;">
          <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 2px 6px rgba(33, 150, 243, 0.3);">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
              <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
            </svg>
          </div>
          <div style="flex: 1; min-width: 0;">
            <div style="font-weight: 600; font-size: 15px; color: #1565c0; margin-bottom: 4px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${lt}</div>
            <div style="font-size: 12px; color: #1976d2; display: flex; align-items: center; gap: 4px; opacity: 0.8;">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="#1976d2">
                <path d="M8 5v14l11-7z"/>
              </svg>
              
            </div>
          </div>
        </div>
        <div style="height: 3px; background: linear-gradient(90deg, #2196f3 0%, #64b5f6 50%, #2196f3 100%); background-size: 200% 100%; animation: shimmer 2s infinite;"></div>
      </div>
      <style>
        @keyframes shimmer {
          0% { background-position: 200% 0; }
          100% { background-position: -200% 0; }
        }
      </style>`,type:"song",songData:{name:lt}}}const Wo=Z.match(/^\[([^|]+)\|(.+)\]$/);if(Wo){const[,lt,_t]=Wo;return{text:`[] ${lt}`,html:`<div style="display: inline-block; padding: 16px; background: linear-gradient(135deg, #e3f2fd 0%, #f5f9ff 100%); border-left: 4px solid #2196f3; border-radius: 12px; max-width: 280px; box-shadow: 0 2px 8px rgba(33, 150, 243, 0.1);">
        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#2196f3">
            <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
          </svg>
          <div style="font-weight: 600; font-size: 13px; color: #1565c0;">${lt}</div>
        </div>
        <div style="font-size: 14px; line-height: 1.6; color: #1976d2; font-style: italic; white-space: pre-wrap; opacity: 0.9;">${_t}</div>
      </div>`,type:"lyrics",lyricsData:{songName:lt,lyrics:_t}}}return{text:Z,html:Z,type:"text"}},G=Z=>{if(!Z)return"";const R=new Date(Z),Ke=String(R.getHours()).padStart(2,"0"),Xe=String(R.getMinutes()).padStart(2,"0");return`${Ke}:${Xe}`},he=Z=>Z?(Z.text||Z.content||"").includes(""):!1,j=Z=>Z?(Z.text||Z.content||"").replace(`
`,"").replace("",""):"",Q=async(Z=!1)=>{await zt(),M.value&&M.value.scrollTo({top:M.value.scrollHeight,behavior:Z?"smooth":"auto"})},W=async()=>{if(!M.value||c.value||!d.value)return;M.value.scrollTop<100&&await B()},B=async()=>{var It;if(c.value||!d.value)return;c.value=!0;const Z=((It=M.value)==null?void 0:It.scrollHeight)||0;await new Promise(Oe=>setTimeout(Oe,300));const R=i.value.length,Xe=l.value.slice(Math.max(0,l.value.length-R-20),l.value.length-R);if(Xe.length===0)d.value=!1;else if(i.value=[...Xe,...i.value],await zt(),M.value){const Oe=M.value.scrollHeight;M.value.scrollTop=Oe-Z}c.value=!1},D=()=>{l.value.length<=r.value?(i.value=[...l.value],d.value=!1):(i.value=l.value.slice(-r.value),d.value=!0)},xe=()=>{ue("click"),b.value=!b.value},V=()=>{b.value=!1},O=async()=>{const Z=u.value.trim();if(!Z)return;ue("send");const R={id:Date.now(),text:Z,html:Z,sent:!0,time:Date.now(),type:"text",chatId:ae.value};await C.addChatMessage(R),l.value.push(R),i.value.push(R),_.value.push(R),u.value="",Q(),await ee(Z,!0)},z=async()=>{if(u.value.trim()&&await O(),_.value.length!==0&&!$.value){$.value=!0;try{T.value=!0,await Q(),await new Promise(St=>setTimeout(St,Math.random()*1e3+1e3));const Z=await C.getContact(o.contactId),R=(Z==null?void 0:Z.contextLength)||20,Ke=l.value.slice(-R).map(St=>({role:St.sent?"user":"assistant",content:St.type==="text"?St.text:`[${St.type}]`})),Xe={name:(Z==null?void 0:Z.name)||a.value.name,prompt:(Z==null?void 0:Z.prompt)||"",personality:(Z==null?void 0:Z.personality)||"",description:(Z==null?void 0:Z.bio)||"",speakingStyle:(Z==null?void 0:Z.speakingStyle)||""},It=await Ut.sendMessage(Ke,o.contactId,Xe);T.value=!1;const Oe=Ut.splitMessages(It);for(let St=0;St<Oe.length;St++){const os=Math.random()*2e3+1e3;await new Promise(Wo=>setTimeout(Wo,os));const zs=await ne(Oe[St]),Ws={id:Date.now()+St,type:zs.type,text:zs.text,html:zs.html,sent:!1,time:Date.now(),chatId:ae.value,read:!1};await C.addChatMessage(Ws),l.value.push(Ws),i.value.push(Ws),await ee(zs.text,!1),Lt.addNotification({contactId:o.contactId,name:a.value.name,avatar:a.value.avatar,message:Lt.formatMessageContent(Ws),type:"chat"}),await Q(),ue("send")}_.value=[]}catch(Z){console.error("AI :",Z),T.value=!1,alert("AI ")}finally{$.value=!1}}},ee=async(Z,R)=>{try{const Xe=(await C.getChatList()).find(It=>It.type==="single"&&It.contactId===o.contactId);Xe&&await C.updateChatListItem({...Xe,lastMessage:Z,lastMessageTime:Date.now(),unreadCount:R?0:Xe.unreadCount||0})}catch(Ke){console.error(":",Ke)}},ce=()=>{ue("click"),n("back"),typeof window.triggerSlash=="function"&&window.triggerSlash("/send |/trigger")},ye=()=>{ue("avatar"),typeof window.triggerSlash=="function"&&window.triggerSlash(`/send ${a.value.name}|/trigger`)},Le=()=>{ue("click"),n("open-diary"),typeof window.triggerSlash=="function"&&window.triggerSlash(`/send ${a.value.name}|/trigger`)},Ae=()=>{ue("click"),y.value=!0},Me=()=>{y.value=!1},be=async Z=>{ue("click");try{await C.updateContact({id:o.contactId,avatar:Z.avatar,name:Z.nickname,prompt:Z.prompt,linkedWorldBook:Z.linkedWorldBook||null,bubbleTheme:Z.bubbleTheme||"default",contextLength:Z.contextLength||20,customEmojis:Z.customEmojis||[]}),a.value.avatar=Z.avatar,a.value.name=Z.nickname;const Ke=(await C.getChatList()).find(Xe=>Xe.type==="single"&&Xe.contactId===o.contactId);if(Ke&&await C.updateChatListItem({...Ke,avatar:Z.avatar,name:Z.nickname}),Z.backgroundPreview){await C.setUserSetting(o.contactId,"chatBackground",Z.backgroundPreview);const Xe=document.querySelector(".chat-container");Xe&&(Xe.style.backgroundImage=`url(${Z.backgroundPreview})`)}Me(),alert("")}catch(R){console.error(":",R),alert("")}},Ne=async Z=>{ue("click");try{await C.setUserSetting(o.contactId,"avatar",Z.avatar),await C.setUserSetting(o.contactId,"prompt",Z.prompt),w.value=Z.avatar,Me(),alert("")}catch(R){console.error(":",R),alert("")}},Ee=async()=>{if(confirm("")){ue("click");try{await C.clearChatMessages(ae.value),l.value=[],i.value=[];const R=(await C.getChatList()).find(Ke=>Ke.type==="single"&&Ke.contactId===o.contactId);R&&await C.updateChatListItem({...R,lastMessage:"",lastMessageTime:Date.now(),unreadCount:0}),alert("")}catch(Z){console.error(":",Z),alert("")}Me()}},De=()=>{confirm("")&&(ue("click"),alert(""),Me())},We=()=>{confirm("")&&(ue("click"),alert(""),Me(),ce())},Je=async Z=>{ue("click"),V();let R;Z.isAiGenerated?R=`<div class="random-image-container" style="display: inline-block; position: relative; min-width: 100px; max-width: 100%; min-height: 100px; max-height: 130px; border: 2px solid transparent; border-radius: 15px; margin: 0 0 -6px 0; overflow-y: auto; box-shadow: 0 4px 8px rgba(255, 182, 193, 0.4); background: url('${Z.url}') center/cover; background-color: rgba(255, 255, 255, 0.8); backdrop-filter: blur(5px);">
  <details style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: pointer;">
    <summary style="list-style: none; width: 100%; height: 100%;"></summary>
    <div style="position: absolute; top: 2px; left: 2px; right: 2px; background: linear-gradient(135deg, rgba(255, 192, 203, 0.4), rgba(255, 182, 193, 0.4)); color: #333333; padding: 8px; border-radius: 12px; text-align: center; z-index: 0; box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.5);">
      <div style="border: 1px solid rgba(255, 192, 203, 0.3); padding: 12px 8px; width: calc(100% - 3px); text-align: center; word-wrap: break-word; border-radius: 10px; background: rgba(255, 255, 255, 0.98); box-shadow: inset 0 0 8px rgba(255, 192, 203, 0.2);">
        <p style="margin: 0; font-family: 'Comic Sans MS', cursive; font-size: 11px; text-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);">${Z.prompt}</p>
      </div>
    </div>
  </details>
</div>`:R=`<img src="${Z.url}" style="max-width: 200px; border-radius: 8px;" />`;const Ke={id:Date.now(),text:"[]",html:R,sent:!0,time:Date.now(),type:"image",chatId:ae.value};await C.addChatMessage(Ke),l.value.push(Ke),i.value.push(Ke),_.value.push(Ke),Q(),await ee("[]",!0)},ge=()=>{ue("click"),V(),v.value=!0,A.value&&(A.value.currentTime=0,A.value.play());const Z=Math.floor(Math.random()*7001+3e3);setTimeout(()=>{const R=Math.random();v.value=!1,A.value&&A.value.pause(),R<=.8?typeof window.triggerSlash=="function"&&window.triggerSlash(`/send ${a.value.name}|/trigger`):typeof window.triggerSlash=="function"&&window.triggerSlash(`/send ${a.value.name}|/trigger`)},Z)},le=async Z=>{ue("click"),V();const R={id:Date.now(),text:"[]",html:`<video src="${Z.url}" controls style="max-width: 200px; border-radius: 8px;"></video>`,sent:!0,time:Date.now(),type:"video",chatId:ae.value};await C.addChatMessage(R),l.value.push(R),i.value.push(R),_.value.push(R),Q(),await ee("[]",!0)},He=async Z=>{ue("click"),V(),me.value=!0,E.value={name:Z.name||"",size:Z.size||"",content:"",url:Z.url||""}},ke=()=>{ue("click"),V(),ve.value=!0},Be=()=>{ue("click"),V(),ze.value=!0},vt=()=>{ue("emoji"),V(),alert("...")},pt=()=>{ue("click"),V(),I.value=!0},re=()=>{I.value=!1},te=async Z=>{ue("click");const R={id:Date.now(),text:`[${Z.name}]`,html:`<img src="${Z.url}" alt="${Z.name}" style="width: 90px; height: 90px; object-fit: contain; border-radius: 8px;" />`,sent:!0,time:Date.now(),type:"emoji",chatId:ae.value};await C.addChatMessage(R),l.value.push(R),i.value.push(R),_.value.push(R),Q(),await ee(`[${Z.name}]`,!0)},pe=async Z=>{const R={id:Date.now(),text:Z.text,html:`<div class="voice-message-wrapper" style="display: flex; flex-direction: column; align-items: flex-end; gap: 8px;">
      <!--  +  -->
      <div style="display: flex; align-items: center; gap: 8px;">
        <!--  -->
        <button class="voice-convert-btn" onclick="const wrapper = this.closest('.voice-message-wrapper'); const textEl = wrapper.querySelector('.voice-text'); const isHidden = textEl.style.display === 'none' || !textEl.style.display; textEl.style.display = isHidden ? 'flex' : 'none'; this.style.background = isHidden ? '#5c7cd1' : 'white'; this.style.color = isHidden ? 'white' : '#5c7cd1'; this.style.border = isHidden ? 'none' : '1px solid rgba(92, 124, 209, 0.2)';" style="width: 24px; height: 24px; border-radius: 50%; background: white; color: #5c7cd1; border: 1px solid rgba(92, 124, 209, 0.2); font-size: 10px; font-weight: bold; cursor: pointer; flex-shrink: 0; box-shadow: 0 1px 2px rgba(0,0,0,0.05); transition: all 0.2s;"></button>
        
        <!--  -->
        <div class="voice-bubble" onclick="this.classList.toggle('playing')" style="display: flex; align-items: center; background: #5c7cd1; padding: 8px 12px; border-radius: 20px; border-top-right-radius: 4px; cursor: pointer; min-width: 85px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); transition: all 0.2s; user-select: none;">
          <!--  -->
          <svg width="12" height="12" viewBox="0 0 24 24" fill="white" style="margin-right: 8px; opacity: 0.9;">
            <path d="M8 5v14l11-7z"/>
          </svg>
          <!--  -->
          <div style="display: flex; align-items: center; gap: 2px; height: 12px; margin-right: 12px;">
            <div style="width: 2px; height: 45%; background: rgba(255,255,255,0.5); border-radius: 2px;"></div>
            <div style="width: 2px; height: 90%; background: rgba(255,255,255,0.5); border-radius: 2px;"></div>
            <div style="width: 2px; height: 60%; background: rgba(255,255,255,0.5); border-radius: 2px;"></div>
            <div style="width: 2px; height: 100%; background: rgba(255,255,255,0.5); border-radius: 2px;"></div>
            <div style="width: 2px; height: 75%; background: rgba(255,255,255,0.5); border-radius: 2px;"></div>
          </div>
          <!--  -->
          <span style="color: white; font-size: 11px; font-weight: bold; font-style: italic; letter-spacing: -0.5px;">${Z.duration}"</span>
        </div>
      </div>
      
      <!--  -->
      <div class="voice-text" style="display: none; padding: 6px 12px; background: white; border-radius: 20px; border-top-right-radius: 4px; font-size: 13px; color: #333; max-width: 200px; word-wrap: break-word; box-shadow: 0 1px 2px rgba(0,0,0,0.05); border: 1px solid #f0f0f0; animation: fadeIn 0.2s; font-weight: 500; line-height: 1; white-space: nowrap;">{{VOICE_TEXT}}</div>
    </div>
    <style>
      @keyframes fadeIn {
        from { opacity: 0; transform: scale(0.95) translateY(-5px); }
        to { opacity: 1; transform: scale(1) translateY(0); }
      }
    </style>`,sent:!0,time:Date.now(),type:"voice",chatId:ae.value,voiceData:Z};R.html=R.html.replace("{{VOICE_TEXT}}",Z.text),await C.addChatMessage(R),l.value.push(R),i.value.push(R),_.value.push(R),Q(),await ee("[]",!0)},ze=h(!1),Ce=h({amount:"",note:""}),me=h(!1),E=h({name:"",size:"",content:"",url:""}),ve=h(!1),Ye=h({foodName:"",price:"",note:""}),ct=h(!1),bt=h({id:null,amount:"",note:""}),ft=()=>{ze.value=!1,Ce.value={amount:"",note:""}},wt=()=>{me.value=!1,E.value={name:"",size:"",content:"",url:""}},it=()=>{ve.value=!1,Ye.value={foodName:"",price:"",note:""}},Tt=(Z,R,Ke)=>{ue("click"),bt.value={id:Z,amount:R,note:Ke},ct.value=!0},Et=async()=>{ue("click");const Z={id:Date.now(),text:` ${bt.value.amount} `,type:"system",time:Date.now(),chatId:ae.value};await C.addChatMessage(Z),l.value.push(Z),i.value.push(Z),ct.value=!1,Q()},Wt=async()=>{ue("click");const Z={id:Date.now(),text:` ${bt.value.amount} `,type:"system",time:Date.now(),chatId:ae.value};await C.addChatMessage(Z),l.value.push(Z),i.value.push(Z),ct.value=!1,Q()};typeof window<"u"&&(window.handleTransferClick=Tt);const Kt=async()=>{const Z=parseFloat(Ce.value.amount);if(!Z||Z<=0){alert("");return}G(Date.now());const R={id:Date.now(),text:`[] ${Z}`,html:`<div class="transfer-bubble" style="background: #f8f8f8; border-radius: 12px; padding: 10px; width: 125px; cursor: pointer;">
      <div class="transfer-content" style="display: flex; align-items: center; gap: 8px;">
        <div class="transfer-icon" style="width: 28px; height: 28px; background: #6C8CD5; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
            <path d="M12 2v20M2 12h20"/>
          </svg>
        </div>
        <div class="transfer-info" style="flex: 1; min-width: 0;">
          <div class="transfer-amount" style="font-size: 15px; font-weight: 600; color: #333; margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${Z}</div>
          <div class="transfer-status" style="font-size: 11px; color: #666; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"></div>
        </div>
      </div>
    </div>`,sent:!0,time:Date.now(),type:"transfer",chatId:ae.value,transferData:{amount:Z,note:Ce.value.note}};await C.addChatMessage(R),l.value.push(R),i.value.push(R),_.value.push(R),Q(),await ee("[]",!0),ft()},Y=async()=>{if(!E.value.name.trim()){alert("");return}const Z={id:Date.now(),text:`[] ${E.value.name}`,html:`<div style="display: inline-flex; align-items: center; gap: 10px; padding: 12px; background: #f5f5f5; border-radius: 12px; border: 1px solid #e0e0e0; max-width: 240px;">
      <div style="width: 40px; height: 40px; background: #6c8cd5; border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
          <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
        </svg>
      </div>
      <div style="flex: 1; min-width: 0;">
        <div style="font-weight: 600; font-size: 14px; color: #333; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{FILE_NAME}}</div>
        {{SIZE_HTML}}
        {{CONTENT_HTML}}
      </div>
    </div>`,sent:!0,time:Date.now(),type:"file",chatId:ae.value,fileData:E.value};let R=Z.html.replace("{{FILE_NAME}}",E.value.name);E.value.size?R=R.replace("{{SIZE_HTML}}",`<div style="font-size: 12px; color: #999; margin-top: 2px;">${E.value.size}</div>`):R=R.replace("{{SIZE_HTML}}",""),E.value.content?R=R.replace("{{CONTENT_HTML}}",`<div style="font-size: 12px; color: #666; margin-top: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${E.value.content}</div>`):R=R.replace("{{CONTENT_HTML}}",""),Z.html=R,await C.addChatMessage(Z),l.value.push(Z),i.value.push(Z),_.value.push(Z),Q(),await ee("[]",!0),wt()},X=async()=>{if(!Ye.value.foodName.trim()){alert("");return}if(!Ye.value.price){alert("");return}const Z={id:Date.now(),text:`[] ${Ye.value.foodName}`,html:`<div style="display: inline-flex; align-items: center; gap: 12px; padding: 12px; background: #fff; border-radius: 12px; border: 1px solid #e0e0e0; max-width: 260px;">
      <div style="font-size: 36px; flex-shrink: 0;"></div>
      <div style="flex: 1; min-width: 0;">
        <div style="font-weight: 600; font-size: 14px; color: #333; margin-bottom: 4px;">{{FOOD_NAME}}</div>
        <div style="font-size: 15px; color: #ff6b6b; font-weight: 600; margin-bottom: 2px;">{{PRICE}}</div>
        {{NOTE_HTML}}
      </div>
    </div>`,sent:!0,time:Date.now(),type:"takeout",chatId:ae.value,takeoutData:Ye.value};let R=Z.html.replace("{{FOOD_NAME}}",Ye.value.foodName).replace("{{PRICE}}",Ye.value.price);Ye.value.note?R=R.replace("{{NOTE_HTML}}",`<div style="font-size: 12px; color: #999; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${Ye.value.note}</div>`):R=R.replace("{{NOTE_HTML}}",""),Z.html=R,await C.addChatMessage(Z),l.value.push(Z),i.value.push(Z),_.value.push(Z),Q(),await ee("[]",!0),it()},ie=()=>{ue("click"),V(),Ve.value=!0},Ve=h(!1),fe=h({address:""}),et=()=>{Ve.value=!1,fe.value={address:""}},Mt=async()=>{const Z=fe.value.address.trim();if(!Z){alert("");return}const R=["https://img.wjwj.top/2026/02/14/618ba7726d83280c55ac2cd72ad77c48.md.png","https://img.wjwj.top/2026/02/14/e2bf1bd411e4938d461fdb93734d0ba8.md.png","https://img.wjwj.top/2026/02/14/513c5e9eea4829323a5d4b40349b5037.md.png","https://img.wjwj.top/2026/02/14/6f9080ad44c879ae0f5eb3e01bc77fcf.md.png","https://img.wjwj.top/2026/02/14/db59081b9ab226d8c2c07b3d2defda29.md.png","https://img.wjwj.top/2026/02/14/7111d2e400f6ee5d072105f4421f5b10.md.png","https://img.wjwj.top/2026/02/14/9d771362701465ecade9da8eccc9c317.md.png","https://img.wjwj.top/2026/02/14/4f4286a6d3170b8910b6866830864e3d.md.png","https://img.wjwj.top/2026/02/14/2e01f4619d5140622c1adc1d0cb10f37.md.png","https://img.wjwj.top/2026/02/14/23aa94b79868c8daa814933079b8398f.md.png"],Ke=R[Math.floor(Math.random()*R.length)],Xe={id:Date.now(),text:`[] ${Z}`,html:`<div class="location-card" style="background: white; padding: 10px; border-radius: 32px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); border: 1px solid #f0f0f0; overflow: hidden; width: 256px; cursor: pointer; transition: all 0.2s;">
      <!--  -->
      <div style="padding: 8px 12px; text-align: left;">
        <h3 style="color: #333; font-size: 15px; font-weight: bold; margin: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; letter-spacing: -0.3px;">{{LOCATION_NAME}}</h3>
      </div>
      <!--  -->
      <div style="position: relative; height: 176px; width: 100%; border-radius: 24px; overflow: hidden; background: #f5f5f5;">
        <img src="{{MAP_IMAGE}}" alt="Map" style="width: 100%; height: 100%; object-fit: cover; opacity: 0.9;">
        <!--  -->
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); pointer-events: none;">
          <div style="position: relative;">
            <!--  -->
            <div style="position: absolute; inset: 0; background: #5c7cd1; border-radius: 50%; animation: ping 1.5s cubic-bezier(0, 0, 0.2, 1) infinite; opacity: 0.2; transform: scale(2.2);"></div>
            <!--  -->
            <div style="position: relative; background: white; width: 40px; height: 40px; border-radius: 50%; box-shadow: 0 4px 6px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; border: 2px solid white;">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="#5c7cd1" fill-opacity="0.15" stroke="#5c7cd1" stroke-width="2">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                <circle cx="12" cy="10" r="3"></circle>
              </svg>
              <div style="position: absolute; width: 6px; height: 6px; background: #5c7cd1; border-radius: 50%; top: 13px;"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <style>
      @keyframes ping {
        75%, 100% {
          transform: scale(2.2);
          opacity: 0;
        }
      }
    </style>`,sent:!0,time:Date.now(),type:"location",chatId:ae.value,locationData:{address:Z,mapImage:Ke}};Xe.html=Xe.html.replace("{{LOCATION_NAME}}",Z).replace("{{MAP_IMAGE}}",Ke),await C.addChatMessage(Xe),l.value.push(Xe),i.value.push(Xe),_.value.push(Xe),Q(),await ee("[]",!0),et()},at=()=>{v.value=!1,A.value&&A.value.pause(),typeof window.triggerSlash=="function"&&window.triggerSlash(`/send ${a.value.name}|/trigger`)},Ft=()=>{v.value=!1,A.value&&A.value.pause()},jt=(Z,R,Ke)=>{x=Z.touches[0].clientX,L=Z.touches[0].clientY,F=setTimeout(()=>{La(Z,R,Ke)},wf)},En=Z=>{const R=Math.abs(Z.touches[0].clientX-x),Ke=Math.abs(Z.touches[0].clientY-L);(R>Cl||Ke>Cl)&&clearTimeout(F)},ar=()=>{clearTimeout(F)},La=(Z,R,Ke)=>{ue("click"),se.value=R,J.value=Ke;const Xe=Z.touches?Z.touches[0].clientX:Z.clientX,It=Z.touches?Z.touches[0].clientY:Z.clientY;oe.value={x:Math.min(Xe,window.innerWidth-150),y:Math.min(It,window.innerHeight-200)},q.value=!0},so=()=>{q.value=!1,se.value=null,J.value=-1},lr=()=>{ue("click");const Z=se.value;Z&&(u.value=`${Z.text}
`,so())},ir=()=>{ue("click"),N.value=!0,P.value=[],so(),V()},Bn=()=>{ue("click"),N.value=!1,P.value=[]},rr=Z=>{ue("click");const R=P.value.indexOf(Z);R>-1?P.value.splice(R,1):P.value.push(Z)},cr=async()=>{if(se.value&&confirm("")){ue("click");const Z=se.value.id;await C.deleteChatMessage(Z);const R=l.value.findIndex(Xe=>Xe.id===Z);R>-1&&l.value.splice(R,1);const Ke=i.value.findIndex(Xe=>Xe.id===Z);Ke>-1&&i.value.splice(Ke,1),so()}},dr=async()=>{if(P.value.length===0){alert("");return}if(confirm(` ${P.value.length} `)){ue("click");for(const Z of P.value){await C.deleteChatMessage(Z);const R=l.value.findIndex(Xe=>Xe.id===Z);R>-1&&l.value.splice(R,1);const Ke=i.value.findIndex(Xe=>Xe.id===Z);Ke>-1&&i.value.splice(Ke,1)}Bn()}},ur=async()=>{if(!se.value)return;ue("click");const Z=se.value.id,R={id:Date.now(),text:"",type:"system",time:Date.now(),chatId:ae.value},Ke=l.value.findIndex(It=>It.id===Z);Ke>-1&&(l.value.splice(Ke,1),await C.deleteChatMessage(Z));const Xe=i.value.findIndex(It=>It.id===Z);Xe>-1&&i.value.splice(Xe,1),await C.addChatMessage(R),l.value.push(R),i.value.push(R),so(),Q()},vr=async Z=>{if(Z.sent)return;ue("click");const R={id:Date.now(),text:` ${a.value.name}`,type:"system",time:Date.now(),chatId:ae.value};await C.addChatMessage(R),l.value.push(R),i.value.push(R),Q()},pr=()=>{se.value&&(ue("click"),g.value=se.value.text,H.value=se.value.id,f.value=!0,so())},Vn=()=>{f.value=!1,g.value="",H.value=null},fr=async()=>{if(!g.value.trim()){alert("");return}ue("click");const Z=l.value.findIndex(Ke=>Ke.id===H.value);Z>-1&&(l.value[Z].text=g.value.trim(),l.value[Z].html=g.value.trim(),await C.addChatMessage(l.value[Z]));const R=i.value.findIndex(Ke=>Ke.id===H.value);R>-1&&(i.value[R].text=g.value.trim(),i.value[R].html=g.value.trim()),Vn()},mr=()=>{if(P.value.length===0){alert("");return}ue("click"),K.value=!0},gr=()=>l.value.filter(Z=>P.value.includes(Z.id)),hr=()=>{K.value=!1},yr=()=>{K.value=!1,Bn()},br=()=>{if(P.value.length===0){alert("");return}ue("click"),alert(` ${P.value.length} ...`)};return nt(async()=>{Object.values(de).forEach(Z=>{Z.load()});try{const Z=await C.getChatMessages(ae.value);l.value=Z||[],D();const R=await C.getUserSetting(o.contactId,"avatar");R&&(w.value=R);const Ke=await C.getContact(o.contactId);Ke&&(a.value.avatar=Ke.avatar,a.value.name=Ke.name);const Xe=await C.getUserSetting(o.contactId,"chatBackground");if(Xe){const St=document.querySelector(".chat-container");St&&(St.style.backgroundImage=`url(${Xe})`)}await C.markMessagesAsRead(ae.value);const Oe=(await C.getChatList()).find(St=>St.type==="single"&&St.contactId===o.contactId);Oe&&await C.updateChatListItem({...Oe,unreadCount:0}),Q()}catch(Z){console.error(":",Z)}}),(Z,R)=>{var Ke,Xe,It;return p(),m("div",Cp,[v.value?(p(),m("div",$p,[e("audio",{ref_key:"callAudio",ref:A,loop:""},[...R[15]||(R[15]=[e("source",{src:"https://files.catbox.moe/23kcq4.mp3",type:"audio/mpeg"},null,-1)])],512),e("div",_p,[e("img",{src:a.value.avatar,class:"caller-avatar",alt:a.value.name},null,8,Mp),e("div",Sp,S(a.value.name),1),R[18]||(R[18]=e("div",{class:"call-status"},"...",-1)),e("div",{class:"call-buttons"},[e("button",{class:"call-button accept-call",onClick:at},[...R[16]||(R[16]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M20.01 15.38c-1.23 0-2.42-.2-3.53-.56a.977.977 0 0 0-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02c-.37-1.11-.56-2.3-.56-3.53c0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99C3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"})],-1)])]),e("button",{class:"call-button reject-call",onClick:Ft},[...R[17]||(R[17]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9c-.98.49-1.87 1.12-2.66 1.85c-.18.18-.43.28-.7.28c-.28 0-.53-.11-.71-.29L.29 13.08a.996.996 0 0 1 0-1.41c1.34-1.34 2.87-2.42 4.55-3.2C6.87 7.81 9.04 7 12 7s5.13.81 7.16 2.47c1.68.78 3.21 1.86 4.55 3.2c.39.39.39 1.02 0 1.41l-2.49 2.49c-.18.18-.43.29-.71.29c-.27 0-.52-.11-.7-.28c-.79-.74-1.69-1.36-2.67-1.85c-.33-.16-.56-.51-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z"})],-1)])])])])])):U("",!0),e("div",Ip,[e("div",Ap,[e("div",{class:"header-info",onClick:ye},[e("img",{src:a.value.avatar,class:"avatar",alt:a.value.name},null,8,Lp),e("div",Tp,[e("h2",null,S(a.value.name),1),R[19]||(R[19]=e("div",{class:"header-status"},[e("div",{class:"status-dot"}),Qe("  ")],-1))])]),e("div",jp,[(p(),m("svg",{class:"header-icon diary-btn",onClick:Le,viewBox:"0 0 24 24"},[...R[20]||(R[20]=[e("path",{fill:"currentColor",d:"M19,3H14.82C14.4,1.84 13.3,1 12,1C10.7,1 9.6,1.84 9.18,3H5C3.9,3 3,3.9 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.9 20.1,3 19,3M12,3C12.55,3 13,3.45 13,4C13,4.55 12.55,5 12,5C11.45,5 11,4.55 11,4C11,3.45 11.45,3 12,3M7,7H17V5H19V19H5V5H7V7Z"},null,-1)])])),(p(),m("svg",{class:"header-icon home-btn",onClick:ce,viewBox:"0 0 24 24"},[...R[21]||(R[21]=[e("path",{fill:"currentColor",d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"},null,-1)])])),(p(),m("svg",{class:"header-icon menu-btn",onClick:Ae,viewBox:"0 0 24 24"},[...R[22]||(R[22]=[e("path",{fill:"currentColor",d:"M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"},null,-1)])]))])]),e("div",{class:"chat-messages",ref_key:"messagesContainer",ref:M,onClick:so,onScroll:W},[d.value&&i.value.length>0?(p(),m("div",Pp,[c.value?(p(),m("div",Ep,[...R[23]||(R[23]=[e("div",{class:"loading-spinner"},null,-1),e("span",null,"...",-1)])])):(p(),m("div",Bp,[...R[24]||(R[24]=[e("span",null," ",-1)])]))])):U("",!0),(p(!0),m(Pe,null,Fe(i.value,(Oe,St)=>(p(),m("div",{key:Oe.id||St,class:Ie(["message-container",{"multi-select-mode":N.value}])},[Oe.type==="system"?(p(),m("div",Vp,S(Oe.text),1)):(p(),m(Pe,{key:1},[N.value?(p(),m("div",{key:0,class:"message-checkbox",onClick:je(os=>rr(Oe.id),["stop"])},[e("div",{class:Ie(["checkbox",{checked:P.value.includes(Oe.id)}])},[P.value.includes(Oe.id)?(p(),m("svg",Dp,[...R[25]||(R[25]=[e("path",{fill:"white",d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"},null,-1)])])):U("",!0)],2)],8,Hp)):U("",!0),e("div",{class:Ie(["message",[Oe.sent?"sent":"received",{selected:P.value.includes(Oe.id)}]])},[e("div",{class:Ie(["avatar",Oe.sent?"user_avatar":"character_avatar"]),style:Re({backgroundImage:`url(${Oe.sent?w.value:a.value.avatar})`,backgroundSize:"cover",backgroundPosition:"center"}),onClick:R[0]||(R[0]=os=>ue("avatar")),onDblclick:os=>!Oe.sent&&vr(Oe)},null,46,Fp),e("div",{class:"message-wrapper",onTouchstart:os=>jt(os,Oe,St),onTouchend:ar,onTouchmove:En,onContextmenu:je(os=>La(os,Oe,St),["prevent"])},[he(Oe)?(p(),m("div",Np,[R[26]||(R[26]=e("div",{class:"forward-tag"},"",-1)),e("div",Op,S(j(Oe)),1)])):(p(),st(V1,{key:1,content:Oe.html||Oe.text,"is-sent":Oe.sent,type:Oe.type||"text",onClick:R[1]||(R[1]=os=>ue("bubble"))},null,8,["content","is-sent","type"])),e("div",Rp,S(G(Oe.time)),1)],40,Up)],2)],64))],2))),128)),T.value?(p(),m("div",zp,[e("div",{class:"avatar character_avatar",style:Re({backgroundImage:`url(${a.value.avatar})`,backgroundSize:"cover",backgroundPosition:"center"})},null,4),R[27]||(R[27]=e("div",{class:"message-wrapper"},[e("div",{class:"message-content typing-bubble"},[e("div",{class:"typing-dots"},[e("span"),e("span"),e("span")])])],-1))])):U("",!0)],544),Ge(W1,{ref_key:"chatAddMenuRef",ref:k,show:b.value,onSendEmoji:vt,onSendTransfer:Be,onSendImage:Je,onSendCall:ge,onSendVoice:pe,onSendVideo:le,onSendFile:He,onSendLocation:ie,onSendTakeout:ke,onOpenEmojiManager:pt},null,8,["show"]),Ge(gp,{show:I.value,onClose:re,onSelect:te},null,8,["show"]),ze.value?(p(),m("div",{key:0,class:"modal-overlay",onClick:je(ft,["self"])},[e("div",Wp,[R[30]||(R[30]=e("div",{class:"modal-title"},"",-1)),e("div",Kp,[e("div",Gp,[R[28]||(R[28]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":R[2]||(R[2]=Oe=>Ce.value.amount=Oe),type:"number",class:"form-input",placeholder:""},null,512),[[Te,Ce.value.amount]])]),e("div",qp,[R[29]||(R[29]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":R[3]||(R[3]=Oe=>Ce.value.note=Oe),type:"text",class:"form-input",placeholder:""},null,512),[[Te,Ce.value.note]])])]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:ft},""),e("button",{class:"btn btn-confirm",onClick:Kt},"")])])])):U("",!0),Ve.value?(p(),m("div",{key:1,class:"modal-overlay",onClick:je(et,["self"])},[e("div",Zp,[R[32]||(R[32]=e("div",{class:"modal-title"},"",-1)),e("div",Jp,[e("div",Yp,[R[31]||(R[31]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":R[4]||(R[4]=Oe=>fe.value.address=Oe),type:"text",class:"form-input",placeholder:""},null,512),[[Te,fe.value.address]])])]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:et},""),e("button",{class:"btn btn-confirm",onClick:Mt},"")])])])):U("",!0),me.value?(p(),m("div",{key:2,class:"modal-overlay",onClick:je(wt,["self"])},[e("div",Xp,[R[36]||(R[36]=e("div",{class:"modal-title"},"",-1)),e("div",Qp,[e("div",ef,[R[33]||(R[33]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":R[5]||(R[5]=Oe=>E.value.name=Oe),type:"text",class:"form-input",placeholder:""},null,512),[[Te,E.value.name]])]),e("div",tf,[R[34]||(R[34]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":R[6]||(R[6]=Oe=>E.value.size=Oe),type:"text",class:"form-input",placeholder:"2.5MB"},null,512),[[Te,E.value.size]])]),e("div",sf,[R[35]||(R[35]=e("label",null,"",-1)),we(e("textarea",{"onUpdate:modelValue":R[7]||(R[7]=Oe=>E.value.content=Oe),class:"form-input",rows:"3",placeholder:"..."},null,512),[[Te,E.value.content]])])]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:wt},""),e("button",{class:"btn btn-confirm",onClick:Y},"")])])])):U("",!0),ve.value?(p(),m("div",{key:3,class:"modal-overlay",onClick:je(it,["self"])},[e("div",of,[R[40]||(R[40]=e("div",{class:"modal-title"},"",-1)),e("div",nf,[e("div",af,[R[37]||(R[37]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":R[8]||(R[8]=Oe=>Ye.value.foodName=Oe),type:"text",class:"form-input",placeholder:""},null,512),[[Te,Ye.value.foodName]])]),e("div",lf,[R[38]||(R[38]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":R[9]||(R[9]=Oe=>Ye.value.price=Oe),type:"number",class:"form-input",placeholder:""},null,512),[[Te,Ye.value.price]])]),e("div",rf,[R[39]||(R[39]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":R[10]||(R[10]=Oe=>Ye.value.note=Oe),type:"text",class:"form-input",placeholder:""},null,512),[[Te,Ye.value.note]])])]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:it},""),e("button",{class:"btn btn-confirm",onClick:X},"")])])])):U("",!0),ct.value?(p(),m("div",{key:4,class:"modal-overlay",onClick:R[11]||(R[11]=je(Oe=>ct.value=!1,["self"]))},[e("div",cf,[R[42]||(R[42]=e("div",{class:"modal-title"},"",-1)),e("div",df,[R[41]||(R[41]=e("div",{style:{"font-size":"36px","margin-bottom":"16px"}},"",-1)),e("div",uf," "+S(bt.value.amount),1),e("div",vf,S(bt.value.note),1)]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:Wt},""),e("button",{class:"btn btn-confirm",onClick:Et},"")])])])):U("",!0),Ge(Uv,{show:y.value,"contact-id":a.value.id,"contact-info":a.value,onClose:Me,onSaveCharacter:be,onSaveUser:Ne,onClearHistory:Ee,onBlockContact:De,onDeleteContact:We},null,8,["show","contact-id","contact-info"]),Ge(qv,{show:K.value,"selected-messages":gr(),"current-contact-info":a.value,"user-avatar":w.value,onClose:hr,onForwardComplete:yr},null,8,["show","selected-messages","current-contact-info","user-avatar"]),q.value?(p(),m("div",{key:5,class:"message-menu",style:Re({top:oe.value.y+"px",left:oe.value.x+"px"})},[(Ke=se.value)!=null&&Ke.sent?(p(),m("div",{key:0,class:"menu-item",onClick:lr},[...R[43]||(R[43]=[e("svg",{viewBox:"0 0 24 24",width:"18",height:"18"},[e("path",{fill:"currentColor",d:"M14,17H17L19,13V7H13V13H16M6,17H9L11,13V7H5V13H8L6,17Z"})],-1),e("span",null,"",-1)])])):U("",!0),e("div",{class:"menu-item",onClick:ir},[...R[44]||(R[44]=[e("svg",{viewBox:"0 0 24 24",width:"18",height:"18"},[e("path",{fill:"currentColor",d:"M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,5V19H5V5H19M11.5,10A0.5,0.5 0 0,0 11,10.5V13H13.5A0.5,0.5 0 0,0 14,12.5A0.5,0.5 0 0,0 13.5,12H12V10.5A0.5,0.5 0 0,0 11.5,10M8,10V12H9.5A0.5,0.5 0 0,1 10,12.5A0.5,0.5 0 0,1 9.5,13H8V14.5A0.5,0.5 0 0,1 7.5,15A0.5,0.5 0 0,1 7,14.5V10H8M16,10V14.5A0.5,0.5 0 0,1 15.5,15A0.5,0.5 0 0,1 15,14.5V10H16Z"})],-1),e("span",null,"",-1)])]),e("div",{class:"menu-item",onClick:cr},[...R[45]||(R[45]=[e("svg",{viewBox:"0 0 24 24",width:"18",height:"18"},[e("path",{fill:"currentColor",d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"})],-1),e("span",null,"",-1)])]),(Xe=se.value)!=null&&Xe.sent?(p(),m("div",{key:1,class:"menu-item",onClick:ur},[...R[46]||(R[46]=[e("svg",{viewBox:"0 0 24 24",width:"18",height:"18"},[e("path",{fill:"currentColor",d:"M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"})],-1),e("span",null,"",-1)])])):U("",!0),(It=se.value)!=null&&It.sent?U("",!0):(p(),m("div",{key:2,class:"menu-item",onClick:pr},[...R[47]||(R[47]=[e("svg",{viewBox:"0 0 24 24",width:"18",height:"18"},[e("path",{fill:"currentColor",d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})],-1),e("span",null,"",-1)])]))],4)):U("",!0),f.value?(p(),m("div",{key:6,class:"modal-overlay",onClick:je(Vn,["self"])},[e("div",pf,[R[48]||(R[48]=e("div",{class:"modal-title"},"",-1)),e("div",ff,[we(e("textarea",{"onUpdate:modelValue":R[12]||(R[12]=Oe=>g.value=Oe),class:"form-input",rows:"4",placeholder:"..."},null,512),[[Te,g.value]])]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:Vn},""),e("button",{class:"btn btn-confirm",onClick:fr},"")])])])):U("",!0),N.value?(p(),m("div",mf,[e("button",{class:"toolbar-btn",onClick:mr},[...R[49]||(R[49]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M12,8V4L20,12L12,20V16H4V8H12Z"})],-1),e("span",null,"",-1)])]),e("button",{class:"toolbar-btn",onClick:dr},[...R[50]||(R[50]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"})],-1),e("span",null,"",-1)])]),e("button",{class:"toolbar-btn",onClick:br},[...R[51]||(R[51]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"})],-1),e("span",null,"",-1)])]),e("button",{class:"toolbar-btn cancel",onClick:Bn},[...R[52]||(R[52]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})],-1),e("span",null,"",-1)])])])):U("",!0),N.value?U("",!0):(p(),m("div",gf,[e("button",{class:"add-btn",onClick:xe},[...R[53]||(R[53]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})],-1)])]),we(e("input",{type:"text",class:"input-field","onUpdate:modelValue":R[13]||(R[13]=Oe=>u.value=Oe),placeholder:"...",onKeyup:Xt(O,["enter"]),onClick:R[14]||(R[14]=Oe=>ue("bubble")),onFocus:V},null,544),[[Te,u.value]]),e("button",{class:Ie(["send-btn",{"is-sending":$.value}]),onClick:z,disabled:$.value},[$.value?(p(),m("svg",bf,[...R[55]||(R[55]=[e("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-dasharray":"31.4 31.4","stroke-dashoffset":"0"},[e("animateTransform",{attributeName:"transform",type:"rotate",from:"0 12 12",to:"360 12 12",dur:"1s",repeatCount:"indefinite"})],-1)])])):(p(),m("svg",yf,[...R[54]||(R[54]=[e("path",{fill:"currentColor",d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"},null,-1)])]))],10,hf)]))])])}}},xf=Ze(kf,[["__scopeId","data-v-82bef864"]]),Cf={class:"modal group-info-modal"},$f={class:"modal-header"},_f={class:"modal-body"},Mf={class:"group-basic-info"},Sf=["src"],If={class:"group-name-large"},Af={class:"group-id"},Lf={class:"info-section"},Tf={key:0,class:"announcement-content"},jf={key:1,class:"announcement-placeholder"},Pf={class:"info-section"},Ef={class:"section-title"},Bf={class:"members-grid"},Vf=["onClick"],Hf={class:"member-avatar-wrapper"},Df=["src"],Ff={key:0,class:"member-badge owner"},Uf={key:1,class:"member-badge admin"},Nf={key:2,class:"member-badge muted"},Of={class:"member-name"},Rf={class:"info-section"},zf={class:"settings-list"},Wf={class:"modal announcement-modal"},Kf={class:"modal-body"},Gf={class:"modal member-manage-modal"},qf={class:"modal-body"},Zf={class:"member-manage-info"},Jf=["src"],Yf={class:"member-manage-name"},Xf={class:"member-manage-status"},Qf={key:0,class:"status-badge owner"},e0={key:1,class:"status-badge admin"},t0={key:2,class:"status-badge member"},s0={class:"member-manage-actions"},o0={__name:"GroupInfoModal",props:{groupInfo:{type:Object,required:!0},groupMembers:{type:Array,required:!0}},emits:["close","update-announcement","update-avatar"],setup(t,{emit:s}){const o=t,n=s,a=h(!1),l=h(!1),i=h(!1),r=h(o.groupInfo.announcement||""),c=h(!1),d=h(null),u=h(null),v=()=>{var g;(g=u.value)==null||g.click()},b=async g=>{var K;const H=(K=g.target.files)==null?void 0:K[0];if(H)try{const F=new FileReader;F.onload=x=>{const L=x.target.result;n("update-avatar",L),alert("")},F.readAsDataURL(H)}catch(F){console.error(":",F),alert("")}},y=()=>{r.value=o.groupInfo.announcement||"",i.value=!0},M=()=>{i.value=!1},A=()=>{n("update-announcement",r.value),M()},w=g=>{d.value=g,c.value=!0},k=()=>{c.value=!1,d.value=null},I=()=>{confirm(` ${d.value.name} 

`)&&(o.groupMembers.forEach(g=>{g.isOwner&&(g.isOwner=!1)}),d.value.isOwner=!0,d.value.isAdmin=!1,alert(`${d.value.name} `),k())},_=()=>{d.value.isAdmin=!0,alert(`${d.value.name} `),k()},$=()=>{confirm(` ${d.value.name} `)&&(d.value.isAdmin=!1,alert(` ${d.value.name} `),k())},T=()=>{const g=d.value.isMuted?"":"";confirm(`${g} ${d.value.name} `)&&(d.value.isMuted=!d.value.isMuted,alert(`${g} ${d.value.name}`),k())},q=()=>{confirm(` ${d.value.name} 

`)&&(alert(`${d.value.name} `),k())},oe=()=>{alert("...")},se=()=>{a.value=!a.value},J=()=>{l.value=!l.value},N=()=>{alert("...")},P=async()=>{if(confirm(`

`))try{await C.clearGroupMessages(o.groupInfo.id),alert(""),n("close"),window.location.reload()}catch(g){console.error(":",g),alert("")}},f=async()=>{if(confirm(`

`))try{await C.deleteGroup(o.groupInfo.id);const H=(await C.getChatList()).find(K=>K.groupId===o.groupInfo.id);H&&await C.deleteChatListItem(H.id),await C.clearGroupMessages(o.groupInfo.id),alert(""),n("close"),setTimeout(()=>{window.location.reload()},500)}catch(g){console.error(":",g),alert("")}};return(g,H)=>{var K,F,x,L,ae,de,ue,$e,ne,G,he;return p(),m("div",{class:"modal-overlay",onClick:H[2]||(H[2]=je(j=>g.$emit("close"),["self"]))},[e("div",Cf,[e("div",$f,[H[3]||(H[3]=e("h3",null,"",-1)),e("button",{class:"close-btn",onClick:H[0]||(H[0]=j=>g.$emit("close"))},"")]),e("div",_f,[e("div",Mf,[e("div",{class:"group-avatar-wrapper",onClick:v},[e("img",{src:t.groupInfo.avatar,class:"group-avatar-large"},null,8,Sf),H[4]||(H[4]=e("div",{class:"avatar-edit-overlay"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"white",d:"M3,17.25V21H6.75L17.81,9.94L14.06,6.19L3,17.25M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.13,5.12L18.88,8.87L20.71,7.04Z"})])],-1))]),e("div",If,S(t.groupInfo.name),1),e("div",Af,""+S(t.groupInfo.id),1)]),e("input",{ref_key:"avatarInputRef",ref:u,type:"file",accept:"image/*",onChange:b,style:{display:"none"}},null,544),e("div",Lf,[H[5]||(H[5]=e("div",{class:"section-title"},"",-1)),e("div",{class:"announcement-box",onClick:y},[t.groupInfo.announcement?(p(),m("div",Tf,S(t.groupInfo.announcement),1)):(p(),m("div",jf,"  "))])]),e("div",Pf,[e("div",Ef," ("+S(t.groupMembers.length)+")",1),e("div",Bf,[(p(!0),m(Pe,null,Fe(t.groupMembers,j=>(p(),m("div",{key:j.id,class:"member-item",onClick:Q=>w(j)},[e("div",Hf,[e("img",{src:j.avatar,class:"member-avatar"},null,8,Df),j.isOwner?(p(),m("div",Ff,"")):j.isAdmin?(p(),m("div",Uf,"")):U("",!0),j.isMuted?(p(),m("div",Nf,"")):U("",!0)]),e("div",Of,S(j.name),1)],8,Vf))),128)),e("div",{class:"member-item add-member",onClick:oe},[...H[6]||(H[6]=[e("div",{class:"add-icon"},[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})])],-1),e("div",{class:"member-name"},"",-1)])])])]),e("div",Rf,[e("div",zf,[e("div",{class:"settings-item",onClick:se},[H[8]||(H[8]=e("span",null,"",-1)),e("div",{class:Ie(["toggle-switch",{active:a.value}])},[...H[7]||(H[7]=[e("div",{class:"toggle-slider"},null,-1)])],2)]),e("div",{class:"settings-item",onClick:J},[H[10]||(H[10]=e("span",null,"",-1)),e("div",{class:Ie(["toggle-switch",{active:l.value}])},[...H[9]||(H[9]=[e("div",{class:"toggle-slider"},null,-1)])],2)]),e("div",{class:"settings-item",onClick:N},[...H[11]||(H[11]=[e("span",null,"",-1),e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"})],-1)])])])]),e("div",{class:"info-section danger-section"},[e("div",{class:"settings-list"},[e("div",{class:"settings-item danger",onClick:P},[...H[12]||(H[12]=[e("span",null,"",-1)])]),e("div",{class:"settings-item danger",onClick:f},[...H[13]||(H[13]=[e("span",null,"",-1)])])])])])]),i.value?(p(),m("div",{key:0,class:"modal-overlay",onClick:je(M,["self"])},[e("div",Wf,[e("div",{class:"modal-header"},[H[14]||(H[14]=e("h3",null,"",-1)),e("button",{class:"close-btn",onClick:M},"")]),e("div",Kf,[we(e("textarea",{"onUpdate:modelValue":H[1]||(H[1]=j=>r.value=j),class:"announcement-textarea",placeholder:"...",rows:"6"},null,512),[[Te,r.value]])]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-cancel",onClick:M},""),e("button",{class:"btn btn-confirm",onClick:A},"")])])])):U("",!0),c.value?(p(),m("div",{key:1,class:"modal-overlay",onClick:je(k,["self"])},[e("div",Gf,[e("div",{class:"modal-header"},[H[15]||(H[15]=e("h3",null,"",-1)),e("button",{class:"close-btn",onClick:k},"")]),e("div",qf,[e("div",Zf,[e("img",{src:(K=d.value)==null?void 0:K.avatar,class:"member-manage-avatar"},null,8,Jf),e("div",Yf,S((F=d.value)==null?void 0:F.name),1),e("div",Xf,[(x=d.value)!=null&&x.isOwner?(p(),m("span",Qf,"")):(L=d.value)!=null&&L.isAdmin?(p(),m("span",e0,"")):(p(),m("span",t0,""))])]),e("div",s0,[(ae=d.value)!=null&&ae.isOwner?U("",!0):(p(),m("div",{key:0,class:"manage-action-item",onClick:I},[...H[16]||(H[16]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M12,2L2,7V13.5C2,19.75 6.5,25.5 12,27C17.5,25.5 22,19.75 22,13.5V7L12,2M12,4.18L20,8.09V13.5C20,18.87 16.25,23.74 12,25.23C7.75,23.74 4,18.87 4,13.5V8.09L12,4.18M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9"})],-1),e("span",null,"",-1)])])),!((de=d.value)!=null&&de.isOwner)&&!((ue=d.value)!=null&&ue.isAdmin)?(p(),m("div",{key:1,class:"manage-action-item",onClick:_},[...H[17]||(H[17]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M17.13,17C15.92,18.85 14.11,20.24 12,20.92C9.89,20.24 8.08,18.85 6.87,17C6.53,16.5 6.24,16 6,15.47C6,13.82 8.71,12.47 12,12.47C15.29,12.47 18,13.79 18,15.47C17.76,16 17.47,16.5 17.13,17Z"})],-1),e("span",null,"",-1)])])):U("",!0),($e=d.value)!=null&&$e.isAdmin?(p(),m("div",{key:2,class:"manage-action-item",onClick:$},[...H[18]||(H[18]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M17.13,17C15.92,18.85 14.11,20.24 12,20.92C9.89,20.24 8.08,18.85 6.87,17C6.53,16.5 6.24,16 6,15.47C6,13.82 8.71,12.47 12,12.47C15.29,12.47 18,13.79 18,15.47C17.76,16 17.47,16.5 17.13,17Z"})],-1),e("span",null,"",-1)])])):U("",!0),(ne=d.value)!=null&&ne.isOwner?U("",!0):(p(),m("div",{key:3,class:"manage-action-item",onClick:T},[H[19]||(H[19]=e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4M9,9V15H15V9"})],-1)),e("span",null,S((G=d.value)!=null&&G.isMuted?"":""),1)])),(he=d.value)!=null&&he.isOwner?U("",!0):(p(),m("div",{key:4,class:"manage-action-item danger",onClick:q},[...H[20]||(H[20]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})],-1),e("span",null,"",-1)])]))])])])])):U("",!0)])}}},n0=Ze(o0,[["__scopeId","data-v-4d972600"]]),a0={class:"modal user-profile-modal"},l0={class:"modal-header"},i0={class:"modal-body"},r0={class:"profile-section"},c0=["src"],d0={class:"profile-section"},u0={class:"profile-section"},v0={class:"modal-actions"},p0={__name:"UserProfileModal",emits:["close","update"],setup(t,{emit:s}){const o=s,n=h({avatar:"https://via.placeholder.com/120",name:"",bio:""}),a=h(null),l=()=>{var d;(d=a.value)==null||d.click()},i=async d=>{var v;const u=(v=d.target.files)==null?void 0:v[0];if(u)try{const b=new FileReader;b.onload=y=>{n.value.avatar=y.target.result},b.readAsDataURL(u)}catch(b){console.error(":",b),alert("")}},r=async()=>{try{await C.setSetting("userAvatar",n.value.avatar),await C.setSetting("userName",n.value.name),await C.setSetting("userBio",n.value.bio),o("update",n.value),o("close"),alert("")}catch(d){console.error(":",d),alert("")}},c=async()=>{try{const d=await C.getSetting("userAvatar"),u=await C.getSetting("userName"),v=await C.getSetting("userBio");d&&(n.value.avatar=d),u&&(n.value.name=u),v&&(n.value.bio=v)}catch(d){console.error(":",d)}};return nt(()=>{c()}),(d,u)=>(p(),m("div",{class:"modal-overlay",onClick:u[4]||(u[4]=je(v=>d.$emit("close"),["self"]))},[e("div",a0,[e("div",l0,[u[5]||(u[5]=e("h3",null,"",-1)),e("button",{class:"close-btn",onClick:u[0]||(u[0]=v=>d.$emit("close"))},"")]),e("div",i0,[e("div",r0,[u[7]||(u[7]=e("div",{class:"section-title"},"",-1)),e("div",{class:"avatar-upload-wrapper",onClick:l},[e("img",{src:n.value.avatar,class:"user-avatar-large"},null,8,c0),u[6]||(u[6]=e("div",{class:"avatar-edit-overlay"},[e("svg",{viewBox:"0 0 24 24",width:"28",height:"28"},[e("path",{fill:"white",d:"M3,17.25V21H6.75L17.81,9.94L14.06,6.19L3,17.25M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.13,5.12L18.88,8.87L20.71,7.04Z"})]),e("div",{class:"edit-text"},"")],-1))]),e("input",{ref_key:"avatarInputRef",ref:a,type:"file",accept:"image/*",onChange:i,style:{display:"none"}},null,544)]),e("div",d0,[u[8]||(u[8]=e("div",{class:"section-title"},"",-1)),we(e("input",{"onUpdate:modelValue":u[1]||(u[1]=v=>n.value.name=v),type:"text",class:"profile-input",placeholder:"..."},null,512),[[Te,n.value.name]])]),e("div",u0,[u[9]||(u[9]=e("div",{class:"section-title"},"",-1)),we(e("textarea",{"onUpdate:modelValue":u[2]||(u[2]=v=>n.value.bio=v),class:"profile-textarea",placeholder:`...


- 
- 
- 
- `,rows:"8"},null,512),[[Te,n.value.bio]]),u[10]||(u[10]=e("div",{class:"bio-hint"},"   AI  ",-1))])]),e("div",v0,[e("button",{class:"btn btn-cancel",onClick:u[3]||(u[3]=v=>d.$emit("close"))},""),e("button",{class:"btn btn-confirm",onClick:r},"")])])]))}},f0=Ze(p0,[["__scopeId","data-v-3c39b418"]]),m0={class:"phone-container"},g0={key:0,class:"loading-overlay"},h0={class:"chat-header"},y0=["src","alt"],b0={class:"header-text"},w0={class:"header-status"},k0={class:"header-icons"},x0=["title"],C0=["d"],$0={class:"announcement-text"},_0=["onContextmenu","onClick"],M0={key:0,class:"message-checkbox"},S0={key:0,viewBox:"0 0 24 24",width:"16",height:"16"},I0={class:"message-wrapper"},A0={key:0,class:"sender-name"},L0=["innerHTML"],T0=["onClick"],j0={class:"redpacket-info"},P0={class:"redpacket-blessing"},E0={class:"redpacket-status"},B0=["onClick"],V0={class:"vote-title"},H0={class:"vote-options"},D0={class:"vote-option-text"},F0={class:"vote-option-count"},U0=["onClick"],N0={class:"solitaire-title"},O0={class:"solitaire-count"},R0={key:5,class:"message-content location-message"},z0={class:"location-info"},W0={class:"location-name"},K0={class:"location-address"},G0={key:6,class:"message-content"},q0=["src","alt"],Z0={class:"message-time"},J0={key:0,class:"typing-indicator"},Y0={key:1,class:"mention-panel"},X0=["onClick"],Q0=["src"],em={key:2,class:"add-menu"},tm={key:3,class:"chat-input"},sm={key:4,class:"multi-select-toolbar"},om=["disabled"],nm=["disabled"],am={__name:"GroupChatWindow",props:{groupId:{type:Number,required:!0}},emits:["back"],setup(t,{emit:s}){const o=t,n=s,a=h(!0),l=h({id:o.groupId,name:"",avatar:"",memberIds:[]}),i=h([]),r=h([]),c=h(""),d=h("https://via.placeholder.com/36"),u=h(null),v=h(null),b=h(null),y=h(!1),M=h(""),A=h([]),w=h(!1),k=h(!1),I=h([]),_=h(""),$=h([]),T=h(!1),q=h(!1),oe=h(!1),se=h(null),J=h({avatar:"https://via.placeholder.com/36",name:"",bio:""}),N=ot(()=>r.value),P=re=>{const te=i.value.find(pe=>pe.id===re);return(te==null?void 0:te.avatar)||"https://via.placeholder.com/36"},f=re=>{const te=i.value.find(pe=>pe.id===re);return(te==null?void 0:te.name)||""},g=ot(()=>M.value?i.value.filter(re=>re.name.toLowerCase().includes(M.value.toLowerCase())):i.value),H=re=>re?re.replace(/@(\S+)/g,(te,pe)=>`<span class="mention-highlight">@${pe}</span>`):"",K=()=>{const re=c.value,te=re.lastIndexOf("@");if(te!==-1&&te===re.length-1)y.value=!0,M.value="";else if(te!==-1){const pe=re.substring(te+1);pe.includes(" ")?y.value=!1:(y.value=!0,M.value=pe)}else y.value=!1},F=()=>{y.value=!y.value,y.value&&!c.value.endsWith("@")&&(c.value+="@")},x=re=>{var pe;const te=c.value.lastIndexOf("@");te!==-1?c.value=c.value.substring(0,te)+`@${re.name} `:c.value+=`@${re.name} `,y.value=!1,A.value.push(re.id),(pe=b.value)==null||pe.focus()},L=async()=>{const re=c.value.trim();if(!re)return;const te={id:Date.now(),type:"text",text:re,sent:!0,senderId:"me",time:Date.now(),groupId:o.groupId,mentions:A.value};try{await C.addGroupMessage(te),r.value.push(te),c.value="",A.value=[],await He()}catch(pe){console.error(":",pe)}},ae=()=>{q.value=!0},de=re=>{J.value=re,d.value=re.avatar},ue=()=>{oe.value=!oe.value,oe.value?(alert(` AI 


 10-30 `),$e()):(alert(" AI "),ne())},$e=()=>{if(se.value)return;const re=()=>{if(!oe.value)return;const te=i.value.filter(Ce=>Ce.id!=="me");if(te.length===0)return;const pe=te[Math.floor(Math.random()*te.length)];G(pe);const ze=Math.random()*2e4+1e4;se.value=setTimeout(re,ze)};se.value=setTimeout(re,3e3)},ne=()=>{se.value&&(clearTimeout(se.value),se.value=null)},G=async re=>{var te,pe,ze;try{const Ce=await Ut.getApiConfig();if(!Ce.apiKey||!Ce.model){console.error(" API Key ");return}console.log(" AI :",re.name);const me=r.value.slice(-15).filter(Et=>Et.type==="text").map(Et=>`${f(Et.senderId)}: ${Et.text}`).join(`
`),E=Ut.buildApiUrl(Ce.baseUrl,Ce.provider,"/v1/chat/completions"),ve=r.value.filter(Et=>Et.type==="text").slice(-1)[0],Ye=ve?f(ve.senderId):"",ct=ve?ve.text:"",bt=`"${re.name}"


${re.bio||re.prompt||""}

 - 
1. 
2. 5-15
3. 
4. 
5. 
6. 
7. 


A: 
B: 
C: 
A: 

 - 
 ""
 ""
 ""
 "**"

 - 
 ""
 ""
 ""
 ""
 ""
 ""
 ""
 "6666"


${me}

 ${Ye} "${ct}"

"${re.name}"
- 5-15
- 
- 
- `,ft=await fetch(E,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ce.apiKey}`},body:JSON.stringify({model:Ce.model,messages:[{role:"system",content:bt},{role:"user",content:`5-15"${re.name}"`}],temperature:.7,max_tokens:30,presence_penalty:.6,frequency_penalty:.6})});if(!ft.ok){const Et=await ft.text();throw console.error("API :",ft.status,Et),new Error(`API : ${ft.status}`)}let it=(ze=(pe=(te=(await ft.json()).choices[0])==null?void 0:te.message)==null?void 0:pe.content)==null?void 0:ze.trim();if(!it){console.error("AI ");return}if(it=it.replace(/^["']|["']$/g,""),it=it.replace(/\*[^*]+\*/g,"").replace(/\([^)]+\)/g,"").replace(/\[[^\]]+\]/g,"").replace(/~[^~]+~/g,"").replace(/[^]+/g,"").trim(),it.length>50&&(it=it.substring(0,50)),!it||it.length<2){console.warn("");return}console.log(" AI :",it);const Tt={id:Date.now(),type:"text",text:it,sent:!1,senderId:re.id,time:Date.now(),groupId:o.groupId,mentions:[]};await C.addGroupMessage(Tt),r.value.push(Tt),await He()}catch(Ce){console.error(" AI :",Ce),console.error(":",Ce.message)}},he=()=>{T.value=!0},j=re=>{_.value=re},Q=async re=>{try{l.value.avatar=re,await C.updateGroup(l.value);const pe=(await C.getChatList()).find(ze=>ze.groupId===o.groupId);pe&&(pe.avatar=re,await C.updateChatListItem(pe))}catch(te){console.error(":",te)}},W=re=>{const te=re.redpacket.claimed,pe=re.redpacket.count,ze=re.redpacket.remaining;let Ce=` ${re.redpacket.blessing}

`;Ce+=`${re.redpacket.amount.toFixed(2)}
`,Ce+=`${te.length}/${pe}
`,Ce+=`${ze.toFixed(2)}

`,te.length>0?(Ce+=`
`,te.forEach((me,E)=>{const ve=new Date(me.time).toLocaleTimeString();Ce+=`${E+1}. ${me.memberName} - ${me.amount.toFixed(2)} (${ve})
`})):Ce+="",alert(Ce)},B=re=>{const te=re.vote;let pe=` ${te.title}

`;const ze=te.options.reduce((Ce,me)=>Ce+me.voters.length,0);pe+=`${ze}

`,te.options.forEach((Ce,me)=>{const E=ze>0?(Ce.voters.length/ze*100).toFixed(1):0;pe+=`${me+1}. ${Ce.text}
`,pe+=`   ${Ce.voters.length} (${E}%)
`,Ce.voters.length>0&&(pe+=`   ${Ce.voters.map(ve=>ve.memberName).join("")}
`),pe+=`
`}),alert(pe)},D=re=>{const te=re.solitaire;let pe=` ${te.title}

`;pe+=`${te.items.length}

`,te.items.length>0?te.items.forEach((ze,Ce)=>{const me=new Date(ze.time).toLocaleTimeString();pe+=`${Ce+1}. ${ze.content} (${me})
`}):pe+="",alert(pe)},xe=()=>{w.value=!w.value,w.value&&(y.value=!1)},V=async()=>{w.value=!1;const re=prompt(` 

`);if(!re||isNaN(re)||parseFloat(re)<=0)return;const te=prompt("");if(!te||isNaN(te)||parseInt(te)<=0)return;const pe=prompt("")||"",ze={id:Date.now(),type:"redpacket",text:pe,sent:!0,senderId:"me",time:Date.now(),groupId:o.groupId,redpacket:{amount:parseFloat(re),count:parseInt(te),blessing:pe,claimed:[],remaining:parseFloat(re)}};try{await C.addGroupMessage(ze),r.value.push(ze),await He(),oe.value&&setTimeout(()=>O(ze),2e3)}catch(Ce){console.error(":",Ce)}},O=async re=>{const te=i.value.filter(Ce=>Ce.id!=="me"&&!re.redpacket.claimed.find(me=>me.memberId===Ce.id));if(te.length===0||re.redpacket.remaining<=0)return;const pe=Math.min(Math.floor(Math.random()*te.length)+1,re.redpacket.count-re.redpacket.claimed.length);for(let Ce=0;Ce<pe&&te.length!==0;Ce++){const me=Math.floor(Math.random()*te.length),E=te.splice(me,1)[0],ve=re.redpacket.remaining,Ye=re.redpacket.count-re.redpacket.claimed.length,ct=Ye===1?ve:parseFloat((Math.random()*(ve/Ye*2)).toFixed(2));re.redpacket.claimed.push({memberId:E.id,memberName:E.name,amount:ct,time:Date.now()+Ce*500}),re.redpacket.remaining-=ct,await C.addGroupMessage(re),await new Promise(bt=>setTimeout(bt,800))}const ze=r.value.findIndex(Ce=>Ce.id===re.id);ze!==-1&&(r.value[ze]={...re})},z=async()=>{w.value=!1;const re=prompt(` 

`);if(!re)return;const te=prompt(`
A,B,C`);if(!te)return;const pe=te.split(",").map(Ce=>Ce.trim()).filter(Ce=>Ce);if(pe.length<2){alert("2");return}const ze={id:Date.now(),type:"vote",text:re,sent:!0,senderId:"me",time:Date.now(),groupId:o.groupId,vote:{title:re,options:pe.map(Ce=>({text:Ce,voters:[]})),multipleChoice:!1}};try{await C.addGroupMessage(ze),r.value.push(ze),await He(),oe.value&&setTimeout(()=>ee(ze),3e3)}catch(Ce){console.error(":",Ce)}},ee=async re=>{const te=i.value.filter(Ce=>Ce.id!=="me"),pe=Math.floor(Math.random()*te.length)+1;for(let Ce=0;Ce<pe&&te.length!==0;Ce++){const me=Math.floor(Math.random()*te.length),E=te.splice(me,1)[0],ve=Math.floor(Math.random()*re.vote.options.length);re.vote.options[ve].voters.push({memberId:E.id,memberName:E.name,time:Date.now()+Ce*1e3}),await C.addGroupMessage(re),await new Promise(Ye=>setTimeout(Ye,1200))}const ze=r.value.findIndex(Ce=>Ce.id===re.id);ze!==-1&&(r.value[ze]={...re})},ce=()=>{w.value=!1;const re=document.createElement("input");re.type="file",re.accept="image/*",re.onchange=async te=>{var ze;const pe=(ze=te.target.files)==null?void 0:ze[0];if(pe)try{const Ce=new FileReader;Ce.onload=async me=>{const E={id:Date.now(),type:"image",text:"[]",imageUrl:me.target.result,sent:!0,senderId:"me",time:Date.now(),groupId:o.groupId};await C.addGroupMessage(E),r.value.push(E),await He(),oe.value&&setTimeout(()=>ye(E),2e3)},Ce.readAsDataURL(pe)}catch(Ce){console.error(":",Ce)}},re.click()},ye=async re=>{const te=["","","","","","",""],pe=i.value.filter(Ce=>Ce.id!=="me");if(pe.length===0)return;const ze=Math.floor(Math.random()*2)+1;for(let Ce=0;Ce<ze&&Ce<pe.length;Ce++){const me=pe[Math.floor(Math.random()*pe.length)],E=te[Math.floor(Math.random()*te.length)],ve={id:Date.now()+Ce,type:"text",text:E,sent:!1,senderId:me.id,time:Date.now()+Ce*1e3,groupId:o.groupId,mentions:[]};await C.addGroupMessage(ve),r.value.push(ve),await He(),await new Promise(Ye=>setTimeout(Ye,1500))}},Le=()=>{w.value=!1,alert(` ...

`)},Ae=async()=>{w.value=!1;const re=prompt(` 

`);if(!re)return;const te={id:Date.now(),type:"solitaire",text:re,sent:!0,senderId:"me",time:Date.now(),groupId:o.groupId,solitaire:{title:re,items:[]}};try{await C.addGroupMessage(te),r.value.push(te),await He(),oe.value&&setTimeout(()=>Me(te),2e3)}catch(pe){console.error(":",pe)}},Me=async re=>{const te=i.value.filter(Ce=>Ce.id!=="me"),pe=Math.floor(Math.random()*te.length)+1;for(let Ce=0;Ce<pe&&te.length!==0;Ce++){const me=Math.floor(Math.random()*te.length),E=te.splice(me,1)[0];re.solitaire.items.push({memberId:E.id,memberName:E.name,content:`${E.name} +1`,time:Date.now()+Ce*1e3}),await C.addGroupMessage(re),await new Promise(ve=>setTimeout(ve,1500))}const ze=r.value.findIndex(Ce=>Ce.id===re.id);ze!==-1&&(r.value[ze]={...re})},be=async()=>{w.value=!1;const re=prompt(` 

`)||"",te={id:Date.now(),type:"location",text:re,sent:!0,senderId:"me",time:Date.now(),groupId:o.groupId,location:{name:re,address:""}};try{await C.addGroupMessage(te),r.value.push(te),await He()}catch(pe){console.error(":",pe)}},Ne=(re,te)=>{k.value},Ee=re=>{const te=I.value.findIndex(pe=>pe.id===re.id);te>-1?I.value.splice(te,1):I.value.push(re)},De=re=>I.value.some(te=>te.id===re.id),We=()=>{k.value=!1,I.value=[]},Je=()=>{alert("...")},ge=async()=>{confirm(`${I.value.length}`)&&We()},le=re=>{if(!re)return"";const te=new Date(re),pe=String(te.getHours()).padStart(2,"0"),ze=String(te.getMinutes()).padStart(2,"0");return`${pe}:${ze}`},He=async()=>{await zt(),u.value&&(u.value.scrollTop=u.value.scrollHeight)},ke=()=>{n("back")},Be=async()=>{try{const re=await C.getGroup(o.groupId);if(console.log(":",re),re){l.value=re,_.value=re.announcement||"";let te=re.memberIds||[];if(te.length===0){const ze=(await C.getChatList()).find(Ce=>Ce.groupId===o.groupId);ze&&ze.members&&(te=ze.members,console.log(" chatList ID:",te))}if(console.log("ID:",te),te.length>0){const pe=await C.getGroupMembers(te);console.log(":",pe),i.value=pe}else console.warn(""),i.value=[]}}catch(re){console.error(":",re)}},vt=async()=>{try{const re=await C.getGroupMessages(o.groupId);r.value=re,await He()}catch(re){console.error(":",re)}},pt=async()=>{try{const re=await C.getSetting("userAvatar"),te=await C.getSetting("userName"),pe=await C.getSetting("userBio");re&&(J.value.avatar=re,d.value=re),te&&(J.value.name=te),pe&&(J.value.bio=pe)}catch(re){console.error(":",re)}};return nt(async()=>{try{await Promise.all([Be(),vt(),pt()]),a.value=!1}catch(re){console.error(":",re),a.value=!1}}),Dt(()=>{ne()}),(re,te)=>(p(),m("div",m0,[a.value?(p(),m("div",g0,[...te[5]||(te[5]=[e("div",{class:"loading-spinner"},null,-1),e("div",{class:"loading-text"},"...",-1)])])):U("",!0),e("div",{class:"chat-container",ref_key:"chatContainer",ref:v},[e("div",h0,[e("div",{class:"header-info",onClick:te[0]||(te[0]=(...pe)=>re.showGroupInfo&&re.showGroupInfo(...pe))},[e("img",{src:l.value.avatar,class:"avatar header-avatar",alt:l.value.name},null,8,y0),e("div",b0,[e("h2",null,S(l.value.name),1),e("div",w0,[e("span",null,S(i.value.length)+"",1)])])]),e("div",k0,[(p(),m("svg",{class:"header-icon",onClick:ae,viewBox:"0 0 24 24",title:""},[...te[6]||(te[6]=[e("path",{fill:"currentColor",d:"M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"},null,-1)])])),(p(),m("svg",{class:"header-icon",onClick:ue,viewBox:"0 0 24 24",title:oe.value?"AI":"AI"},[e("path",{fill:"currentColor",d:oe.value?"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z":"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},null,8,C0)],8,x0)),(p(),m("svg",{class:"header-icon",onClick:ke,viewBox:"0 0 24 24"},[...te[7]||(te[7]=[e("path",{fill:"currentColor",d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"},null,-1)])])),(p(),m("svg",{class:"header-icon",onClick:he,viewBox:"0 0 24 24"},[...te[8]||(te[8]=[e("path",{fill:"currentColor",d:"M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"},null,-1)])]))])]),_.value?(p(),m("div",{key:0,class:"group-announcement",onClick:te[1]||(te[1]=(...pe)=>re.showAnnouncementDetail&&re.showAnnouncementDetail(...pe))},[te[9]||(te[9]=e("svg",{viewBox:"0 0 24 24",width:"16",height:"16"},[e("path",{fill:"currentColor",d:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"})],-1)),e("span",$0,S(_.value),1),te[10]||(te[10]=e("svg",{viewBox:"0 0 24 24",width:"16",height:"16"},[e("path",{fill:"currentColor",d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"})],-1))])):U("",!0),e("div",{class:"chat-messages",ref_key:"messagesContainer",ref:u},[(p(!0),m(Pe,null,Fe(N.value,(pe,ze)=>(p(),m("div",{key:pe.id||ze,class:Ie(["message",[pe.sent?"sent":"received",{"multi-select-mode":k.value}]]),onContextmenu:je(Ce=>Ne(),["prevent"]),onClick:Ce=>k.value?Ee(pe):null},[k.value?(p(),m("div",M0,[e("div",{class:Ie(["checkbox",{checked:De(pe)}])},[De(pe)?(p(),m("svg",S0,[...te[11]||(te[11]=[e("path",{fill:"white",d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},null,-1)])])):U("",!0)],2)])):U("",!0),e("div",{class:"avatar",style:Re({backgroundImage:`url(${pe.sent?d.value:P(pe.senderId)})`,backgroundSize:"cover",backgroundPosition:"center"})},null,4),e("div",I0,[pe.sent?U("",!0):(p(),m("div",A0,S(f(pe.senderId)),1)),pe.type==="text"?(p(),m("div",{key:1,class:"message-content",innerHTML:H(pe.text)},null,8,L0)):pe.type==="redpacket"?(p(),m("div",{key:2,class:"message-content redpacket-message",onClick:Ce=>W(pe)},[te[12]||(te[12]=e("div",{class:"redpacket-icon"},"",-1)),e("div",j0,[e("div",P0,S(pe.redpacket.blessing),1),e("div",E0,S(pe.redpacket.claimed.length)+"/"+S(pe.redpacket.count)+"  ",1)])],8,T0)):pe.type==="vote"?(p(),m("div",{key:3,class:"message-content vote-message",onClick:Ce=>B(pe)},[e("div",V0," "+S(pe.vote.title),1),e("div",H0,[(p(!0),m(Pe,null,Fe(pe.vote.options,(Ce,me)=>(p(),m("div",{key:me,class:"vote-option"},[e("div",D0,S(Ce.text),1),e("div",F0,S(Ce.voters.length)+"",1)]))),128))])],8,B0)):pe.type==="solitaire"?(p(),m("div",{key:4,class:"message-content solitaire-message",onClick:Ce=>D(pe)},[e("div",N0," "+S(pe.solitaire.title),1),e("div",O0,S(pe.solitaire.items.length)+"",1)],8,U0)):pe.type==="location"?(p(),m("div",R0,[te[13]||(te[13]=e("div",{class:"location-icon"},"",-1)),e("div",z0,[e("div",W0,S(pe.location.name),1),e("div",K0,S(pe.location.address),1)])])):pe.type==="image"?(p(),m("div",G0,[e("img",{src:pe.imageUrl,class:"message-image",alt:pe.text||""},null,8,q0)])):U("",!0),e("div",Z0,S(le(pe.time)),1)])],42,_0))),128)),$.value.length>0?(p(),m("div",J0,[e("span",null,S($.value.join(""))+" ...",1)])):U("",!0)],512),y.value?(p(),m("div",Y0,[te[14]||(te[14]=e("div",{class:"mention-title"},"@",-1)),(p(!0),m(Pe,null,Fe(g.value,pe=>(p(),m("div",{key:pe.id,class:"mention-item",onClick:ze=>x(pe)},[e("img",{src:pe.avatar,class:"mention-avatar"},null,8,Q0),e("span",null,S(pe.name),1)],8,X0))),128))])):U("",!0),w.value?(p(),m("div",em,[e("div",{class:"add-menu-grid"},[e("div",{class:"add-menu-item",onClick:V},[...te[15]||(te[15]=[dt('<div class="add-menu-icon red-packet" data-v-8120ba77><svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="white" stroke-width="2" data-v-8120ba77><rect x="3" y="6" width="18" height="16" rx="2" data-v-8120ba77></rect><path d="M3 10h18" data-v-8120ba77></path><circle cx="12" cy="15" r="2" fill="white" data-v-8120ba77></circle></svg></div><span data-v-8120ba77></span>',2)])]),e("div",{class:"add-menu-item",onClick:z},[...te[16]||(te[16]=[e("div",{class:"add-menu-icon vote"},[e("svg",{viewBox:"0 0 24 24",width:"32",height:"32",fill:"none",stroke:"white","stroke-width":"2"},[e("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),e("path",{d:"M8 12h8M8 8h8M8 16h5"})])],-1),e("span",null,"",-1)])]),e("div",{class:"add-menu-item",onClick:ce},[...te[17]||(te[17]=[dt('<div class="add-menu-icon image" data-v-8120ba77><svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="white" stroke-width="2" data-v-8120ba77><rect x="3" y="3" width="18" height="18" rx="2" data-v-8120ba77></rect><circle cx="8.5" cy="8.5" r="1.5" fill="white" data-v-8120ba77></circle><path d="M21 15l-5-5L5 21" data-v-8120ba77></path></svg></div><span data-v-8120ba77></span>',2)])]),e("div",{class:"add-menu-item",onClick:Le},[...te[18]||(te[18]=[e("div",{class:"add-menu-icon file"},[e("svg",{viewBox:"0 0 24 24",width:"32",height:"32",fill:"none",stroke:"white","stroke-width":"2"},[e("path",{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"}),e("polyline",{points:"13 2 13 9 20 9"})])],-1),e("span",null,"",-1)])]),e("div",{class:"add-menu-item",onClick:Ae},[...te[19]||(te[19]=[dt('<div class="add-menu-icon solitaire" data-v-8120ba77><svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="white" stroke-width="2" data-v-8120ba77><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" data-v-8120ba77></path><rect x="8" y="2" width="8" height="4" rx="1" data-v-8120ba77></rect><path d="M9 12h6M9 16h6" data-v-8120ba77></path></svg></div><span data-v-8120ba77></span>',2)])]),e("div",{class:"add-menu-item",onClick:be},[...te[20]||(te[20]=[e("div",{class:"add-menu-icon location"},[e("svg",{viewBox:"0 0 24 24",width:"32",height:"32",fill:"none",stroke:"white","stroke-width":"2"},[e("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),e("circle",{cx:"12",cy:"10",r:"3"})])],-1),e("span",null,"",-1)])])])])):U("",!0),k.value?U("",!0):(p(),m("div",tm,[e("button",{class:"add-btn",onClick:xe},[...te[21]||(te[21]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})],-1)])]),we(e("input",{ref_key:"inputField",ref:b,type:"text",class:"input-field","onUpdate:modelValue":te[2]||(te[2]=pe=>c.value=pe),placeholder:"...",onKeyup:Xt(L,["enter"]),onInput:K},null,544),[[Te,c.value]]),e("button",{class:"at-btn",onClick:F},[...te[22]||(te[22]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22H17V20H12C7.66,20 4,16.34 4,12C4,7.66 7.66,4 12,4C16.34,4 20,7.66 20,12V13.43C20,14.22 19.29,15 18.5,15C17.71,15 17,14.22 17,13.43V12C17,9.24 14.76,7 12,7C9.24,7 7,9.24 7,12C7,14.76 9.24,17 12,17C13.38,17 14.64,16.44 15.54,15.53C16.19,16.42 17.31,17 18.5,17C20.47,17 22,15.4 22,13.43V12C22,6.48 17.52,2 12,2M12,15C10.34,15 9,13.66 9,12C9,10.34 10.34,9 12,9C13.66,9 15,10.34 15,12C15,13.66 13.66,15 12,15Z"})],-1)])]),e("button",{class:"send-btn",onClick:L},[...te[23]||(te[23]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"})],-1)])])])),k.value?(p(),m("div",sm,[e("button",{class:"toolbar-btn",onClick:Je,disabled:I.value.length===0},[...te[24]||(te[24]=[e("svg",{viewBox:"0 0 24 24",width:"22",height:"22"},[e("path",{fill:"currentColor",d:"M12,8V4L20,12L12,20V16H4V8H12Z"})],-1),e("span",null,"",-1)])],8,om),e("button",{class:"toolbar-btn danger",onClick:ge,disabled:I.value.length===0},[...te[25]||(te[25]=[e("svg",{viewBox:"0 0 24 24",width:"22",height:"22"},[e("path",{fill:"currentColor",d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"})],-1),e("span",null,"",-1)])],8,nm),te[27]||(te[27]=e("div",{style:{flex:"1"}},null,-1)),e("button",{class:"toolbar-btn",onClick:We},[...te[26]||(te[26]=[e("svg",{viewBox:"0 0 24 24",width:"22",height:"22"},[e("path",{fill:"currentColor",d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})],-1),e("span",null,"",-1)])])])):U("",!0),T.value?(p(),st(n0,{key:5,"group-info":l.value,"group-members":i.value,onClose:te[3]||(te[3]=pe=>T.value=!1),onUpdateAnnouncement:j,onUpdateAvatar:Q},null,8,["group-info","group-members"])):U("",!0),q.value?(p(),st(f0,{key:6,onClose:te[4]||(te[4]=pe=>q.value=!1),onUpdate:de})):U("",!0)],512)]))}},lm=Ze(am,[["__scopeId","data-v-8120ba77"]]),im={class:"phone-container"},rm={key:0,class:"diary-container"},cm={class:"diary-header"},dm={class:"diary-date"},um={class:"diary-weather"},vm=["innerHTML"],pm={key:1,class:"history-container"},fm={class:"character-avatar"},mm=["src"],gm={class:"diary-list"},hm=["onTouchstart","onTouchend","onMousedown","onMouseup"],ym={class:"diary-item-date"},bm={class:"diary-item-preview"},wm={class:"diary-item-weather"},km={key:0,class:"empty-state"},xm={key:2,class:"diary-container"},Cm={class:"diary-header"},$m={class:"diary-date"},_m={class:"diary-weather"},Mm=["innerHTML"],Sm=`
  <p><span class="highlight"></span><span class="emphasis"></span></p>
  <p><span class="handwritten"></span><span class="strikethrough"></span></p>
  <p><span class="censored hidden"></span></p>
  <p><span class="underline"></span>~</p>
`,$l=800,Im={__name:"Diary",props:{contactId:{type:Number,required:!0}},emits:["back"],setup(t,{emit:s}){const o=t,n=s,a=h("main"),l=h({date:"",weather:"",content:""}),i=h(null),r=h("https://via.placeholder.com/80"),c=h(""),d=ot(()=>{const P=new Date,f=P.getFullYear(),g=String(P.getMonth()+1).padStart(2,"0"),H=String(P.getDate()).padStart(2,"0"),F=["","","","","","",""][P.getDay()];return`${f}${g}${H} ${F}`}),u=h("  25C"),v=h([]),b=async()=>{try{const f=(await C.getChatList()).find(g=>g.contactId===o.contactId);f&&(r.value=f.avatar||"https://via.placeholder.com/80",c.value=f.name||"")}catch(P){console.error(":",P)}},y=async()=>{try{const f=(await C.getDiaries(o.contactId)).sort((g,H)=>(H.createdAt||0)-(g.createdAt||0));if(v.value=f.map(g=>({id:g.id,date:g.date,preview:g.content.replace(/<[^>]*>/g,"").substring(0,30)+"...",weather:g.weather||" ",content:g.content,createdAt:g.createdAt})),f.length>0){const g=f[0];l.value={date:g.date,weather:g.weather,content:g.content}}}catch(P){console.error(":",P)}},M=()=>{n("back")},A=async()=>{await y(),a.value="history"},w=()=>{a.value="main"},k=P=>{i.value=P,a.value="view",zt(()=>{I()})},I=()=>{document.querySelectorAll(".censored").forEach(f=>{f.addEventListener("click",function(){this.classList.toggle("hidden")})})},_=()=>{a.value="history",i.value=null};let $=null,T=0;const q=(P,f)=>{T=Date.now(),$=setTimeout(()=>{J(P)},$l)},oe=(P,f)=>{const g=Date.now()-T;$&&(clearTimeout($),$=null),g<$l&&k(P)},se=()=>{$&&(clearTimeout($),$=null)},J=P=>{confirm(`

${P.date}
${P.preview}`)&&N(P)},N=async P=>{try{await C.deleteDiary(P.id);const f=v.value.findIndex(g=>g.id===P.id);if(f>-1&&v.value.splice(f,1),l.value.date===P.date)if(v.value.length>0){const g=v.value[0];l.value={date:g.date,weather:g.weather,content:g.content}}else l.value={date:"",weather:"",content:""};alert("")}catch(f){console.error(":",f),alert("")}};return nt(async()=>{await b(),await y(),await zt(),I()}),(P,f)=>(p(),m("div",im,[a.value==="main"?(p(),m("div",rm,[e("div",cm,[e("div",dm,S(l.value.date||d.value),1),e("div",um,S(l.value.weather||u.value),1)]),e("div",{class:"diary-entry",innerHTML:l.value.content||Sm},null,8,vm),f[1]||(f[1]=e("div",{class:"diary-footer"},"~~",-1)),f[2]||(f[2]=e("div",{class:"diary-sticker sticker1"},null,-1)),e("div",{class:"back-text",onClick:M},""),e("div",{class:"history-btn",onClick:A},[...f[0]||(f[0]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("polyline",{points:"12 6 12 12 16 14"})],-1)])])])):U("",!0),a.value==="history"?(p(),m("div",pm,[e("div",{class:"history-header"},[e("div",{class:"back-text",onClick:w},""),f[3]||(f[3]=e("div",{class:"history-title"},"",-1)),f[4]||(f[4]=e("div",{style:{width:"40px"}},null,-1))]),e("div",fm,[e("img",{src:r.value,alt:"avatar"},null,8,mm)]),e("div",gm,[(p(!0),m(Pe,null,Fe(v.value,(g,H)=>(p(),m("div",{key:H,class:"diary-item",onTouchstart:K=>q(g),onTouchend:K=>oe(g),onTouchcancel:se,onMousedown:K=>q(g),onMouseup:K=>oe(g),onMouseleave:se},[e("div",ym,S(g.date),1),e("div",bm,S(g.preview),1),e("div",wm,S(g.weather),1)],40,hm))),128)),v.value.length===0?(p(),m("div",km,"  ")):U("",!0)])])):U("",!0),a.value==="view"?(p(),m("div",xm,[e("div",Cm,[e("div",$m,S(i.value.date),1),e("div",_m,S(i.value.weather),1)]),e("div",{class:"diary-entry",innerHTML:i.value.content},null,8,Mm),f[5]||(f[5]=e("div",{class:"diary-footer"},"~~",-1)),f[6]||(f[6]=e("div",{class:"diary-sticker sticker1"},null,-1)),e("div",{class:"back-text",onClick:_},"")])):U("",!0)]))}},Am=Ze(Im,[["__scopeId","data-v-d81cb455"]]),on=()=>crypto.randomUUID?crypto.randomUUID():`id-${Date.now()}-${Math.random().toString(16).slice(2)}`,Ps=(t,s)=>{const o=Array.from(String(t||""));return o.length<=s?o.join(""):o.slice(0,s).join("")};function Lm(t){const s=(t||"").trim();if(!s)return null;console.log(" :",s.substring(0,200));try{return JSON.parse(s)}catch{}let o=s.replace(/```json\s*/g,"").replace(/```\s*/g,"").replace(/[\u0000-\u001F\u007F-\u009F]/g,"").trim();const n=o.match(/(\{[\s\S]*\}|\[[\s\S]*\])/);if(n)try{const a=n[0].trim();return console.log("  JSON:",a.substring(0,100)),JSON.parse(a)}catch(a){console.warn(" :",a.message);try{let l=cleanJson;l=l.replace(/"\s*\n\s*"/g,`",
"`);const i=(l.match(/\{/g)||[]).length,r=(l.match(/\}/g)||[]).length,c=(l.match(/\[/g)||[]).length,d=(l.match(/\]/g)||[]).length;return i>r&&(l+="}".repeat(i-r)),c>d&&(l+="]".repeat(c-d)),console.log("  JSON:",l.substring(0,100)),JSON.parse(l)}catch(l){console.warn(" :",l.message)}}if(o.includes("{")&&!o.includes("}"))try{console.log("  JSON...");const a=o+"}";return JSON.parse(a)}catch{}if(o.includes("[")&&!o.includes("]"))try{console.log(" ...");const a=o+"]";return JSON.parse(a)}catch{}return console.error(" :",s),null}async function nn({system:t,user:s}){var l,i,r,c,d;const o=await Ut.getApiConfig();if(!(o!=null&&o.apiKey)||!(o!=null&&o.model))return{error:"NO_API_CONFIG"};let n=o.baseUrl||"",a;n?n.endsWith("/v1")?a=`${n}/chat/completions`:(n.endsWith("/")&&(n=n.slice(0,-1)),a=`${n}/v1/chat/completions`):a=`${{deepseek:"https://api.deepseek.com",gemini:"https://generativelanguage.googleapis.com",openai:"https://api.openai.com"}[o.provider]}/v1/chat/completions`,console.log(" :",a);try{const u=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.apiKey}`},body:JSON.stringify({model:o.model,messages:[{role:"system",content:t},{role:"user",content:s}],temperature:.9,max_tokens:2e3,stream:!1})});if(!u.ok){const A=await u.text().catch(()=>"");return console.error(" API :",u.status,A),{error:`HTTP_${u.status}`,detail:A}}const v=await u.text();console.log(" :",v.substring(0,200));let b;try{b=JSON.parse(v)}catch(A){return console.error(" JSON :",A),{error:"PARSE_ERROR",raw:v}}let y=null;if(b.choices&&b.choices[0]&&(y=((l=b.choices[0].message)==null?void 0:l.content)||b.choices[0].text),!y&&b.candidates&&b.candidates[0]&&(y=(c=(r=(i=b.candidates[0].content)==null?void 0:i.parts)==null?void 0:r[0])==null?void 0:c.text),!y&&b.content&&(y=b.content),!y)return console.error(" :",JSON.stringify(b,null,2)),b.candidates&&((d=b.candidates[0])==null?void 0:d.finishReason)==="SAFETY"?(console.error(" "),{error:"SAFETY_FILTERED",raw:b,content:" prompt "}):b.choices&&b.choices.length===0?(console.error(" API  choices "),{error:"EMPTY_CHOICES",raw:b,content:"API "}):{error:"NO_CONTENT",raw:b,content:""};console.log(" :",y.substring(0,100));const M=Lm(y);return M||(console.error("  JSON:",y),{error:"INVALID_JSON",raw:y})}catch(u){return console.error(" :",u),{error:"NETWORK_ERROR",detail:u.message}}}async function da(t){var y,M,A;const s=await C.getContact(t);if(!s)return{ok:!1,reason:"NO_CONTACT"};const o=`chat_${t}`,a=(await C.getChatMessages(o)||[]).slice(-30);if(a.length===0)return{ok:!1,reason:"NO_MESSAGES"};const l=a.map(w=>{const k=w.sent?"":"",I=w.type==="text"?w.text:`[${w.type}]`;return`${k}: ${I}`}).join(`
`),i=await nn({system:` ${s.name||"ta"}JSONemoji2080${s.prompt||s.bio||""}`,user:`${l}

 1 
author_id ${String(t)}
${s.name||"ta"}
${s.prompt||s.bio||""}

""(bio)820

 
emojiooc

20











${l}`});console.log("  AI :",i);let r="",c="",d="";if(i!=null&&i.error&&(i==null?void 0:i.error)!=="INVALID_JSON")if(console.error(" AI :",i.error),i!=null&&i.content&&typeof i.content=="string"&&i.content.trim())console.log("  content ");else return{ok:!1,reason:"AI_ERROR",detail:i.error};let u="";if(typeof i=="string"?u=i:i!=null&&i.content?u=i.content:(y=i==null?void 0:i.data)!=null&&y.content?u=i.data.content:i!=null&&i.raw&&(typeof i.raw=="string"?u=i.raw:(M=i.raw)!=null&&M.content?u=i.raw.content:(A=i.raw)!=null&&A.text&&(u=i.raw.text)),u=(u||"").trim(),console.log(" :",u),!u)return console.error(" "),{ok:!1,reason:"EMPTY_RESPONSE"};const v=u.split(/\n\s*\n/).map(w=>w.trim()).filter(w=>w);if(v.length>=3)r=v[0],c=v[1],d=Ps(v[2],20).trim(),console.log("  3 ");else if(v.length===2){r=v[0],c=v[1];const w=r.split(`
`).map(k=>k.trim()).filter(k=>k);d=w.length>0?Ps(w[w.length-1],20).trim():r.substring(0,20),console.log("  2 ")}else if(v.length===1){const w=u.split(`
`).map(k=>k.trim()).filter(k=>k);if(w.length>=3){const k=w[w.length-1];if(k.length<=15){const I=w[w.length-2];I.length<=20?(r=w.slice(0,-2).join(`
`),c=I,d=Ps(k,20).trim(),console.log("  +  + ")):(r=w.slice(0,-1).join(`
`),c="",d=Ps(k,20).trim(),console.log("  + "))}else r=w.slice(0,-1).join(`
`),c=w[w.length-1],d=Ps(w[0],20).trim(),console.log("  + ")}else w.length===2?(r=w[0],c=w[1],d=Ps(w[0],20).trim(),console.log("  2 ")):(r=u,c="",d=Ps(r,20).trim(),console.log("  1 "))}else r=u,c="",d=Ps(r,20).trim(),console.log(" ");if(r=r.replace(/\n/g,`
`).replace(/\"/g,'"').trim(),c=c.replace(/\n/g,`
`).replace(/\"/g,'"').trim(),d=d.replace(/\n/g," ").replace(/\"/g,'"').trim(),!r)return console.error(" "),{ok:!1,reason:"EMPTY_CONTENT"};const b={id:on(),author_id:t,isSelf:!1,aiGenerated:!0,content:r,mediaDesc:c,image:"",mentions:[],visibility:"public",likes:0,liked:!1,shares:0,comments:[],createdAt:Date.now()};if(await C.upsertMomentPost(b),d)try{await C.updateContact({...s,bio:d,updatedAt:Date.now()})}catch(w){console.warn(" bio :",t,w)}return await C.markMessagesAsProcessedForMoment(a.map(w=>w.id)),{ok:!0,postId:b.id}}async function Tm(){const s=(await C.getChatList()||[]).filter(n=>n.type==="single"&&n.contactId);let o=0;for(const n of s)try{const a=await da(n.contactId);a!=null&&a.ok&&(o+=1)}catch(a){console.warn(":",n==null?void 0:n.contactId,a)}return{okCount:o,total:s.length}}typeof window<"u"&&window.addEventListener("ai-force-generate-moments",async()=>{try{const t=await Tm();window.dispatchEvent(new CustomEvent("ai-force-generate-moments-done",{detail:t}))}catch(t){window.dispatchEvent(new CustomEvent("ai-force-generate-moments-done",{detail:{okCount:0,total:0,error:String((t==null?void 0:t.message)||t)}}))}});class jm{constructor(){this.isEnabled=!1,this.checkInterval=null,this.lastCheckTime={}}async start(){this.isEnabled=!0,await C.setSetting("autoDiaryEnabled",!0),this.checkInterval=setInterval(()=>{this.checkAndGenerate()},6e4),console.log("")}async stop(){this.isEnabled=!1,await C.setSetting("autoDiaryEnabled",!1),this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),console.log("")}async enableFirstTime(s){try{const o=`chat_${s}`;await C.markAllMessagesAsSummarized(o),console.log(` ${s} `)}catch(o){console.error(":",o)}}async checkAndGenerate(){if(this.isEnabled)try{const s=await C.getChatList();for(const o of s){if(o.type!=="single")continue;const n=`chat_${o.contactId}`,a=o.contactId;(await C.getUnsummarizedMessages(n,null)).length<=10||(console.log(`:  ${a}`),await this.generateDiary(a,n))}}catch(s){console.error(":",s)}}async generateDiary(s,o){var n,a,l,i;try{const r=await C.getUnsummarizedMessages(o,50);if(r.length===0){console.log("");return}const c=r.map(se=>{const J=se.sent?"":"ta",N=se.type==="text"?se.text:`[${se.type}]`;return`${J}: ${N}`}).join(`
`),d=await C.getContact(s),u=(d==null?void 0:d.name)||"ta",b=[{role:"system",content:this.buildDiaryPrompt(u)},{role:"user",content:`

${c}`}],y=await Ut.getApiConfig();if(!y.apiKey||!y.model)throw new Error(" API ");let M=y.baseUrl||"";M.endsWith("/v1")?M=M.slice(0,-3):M.endsWith("/")&&(M=M.slice(0,-1));const w=`${{deepseek:M||"https://api.deepseek.com",gemini:M||"https://generativelanguage.googleapis.com",openai:M||"https://api.openai.com"}[y.provider]}/v1/chat/completions`;console.log(" :",w);const k=await fetch(w,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y.apiKey}`},body:JSON.stringify({model:y.model,messages:b,temperature:.9,max_tokens:2e3,stream:!1})});if(!k.ok){const se=await k.text();throw console.error(" API :",k.status,se),new Error(`HTTP error! status: ${k.status}`)}const I=await k.text();console.log(" :",I.substring(0,200));let _;try{_=JSON.parse(I)}catch(se){throw console.error(" JSON :",se),new Error(" API ")}let $=null;if(_.choices&&_.choices[0]&&($=((n=_.choices[0].message)==null?void 0:n.content)||_.choices[0].text),!$&&_.candidates&&_.candidates[0]&&($=(i=(l=(a=_.candidates[0].content)==null?void 0:a.parts)==null?void 0:l[0])==null?void 0:i.text),!$&&_.content&&($=_.content),!$)throw console.error(" :",_),new Error("");console.log(" :",$.substring(0,100));const T=this.parseDiaryContent($),q={contactId:s,date:T.date,weather:T.weather,content:T.content,createdAt:Date.now()};await C.addDiary(q);const oe=r.map(se=>se.id);await C.markMessagesAsSummarized(oe),this.showDiaryNotification(u),console.log(" :",q)}catch(r){throw console.error(" :",r),r}}async manualGenerate(s){const o=`chat_${s}`;if((await C.getUnsummarizedMessages(o,null)).length===0)throw new Error("");await this.generateDiary(s,o)}buildDiaryPrompt(s){return` ${s}

{{}}
{{}}
{{}}


1. YYYYMMDD X20260118 
2. emoji +  +   / 15
3. 
   - 
   - ""
   - 
   - 5-82-4
   - 

3-5
- ~~~~ - 
- **** - 
- ____ - 
- !!!! - 
- #### - 
- @@@@ - 2-8


-  ${s}""
- """ta""/"
- "ta"""
- ""  "ta"
- "ta"  "tata"


- 
- 
- 
- 
- 
- 
- ${s}


- 5-82-4
- 3-5
- 
- 


20260118 
  / 22
##ta##""""
ta""****
ta
tata""
ta""""""
ta""
____~~~~
@@ta@@ta

`}convertMarkupToHTML(s){return s?s.split(`
`).map(a=>a.trim()).filter(a=>a).map(a=>(a=a.replace(/~~(.+?)~~/g,'<span class="strikethrough">$1</span>'),a=a.replace(/\*\*(.+?)\*\*/g,'<span class="highlight">$1</span>'),a=a.replace(/__(.+?)__/g,'<span class="underline">$1</span>'),a=a.replace(/!!(.+?)!!/g,'<span class="emphasis">$1</span>'),a=a.replace(/##(.+?)##/g,'<span class="handwritten">$1</span>'),a=a.replace(/@@(.+?)@@/g,'<span class="censored hidden">$1</span>'),`<p>${a}</p>`)).join(""):""}parseDiaryContent(s){const o=s.match(/[:]\s*(.+)/),n=o?o[1].trim():this.getCurrentDate(),a=s.match(/[:]\s*(.+)/),l=a?a[1].trim():"  / 22",i=s.match(/[:]\s*([\s\S]+)/);let r=i?i[1].trim():s;return r=this.convertMarkupToHTML(r),{date:n,weather:l,content:r}}getCurrentDate(){const s=new Date,o=s.getFullYear(),n=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0"),i=["","","","","","",""][s.getDay()];return`${o}${n}${a} ${i}`}showDiaryNotification(s){window.dispatchEvent(new CustomEvent("show-diary-notification",{detail:{message:`${s}`}}))}async getStatus(){return await C.getSetting("autoDiaryEnabled")}}const lo=new jm;class Pm{constructor(){this.isEnabled=!1,this.checkInterval=null,this.lastMomentTime={}}async start(){this.isEnabled=!0,await C.setSetting("autoMomentEnabled",!0),this.checkInterval=setInterval(()=>{this.checkAndGenerate()},18e4),console.log(" ")}async stop(){this.isEnabled=!1,await C.setSetting("autoMomentEnabled",!1),this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),console.log(" ")}async enableFirstTime(s){try{const o=`chat_${s}`;await C.markAllMessagesAsProcessedForMoment(o),console.log(`  ${s} `)}catch(o){console.error(" :",o)}}async checkAndGenerate(){if(this.isEnabled)try{const s=await C.getChatList(),o=Date.now();for(const n of s){if(n.type!=="single"||!n.contactId)continue;const a=n.contactId,l=`chat_${a}`,i=await C.getUnprocessedForMomentMessages(l),r=this.lastMomentTime[a]||0,c=30*60*1e3;if(o-r<c){console.log(`  ${a} `);continue}const d=this.shouldGenerateMoment(i,o,r);if(d.trigger){console.log(` :  ${a}, : ${d.reason}`);try{const u=await da(a);u!=null&&u.ok&&(this.lastMomentTime[a]=o,console.log(`  ${a} `),this.showMomentNotification(a))}catch(u){console.warn(` : ${a}`,u)}}}}catch(s){console.error(" :",s)}}shouldGenerateMoment(s,o,n){if(!s||s.length===0)return{trigger:!1,reason:""};const a=s.length,l=o-(n||0);return a>=15?{trigger:!0,reason:` (${a})`}:a>=8&&l>2*60*60*1e3?{trigger:!0,reason:` (${a}) + `}:a>=5&&l>4*60*60*1e3&&Math.random()<.3?{trigger:!0,reason:" + "}:!n&&a>=10?{trigger:!0,reason:` (${a})`}:{trigger:!1,reason:` (${a})`}}async showMomentNotification(s){try{const o=await C.getContact(s),n=(o==null?void 0:o.name)||"";window.dispatchEvent(new CustomEvent("show-moment-notification",{detail:{message:`${n} `,contactId:s}}))}catch(o){console.warn(":",o)}}async manualGenerate(s){const o=`chat_${s}`;if((await C.getUnprocessedForMomentMessages(o)).length===0)throw new Error("");const a=await da(s);return a!=null&&a.ok&&(this.lastMomentTime[s]=Date.now()),a}async getStatus(){return{enabled:await C.getSetting("autoMomentEnabled")||!1,isRunning:this.isEnabled,lastMomentTime:this.lastMomentTime}}resetCooldown(s){delete this.lastMomentTime[s],console.log(`  ${s} `)}resetAllCooldowns(){this.lastMomentTime={},console.log(" ")}scheduleInteractForUserPost(s){if(!(s!=null&&s.isSelf)||!(s!=null&&s.id))return;const o=Math.floor(Math.random()*10001+5e3);setTimeout(()=>{this.interactWithUserPost(s).catch(n=>console.error(":",n))},o)}scheduleReplyToMention({postId:s,actorId:o,userName:n,userCommentText:a}){if(!s||o==null||!n)return;const l=Math.floor(Math.random()*5001+5e3);setTimeout(()=>{this.replyToMention({postId:s,actorId:o,userName:n,userCommentText:a}).catch(i=>console.error(":",i))},l)}scheduleReplyToUserCommentOnRolePost({postId:s,actorId:o,userId:n="self",userName:a,userCommentText:l}){if(!s||o==null||!a)return;const i=Math.floor(Math.random()*10001+5e3);setTimeout(()=>{this.replyToUserCommentOnRolePost({postId:s,actorId:o,userId:n,userName:a,userCommentText:l}).catch(r=>console.error(":",r))},i)}async interactWithUserPost(s){const o=await C.getContacts(),n=o[Math.floor(Math.random()*o.length)];if(!n)return;const a=n.id,l=await nn({system:` ${n.name||"ta"}



 like  comment

 comment525 like 

${n.prompt||n.bio||""}`,user:`
${s.content||"()"}

`});console.log(" :",l);let i="";if(typeof l=="string"?i=l:l!=null&&l.raw&&typeof l.raw=="string"?i=l.raw:l!=null&&l.content&&typeof l.content=="string"&&(i=l.content),i=(i||"").trim(),i=i.replace(/```[\s\S]*?```/g,"").trim(),i=i.replace(/^["']|["']$/g,"").trim(),console.log(" :",i),!i)return;const r=i.split(/\n\s*\n/).map(v=>v.trim()).filter(v=>v);let c="",d="";if(r.length>=2)c=r[0].toLowerCase(),d=r[1];else if(r.length===1){const v=r[0].toLowerCase();v.includes("like")||v.includes("")?c="like":(v.includes("comment")||v.includes(""))&&(c="comment",d=r[0])}const u=await C.getMomentPost(s.id);if(!(!u||!u.isSelf)){if(c==="like"){const v={...u,likes:(u.likes||0)+1};await C.upsertMomentPost(v);return}if(c==="comment"&&d&&d!==""){const v={id:on(),author_id:a,text:d,createdAt:Date.now()},b={...u,comments:[...u.comments||[],v]};await C.upsertMomentPost(b),window.dispatchEvent(new CustomEvent("moment-ai-comment",{detail:{author_id:a,authorName:n.name,postId:u.id}}))}}}async replyToMention({postId:s,actorId:o,userName:n,userCommentText:a}){const l=await C.getContact(o);if(!l)return;const i=await C.getMomentPost(s);if(!i||!i.isSelf)return;const r=(i.comments||[]).slice().sort((b,y)=>(b.createdAt||0)-(y.createdAt||0)).slice(-12).map(b=>{const y=b.isSelf?"":"",M=b.text||"";return`${y}: ${M}`}).join(`
`),c=await nn({system:` ${l.name||"ta"}

JSON


-  @${n} 
- 
- 630
- 

${l.prompt||l.bio||""}`,user:`${i.content||"()"}

${a||""}


${r}

 @${n} `});console.log("  @:",c);let d="";if(typeof c=="string"?d=c:c!=null&&c.raw&&typeof c.raw=="string"?d=c.raw:c!=null&&c.content&&typeof c.content=="string"&&(d=c.content),d=(d||"").trim(),d=d.replace(/```[\s\S]*?```/g,"").trim(),d=d.replace(/^["']|["']$/g,"").trim(),console.log(" :",d),!d||d.length<2){console.error(" ");return}d.startsWith(`@${n}`)||(d=`@${n} ${d}`);const u={id:on(),author_id:o,text:d,createdAt:Date.now()},v={...i,comments:[...i.comments||[],u]};await C.upsertMomentPost(v),window.dispatchEvent(new CustomEvent("moment-ai-comment",{detail:{author_id:o,authorName:l.name,postId:i.id}}))}async replyToUserCommentOnRolePost({postId:s,actorId:o,userId:n="self",userName:a,userCommentText:l}){const i=await C.getContact(o);if(!i)return;const r=await C.getMomentPost(s);if(!r||r.isSelf||r.author_id!==o)return;const c=(r.comments||[]).slice().sort((y,M)=>(y.createdAt||0)-(M.createdAt||0)).slice(-14).map(y=>{const M=y.isSelf?"":"",A=y.text||"";return`${M}: ${A}`}).join(`
`),d=await nn({system:` ${i.name||"ta"}

JSON


-  @${a} 
- 
- 635
- 

${i.prompt||i.bio||""}`,user:`${r.content||"()"}

${l||""}


${c}

 @${a} `});console.log(" :",d);let u="";if(typeof d=="string"?u=d:d!=null&&d.raw&&typeof d.raw=="string"?u=d.raw:d!=null&&d.content&&typeof d.content=="string"&&(u=d.content),u=(u||"").trim(),u=u.replace(/```[\s\S]*?```/g,"").trim(),u=u.replace(/^["']|["']$/g,"").trim(),console.log(" :",u),!u||u.length<2){console.error(" ");return}u.startsWith(`@${a}`)||(u=`@${a} ${u}`);const v={id:on(),author_id:o,text:u,createdAt:Date.now()},b={...r,comments:[...r.comments||[],v]};await C.upsertMomentPost(b),window.dispatchEvent(new CustomEvent("moment-ai-comment",{detail:{author_id:o,authorName:i.name,postId:r.id}}))}}const Qt=new Pm,Em={class:"phone-container"},Bm={class:"settings-container"},Vm={class:"settings-tabs"},Hm={class:"settings-list"},Dm={key:0},Fm={class:"setting-section"},Um={class:"setting-item"},Nm={class:"setting-item"},Om={class:"setting-item"},Rm={class:"password-input"},zm=["type"],Wm={class:"setting-item"},Km=["disabled"],Gm={key:0,class:"setting-item"},qm=["value"],Zm={class:"setting-section"},Jm={class:"setting-item"},Ym={class:"switch-container"},Xm={class:"switch"},Qm={class:"switch-label"},eg={class:"setting-item"},tg=["disabled"],sg={class:"setting-section"},og={class:"setting-item"},ng={class:"switch-container"},ag={class:"switch"},lg={class:"switch-label"},ig={key:0,class:"setting-item"},rg={class:"setting-section"},cg={class:"setting-item"},dg={class:"switch-container"},ug={class:"switch"},vg={class:"switch-label"},pg={key:1},fg={class:"setting-section"},mg={class:"setting-item"},gg={class:"avatar-preview-container"},hg={class:"setting-item"},yg={class:"setting-section"},bg={class:"setting-item"},wg={key:0,class:"wallpaper-preview"},kg=["src"],xg={class:"setting-section"},Cg={viewBox:"0 0 24 24",width:"20",height:"20",style:{fill:"#999"}},$g={class:"setting-section"},_g={viewBox:"0 0 24 24",width:"20",height:"20",style:{fill:"#999"}},Mg={viewBox:"0 0 24 24",width:"20",height:"20",style:{fill:"#999"}},Sg={class:"setting-section"},Ig={class:"setting-item"},Ag={class:"switch-container"},Lg={class:"switch"},Tg={class:"switch-label"},jg={class:"setting-item"},Pg={class:"switch-container"},Eg={class:"switch"},Bg={class:"switch-label"},Vg={class:"setting-section"},Hg={class:"setting-item"},Dg=["disabled"],Fg={class:"setting-item"},Ug=["disabled"],Ng={class:"font-manager-container"},Og={class:"font-manager-content"},Rg={class:"font-preview-section"},zg={class:"setting-item"},Wg={class:"switch-container"},Kg={class:"switch"},Gg={class:"switch-label"},qg={class:"installed-fonts-section"},Zg={class:"font-list"},Jg={class:"app-icon-info"},Yg=["src"],Xg={class:"font-item-name"},Qg={class:"font-item-actions"},eh=["onClick"],th=["onClick"],sh={class:"font-manager-container"},oh={class:"customizer-content"},nh={class:"customizer-tabs"},ah={key:0,class:"editor-panel"},lh={key:1,class:"editor-panel"},ih={key:2,class:"preview-panel"},rh={class:"preview-container"},ch={class:"preview-phone",ref:"previewPhone"},dh={class:"preview-desktop"},uh={class:"status-bar"},vh={class:"status-bar-left"},ph={class:"widget-container"},fh={class:"widget widget-clock"},mh={class:"time"},gh={class:"date"},hh=["innerHTML"],yh={class:"font-manager-container"},bh={class:"font-manager-content"},wh={class:"font-preview-section"},kh={class:"font-upload-section"},xh={viewBox:"0 0 24 24",width:"48",height:"48",style:{fill:"#6c8cd5","margin-bottom":"12px"}},Ch={class:"font-link-section"},$h={class:"installed-fonts-section"},_h={class:"font-list"},Mh=["onClick"],Sh={class:"font-item-actions"},Ih={key:0,class:"font-btn active-btn"},Ah={key:1,class:"font-btn apply-btn"},Lh=["onClick"],Th={__name:"Settings",emits:["back"],setup(t,{emit:s}){const o=s,n=h("ai"),a=h({provider:"deepseek",apiKey:"",baseUrl:"",model:""}),l=h(!1),i=h([]),r=h(!1),c=h(!1),d=h(!1),u=h(!1),v=h("https://via.placeholder.com/80"),b=h(""),y=h(null),M=h(null),A=h(""),w=h(""),k=h(!0),I=h(!0),_=h(!1),$=h(!1),T=h(null),q=h(!1),oe=h(""),se=h(!1),J=h(null),N=h(""),P=h("system-ui"),f=h([{name:"",family:"system-ui",isSystem:!0},{name:"Arial",family:"Arial",isSystem:!0},{name:"Times New Roman",family:"Times New Roman",isSystem:!0},{name:"Courier New",family:"Courier New",isSystem:!0}]),g=h(!1),H=h(null),K=h(""),F=h(!0),x=h([{name:"Messages",iconSrc:"https://files.catbox.moe/14op6b.jpg",isCustom:!1},{name:"Moments",iconSrc:"https://files.catbox.moe/gvs6a5.jpg",isCustom:!1},{name:"Mori",iconSrc:"https://files.catbox.moe/f0p41u.png",isCustom:!1},{name:"Forum",iconSrc:"https://files.catbox.moe/jpd1lk.jpg",isCustom:!1},{name:"Music",iconSrc:"https://img.wjwj.top/2026/02/18/f6486d844bff10d88a0514db5f710875.md.png",isCustom:!1},{name:"Pornhub",iconSrc:"https://upload.wikimedia.org/wikipedia/commons/f/f1/Pornhub-logo.svg",isCustom:!1},{name:"Live",iconSrc:"https://files.catbox.moe/mg3qg0.jpg",isCustom:!1},{name:"Phone",iconSrc:"https://files.catbox.moe/7ji6fb.png",isCustom:!1},{name:"Mail",iconSrc:"https://files.catbox.moe/edai70.png",isCustom:!1},{name:"World",iconSrc:"https://files.catbox.moe/it221m.png",isCustom:!1},{name:"Settings",iconSrc:"https://files.catbox.moe/2khrtz.png",isCustom:!1}]),L=h(!1),ae=h("css"),de=h(""),ue=h(""),$e=h(""),ne=()=>{const me=new Date,E=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ve=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];$e.value=`${E[me.getDay()]}, ${ve[me.getMonth()]} ${me.getDate()}`},G=me=>{oe.value=me,q.value=!0,setTimeout(()=>{q.value=!1},2e3)},he=async()=>{try{const me=await Ut.getApiConfig();a.value=me;const E=await lo.getStatus();c.value=E||!1;const ve=await Qt.getStatus();d.value=ve.enabled||!1;const Ye=await Ut.getBackgroundStatus();u.value=Ye||!1;const ct=await C.getSetting("userAvatar");ct&&(v.value=ct);const bt=await C.getSetting("userNickname");bt&&(b.value=bt);const ft=await C.getSetting("wallpaper");ft&&(A.value=ft);const wt=await C.getSetting("notificationSound");k.value=wt!==!1;const it=await C.getSetting("vibration");I.value=it!==!1;const Tt=await C.getSetting("iconBackdropFilter");Tt!==void 0&&(F.value=Tt);const Et=await C.getSetting("appIcons");Et&&Array.isArray(Et)&&(x.value=Et);const Wt=await C.getSetting("globalFont");Wt&&(P.value=Wt,document.documentElement.style.setProperty("--global-font",Wt));const Kt=await C.getSetting("customFonts");if(Kt&&Array.isArray(Kt)){for(const Y of Kt){const X=document.createElement("style");Y.data?X.textContent=`
            @font-face {
              font-family: '${Y.family}';
              src: url(${Y.data});
            }
          `:Y.url&&(X.textContent=`
            @font-face {
              font-family: '${Y.family}';
              src: url(${Y.url});
            }
          `),document.head.appendChild(X)}f.value=[...f.value.filter(Y=>Y.isSystem),...Kt]}}catch(me){console.error(":",me)}},j=async()=>{if(!a.value.apiKey){G(" API ");return}r.value=!0;try{const me=await Ut.fetchModels(a.value.provider,a.value.apiKey,a.value.baseUrl);i.value=me,G("")}catch(me){G(""),console.error(me)}finally{r.value=!1}},Q=async()=>{try{await Ut.saveApiConfig(a.value),G("API ")}catch(me){G(""),console.error(me)}},W=async()=>{try{if(c.value){const me=await C.getChatList();for(const E of me)E.type==="single"&&await lo.enableFirstTime(E.contactId);await lo.start(),G("")}else await lo.stop(),G("")}catch(me){G(""),console.error(me)}},B=async()=>{try{const E=(await C.getChatList()).find(ve=>ve.type==="single");if(!E){G("");return}G("..."),await lo.manualGenerate(E.contactId),G("")}catch(me){G(""+me.message),console.error(me)}},D=async()=>{try{if(d.value){const me=await C.getChatList();for(const E of me)E.type==="single"&&E.contactId&&await Qt.enableFirstTime(E.contactId);await Qt.start(),G(" ")}else await Qt.stop(),G(" ")}catch(me){G(""),console.error(me)}},xe=async()=>{try{Qt.resetAllCooldowns(),G(" ")}catch(me){G(""),console.error(me)}},V=async()=>{try{u.value?(await Ut.startBackgroundMessages(),G("")):(await Ut.stopBackgroundMessages(),G(""))}catch(me){G(""),console.error(me)}},O=async me=>{const E=me.target.files[0];if(E)try{G("...");const ve=await z(E,400,400,.8);v.value=ve,G(" ")}catch(ve){console.error(":",ve),G(" ")}},z=(me,E,ve,Ye=.8)=>new Promise((ct,bt)=>{const ft=new FileReader;ft.onload=wt=>{const it=new Image;it.onload=()=>{const Tt=document.createElement("canvas"),Et=Tt.getContext("2d");let Wt=it.width,Kt=it.height;if(Wt>E||Kt>ve){const X=Math.min(E/Wt,ve/Kt);Wt=Wt*X,Kt=Kt*X}Tt.width=Wt,Tt.height=Kt,Et.drawImage(it,0,0,Wt,Kt);const Y=Tt.toDataURL("image/jpeg",Ye);console.log(` : ${(me.size/1024).toFixed(2)}KB -> ${(Y.length/1024).toFixed(2)}KB`),ct(Y)},it.onerror=()=>{bt(new Error(""))},it.src=wt.target.result},ft.onerror=()=>{bt(new Error(""))},ft.readAsDataURL(me)}),ee=async()=>{try{await C.setSetting("userAvatar",v.value),await C.setSetting("userNickname",b.value),G("")}catch(me){G(""),console.error(me)}},ce=async me=>{const E=me.target.files[0];if(E)try{G("...");const ve=await z(E,1080,1920,.85);A.value=ve,w.value=ve,G(" ")}catch(ve){console.error(":",ve),G(" ")}},ye=async()=>{if(!w.value){G("");return}try{await C.setSetting("wallpaper",w.value),G(""),window.dispatchEvent(new CustomEvent("wallpaper-changed",{detail:{wallpaper:w.value}}))}catch(me){G(""),console.error(me)}},Le=()=>{o("back")},Ae=()=>{se.value=!0},Me=()=>{se.value=!1},be=async me=>{const E=me.target.files[0];if(E)try{const ve=new FileReader;ve.onload=async Ye=>{const ct=Ye.target.result,bt=E.name.replace(/\.[^/.]+$/,""),ft=`custom-${Date.now()}`,wt=document.createElement("style");wt.textContent=`
        @font-face {
          font-family: '${ft}';
          src: url(${ct});
        }
      `,document.head.appendChild(wt);const it={name:bt,family:ft,data:ct,isSystem:!1};f.value.push(it),await C.setSetting("customFonts",f.value.filter(Tt=>!Tt.isSystem)),G(` "${bt}" `)},ve.readAsDataURL(E)}catch(ve){G(""),console.error(ve)}},Ne=async()=>{if(!N.value.trim()){G("");return}try{const me=N.value.trim(),E=`url-font-${Date.now()}`,ve=document.createElement("style");ve.textContent=`
      @font-face {
        font-family: '${E}';
        src: url(${me});
      }
    `,document.head.appendChild(ve);const Ye={name:`URL-${f.value.length}`,family:E,url:me,isSystem:!1};f.value.push(Ye),await C.setSetting("customFonts",f.value.filter(ct=>!ct.isSystem)),G(""),N.value=""}catch(me){G(""),console.error(me)}},Ee=async me=>{P.value=me,document.documentElement.style.setProperty("--global-font",me),await C.setSetting("globalFont",me),G("")},De=async me=>{f.value=f.value.filter(E=>E.name!==me),await C.setSetting("customFonts",f.value.filter(E=>!E.isSystem)),G(` "${me}" `)},We=()=>{g.value=!0},Je=()=>{g.value=!1},ge=async()=>{try{await C.setSetting("iconBackdropFilter",F.value),window.dispatchEvent(new CustomEvent("icon-backdrop-filter-changed",{detail:{enabled:F.value}})),G(F.value?"":"")}catch(me){G(""),console.error(me)}},le=me=>{var E;K.value=me,(E=H.value)==null||E.click()},He=async me=>{const E=me.target.files[0];if(E)try{G("...");const ve=await z(E,512,512,.9),Ye=x.value.findIndex(ct=>ct.name===K.value);Ye!==-1&&(x.value[Ye].iconSrc=ve,x.value[Ye].isCustom=!0,await C.setSetting("appIcons",x.value),window.dispatchEvent(new CustomEvent("app-icon-changed",{detail:{appName:K.value,iconSrc:ve}})),G(` "${K.value}" `))}catch(ve){console.error(":",ve),G(" ")}},ke=async me=>{const E={Messages:"https://files.catbox.moe/14op6b.jpg",Moments:"https://files.catbox.moe/gvs6a5.jpg",Mori:"https://files.catbox.moe/f0p41u.png",Forum:"https://files.catbox.moe/jpd1lk.jpg",Music:"https://img.wjwj.top/2026/02/18/f6486d844bff10d88a0514db5f710875.md.png",Pornhub:"https://upload.wikimedia.org/wikipedia/commons/f/f1/Pornhub-logo.svg",Live:"https://files.catbox.moe/mg3qg0.jpg",Phone:"https://files.catbox.moe/7ji6fb.png",Mail:"https://files.catbox.moe/edai70.png",World:"https://files.catbox.moe/it221m.png",Settings:"https://files.catbox.moe/2khrtz.png"},ve=x.value.findIndex(Ye=>Ye.name===me);ve!==-1&&(x.value[ve].iconSrc=E[me],x.value[ve].isCustom=!1,await C.setSetting("appIcons",x.value),window.dispatchEvent(new CustomEvent("app-icon-changed",{detail:{appName:me,iconSrc:E[me]}})),G(`"${me}" `))},Be=async()=>{L.value=!0,ne();const me=await C.getSetting("desktopCustomCSS"),E=await C.getSetting("desktopCustomHTML");me&&(de.value=me),E&&(ue.value=E)},vt=()=>{L.value=!1,ae.value="css"},pt=()=>{confirm(" CSS ")&&(de.value="",G("CSS "))},re=()=>{confirm(" HTML ")&&(ue.value="",G("HTML "))},te=()=>{window.dispatchEvent(new CustomEvent("desktop-customization-preview",{detail:{css:de.value,html:ue.value}})),G(" ")},pe=async()=>{try{await C.setSetting("desktopCustomCSS",de.value),await C.setSetting("desktopCustomHTML",ue.value),window.dispatchEvent(new CustomEvent("desktop-customization-apply",{detail:{css:de.value,html:ue.value}})),G(" "),vt()}catch(me){console.error(":",me),G(" ")}},ze=async()=>{_.value=!0,G("...");try{await _e.init();const me=["settings","apiKeys","chatRecords","characterCards","contacts","chatList","chatMessages","userSettings","diaries","momentPosts","worldBooks","groups","groupMessages","customEmojis"],E={version:"1.0",exportTime:new Date().toISOString(),data:{}};for(const wt of me)try{const it=await _e.getAll(wt);E.data[wt]=it,console.log(`  ${wt}: ${it.length} `)}catch(it){console.warn(`  ${wt} :`,it),E.data[wt]=[]}const Ye=`myphone-backup-${new Date().toISOString().split("T")[0]}.json`,ct=new Blob([JSON.stringify(E,null,2)],{type:"application/json"}),bt=URL.createObjectURL(ct),ft=document.createElement("a");ft.href=bt,ft.download=Ye,document.body.appendChild(ft),ft.click(),document.body.removeChild(ft),URL.revokeObjectURL(bt),G(" ")}catch(me){console.error(":",me),G(" "+me.message)}finally{_.value=!1}},Ce=async me=>{const E=me.target.files[0];if(E){if(!confirm(` 

`)){me.target.value="";return}$.value=!0,G("...");try{const ve=new FileReader;ve.onload=async Ye=>{try{const ct=JSON.parse(Ye.target.result);if(!ct.version||!ct.data)throw new Error("");console.log(` : ${ct.version}`),console.log(` : ${ct.exportTime}`),await _e.init();let bt=0,ft=0;for(const[wt,it]of Object.entries(ct.data))try{if(!Array.isArray(it)){console.warn(` ${wt} `);continue}await _e.clear(wt),console.log(`  ${wt}`);for(const Tt of it)await _e.set(wt,Tt);console.log(`  ${wt}: ${it.length} `),bt++}catch(Tt){console.error(`  ${wt} :`,Tt),ft++}G(` : ${bt}, : ${ft}`),setTimeout(()=>{confirm("")&&window.location.reload()},1500)}catch(ct){console.error(":",ct),G(" "+ct.message)}finally{$.value=!1,me.target.value=""}},ve.onerror=()=>{G(" "),$.value=!1,me.target.value=""},ve.readAsText(E)}catch(ve){console.error(":",ve),G(" "+ve.message),$.value=!1,me.target.value=""}}};return nt(()=>{he()}),(me,E)=>(p(),m("div",Em,[e("div",Bm,[e("div",{class:"settings-header"},[e("div",{class:"back-btn",onClick:Le},[...E[23]||(E[23]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})],-1)])]),E[24]||(E[24]=e("h2",null,"",-1)),E[25]||(E[25]=e("div",{style:{width:"40px"}},null,-1))]),e("div",Vm,[e("div",{class:Ie(["tab-item",{active:n.value==="ai"}]),onClick:E[0]||(E[0]=ve=>n.value="ai")}," AI  ",2),e("div",{class:Ie(["tab-item",{active:n.value==="system"}]),onClick:E[1]||(E[1]=ve=>n.value="system")},"  ",2)]),e("div",Hm,[n.value==="ai"?(p(),m("div",Dm,[e("div",Fm,[E[33]||(E[33]=e("div",{class:"section-title"},"API ",-1)),e("div",Um,[E[27]||(E[27]=e("label",null,"AI ",-1)),we(e("select",{"onUpdate:modelValue":E[2]||(E[2]=ve=>a.value.provider=ve)},[...E[26]||(E[26]=[e("option",{value:"deepseek"},"DeepSeek",-1),e("option",{value:"gemini"},"Gemini",-1),e("option",{value:"openai"},"OpenAI",-1)])],512),[[Ls,a.value.provider]])]),e("div",Nm,[E[28]||(E[28]=e("label",null,"",-1)),we(e("input",{type:"text","onUpdate:modelValue":E[3]||(E[3]=ve=>a.value.baseUrl=ve),placeholder:": http://127.0.0.1:8888  http://192.168.1.100:8888"},null,512),[[Te,a.value.baseUrl]]),E[29]||(E[29]=e("div",{class:"setting-hint",style:{"font-size":"12px",color:"#999","margin-top":"4px"}},"  /v1  ",-1))]),e("div",Om,[E[30]||(E[30]=e("label",null,"API ",-1)),e("div",Rm,[we(e("input",{type:l.value?"text":"password","onUpdate:modelValue":E[4]||(E[4]=ve=>a.value.apiKey=ve),placeholder:" API Key"},null,8,zm),[[zd,a.value.apiKey]]),e("button",{class:"toggle-btn",onClick:E[5]||(E[5]=ve=>l.value=!l.value)},S(l.value?"":""),1)])]),e("div",Wm,[e("button",{class:"btn btn-primary",onClick:j,disabled:r.value},S(r.value?"...":""),9,Km)]),i.value.length>0?(p(),m("div",Gm,[E[32]||(E[32]=e("label",null,"",-1)),we(e("select",{"onUpdate:modelValue":E[6]||(E[6]=ve=>a.value.model=ve)},[E[31]||(E[31]=e("option",{value:""},"",-1)),(p(!0),m(Pe,null,Fe(i.value,ve=>(p(),m("option",{key:ve.id,value:ve.id},S(ve.id),9,qm))),128))],512),[[Ls,a.value.model]])])):U("",!0),e("div",{class:"setting-item"},[e("button",{class:"btn btn-success",onClick:Q}," API ")])]),e("div",Zm,[E[36]||(E[36]=e("div",{class:"section-title"},"",-1)),e("div",Jm,[E[35]||(E[35]=e("label",null,"",-1)),e("div",Ym,[e("label",Xm,[we(e("input",{type:"checkbox","onUpdate:modelValue":E[7]||(E[7]=ve=>c.value=ve),onChange:W},null,544),[[es,c.value]]),E[34]||(E[34]=e("span",{class:"slider"},null,-1))]),e("span",Qm,S(c.value?"":""),1)])]),E[37]||(E[37]=e("div",{class:"setting-description"}," 3010 ",-1)),e("div",eg,[e("button",{class:"btn btn-primary",onClick:B,disabled:!a.value.apiKey},"  ",8,tg)])]),e("div",sg,[E[40]||(E[40]=e("div",{class:"section-title"}," ",-1)),e("div",og,[E[39]||(E[39]=e("label",null,"AI ",-1)),e("div",ng,[e("label",ag,[we(e("input",{type:"checkbox","onUpdate:modelValue":E[8]||(E[8]=ve=>d.value=ve),onChange:D},null,544),[[es,d.value]]),E[38]||(E[38]=e("span",{class:"slider"},null,-1))]),e("span",lg,S(d.value?"":""),1)])]),E[41]||(E[41]=e("div",{class:"setting-description"},[Qe("  "),e("ul",{style:{"margin-top":"8px","padding-left":"20px"}},[e("li",null," 15 "),e("li",null," 8-14  +  2 "),e("li",null," 5-7  +  4 30% "),e("li",null," 10 ")]),e("div",{style:{"margin-top":"8px",color:"#ff6b6b"}},"  30  ")],-1)),d.value?(p(),m("div",ig,[e("button",{class:"btn btn-secondary",onClick:xe},"   ")])):U("",!0)]),e("div",rg,[E[44]||(E[44]=e("div",{class:"section-title"},"",-1)),e("div",cg,[E[43]||(E[43]=e("label",null,"AI ",-1)),e("div",dg,[e("label",ug,[we(e("input",{type:"checkbox","onUpdate:modelValue":E[9]||(E[9]=ve=>u.value=ve),onChange:V},null,544),[[es,u.value]]),E[42]||(E[42]=e("span",{class:"slider"},null,-1))]),e("span",vg,S(u.value?"":""),1)])]),E[45]||(E[45]=e("div",{class:"setting-description"}," AI  ",-1))])])):U("",!0),n.value==="system"?(p(),m("div",pg,[e("div",fg,[E[48]||(E[48]=e("div",{class:"section-title"},"",-1)),e("div",mg,[E[46]||(E[46]=e("label",null,"",-1)),e("div",gg,[e("div",{class:"avatar-preview",style:Re({backgroundImage:`url(${v.value})`})},null,4),e("button",{class:"btn btn-secondary",onClick:E[10]||(E[10]=()=>{var ve;return(ve=y.value)==null?void 0:ve.click()})},""),e("input",{ref_key:"userAvatarInput",ref:y,type:"file",accept:"image/*",onChange:O,style:{display:"none"}},null,544)])]),e("div",hg,[E[47]||(E[47]=e("label",null,"",-1)),we(e("input",{type:"text","onUpdate:modelValue":E[11]||(E[11]=ve=>b.value=ve),placeholder:""},null,512),[[Te,b.value]])]),e("div",{class:"setting-item"},[e("button",{class:"btn btn-success",onClick:ee},"")])]),e("div",yg,[E[50]||(E[50]=e("div",{class:"section-title"},"",-1)),e("div",bg,[E[49]||(E[49]=e("label",null,"",-1)),e("input",{type:"file",accept:"image/*",onChange:ce,ref_key:"wallpaperInput",ref:M},null,544)]),A.value?(p(),m("div",wg,[e("img",{src:A.value,alt:""},null,8,kg)])):U("",!0),e("div",{class:"setting-item"},[e("button",{class:"btn btn-success",onClick:ye},"")])]),e("div",xg,[E[53]||(E[53]=e("div",{class:"section-title"},"",-1)),e("div",{class:"setting-item setting-item-clickable",onClick:Ae},[E[52]||(E[52]=e("label",null,"",-1)),(p(),m("svg",Cg,[...E[51]||(E[51]=[e("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"},null,-1)])]))])]),e("div",$g,[E[58]||(E[58]=e("div",{class:"section-title"},"",-1)),e("div",{class:"setting-item setting-item-clickable",onClick:We},[E[55]||(E[55]=e("label",null,"",-1)),(p(),m("svg",_g,[...E[54]||(E[54]=[e("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"},null,-1)])]))]),e("div",{class:"setting-item setting-item-clickable",onClick:Be},[E[57]||(E[57]=e("label",null," ",-1)),(p(),m("svg",Mg,[...E[56]||(E[56]=[e("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"},null,-1)])]))])]),e("div",Sg,[E[63]||(E[63]=e("div",{class:"section-title"},"",-1)),e("div",Ig,[E[60]||(E[60]=e("label",null,"",-1)),e("div",Ag,[e("label",Lg,[we(e("input",{type:"checkbox","onUpdate:modelValue":E[12]||(E[12]=ve=>k.value=ve)},null,512),[[es,k.value]]),E[59]||(E[59]=e("span",{class:"slider"},null,-1))]),e("span",Tg,S(k.value?"":""),1)])]),e("div",jg,[E[62]||(E[62]=e("label",null,"",-1)),e("div",Pg,[e("label",Eg,[we(e("input",{type:"checkbox","onUpdate:modelValue":E[13]||(E[13]=ve=>I.value=ve)},null,512),[[es,I.value]]),E[61]||(E[61]=e("span",{class:"slider"},null,-1))]),e("span",Bg,S(I.value?"":""),1)])])]),e("div",Vg,[E[64]||(E[64]=e("div",{class:"section-title"}," ",-1)),E[65]||(E[65]=e("div",{class:"setting-description",style:{"margin-bottom":"16px"}},"  ",-1)),e("div",Hg,[e("button",{class:"btn btn-primary",onClick:ze,disabled:_.value},S(_.value?"...":" "),9,Dg)]),e("div",Fg,[e("button",{class:"btn btn-secondary",onClick:E[14]||(E[14]=()=>{var ve;return(ve=T.value)==null?void 0:ve.click()}),disabled:$.value},S($.value?"...":" "),9,Ug),e("input",{ref_key:"importFileInput",ref:T,type:"file",accept:".json",onChange:Ce,style:{display:"none"}},null,544)]),E[66]||(E[66]=e("div",{class:"setting-description",style:{"margin-top":"8px",color:"#ff6b6b"}},"   ",-1))])])):U("",!0)])]),e("div",{class:Ie(["toast",{show:q.value}])},S(oe.value),3),e("div",{class:Ie(["font-manager-overlay",{show:g.value}])},[e("div",Ng,[e("div",{class:"font-manager-header"},[e("div",{class:"back-btn",onClick:Je},[...E[67]||(E[67]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})],-1)])]),E[68]||(E[68]=e("h2",null,"",-1)),E[69]||(E[69]=e("div",{style:{width:"40px"}},null,-1))]),e("div",Og,[e("div",Rg,[E[72]||(E[72]=e("div",{class:"section-title"},"",-1)),e("div",zg,[E[71]||(E[71]=e("label",null,"",-1)),e("div",Wg,[e("label",Kg,[we(e("input",{type:"checkbox","onUpdate:modelValue":E[15]||(E[15]=ve=>F.value=ve),onChange:ge},null,544),[[es,F.value]]),E[70]||(E[70]=e("span",{class:"slider"},null,-1))]),e("span",Gg,S(F.value?"":""),1)])]),E[73]||(E[73]=e("div",{class:"setting-description"},"  ",-1))]),e("div",qg,[E[74]||(E[74]=e("div",{class:"section-title"},"",-1)),e("div",Zg,[(p(!0),m(Pe,null,Fe(x.value,ve=>(p(),m("div",{key:ve.name,class:"font-item"},[e("div",Jg,[e("img",{src:ve.iconSrc,class:"app-icon-preview"},null,8,Yg),e("div",Xg,S(ve.name),1)]),e("div",Qg,[e("button",{class:"font-btn apply-btn",onClick:()=>le(ve.name)},"",8,eh),ve.isCustom?(p(),m("button",{key:0,class:"font-btn delete-btn",onClick:Ye=>ke(ve.name)},"",8,th)):U("",!0)])]))),128))])])])])],2),e("input",{ref_key:"iconFileInput",ref:H,type:"file",accept:"image/*",onChange:He,style:{display:"none"}},null,544),e("div",{class:Ie(["font-manager-overlay",{show:L.value}])},[e("div",sh,[e("div",{class:"font-manager-header"},[e("div",{class:"back-btn",onClick:vt},[...E[75]||(E[75]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})],-1)])]),E[76]||(E[76]=e("h2",null," ",-1)),E[77]||(E[77]=e("div",{style:{width:"40px"}},null,-1))]),e("div",oh,[e("div",nh,[e("div",{class:Ie(["customizer-tab",{active:ae.value==="css"}]),onClick:E[16]||(E[16]=ve=>ae.value="css")}," CSS  ",2),e("div",{class:Ie(["customizer-tab",{active:ae.value==="html"}]),onClick:E[17]||(E[17]=ve=>ae.value="html")}," HTML  ",2),e("div",{class:Ie(["customizer-tab",{active:ae.value==="preview"}]),onClick:E[18]||(E[18]=ve=>ae.value="preview")},"  ",2)]),ae.value==="css"?(p(),m("div",ah,[e("div",{class:"editor-header"},[E[78]||(E[78]=e("span",null," CSS ",-1)),e("button",{class:"btn btn-secondary",onClick:pt},"")]),we(e("textarea",{"onUpdate:modelValue":E[19]||(E[19]=ve=>de.value=ve),class:"code-editor",placeholder:`/*  CSS */
.phone-container {
  /*  */
}

.app-grid {
  /*  */
}`,spellcheck:"false"},null,512),[[Te,de.value]]),E[79]||(E[79]=e("div",{class:"editor-hint"},'  """" ',-1))])):U("",!0),ae.value==="html"?(p(),m("div",lh,[e("div",{class:"editor-header"},[E[80]||(E[80]=e("span",null," HTML ",-1)),e("button",{class:"btn btn-secondary",onClick:re},"")]),we(e("textarea",{"onUpdate:modelValue":E[20]||(E[20]=ve=>ue.value=ve),class:"code-editor",placeholder:`<!--  HTML -->
<div class='custom-widget'>
  <h3></h3>
  <p>~</p>
</div>`,spellcheck:"false"},null,512),[[Te,ue.value]]),E[81]||(E[81]=e("div",{class:"editor-hint"},"   CSS ~ ",-1))])):U("",!0),ae.value==="preview"?(p(),m("div",ih,[e("div",{class:"preview-header"},[E[82]||(E[82]=e("span",null,"",-1)),e("button",{class:"btn btn-primary",onClick:te},"")]),e("div",rh,[e("div",ch,[de.value?(p(),st(_a("style"),{key:0},{default:ho(()=>[Qe(S(de.value),1)]),_:1})):U("",!0),e("div",dh,[e("div",uh,[e("div",vh,[e("span",null,S(me.currentTime),1)]),E[83]||(E[83]=e("div",{class:"status-bar-right"},[e("svg",{class:"status-icon-svg",viewBox:"0 0 24 24"},[e("path",{d:"M20,20h2v-2h-2V20z M18,20h-2v-4h2V20z"})])],-1))]),e("div",ph,[e("div",fh,[e("div",mh,S(me.currentTime),1),e("div",gh,S($e.value),1)])]),ue.value?(p(),m("div",{key:0,class:"custom-html-container",innerHTML:ue.value},null,8,hh)):U("",!0),E[84]||(E[84]=dt('<div class="app-grid" data-v-93c63975><div class="app-icon-preview" data-v-93c63975><div class="icon-bg" data-v-93c63975></div><span data-v-93c63975>App</span></div><div class="app-icon-preview" data-v-93c63975><div class="icon-bg" data-v-93c63975></div><span data-v-93c63975>Chat</span></div></div><div class="bottom-bar" data-v-93c63975><div class="app-icon-preview" data-v-93c63975><div class="icon-bg" data-v-93c63975></div></div><div class="app-icon-preview" data-v-93c63975><div class="icon-bg" data-v-93c63975></div></div></div>',2))])],512)]),E[85]||(E[85]=e("div",{class:"preview-hint"},"   CSS  HTML  ",-1))])):U("",!0)]),e("div",{class:"customizer-footer"},[e("button",{class:"btn btn-cancel",onClick:vt},""),e("button",{class:"btn btn-success",onClick:pe}," ")])])],2),e("div",{class:Ie(["font-manager-overlay",{show:se.value}])},[e("div",yh,[e("div",{class:"font-manager-header"},[e("div",{class:"back-btn",onClick:Me},[...E[86]||(E[86]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})],-1)])]),E[87]||(E[87]=e("h2",null,"",-1)),E[88]||(E[88]=e("div",{style:{width:"40px"}},null,-1))]),e("div",bh,[e("div",wh,[E[90]||(E[90]=e("div",{class:"section-title"},"",-1)),e("div",{class:"font-preview-text",style:Re({fontFamily:P.value})},[...E[89]||(E[89]=[Qe(" The quick brown fox jumps over the lazy dog",-1),e("br",null,null,-1),Qe("  0123456789 ",-1)])],4)]),e("div",kh,[E[94]||(E[94]=e("div",{class:"section-title"},"",-1)),e("div",{class:"upload-area",onClick:E[21]||(E[21]=()=>{var ve;return(ve=J.value)==null?void 0:ve.click()})},[(p(),m("svg",xh,[...E[91]||(E[91]=[e("path",{d:"M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"},null,-1)])])),E[92]||(E[92]=e("div",{class:"upload-text"},"",-1)),E[93]||(E[93]=e("div",{class:"upload-hint"}," .ttf, .otf, .woff, .woff2 ",-1)),e("input",{ref_key:"fontFileInput",ref:J,type:"file",accept:".ttf,.otf,.woff,.woff2",onChange:be,style:{display:"none"}},null,544)])]),e("div",Ch,[E[95]||(E[95]=e("div",{class:"section-title"},"",-1)),we(e("input",{type:"text","onUpdate:modelValue":E[22]||(E[22]=ve=>N.value=ve),placeholder:" URL  Google Fonts ",class:"font-url-input"},null,512),[[Te,N.value]]),e("button",{class:"btn btn-secondary",onClick:Ne,style:{"margin-top":"12px",width:"100%"}},"  ")]),e("div",$h,[E[96]||(E[96]=e("div",{class:"section-title"},"",-1)),e("div",_h,[(p(!0),m(Pe,null,Fe(f.value,ve=>(p(),m("div",{key:ve.name,class:Ie(["font-item",{active:P.value===ve.family}]),onClick:Ye=>Ee(ve.family)},[e("div",{class:"font-item-name",style:Re({fontFamily:ve.family})},S(ve.name),5),e("div",Sh,[P.value===ve.family?(p(),m("button",Ih,"")):(p(),m("button",Ah,"")),ve.isSystem?U("",!0):(p(),m("button",{key:2,class:"font-btn delete-btn",onClick:je(Ye=>De(ve.name),["stop"])},"",8,Lh))])],10,Mh))),128))])])])])],2)]))}},jh=Ze(Th,[["__scopeId","data-v-93c63975"]]),Ph={class:"notifications-container"},Eh=["onClick","onTouchstart","onTouchend"],Bh=["src"],Vh={class:"notification-content"},Hh={class:"notification-name"},Dh={class:"notification-message"},Fh={class:"notification-time"},Uh=["onClick"],Nh={__name:"GlobalNotification",emits:["navigate-to-chat"],setup(t,{emit:s}){const o=h([]);let n=0,a=0,l=null;const i=s,r=y=>{o.value=y.map(M=>({...M,timeText:Lt.formatTime(M.timestamp)}))},c=y=>{y.contactId&&i("navigate-to-chat",{contactId:y.contactId,contactName:y.name,contactAvatar:y.avatar}),d(y.id)},d=y=>{Lt.removeNotification(y)},u=(y,M)=>{n=y.touches[0].clientX,a=y.touches[0].clientY,l=M},v=y=>{if(!l)return;const M=y.touches[0].clientX,A=y.touches[0].clientY,w=M-n,k=A-a;if(Math.abs(w)>Math.abs(k)&&Math.abs(w)>10){y.preventDefault();const I=y.currentTarget;I.style.transform=`translateX(${w}px)`,I.style.opacity=Math.max(0,1-Math.abs(w)/200)}},b=y=>{if(!l)return;const M=event.currentTarget,A=event.changedTouches[0].clientX-n;Math.abs(A)>100?(M.style.transition="all 0.3s ease-out",M.style.transform=`translateX(${A>0?"400px":"-400px"})`,M.style.opacity="0",setTimeout(()=>{d(y.id),M.style.transition="",M.style.transform="",M.style.opacity=""},300)):(M.style.transition="all 0.2s ease-out",M.style.transform="translateX(0)",M.style.opacity="1",setTimeout(()=>{M.style.transition=""},200)),l=null};return nt(()=>{Lt.addListener(r),window.addEventListener("show-global-notification",y=>{const M=y.detail;Lt.addNotification({contactId:M.contactId,name:M.name,avatar:M.avatar,message:M.message,type:"legacy"})}),window.addEventListener("show-moment-notification",y=>{const M=y.detail;Lt.addNotification({contactId:M.contactId,name:M.message||"",avatar:"https://via.placeholder.com/40?text=",message:"",type:"moment"})})}),Dt(()=>{Lt.removeListener(r)}),(y,M)=>(p(),m("div",Ph,[(p(!0),m(Pe,null,Fe(o.value,(A,w)=>(p(),m("div",{key:A.id,class:"global-notification",style:{top:"20px",zIndex:10001},onClick:k=>c(A),onTouchstart:k=>u(k,A),onTouchmove:v,onTouchend:k=>b(A)},[e("img",{src:A.avatar,class:"notification-avatar"},null,8,Bh),e("div",Vh,[e("div",Hh,S(A.name),1),e("div",Dh,S(A.message),1),e("div",Fh,S(A.timeText),1)]),e("button",{class:"notification-close",onClick:je(k=>d(A.id),["stop"])},"",8,Uh)],40,Eh))),128))]))}},Oh=Ze(Nh,[["__scopeId","data-v-43d4d770"]]),Rh={class:"notification-text"},zh={__name:"DiaryNotification",setup(t,{expose:s}){const o=h(!1),n=h("");let a=null;const l=d=>{n.value=d.message,o.value=!0,a&&clearTimeout(a),a=setTimeout(()=>{i()},5e3)},i=()=>{o.value=!1,a&&(clearTimeout(a),a=null)},r=()=>{i()},c=d=>{l(d.detail)};return nt(()=>{window.addEventListener("show-diary-notification",c)}),Dt(()=>{window.removeEventListener("show-diary-notification",c),a&&clearTimeout(a)}),s({showNotification:l,close:i}),(d,u)=>o.value?(p(),m("div",{key:0,class:"diary-notification",onClick:r},[u[0]||(u[0]=e("div",{class:"notification-icon"},"",-1)),e("div",Rh,S(n.value),1),e("button",{class:"notification-close",onClick:je(i,["stop"])},"")])):U("",!0)}},Wh=Ze(zh,[["__scopeId","data-v-b4643fe4"]]),Kh={class:"music-player"},Gh={class:"player-content"},qh={class:"album-cover"},Zh=["src","alt"],Jh={class:"cover-overlay"},Yh={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},Xh={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},Qh={class:"song-info"},e2={class:"song-title"},t2={class:"song-artist"},s2={class:"progress-section"},o2={class:"progress-time"},n2={class:"progress-bar"},a2={class:"progress-time"},l2={class:"player-controls"},i2={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},r2={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},c2={class:"extra-controls"},d2={key:0,viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor"},u2={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},v2={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},p2={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},f2={__name:"MusicPlayer",setup(t){const s=h(!1),o=h(0),n=h(!1),a=h("off"),l=h(0),i=h([{id:1,title:"",artist:"",cover:"https://picsum.photos/200/200?random=1",duration:269,isFavorite:!0},{id:2,title:"",artist:"",cover:"https://picsum.photos/200/200?random=2",duration:300,isFavorite:!1},{id:3,title:"",artist:"",cover:"https://picsum.photos/200/200?random=3",duration:223,isFavorite:!0},{id:4,title:"",artist:"",cover:"https://picsum.photos/200/200?random=4",duration:213,isFavorite:!1}]),r=ot(()=>i.value[l.value]),c=ot(()=>r.value.duration?o.value/r.value.duration*100:0),d=()=>{s.value=!s.value},u=()=>{l.value>0?l.value--:l.value=i.value.length-1,o.value=0,s.value},v=()=>{if(n.value){let I;do I=Math.floor(Math.random()*i.value.length);while(I===l.value&&i.value.length>1);l.value=I}else l.value<i.value.length-1?l.value++:l.value=0;o.value=0,s.value},b=()=>{n.value=!n.value},y=()=>{a.value==="off"?a.value="all":a.value==="all"?a.value="one":a.value="off"},M=()=>{r.value.isFavorite=!r.value.isFavorite},A=I=>{const _=I.currentTarget.getBoundingClientRect(),T=(I.clientX-_.left)/_.width;o.value=T*r.value.duration},w=I=>{const _=Math.floor(I/60),$=Math.floor(I%60);return`${_}:${$.toString().padStart(2,"0")}`};let k=null;return nt(()=>{k=setInterval(()=>{s.value&&(o.value+=1,o.value>=r.value.duration&&(a.value==="one"?o.value=0:a.value==="all"||n.value?v():(s.value=!1,o.value=0)))},1e3)}),Dt(()=>{k&&clearInterval(k)}),(I,_)=>(p(),m("div",Kh,[_[11]||(_[11]=e("div",{class:"player-header"},[e("span",{class:"player-icon"},""),e("span",{class:"player-title"},"")],-1)),e("div",Gh,[e("div",qh,[e("img",{src:r.value.cover,alt:r.value.title,class:Ie(["cover-image",{rotating:s.value}])},null,10,Zh),e("div",Jh,[e("button",{class:"play-pause-btn-large",onClick:d},[s.value?(p(),m("svg",Yh,[..._[0]||(_[0]=[e("rect",{x:"6",y:"4",width:"4",height:"16","stroke-width":"2","stroke-linecap":"round"},null,-1),e("rect",{x:"14",y:"4",width:"4",height:"16","stroke-width":"2","stroke-linecap":"round"},null,-1)])])):(p(),m("svg",Xh,[..._[1]||(_[1]=[e("polygon",{points:"5 3 19 12 5 21 5 3","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))])])]),e("div",Qh,[e("div",e2,S(r.value.title),1),e("div",t2,S(r.value.artist),1)]),e("div",s2,[e("div",o2,S(w(o.value)),1),e("div",{class:"progress-bar-container",onClick:A},[e("div",n2,[e("div",{class:"progress-fill",style:Re({width:c.value+"%"})},null,4),e("div",{class:"progress-thumb",style:Re({left:c.value+"%"})},null,4)])]),e("div",a2,S(w(r.value.duration)),1)]),e("div",l2,[e("button",{class:"control-btn",onClick:u},[..._[2]||(_[2]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("polygon",{points:"19 20 9 12 19 4 19 20","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("line",{x1:"5",y1:"19",x2:"5",y2:"5","stroke-width":"2","stroke-linecap":"round"})],-1)])]),e("button",{class:"control-btn play-pause",onClick:d},[s.value?(p(),m("svg",i2,[..._[3]||(_[3]=[e("rect",{x:"6",y:"4",width:"4",height:"16","stroke-width":"2","stroke-linecap":"round"},null,-1),e("rect",{x:"14",y:"4",width:"4",height:"16","stroke-width":"2","stroke-linecap":"round"},null,-1)])])):(p(),m("svg",r2,[..._[4]||(_[4]=[e("polygon",{points:"5 3 19 12 5 21 5 3","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))]),e("button",{class:"control-btn",onClick:v},[..._[5]||(_[5]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("polygon",{points:"5 4 15 12 5 20 5 4","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("line",{x1:"19",y1:"5",x2:"19",y2:"19","stroke-width":"2","stroke-linecap":"round"})],-1)])])]),e("div",c2,[e("button",{class:Ie(["extra-btn",{active:n.value}]),onClick:b},[..._[6]||(_[6]=[dt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-9fdac3e9><polyline points="16 3 21 3 21 8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-9fdac3e9></polyline><line x1="4" y1="20" x2="21" y2="3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-9fdac3e9></line><polyline points="21 16 21 21 16 21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-9fdac3e9></polyline><line x1="15" y1="15" x2="21" y2="21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-9fdac3e9></line><line x1="4" y1="4" x2="9" y2="9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-9fdac3e9></line></svg>',1)])],2),e("button",{class:"extra-btn",onClick:M},[r.value.isFavorite?(p(),m("svg",d2,[..._[7]||(_[7]=[e("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):(p(),m("svg",u2,[..._[8]||(_[8]=[e("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))]),e("button",{class:Ie(["extra-btn",{active:a.value!=="off"}]),onClick:y},[a.value==="one"?(p(),m("svg",v2,[..._[9]||(_[9]=[dt('<polyline points="17 1 21 5 17 9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-9fdac3e9></polyline><path d="M3 11V9a4 4 0 0 1 4-4h14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-9fdac3e9></path><polyline points="7 23 3 19 7 15" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-9fdac3e9></polyline><path d="M21 13v2a4 4 0 0 1-4 4H3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-9fdac3e9></path><text x="12" y="16" text-anchor="middle" font-size="8" fill="currentColor" font-weight="bold" data-v-9fdac3e9>1</text>',5)])])):(p(),m("svg",p2,[..._[10]||(_[10]=[e("polyline",{points:"17 1 21 5 17 9","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("path",{d:"M3 11V9a4 4 0 0 1 4-4h14","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("polyline",{points:"7 23 3 19 7 15","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("path",{d:"M21 13v2a4 4 0 0 1-4 4H3","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))],2)])])]))}},m2=Ze(f2,[["__scopeId","data-v-9fdac3e9"]]),g2={class:"notification-panel-wrapper"},h2={class:"status-bar"},y2={class:"status-time"},b2={class:"quick-settings"},w2={class:"notifications-section"},k2={key:0,class:"no-notifications"},x2={key:1,class:"notifications-list"},C2=["onClick"],$2={class:"notification-icon"},_2={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},M2={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},S2={key:2,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},I2={class:"notification-content"},A2={class:"notification-title"},L2={class:"notification-message"},T2={class:"notification-time"},j2=["onClick"],P2={__name:"NotificationPanel",emits:["notification-click"],setup(t,{expose:s,emit:o}){const n=o,a=h(!0),l=h(!1),i=h(-1e3),r=h(0),c=h(0),d=h(!1),u=h(!0),v=h(!1),b=h(!1),y=h(!1);h(80),h(50);const M=h(""),A=h([{id:1,iconType:"message",title:"",message:"",time:"5",app:"wechat"},{id:2,iconType:"email",title:"",message:"",time:"1",app:"email"}]),w=()=>{const x=new Date,L=String(x.getHours()).padStart(2,"0"),ae=String(x.getMinutes()).padStart(2,"0");M.value=`${L}:${ae}`},k=x=>{const L=x.touches[0];r.value=L.clientY,c.value=Date.now(),d.value=!0,console.log(":",L.clientY)},I=x=>{r.value=x.clientY,c.value=Date.now(),d.value=!0,x.preventDefault(),console.log(":",x.clientY)},_=x=>{if(!d.value)return;const ae=x.touches[0].clientY-r.value;l.value?ae<0?i.value=Math.max(ae,-500):i.value=Math.min(ae*.3,50):ae>0&&(i.value=Math.min(ae-1e3,0),ae>20&&(l.value=!0))},$=x=>{if(!d.value)return;const L=x.clientY-r.value;console.log(" deltaY:",L,"isVisible:",l.value),l.value?L<0?i.value=Math.max(L,-500):i.value=Math.min(L*.3,50):L>0&&(i.value=Math.min(L-1e3,0),L>20&&(l.value=!0)),x.preventDefault()},T=()=>{if(!d.value)return;const x=Date.now()-c.value,L=i.value;l.value?L<-50||L<0&&x<300?se():oe():L>-50?oe():se(),d.value=!1},q=()=>{if(!d.value)return;const x=Date.now()-c.value,L=i.value;l.value?L<-50||L<0&&x<300?se():oe():L>-50?oe():se(),d.value=!1},oe=()=>{l.value=!0,i.value=0},se=()=>{l.value=!1,i.value=-1e3},J=()=>{u.value=!u.value},N=()=>{v.value=!v.value},P=()=>{b.value=!b.value},f=()=>{y.value=!y.value},g=x=>{n("notification-click",x),se()},H=x=>{const L=A.value.findIndex(ae=>ae.id===x);L>-1&&A.value.splice(L,1)},K=()=>{A.value=[]};return s({addNotification:x=>{const L={id:Date.now(),time:"",...x};A.value.unshift(L)},openPanel:oe,closePanel:se,setTriggerAreaVisible:x=>{a.value=x}}),nt(()=>{w();const x=setInterval(w,6e4);document.addEventListener("mousemove",$),document.addEventListener("mouseup",q),Dt(()=>{clearInterval(x),document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",q)})}),(x,L)=>(p(),m("div",g2,[a.value?(p(),m("div",{key:0,class:"trigger-area",onTouchstart:k,onTouchmove:_,onTouchend:T,onMousedown:I},null,32)):U("",!0),Ge(Ki,{name:"fade"},{default:ho(()=>[l.value?(p(),m("div",{key:0,class:"overlay",onClick:se})):U("",!0)]),_:1}),e("div",{class:Ie(["notification-panel",{"is-visible":l.value}]),style:Re(l.value?{transform:`translateY(${i.value}px)`}:{transform:"translateY(-100%)"}),onMousedown:I,onTouchstart:k},[e("div",h2,[e("div",y2,S(M.value),1),L[0]||(L[0]=dt('<div class="status-icons" data-v-a8861fd9><svg class="status-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-a8861fd9><path d="M5 12.55a11 11 0 0 1 14.08 0" stroke-width="2" stroke-linecap="round" data-v-a8861fd9></path><path d="M1.42 9a16 16 0 0 1 21.16 0" stroke-width="2" stroke-linecap="round" data-v-a8861fd9></path><path d="M8.53 16.11a6 6 0 0 1 6.95 0" stroke-width="2" stroke-linecap="round" data-v-a8861fd9></path><circle cx="12" cy="20" r="1" fill="currentColor" data-v-a8861fd9></circle></svg><svg class="status-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-a8861fd9><path d="M12 2v20M17 7l-5 5-5-5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-a8861fd9></path></svg><svg class="status-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-a8861fd9><rect x="5" y="4" width="14" height="18" rx="2" stroke-width="2" data-v-a8861fd9></rect><path d="M8 18h8" stroke-width="2" stroke-linecap="round" data-v-a8861fd9></path></svg></div>',1))]),L[16]||(L[16]=e("div",{class:"pull-indicator"},[e("div",{class:"indicator-bar"})],-1)),e("div",b2,[e("div",{class:"quick-setting-item",onClick:J},[e("div",{class:Ie(["setting-icon",{active:u.value}])},[...L[1]||(L[1]=[dt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-a8861fd9><path d="M5 12.55a11 11 0 0 1 14.08 0" stroke-width="2" stroke-linecap="round" data-v-a8861fd9></path><path d="M1.42 9a16 16 0 0 1 21.16 0" stroke-width="2" stroke-linecap="round" data-v-a8861fd9></path><path d="M8.53 16.11a6 6 0 0 1 6.95 0" stroke-width="2" stroke-linecap="round" data-v-a8861fd9></path><circle cx="12" cy="20" r="1" fill="currentColor" data-v-a8861fd9></circle></svg>',1)])],2),L[2]||(L[2]=e("div",{class:"setting-label"},"WiFi",-1))]),e("div",{class:"quick-setting-item",onClick:N},[e("div",{class:Ie(["setting-icon",{active:v.value}])},[...L[3]||(L[3]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M6.5 6.5l11 11L12 23V1l5.5 5.5-11 11","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])],2),L[4]||(L[4]=e("div",{class:"setting-label"},"",-1))]),e("div",{class:"quick-setting-item",onClick:P},[e("div",{class:Ie(["setting-icon",{active:b.value}])},[...L[5]||(L[5]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M9 2h6l3 7v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V9l3-7z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M9 9h6","stroke-width":"2","stroke-linecap":"round"})],-1)])],2),L[6]||(L[6]=e("div",{class:"setting-label"},"",-1))]),e("div",{class:"quick-setting-item",onClick:f},[e("div",{class:Ie(["setting-icon",{active:y.value}])},[...L[7]||(L[7]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M10.5 3L3 11l9 1 1 9 7.5-8-9-1-1-9z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])],2),L[8]||(L[8]=e("div",{class:"setting-label"},"",-1))])]),Ge(m2),e("div",w2,[e("div",{class:"section-header"},[L[9]||(L[9]=e("span",null,"",-1)),e("button",{class:"clear-all-btn",onClick:K},"")]),A.value.length===0?(p(),m("div",k2,[...L[10]||(L[10]=[e("svg",{class:"no-notifications-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M13.73 21a2 2 0 0 1-3.46 0","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),e("div",{class:"no-notifications-text"},"",-1)])])):(p(),m("div",x2,[(p(!0),m(Pe,null,Fe(A.value,ae=>(p(),m("div",{key:ae.id,class:"notification-item",onClick:de=>g(ae)},[e("div",$2,[ae.iconType==="message"?(p(),m("svg",_2,[...L[11]||(L[11]=[e("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):ae.iconType==="email"?(p(),m("svg",M2,[...L[12]||(L[12]=[e("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("polyline",{points:"22,6 12,13 2,6","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):(p(),m("svg",S2,[...L[13]||(L[13]=[e("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))]),e("div",I2,[e("div",A2,S(ae.title),1),e("div",L2,S(ae.message),1),e("div",T2,S(ae.time),1)]),e("button",{class:"notification-close",onClick:je(de=>H(ae.id),["stop"])},[...L[14]||(L[14]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M18 6L6 18M6 6l12 12","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])],8,j2)],8,C2))),128))]))]),e("div",{class:"bottom-close-section"},[e("button",{class:"bottom-close-btn",onClick:se},[...L[15]||(L[15]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M18 15l-6-6-6 6","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),e("span",null,"",-1)])])])],38)]))}},E2=Ze(P2,[["__scopeId","data-v-a8861fd9"]]),B2={class:"moment-create-card"},V2={class:"moment-create-header"},H2={class:"moment-create-body"},D2={key:0,class:"image-preview"},F2=["src"],U2={class:"bottom-row"},N2={class:"tools"},O2={class:"mention-search-row"},R2={class:"mention-list",role:"listbox","aria-label":""},z2={key:0,class:"mention-empty"},W2={key:1,class:"mention-empty"},K2=["checked","onChange"],G2={class:"mention-name"},q2={key:0,class:"mention-sub"},Z2={key:2,class:"mentions"},J2={__name:"MomentCreate",emits:["close","submit"],setup(t,{emit:s}){const o=s,n=h({text:"",image:"",mentions:[],visibility:"public"}),a=h(null),l=h(null),i=h({start:0,end:0}),r=h(!1),c=h(null),d=h(""),u=h(!1),v=h([]),b=()=>{var P;(P=a.value)==null||P.click()},y=P=>{var H;const f=(H=P.target.files)==null?void 0:H[0];if(!f)return;const g=new FileReader;g.onload=K=>{n.value.image=K.target.result},g.readAsDataURL(f)},M=()=>{n.value.image="",a.value&&(a.value.value="")},A=()=>{const P=l.value;if(!P)return;const f=P.selectionStart??0,g=P.selectionEnd??f;i.value={start:f,end:g}},w=async()=>{u.value=!0;try{v.value=await C.getContacts()}catch(P){console.error(":",P),v.value=[]}finally{u.value=!1}},k=async()=>{var P,f;r.value=!0,d.value="",await w(),await zt(),(f=(P=c.value)==null?void 0:P.focus)==null||f.call(P)},I=()=>{r.value=!1},_=ot(()=>{const P=(d.value||"").trim().toLowerCase(),f=Array.isArray(v.value)?v.value:[];return P?f.filter(g=>{const H=((g==null?void 0:g.name)||"").toString().toLowerCase(),K=((g==null?void 0:g.bio)||"").toString().toLowerCase();return H.includes(P)||K.includes(P)}):f}),$=P=>((P==null?void 0:P.name)||"").toString().replace(/^@+/,"").trim(),T=P=>{const f=$(P);return f?n.value.mentions.includes(f):!1},q=async P=>{const f=l.value,g=n.value.text||"",H=Math.min(i.value.start||0,g.length),K=Math.min(i.value.end||H,g.length),F=(f==null?void 0:f.selectionStart)??H,x=(f==null?void 0:f.selectionEnd)??K;n.value.text=g.slice(0,F)+P+g.slice(x),await zt();try{f.focus();const L=F+P.length;f.setSelectionRange(L,L),i.value={start:L,end:L}}catch{}},oe=async P=>{const f=$(P);if(!f)return;if(n.value.mentions.includes(f)){n.value.mentions=n.value.mentions.filter(H=>H!==f);return}n.value.mentions=Array.from(new Set([...n.value.mentions,f])),await q(`@${f} `)},se=ot(()=>{switch(n.value.visibility){case"friends":return"";case"private":return"";default:return""}}),J=()=>{const P=n.value.visibility;n.value.visibility=P==="public"?"friends":P==="friends"?"private":"public"},N=()=>{const P={...n.value};o("submit",P)};return(P,f)=>(p(),m("div",{class:"moment-create-mask",onClick:f[4]||(f[4]=je(g=>o("close"),["self"]))},[e("div",B2,[e("header",V2,[f[5]||(f[5]=e("span",{class:"title"}," ",-1)),e("button",{class:"close-btn",onClick:f[0]||(f[0]=g=>o("close"))},"")]),e("section",H2,[we(e("textarea",{ref_key:"textareaRef",ref:l,"onUpdate:modelValue":f[1]||(f[1]=g=>n.value.text=g),class:"main-textarea",rows:"6",placeholder:"...()",onClick:A,onKeyup:A,onSelect:A},null,544),[[Te,n.value.text]]),n.value.image?(p(),m("div",D2,[e("img",{src:n.value.image,alt:""},null,8,F2),e("button",{class:"remove-preview",onClick:M},"")])):U("",!0),e("div",U2,[e("div",N2,[e("button",{class:"tool-btn",onClick:b,"aria-label":""},[...f[6]||(f[6]=[e("svg",{class:"tool-icon",viewBox:"0 0 24 24","aria-hidden":"true"},[e("path",{d:"M7 3h10a3 3 0 0 1 3 3v12a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3Z",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linejoin":"round"}),e("path",{d:"M7 16l3.2-3.2a1.4 1.4 0 0 1 2 0L15 15.6l1.2-1.2a1.4 1.4 0 0 1 2 0L20 16.2",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M9 9.2a1.6 1.6 0 1 0 0 .1Z",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)])]),e("input",{ref_key:"fileInput",ref:a,type:"file",accept:"image/*",class:"hidden-input",onChange:y},null,544),e("button",{class:"tool-btn",onClick:k,"aria-label":""},[...f[7]||(f[7]=[e("span",{class:"at-text"},"@",-1)])])]),e("button",{class:"visibility-pill",onClick:J},[f[8]||(f[8]=e("svg",{class:"pill-icon",viewBox:"0 0 24 24","aria-hidden":"true"},[e("path",{d:"M12 21a9 9 0 1 0-9-9 9 9 0 0 0 9 9Z",fill:"none",stroke:"currentColor","stroke-width":"2"}),e("path",{d:"M3.5 12h17",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),e("path",{d:"M12 3c2.6 2.7 4.1 5.8 4.1 9s-1.5 6.3-4.1 9c-2.6-2.7-4.1-5.8-4.1-9S9.4 5.7 12 3Z",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linejoin":"round"})],-1)),Qe(" "+S(se.value),1)])]),r.value?(p(),m("div",{key:1,class:"mention-popover",onClick:f[3]||(f[3]=je(()=>{},["stop"]))},[e("div",{class:"mention-popover-header"},[f[9]||(f[9]=e("span",{class:"mention-popover-title"}," @ ",-1)),e("button",{class:"mention-close",onClick:I,"aria-label":""},"")]),e("div",O2,[we(e("input",{ref_key:"mentionSearchRef",ref:c,"onUpdate:modelValue":f[2]||(f[2]=g=>d.value=g),type:"text",placeholder:"",class:"mention-search"},null,512),[[Te,d.value]]),e("button",{class:"mention-done",onClick:I},"")]),e("div",R2,[u.value?(p(),m("div",z2,"...")):_.value.length===0?(p(),m("div",W2,"")):(p(!0),m(Pe,{key:2},Fe(_.value,g=>(p(),m("label",{key:g.id??g.name,class:"mention-item"},[e("input",{class:"mention-checkbox",type:"checkbox",checked:T(g),onChange:H=>oe(g)},null,40,K2),e("span",G2,S(g.name||""),1),g.bio?(p(),m("span",q2,S(g.bio),1)):U("",!0)]))),128))])])):U("",!0),n.value.mentions.length?(p(),m("div",Z2,[(p(!0),m(Pe,null,Fe(n.value.mentions,g=>(p(),m("span",{key:g,class:"mention-chip"},"@"+S(g),1))),128))])):U("",!0)]),e("footer",{class:"moment-create-actions"},[e("button",{class:"publish-btn",onClick:N},"")])])]))}},Y2=Ze(J2,[["__scopeId","data-v-bb817b83"]]),X2={class:"contact-card-setting-overlay"},Q2={class:"setting-panel"},ey={class:"header"},ty={class:"contact-info"},sy={class:"contact-name"},oy={class:"content"},ny={class:"tip-box"},ay={class:"cards-grid"},ly=["onClick"],iy=["onClick"],ry={key:0,class:"clear-section"},cy={__name:"ContactCardSetting",props:{contact:{type:Object,required:!0}},emits:["close","save"],setup(t,{emit:s}){const o=t,n=s,a=h([]),l=h(""),i=h(null);nt(async()=>{try{const k=await C.getSetting("moment_contact_cards")||{};a.value=k[o.contact.id]||[]}catch(w){console.error(":",w)}});const r=()=>{i.value&&i.value.click()},c=async w=>{const k=w.target.files;if(!(!k||k.length===0)){try{const I=Array.from(k).map($=>new Promise((T,q)=>{const oe=new FileReader;oe.onload=se=>T(se.target.result),oe.onerror=q,oe.readAsDataURL($)})),_=await Promise.all(I);a.value=[...a.value,..._],A(` ${_.length} `)}catch(I){console.error(":",I),A("")}w.target.value=""}},d=w=>{confirm("")&&(a.value.splice(w,1),A(""))},u=()=>{confirm("")&&(a.value=[],A(""))},v=()=>{n("save",o.contact.id,a.value)},b=()=>{n("close")},y=w=>{l.value=w},M=()=>{l.value=""},A=w=>{const k=document.createElement("div");k.className="kawaii-toast",k.textContent=w,document.body.appendChild(k),k.offsetHeight,k.style.opacity="1",setTimeout(()=>{k.style.opacity="0",setTimeout(()=>k.remove(),300)},2e3)};return(w,k)=>(p(),m("div",X2,[e("div",Q2,[e("div",ey,[e("button",{class:"back-btn",onClick:b},""),e("div",ty,[e("div",{class:"contact-avatar",style:Re({backgroundImage:`url(${t.contact.avatar})`})},null,4),e("div",sy,S(t.contact.name),1)]),e("button",{class:"save-btn",onClick:v},"")]),e("div",oy,[e("div",ny,[e("p",null,"  "+S(t.contact.name)+" ",1),k[0]||(k[0]=e("p",null," ",-1))]),e("div",{class:"add-card-btn",onClick:r},[...k[1]||(k[1]=[e("div",{class:"add-icon"},"+",-1),e("div",{class:"add-text"},"",-1)])]),e("div",ay,[(p(!0),m(Pe,null,Fe(a.value,(I,_)=>(p(),m("div",{key:_,class:"card-item",onClick:$=>y(I)},[e("div",{class:"card-image",style:Re({backgroundImage:`url(${I})`})},null,4),e("button",{class:"delete-btn",onClick:je($=>d(_),["stop"])},"",8,iy)],8,ly))),128))]),a.value.length>0?(p(),m("div",ry,[e("button",{class:"clear-btn",onClick:u},"   ")])):U("",!0)])]),l.value?(p(),m("div",{key:0,class:"preview-overlay",onClick:M},[e("div",{class:"preview-image",style:Re({backgroundImage:`url(${l.value})`})},null,4)])):U("",!0),e("input",{ref_key:"fileInput",ref:i,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:c},null,544)]))}},dy=Ze(cy,[["__scopeId","data-v-cd6cdba3"]]),uy={class:"card-manager-fullscreen"},vy={class:"tabs"},py={key:0,class:"content"},fy={class:"cards-grid"},my=["onClick"],gy=["onClick"],hy={key:0,class:"empty-state"},yy={key:1,class:"content"},by={class:"contacts-list"},wy=["onClick"],ky={class:"contact-info"},xy={class:"contact-name"},Cy={class:"contact-status"},$y={key:0,class:"empty-state"},_y={__name:"CardManager",emits:["close"],setup(t,{emit:s}){const o=s,n=h("public"),a=h([]),l=h([]),i=h({}),r=h(!1),c=h(null),d=h(""),u=h(null);nt(async()=>{await v(),await b(),await y()});const v=async()=>{try{const J=await C.getSetting("moment_public_cards");a.value=J||[]}catch(J){console.error(":",J)}},b=async()=>{try{const J=await C.getContacts();l.value=J||[]}catch(J){console.error(":",J)}},y=async()=>{try{const J=await C.getSetting("moment_contact_cards");i.value=J||{}}catch(J){console.error(":",J)}},M=J=>{const N=i.value[J];return N&&N.length>0?` ${N.length} `:""},A=()=>{u.value&&u.value.click()},w=async J=>{const N=J.target.files;if(!(!N||N.length===0)){try{const P=Array.from(N).map(g=>new Promise((H,K)=>{const F=new FileReader;F.onload=x=>H(x.target.result),F.onerror=K,F.readAsDataURL(g)})),f=await Promise.all(P);a.value=[...a.value,...f],await C.setSetting("moment_public_cards",a.value),se(` ${f.length} `)}catch(P){console.error(":",P),se("")}J.target.value=""}},k=async J=>{confirm("")&&(a.value.splice(J,1),await C.setSetting("moment_public_cards",a.value),se(""))},I=J=>{c.value=J,r.value=!0},_=()=>{r.value=!1,c.value=null},$=async(J,N)=>{i.value[J]=N,await C.setSetting("moment_contact_cards",i.value),se(""),_()},T=J=>{d.value=J},q=()=>{d.value=""},oe=()=>{o("close")},se=J=>{const N=document.createElement("div");N.className="kawaii-toast",N.textContent=J,document.body.appendChild(N),N.offsetHeight,N.style.opacity="1",setTimeout(()=>{N.style.opacity="0",setTimeout(()=>N.remove(),300)},2e3)};return(J,N)=>(p(),m("div",uy,[e("div",{class:"top-bar"},[e("button",{class:"back-btn",onClick:oe}," "),N[2]||(N[2]=e("h2",null,"",-1)),e("button",{class:"add-btn",onClick:A},"+")]),e("div",vy,[e("div",{class:Ie(["tab-item",{active:n.value==="public"}]),onClick:N[0]||(N[0]=P=>n.value="public")},"  ",2),e("div",{class:Ie(["tab-item",{active:n.value==="contacts"}]),onClick:N[1]||(N[1]=P=>n.value="contacts")},"  ",2)]),n.value==="public"?(p(),m("div",py,[N[4]||(N[4]=e("div",{class:"tip-box"},[e("p",null," "),e("p",null," ")],-1)),e("div",fy,[(p(!0),m(Pe,null,Fe(a.value,(P,f)=>(p(),m("div",{key:f,class:"card-item",onClick:g=>T(P)},[e("div",{class:"card-image",style:Re({backgroundImage:`url(${P})`})},null,4),e("button",{class:"delete-btn",onClick:je(g=>k(f),["stop"])},"",8,gy)],8,my))),128)),a.value.length===0?(p(),m("div",hy,[...N[3]||(N[3]=[e("p",null," ",-1),e("p",null," + ",-1)])])):U("",!0)])])):U("",!0),n.value==="contacts"?(p(),m("div",yy,[N[7]||(N[7]=e("div",{class:"tip-box"},[e("p",null," "),e("p",null," ")],-1)),e("div",by,[(p(!0),m(Pe,null,Fe(l.value,P=>(p(),m("div",{key:P.id,class:"contact-item",onClick:f=>I(P)},[e("div",{class:"contact-avatar",style:Re({backgroundImage:`url(${P.avatar})`})},null,4),e("div",ky,[e("div",xy,S(P.name),1),e("div",Cy,S(M(P.id)),1)]),N[5]||(N[5]=e("div",{class:"arrow"},"",-1))],8,wy))),128)),l.value.length===0?(p(),m("div",$y,[...N[6]||(N[6]=[e("p",null," ",-1)])])):U("",!0)])])):U("",!0),r.value?(p(),st(dy,{key:2,contact:c.value,onClose:_,onSave:$},null,8,["contact"])):U("",!0),d.value?(p(),m("div",{key:3,class:"preview-overlay",onClick:q},[e("div",{class:"preview-image",style:Re({backgroundImage:`url(${d.value})`})},null,4)])):U("",!0),e("input",{ref_key:"fileInput",ref:u,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:w},null,544)]))}},My=Ze(_y,[["__scopeId","data-v-13df76ca"]]),Sy={class:"settings-panel"},Iy={class:"settings-content"},Ay={class:"setting-item"},Ly={class:"switch"},Ty={key:0,class:"setting-item"},jy={key:1,class:"setting-item"},Py={class:"stats-section"},Ey={class:"stat-item"},By={class:"stat-value"},Vy={class:"stat-item"},Hy={class:"stat-value"},Dy={__name:"MomentSettings",emits:["close"],setup(t,{emit:s}){const o=s,n=h(!1),a=h(20),l=h(0),i=h(0),r=h(!1);nt(async()=>{try{const w=await C.getSetting("moment_auto_delete_folded"),k=await C.getSetting("moment_fold_threshold");w!==void 0&&(n.value=w),k!==void 0&&(a.value=k),await c()}catch(w){console.error(":",w)}});const c=async()=>{try{const w=await C.getMomentPosts();l.value=w.length,i.value=w.filter(k=>k.aiGenerated).length}catch(w){console.error(":",w)}},d=async()=>{try{await C.setSetting("moment_auto_delete_folded",n.value),b(n.value?"":"")}catch(w){console.error(":",w),b("")}},u=async()=>{try{await C.setSetting("moment_fold_threshold",a.value),b(` ${a.value} `)}catch(w){console.error(":",w),b("")}},v=async()=>{if(confirm(` ${a.value} `))try{const I=(await C.getMomentPosts()).sort((_,$)=>($.createdAt||0)-(_.createdAt||0)).slice(a.value);for(const _ of I)await C.deleteMomentPost(_.id);b(` ${I.length} `),await c()}catch(w){console.error(":",w),b("")}},b=w=>{const k=document.createElement("div");k.className="kawaii-toast",k.textContent=w,document.body.appendChild(k),k.offsetHeight,k.style.opacity="1",setTimeout(()=>{k.style.opacity="0",setTimeout(()=>k.remove(),300)},2e3)},y=()=>{o("close")},M=()=>{r.value=!0},A=()=>{r.value=!1};return(w,k)=>(p(),m("div",{class:"settings-overlay",onClick:je(y,["self"])},[e("div",Sy,[e("div",{class:"settings-header"},[k[2]||(k[2]=e("h3",null,"",-1)),e("button",{class:"close-btn",onClick:y},"")]),e("div",Iy,[e("div",Ay,[k[4]||(k[4]=e("div",{class:"setting-info"},[e("div",{class:"setting-title"},""),e("div",{class:"setting-desc"},"")],-1)),e("label",Ly,[we(e("input",{type:"checkbox","onUpdate:modelValue":k[0]||(k[0]=I=>n.value=I),onChange:d},null,544),[[es,n.value]]),k[3]||(k[3]=e("span",{class:"slider"},null,-1))])]),n.value?(p(),m("div",Ty,[k[6]||(k[6]=e("div",{class:"setting-info"},[e("div",{class:"setting-title"},""),e("div",{class:"setting-desc"},"")],-1)),we(e("select",{"onUpdate:modelValue":k[1]||(k[1]=I=>a.value=I),onChange:u,class:"threshold-select"},[...k[5]||(k[5]=[e("option",{value:10},"10 ",-1),e("option",{value:20},"20 ",-1),e("option",{value:30},"30 ",-1),e("option",{value:50},"50 ",-1),e("option",{value:100},"100 ",-1)])],544),[[Ls,a.value]])])):U("",!0),n.value?(p(),m("div",jy,[e("button",{class:"cleanup-btn",onClick:v},"   ")])):U("",!0),e("div",{class:"setting-item"},[k[7]||(k[7]=e("div",{class:"setting-info"},[e("div",{class:"setting-title"}," "),e("div",{class:"setting-desc"},"")],-1)),e("button",{class:"manage-btn",onClick:M},"   ")]),e("div",Py,[e("div",Ey,[k[8]||(k[8]=e("span",{class:"stat-label"},"",-1)),e("span",By,S(l.value),1)]),e("div",Vy,[k[9]||(k[9]=e("span",{class:"stat-label"},"AI ",-1)),e("span",Hy,S(i.value),1)])])])]),r.value?(p(),st(My,{key:0,onClose:A})):U("",!0)]))}},Fy=Ze(Dy,[["__scopeId","data-v-5d7657b7"]]),Uy={class:"forward-panel"},Ny={class:"forward-content"},Oy={class:"original-post"},Ry={class:"post-author"},zy={class:"author-info"},Wy={class:"author-name"},Ky={class:"author-username"},Gy=["innerHTML"],qy={class:"contacts-section"},Zy={key:0,class:"empty-contacts"},Jy={key:1,class:"contacts-list"},Yy=["value"],Xy={class:"contact-info"},Qy={class:"contact-name"},eb=["disabled"],tb={__name:"MomentForward",props:{post:{type:Object,required:!0}},emits:["close","forward"],setup(t,{emit:s}){const o=t,n=s,a=h([]),l=h([]),i=(v="")=>(v||"").replace(/\n/g,"<br>"),r=async()=>{try{const v=await C.getContacts();a.value=v||[]}catch(v){console.error(":",v),a.value=[]}},c=async()=>{if(l.value.length===0){u("");return}try{const v=`
${o.post.authorName}: ${o.post.content}`;for(const b of l.value){let M=(await C.getChatList()).find(w=>w.contactId===b&&w.type==="single");if(M)M.lastMessage=v.substring(0,50),M.lastMessageTime=Date.now(),await C.updateChatListItem(M);else{const w=a.value.find(I=>I.id===b);M={contactId:b,type:"single",name:(w==null?void 0:w.name)||"",avatar:(w==null?void 0:w.avatar)||"",lastMessage:v.substring(0,50),lastMessageTime:Date.now(),unreadCount:0},await C.addChatListItem(M),M=(await C.getChatList()).find(I=>I.contactId===b&&I.type==="single")}const A={chatId:M.id,text:v,html:v,content:v,sent:!0,time:Date.now(),type:"text",read:!1};await C.addChatMessage(A)}u(` ${l.value.length} `),n("forward",{contactIds:l.value,post:o.post}),d()}catch(v){console.error(":",v),u("")}},d=()=>{n("close")},u=v=>{const b=document.createElement("div");b.className="kawaii-toast",b.textContent=v,document.body.appendChild(b),b.offsetHeight,b.style.opacity="1",setTimeout(()=>{b.style.opacity="0",setTimeout(()=>b.remove(),300)},2e3)};return nt(()=>{r()}),(v,b)=>(p(),m("div",{class:"forward-overlay",onClick:je(d,["self"])},[e("div",Uy,[e("div",{class:"forward-header"},[b[1]||(b[1]=e("h3",null,"",-1)),e("button",{class:"close-btn",onClick:d},"")]),e("div",Ny,[e("div",Oy,[e("div",Ry,[e("div",{class:"author-avatar",style:Re({backgroundImage:`url(${t.post.authorAvatar})`})},null,4),e("div",zy,[e("div",Wy,S(t.post.authorName),1),e("div",Ky,S(t.post.authorUsername),1)])]),e("div",{class:"post-content",innerHTML:i(t.post.content)},null,8,Gy),t.post.image?(p(),m("div",{key:0,class:"post-image",style:Re({backgroundImage:`url(${t.post.image})`})},null,4)):U("",!0)]),e("div",qy,[b[2]||(b[2]=e("div",{class:"section-title"},"",-1)),a.value.length===0?(p(),m("div",Zy,"  ")):(p(),m("div",Jy,[(p(!0),m(Pe,null,Fe(a.value,y=>(p(),m("label",{key:y.id,class:Ie(["contact-item",{selected:l.value.includes(y.id)}])},[we(e("input",{type:"checkbox",value:y.id,"onUpdate:modelValue":b[0]||(b[0]=M=>l.value=M),class:"contact-checkbox"},null,8,Yy),[[es,l.value]]),e("div",{class:"contact-avatar",style:Re({backgroundImage:`url(${y.avatar})`})},null,4),e("div",Xy,[e("div",Qy,S(y.name),1)])],2))),128))]))]),e("button",{class:"forward-btn",onClick:c,disabled:l.value.length===0},"  "+S(l.value.length>0?`${l.value.length} `:"..."),9,eb)])])]))}},sb=Ze(tb,[["__scopeId","data-v-1efc4bb8"]]),ob={class:"phone-container"},nb={class:"status-bar"},ab={class:"status-bar-left"},lb={id:"clock"},ib={key:0,class:"page-content fade-in"},rb={class:"nav-bar"},cb={class:"timeline-content"},db=["onPointerdown"],ub={class:"post-header"},vb=["onClick"],pb={class:"post-info"},fb=["onClick"],mb={class:"post-username"},gb=["innerHTML"],hb={key:0,class:"mentions-line"},yb=["data-description"],bb={class:"post-actions"},wb=["onClick"],kb=["onClick"],xb=["onClick"],Cb={key:1,class:"comments"},$b=["onClick"],_b=["onClick"],Mb={class:"comment-content"},Sb=["onClick"],Ib=["innerHTML"],Ab={key:2,class:"star-input"},Lb=["onUpdate:modelValue","data-post-id","onKeyup"],Tb=["onClick"],jb={key:0,class:"fold-row"},Pb={key:1,class:"page-content fade-in"},Eb={class:"profile-actions"},Bb={class:"profile-content-wrapper"},Vb={class:"profile-stats"},Hb={key:0,class:"empty-tip"},Db={class:"tweet-header"},Fb={class:"tweet-info"},Ub={class:"tweet-name"},Nb={class:"tweet-username"},Ob=["innerHTML"],Rb=["data-description"],zb={key:1,class:"mentions-line"},Wb={class:"tweet-actions"},Kb=["onClick"],Gb=["onClick"],qb={class:"edit-dialog"},Zb={class:"edit-dialog-header"},Jb={class:"edit-dialog-body"},Yb={class:"bottom-nav"},qn="https://files.catbox.moe/3ehyu8.jpg",Xb={__name:"MomentFeed",emits:["back","view-profile"],setup(t,{emit:s}){const o=s,n=h("12:00"),a=h("timeline"),l=h(null),i=h(null),r=h(null),c=h(null),d=h(null),u=h(!1),v=h(!1),b=h(!1),y=h(null),M=h({visible:!1,field:"",title:"",value:"",multiline:!1}),A=h([]),w=h([]),k=h(!1),I=h({}),_=h({}),$=h({avatar:null,coverImage:"https://files.catbox.moe/bpqrv2.jpg",name:"Rina-chan",username:"@rina_kawaii",bio:`Kawaii lover | Caf hopper  | Fashion 
Follow me for cute things! 
`,email:"rina@kawaii.com"}),T=["https://files.catbox.moe/0g3kqu.jpg","https://files.catbox.moe/d5b7k6.jpg","https://files.catbox.moe/0yrhh6.jpg","https://files.catbox.moe/8mjvdg.jpg","https://files.catbox.moe/fvidas.jpg","https://files.catbox.moe/q6so2i.jpg","https://files.catbox.moe/5a96cp.jpg","https://files.catbox.moe/0mp6h0.jpg","https://files.catbox.moe/epcn03.jpg","https://files.catbox.moe/7jzdp7.jpg","https://files.catbox.moe/jrmu6w.jpg","https://files.catbox.moe/c0bwhn.jpg","https://files.catbox.moe/0blxme.jpg","https://files.catbox.moe/qicobr.jpg","https://files.catbox.moe/n94ztu.jpg"],q=()=>crypto.randomUUID?crypto.randomUUID():`id-${Date.now()}-${Math.random().toString(16).slice(2)}`,oe=(Y="")=>(Y||"").replace(/\n/g,"<br>"),se=(Y="")=>String(Y).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),J=(Y="")=>se(Y||"").replace(/@([^\s@]{1,24})/g,'<span class="mention-at">@$1</span>'),N=(Y=0)=>Y>=1e4?`${(Y/1e4).toFixed(1)}w`:Y>=1e3?`${(Y/1e3).toFixed(1)}k`:Y,P=ot(()=>{const Y={};for(const X of w.value||[])X&&X.id!=null&&(Y[X.id]=X);return Y}),f=async({name:Y,avatar:X,username:ie,bio:Ve})=>{const fe=(Y||"").trim();if(!fe)return null;const et=(w.value||[]).find(Ft=>((Ft==null?void 0:Ft.name)||"").trim()===fe);if(et)return et.id;const Mt=Date.now()+Math.floor(Math.random()*1e3),at={id:Mt,name:fe,avatar:X||qn,bio:"",prompt:"",username:ie||"",type:"contact",createdAt:Date.now(),updatedAt:Date.now()};return await C.addContact(at),Mt},g=async Y=>{if(!((Y||[]).some(fe=>fe&&(fe.authorAvatar||fe.authorName||fe.authorUsername))||(Y||[]).some(fe=>((fe==null?void 0:fe.comments)||[]).some(et=>et&&(et.avatar||et.authorName)))))return Y||[];const ie=await C.getContacts();w.value=ie||[];const Ve=[];for(const fe of Y||[]){const et=!!(fe!=null&&fe.isSelf),Mt=et?null:(fe==null?void 0:fe.author_id)??await f({name:fe==null?void 0:fe.authorName,avatar:fe==null?void 0:fe.authorAvatar,username:fe==null?void 0:fe.authorUsername,bio:""}),at=[];for(const jt of(fe==null?void 0:fe.comments)||[]){if(!jt)continue;if(jt.isSelf){at.push({id:jt.id||q(),isSelf:!0,text:jt.text||"",createdAt:jt.createdAt||Date.now()});continue}if(jt.author_id!=null){at.push({id:jt.id||q(),author_id:jt.author_id,text:jt.text||"",createdAt:jt.createdAt||Date.now()});continue}const En=await f({name:jt.authorName,avatar:jt.avatar,username:"",bio:""});at.push({id:jt.id||q(),author_id:En,text:jt.text||"",createdAt:jt.createdAt||Date.now()})}const Ft={id:(fe==null?void 0:fe.id)||q(),author_id:Mt,isSelf:et,aiGenerated:!!(fe!=null&&fe.aiGenerated),content:(fe==null?void 0:fe.content)||"",mediaDesc:(fe==null?void 0:fe.mediaDesc)||(fe==null?void 0:fe.media_desc)||"",image:(fe==null?void 0:fe.image)||"",mentions:(fe==null?void 0:fe.mentions)||[],visibility:(fe==null?void 0:fe.visibility)||"public",likes:(fe==null?void 0:fe.likes)||0,liked:!!(fe!=null&&fe.liked),shares:(fe==null?void 0:fe.shares)||0,comments:at,createdAt:(fe==null?void 0:fe.createdAt)||Date.now()};Ve.push(Ft),await C.upsertMomentPost(Ft)}return Ve.sort((fe,et)=>(et.createdAt||0)-(fe.createdAt||0))},H=Y=>{if(((Y==null?void 0:Y.name)||"").trim()!=="Mio")return!1;const ie=((Y==null?void 0:Y.username)||"").trim(),Ve=((Y==null?void 0:Y.bio)||"").trim(),fe=((Y==null?void 0:Y.avatar)||"").trim();return ie==="@mio_pop"||Ve.includes("New nail art")||fe.includes("tw2ygf.jpg")},K=async()=>{try{const X=(await C.getContacts()||[]).find(H);if(!(X!=null&&X.id))return;const ie=await C.getMomentPosts();for(const Ve of ie||[]){if(!(Ve!=null&&Ve.id))continue;if(Ve.author_id===X.id){await C.deleteMomentPost(Ve.id);continue}const fe=Array.isArray(Ve.comments)?Ve.comments:[],et=fe.filter(Mt=>(Mt==null?void 0:Mt.author_id)!==X.id);et.length!==fe.length&&await C.upsertMomentPost({...Ve,comments:et})}await C.deleteContact(X.id)}catch(Y){console.error(":",Y)}},F=async()=>[],x=h(!1),L=async()=>{try{w.value=await C.getContacts()}catch(Y){console.error(":",Y),w.value=[]}},ae=async Y=>{for(const X of Y||[])if(X!=null&&X.aiGenerated&&!(X!=null&&X.image)){const ie={...X,image:Me()};x.value=!0,await C.upsertMomentPost(ie),x.value=!1,A.value=A.value.map(Ve=>Ve.id===ie.id?ie:Ve)}},de=async()=>{try{const Y=await C.getMomentPosts();Y&&Y.length?A.value=await g(Y):A.value=await F(),await ae(A.value)}catch(Y){console.error(":",Y),A.value=[]}},ue=Y=>{if(!Y)return Y;if(Y.isSelf)return{...Y,authorName:$.value.name,avatar:$.value.avatar};const X=Y.author_id,ie=X!=null?P.value[X]:null;return{...Y,authorName:(ie==null?void 0:ie.name)||"Unknown",avatar:(ie==null?void 0:ie.avatar)||qn}},$e=Y=>{if(!Y)return Y;if(Y.isSelf)return{...Y,authorName:$.value.name,authorUsername:$.value.username,authorAvatar:$.value.avatar,comments:(Y.comments||[]).slice().sort((fe,et)=>(fe.createdAt||0)-(et.createdAt||0)).map(ue)};const X=Y.author_id,ie=X!=null?P.value[X]:null,Ve=(ie==null?void 0:ie.username)||(ie!=null&&ie.name?`@${String(ie.name).toLowerCase().replace(/\s+/g,"_")}`:"@user");return{...Y,authorName:(ie==null?void 0:ie.name)||"Unknown",authorUsername:Ve,authorAvatar:(ie==null?void 0:ie.avatar)||qn,comments:(Y.comments||[]).slice().sort((fe,et)=>(fe.createdAt||0)-(et.createdAt||0)).map(ue)}},ne=ot(()=>A.value.map($e)),G=ot(()=>k.value?ne.value:ne.value.slice(0,5)),he=ot(()=>ne.value.length>5),j=ot(()=>ne.value.filter(Y=>Y.isSelf));let Q=null,W=null,B=null;nt(async()=>{await _e.init(),await K(),Ee(),Q=setInterval(Ee,6e4),l.value=new Audio("https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"),await D(),await L(),await de(),vt(),W=async Y=>{const X=(Y==null?void 0:Y.detail)||{};x.value||(X.storeName==="momentPosts"&&await de(),X.storeName==="contacts"&&await L())},window.addEventListener("idb-change",W),B=Y=>{const X=(Y==null?void 0:Y.detail)||{};X!=null&&X.authorName&&Be(`${X.authorName} `)},window.addEventListener("moment-ai-comment",B),window.addEventListener("ai-force-generate-moments-done",Y=>{const X=(Y==null?void 0:Y.detail)||{};if(X!=null&&X.error){Be("  API ");return}Be(`  ${X.okCount||0}/${X.total||0} `)})}),Dt(()=>{Q&&clearInterval(Q),W&&window.removeEventListener("idb-change",W),B&&window.removeEventListener("moment-ai-comment",B)});const D=async()=>{try{const Y=await C.getSetting("moment_avatar"),X=await C.getSetting("moment_cover"),ie=await C.getSetting("moment_name"),Ve=await C.getSetting("moment_username"),fe=await C.getSetting("moment_bio"),et=await C.getSetting("moment_email");Y&&($.value.avatar=Y),X&&($.value.coverImage=X),ie&&($.value.name=ie),Ve&&($.value.username=Ve),fe&&($.value.bio=fe),et&&($.value.email=et)}catch(Y){console.error(":",Y)}},xe=()=>{const Y=document.createElement("input");Y.type="file",Y.accept="image/*",Y.onchange=async X=>{const ie=X.target.files[0];if(ie){const Ve=new FileReader;Ve.onload=async fe=>{$.value.avatar=fe.target.result,await C.setSetting("moment_avatar",fe.target.result),Be(""),await syncSelfPosts()},Ve.readAsDataURL(ie)}},Y.click()},V=()=>{const Y=document.createElement("input");Y.type="file",Y.accept="image/*",Y.onchange=async X=>{const ie=X.target.files[0];if(ie){const Ve=new FileReader;Ve.onload=async fe=>{$.value.coverImage=fe.target.result,await C.setSetting("moment_cover",fe.target.result),Be("")},Ve.readAsDataURL(ie)}},Y.click()},O={name:{title:"",storageKey:"moment_name",toast:"",multiline:!1},username:{title:"",storageKey:"moment_username",toast:"",multiline:!1},bio:{title:"",storageKey:"moment_bio",toast:"",multiline:!0},email:{title:"",storageKey:"moment_email",toast:"",multiline:!1}},z=Y=>{const X=O[Y];X&&(M.value={visible:!0,field:Y,title:X.title,value:$.value[Y]||"",multiline:!!X.multiline})},ee=()=>{M.value.visible=!1},ce=async()=>{const{field:Y,value:X}=M.value,ie=O[Y];if(!ie)return ee();const Ve=(X||"").trim();if(!Ve){Be("");return}$.value[Y]=Ve,await C.setSetting(ie.storageKey,Ve),Be(ie.toast),(Y==="name"||Y==="username")&&await syncSelfPosts(),ee()},ye=()=>z("name"),Le=()=>z("username"),Ae=()=>z("bio"),Me=()=>T[Math.floor(Math.random()*T.length)],be=Y=>{if(a.value===Y)return;De(),a.value=Y,i.value&&(i.value.scrollTop=0);const X=Y==="timeline"?"":"";Be(`${X}`),He(`${X}`)},Ne=()=>{De(),o("back")},Ee=()=>{const Y=new Date,X=String(Y.getHours()).padStart(2,"0"),ie=String(Y.getMinutes()).padStart(2,"0");n.value=`${X}:${ie}`},De=()=>{l.value&&(l.value.currentTime=0,l.value.play().catch(Y=>console.log("Audio play failed:",Y)))},We=Y=>{const X=document.createElement("div");X.className="heart",X.innerHTML="",X.style.left=Y.clientX+"px",X.style.top=Y.clientY+"px",document.body.appendChild(X),setTimeout(()=>X.remove(),3e3)},Je=(Y,X)=>{Y.stopPropagation(),De();const ie=Y.currentTarget;ke(ie),ie.style.transform="scale(0.95)",setTimeout(()=>ie.style.transform="",100);let Ve="";switch(X){case"like":Ve="";break;case"share":Ve="";break;case"bookmark":Ve="";break;case"settings":Ve="",He("");break;case"profile":Ve="";break;case"edit":Ve="";break;case"stat":Ve="";break;case"comment":Ve="";break;default:Ve="Click! "}Ve&&Be(Ve)},ge=Y=>{Y.stopPropagation(),De();const X=Y.currentTarget,ie=X.querySelector(".image-description");if(ie)ie.remove();else{const Ve=document.createElement("div");Ve.className="image-description",Ve.textContent=X.dataset.description||"Kawaii Image!",X.style.position="relative",X.appendChild(Ve),Be("")}},le=Y=>{if(Y===$.value.name)be("mypage");else{const X=(Y||"").trim();if(!X)return;const ie=(w.value||[]).find(fe=>((fe==null?void 0:fe.name)||"").trim()===X);(async()=>{try{const fe=ie||await(async()=>{const et=await C.getContacts();return w.value=et||[],(w.value||[]).find(Mt=>((Mt==null?void 0:Mt.name)||"").trim()===X)})();if((fe==null?void 0:fe.id)!=null){Be(`${X}...`),o("view-profile",fe.id);return}He(`${X}`),Be(`${X}...`)}catch(fe){console.warn(":",fe),He(`${X}`),Be(`${X}...`)}})()}},He=Y=>{typeof window.triggerSlash=="function"?window.triggerSlash(`/send ${Y}|/trigger`):console.log(`[Mock Send]: ${Y}`)},ke=Y=>{const X=Y.getBoundingClientRect();for(let ie=0;ie<5;ie++){const Ve=document.createElement("div");Ve.className="sparkle",Ve.style.left=`${X.left+Math.random()*X.width}px`,Ve.style.top=`${X.top+Math.random()*X.height}px`,document.body.appendChild(Ve),setTimeout(()=>Ve.remove(),1500)}},Be=Y=>{const X=document.createElement("div");X.className="kawaii-toast",X.textContent=Y,document.body.appendChild(X),X.offsetHeight,X.style.opacity="1",setTimeout(()=>{X.style.opacity="0",setTimeout(()=>X.remove(),300)},2e3)},vt=()=>{const Y=document.createElement("div");Y.className="loading-animation",document.body.appendChild(Y),Y.style.display="block",setTimeout(()=>{Y.style.display="none",Y.remove()},1e3)},pt=()=>{k.value=!k.value},re=async Y=>{const X=A.value.find(et=>et.id===Y);if(!X)return;const ie=!X.liked,Ve=Math.max(0,(X.likes||0)+(ie?1:-1)),fe={...X,liked:ie,likes:Ve};A.value=A.value.map(et=>et.id===Y?fe:et),await C.upsertMomentPost(fe)},te=Y=>{I.value={...I.value,[Y]:!I.value[Y]}},pe=async Y=>{await zt();const X=document.querySelector(`.star-input-field[data-post-id="${Y}"]`);if(X){X.focus();try{X.setSelectionRange(X.value.length,X.value.length)}catch{}}},ze=async(Y,X)=>{const ie=X==null?void 0:X.authorName;ie&&(I.value={...I.value,[Y]:!0},_.value={..._.value,[Y]:`@${ie} `},await pe(Y))},Ce=async Y=>{var et,Mt;const X=(_.value[Y]||"").trim();if(!X){Be("");return}const ie=A.value.find(at=>at.id===Y);if(!ie)return;const Ve={id:q(),isSelf:!0,text:X,createdAt:Date.now()},fe={...ie,comments:[...ie.comments||[],Ve]};if(A.value=A.value.map(at=>at.id===Y?fe:at),await C.upsertMomentPost(fe),!ie.isSelf&&ie.author_id!=null)(et=Qt.scheduleReplyToUserCommentOnRolePost)==null||et.call(Qt,{postId:Y,actorId:ie.author_id,userId:"self",userName:$.value.name,userCommentText:X});else{const at=(w.value||[]).filter(Ft=>{const jt=((Ft==null?void 0:Ft.name)||"").trim();return jt?X.includes(`@${jt}`):!1});for(const Ft of at)(Mt=Qt.scheduleReplyToMention)==null||Mt.call(Qt,{postId:Y,actorId:Ft.id,userName:$.value.name,userCommentText:X})}_.value={..._.value,[Y]:""},I.value={...I.value,[Y]:!1},Be("")},me=()=>{De(),Be(" ..."),window.dispatchEvent(new CustomEvent("ai-force-generate-moments"))};let E=null,ve=!1;const Ye=(Y,X)=>{var Ve;if(!(X!=null&&X.isSelf)&&!(X!=null&&X.aiGenerated))return;const ie=(((Ve=Y.target)==null?void 0:Ve.tagName)||"").toLowerCase();["input","textarea","button","select"].includes(ie)||ve||(ve=!0,E=setTimeout(async()=>{if(!window.confirm("")){ve=!1;return}A.value=A.value.filter(et=>et.id!==X.id);try{await C.deleteMomentPost(X.id),Be("")}catch(et){console.error(":",et),Be("")}finally{ve=!1}},650))},ct=()=>{E&&clearTimeout(E),E=null,setTimeout(()=>{ve=!1},80)},bt=()=>{u.value=!0},ft=()=>{u.value=!1},wt=()=>{De(),v.value=!0},it=()=>{v.value=!1},Tt=Y=>{De(),y.value=Y,b.value=!0},Et=()=>{b.value=!1,y.value=null},Wt=async Y=>{const X=A.value.find(ie=>ie.id===y.value.id);if(X){const ie={...X,shares:(X.shares||0)+1};A.value=A.value.map(Ve=>Ve.id===X.id?ie:Ve),await C.upsertMomentPost(ie)}},Kt=async Y=>{const X=((Y==null?void 0:Y.text)||"").trim(),ie=((Y==null?void 0:Y.image)||"").trim();if(!X&&!ie){Be("");return}const Ve=Date.now(),fe=(Y==null?void 0:Y.visibility)||"public",et=(Y==null?void 0:Y.mentions)||[],Mt={id:q(),author_id:null,content:X,image:ie,mediaDesc:"",mentions:et,visibility:fe,likes:0,liked:!1,shares:0,comments:[],createdAt:Ve,isSelf:!0};A.value=[Mt,...A.value],await C.upsertMomentPost(Mt),Be(""),u.value=!1,Qt.scheduleInteractForUserPost(Mt)};return(Y,X)=>(p(),m("div",{class:"kawaii-container",onClick:We},[e("div",ob,[e("div",nb,[e("div",ab,[e("span",lb,S(n.value),1)]),X[12]||(X[12]=dt('<div class="status-bar-right" data-v-35d1e54a><svg class="status-icon-svg" viewBox="0 0 24 24" data-v-35d1e54a><path d="M20,20h2v-2h-2V20z M18,20h-2v-4h2V20z M14,20h-2v-6h2V20z M10,20H8v-8h2V20z M6,20H4v-10h2V20z" data-v-35d1e54a></path></svg><svg class="status-icon-svg" viewBox="0 0 24 24" data-v-35d1e54a><path d="M12,3C7.41,3,3.86,4.53,0.96,7.03L2.37,8.44C4.89,6.31,8.06,5,12,5s7.11,1.31,9.63,3.44l1.41-1.41C20.14,4.53,16.59,3,12,3z M12,7C9.3,7,6.81,7.89,4.8,9.4l1.4,1.4C7.6,9.67,9.69,9,12,9s4.4,0.67,5.8,1.8l1.4-1.4C17.19,7.89,14.7,7,12,7z M12,11c-1.94,0-3.5,0.5-4.7,1.3l1.4,1.4c0.8-0.5,2-0.7,3.3-0.7s2.5,0.2,3.3,0.7l1.4-1.4C15.5,11.5,13.94,11,12,11z M12,15c-0.85,0-1.5,0.15-2,0.4l2,2l2-2C13.5,15.15,12.85,15,12,15z" data-v-35d1e54a></path></svg><svg class="status-icon-svg" viewBox="0 0 24 24" data-v-35d1e54a><path d="M15.67,4H14V2h-4v2H8.33C7.6,4,7,4.6,7,5.33v15.33C7,21.4,7.6,22,8.33,22h7.33c0.74,0,1.33-0.6,1.33-1.33V5.33C17,4.6,16.4,4,15.67,4z M15,20H9V6h6V20z" data-v-35d1e54a></path></svg></div>',1))]),e("div",{class:"app-container",ref_key:"appContainer",ref:i},[a.value==="timeline"?(p(),m("div",ib,[e("div",rb,[e("div",{class:"nav-profile clickable",onClick:Ne,style:Re({backgroundImage:`url(${$.value.avatar})`})},null,4),X[13]||(X[13]=e("div",{class:"nav-logo"}," Kawaii SNS ",-1)),e("div",{class:"nav-actions"},[e("div",{class:"nav-debug clickable",onClick:me,title:""},""),e("div",{class:"nav-settings clickable",onClick:wt},"")])]),e("div",cb,[(p(!0),m(Pe,null,Fe(G.value,(ie,Ve)=>{var fe,et,Mt;return p(),m("div",{key:ie.id,class:"post",onPointerdown:at=>Ye(at,ie),onPointerup:ct,onPointercancel:ct,onPointerleave:ct},[e("div",ub,[e("div",{class:"post-avatar clickable",style:Re({backgroundImage:`url(${ie.authorAvatar})`}),onClick:at=>ie.isSelf?be("mypage"):le(ie.authorName)},null,12,vb),e("div",pb,[e("div",{class:"post-name clickable",onClick:at=>ie.isSelf?be("mypage"):le(ie.authorName)},S(ie.authorName),9,fb),e("div",mb,S(ie.authorUsername),1)])]),e("div",{class:"post-content clickable",onClick:X[0]||(X[0]=at=>Je(at,"content"))},[e("span",{innerHTML:oe(ie.content)},null,8,gb),(fe=ie.mentions)!=null&&fe.length?(p(),m("div",hb,[(p(!0),m(Pe,null,Fe(ie.mentions,at=>(p(),m("span",{key:at,class:"mention-chip"},"@"+S(at),1))),128))])):U("",!0)]),ie.image?(p(),m("div",{key:0,class:"post-image clickable",style:Re({backgroundImage:`url(${ie.image})`}),"data-description":ie.mediaDesc||"Kawaii Image!",onClick:X[1]||(X[1]=at=>ge(at))},null,12,yb)):U("",!0),e("div",bb,[e("div",{class:Ie(["post-action clickable",{active:ie.liked}]),onClick:at=>re(ie.id)},"  "+S(N(ie.likes)),11,wb),e("div",{class:"post-action clickable",onClick:at=>Tt(ie)}," "+S(N(ie.shares||0)),9,kb),e("div",{class:"post-action clickable",onClick:at=>te(ie.id)},"  "+S(((et=ie.comments)==null?void 0:et.length)||0),9,xb)]),(Mt=ie.comments)!=null&&Mt.length?(p(),m("div",Cb,[(p(!0),m(Pe,null,Fe(ie.comments,at=>(p(),m("div",{class:"comment",key:at.id,onClick:je(Ft=>ze(ie.id,at),["stop"])},[e("div",{class:"comment-avatar clickable",style:Re({backgroundImage:`url(${at.avatar})`}),onClick:je(Ft=>le(at.authorName),["stop"])},null,12,_b),e("div",Mb,[e("span",{class:"comment-name clickable",onClick:je(Ft=>le(at.authorName),["stop"])},S(at.authorName)+":",9,Sb),e("span",{innerHTML:J(at.text)},null,8,Ib)])],8,$b))),128))])):U("",!0),I.value[ie.id]?(p(),m("div",Ab,[e("div",{class:"star-input-avatar",style:Re({backgroundImage:`url(${$.value.avatar})`})},null,4),we(e("input",{"onUpdate:modelValue":at=>_.value[ie.id]=at,class:"star-input-field",type:"text","data-post-id":ie.id,placeholder:"...",onKeyup:Xt(at=>Ce(ie.id),["enter"])},null,40,Lb),[[Te,_.value[ie.id]]]),e("button",{class:"star-submit",onClick:at=>Ce(ie.id)},"",8,Tb)])):U("",!0)],40,db)}),128)),he.value?(p(),m("div",jb,[e("button",{class:"fold-btn clickable",onClick:pt},S(k.value?"":` (${ne.value.length-5})`),1)])):U("",!0)])])):(p(),m("div",Pb,[e("div",{class:"profile-section",ref_key:"profileSection",ref:r,style:Re({backgroundImage:`url(${$.value.coverImage})`}),onClick:V},[X[14]||(X[14]=e("div",{class:"profile-header-overlay"},null,-1)),e("div",{class:"profile-avatar clickable",style:Re({backgroundImage:`url(${$.value.avatar})`}),onClick:je(xe,["stop"])},null,4),e("div",Eb,[e("button",{class:"profile-action-btn clickable",onClick:X[2]||(X[2]=je(ie=>Je(ie,"edit"),["stop"]))},""),e("button",{class:"profile-action-btn clickable",onClick:X[3]||(X[3]=je(ie=>Je(ie,"share"),["stop"]))},"")])],4),e("div",Bb,[e("div",{class:"profile-info",ref_key:"profileInfo",ref:c},[e("div",{class:"profile-name clickable",onClick:je(ye,["stop"])},S($.value.name),1),e("div",{class:"profile-username clickable",onClick:je(Le,["stop"])},S($.value.username),1),e("div",{class:"profile-bio clickable",onClick:je(Ae,["stop"])},S($.value.bio),1),e("div",Vb,[e("div",{class:"stat-item clickable",onClick:X[4]||(X[4]=ie=>Je(ie,"stat"))},[...X[15]||(X[15]=[e("span",null,"1.5k",-1),e("span",null,"",-1)])]),e("div",{class:"stat-item clickable",onClick:X[5]||(X[5]=ie=>Je(ie,"stat"))},[...X[16]||(X[16]=[e("span",null,"892",-1),e("span",null,"",-1)])]),e("div",{class:"stat-item clickable",onClick:X[6]||(X[6]=ie=>Je(ie,"stat"))},[...X[17]||(X[17]=[e("span",null,"5.2k",-1),e("span",null,"",-1)])])])],512),e("div",{class:"timeline-content",ref_key:"profileTimeline",ref:d},[j.value.length===0?(p(),m("div",Hb,"  ")):U("",!0),(p(!0),m(Pe,null,Fe(j.value,ie=>{var Ve;return p(),m("div",{key:ie.id,class:"post tweet"},[e("div",Db,[e("div",{class:"tweet-avatar",style:Re({backgroundImage:`url(${ie.authorAvatar})`})},null,4),e("div",Fb,[e("div",Ub,S(ie.authorName),1),e("div",Nb,S(ie.authorUsername),1)])]),e("div",{class:"tweet-content",innerHTML:oe(ie.content)},null,8,Ob),ie.image?(p(),m("div",{key:0,class:"tweet-image clickable",style:Re({backgroundImage:`url(${ie.image})`}),"data-description":ie.mediaDesc||"My post",onClick:X[7]||(X[7]=fe=>ge(fe))},null,12,Rb)):U("",!0),(Ve=ie.mentions)!=null&&Ve.length?(p(),m("div",zb,[(p(!0),m(Pe,null,Fe(ie.mentions,fe=>(p(),m("span",{key:fe,class:"mention-chip"},"@"+S(fe),1))),128))])):U("",!0),e("div",Wb,[e("div",{class:Ie(["tweet-action clickable",{active:ie.liked}]),onClick:fe=>re(ie.id)}," "+S(N(ie.likes)),11,Kb),e("div",{class:"tweet-action clickable",onClick:fe=>te(ie.id)},"",8,Gb)])])}),128))],512)])])),M.value.visible?(p(),m("div",{key:2,class:"edit-dialog-mask",onClick:je(ee,["self"])},[e("div",qb,[e("div",Zb,[e("span",null,S(M.value.title),1),e("button",{class:"edit-dialog-close",onClick:ee},"")]),e("div",Jb,[M.value.multiline?we((p(),m("textarea",{key:0,"onUpdate:modelValue":X[8]||(X[8]=ie=>M.value.value=ie),class:"edit-dialog-textarea",rows:"4",placeholder:""},null,512)),[[Te,M.value.value]]):we((p(),m("input",{key:1,"onUpdate:modelValue":X[9]||(X[9]=ie=>M.value.value=ie),class:"edit-dialog-input",type:"text",placeholder:""},null,512)),[[Te,M.value.value]])]),e("div",{class:"edit-dialog-actions"},[e("button",{class:"edit-dialog-btn primary",onClick:ce},""),e("button",{class:"edit-dialog-btn",onClick:ee},"")])])])):U("",!0),u.value?(p(),st(Y2,{key:3,onClose:ft,onSubmit:Kt})):U("",!0),v.value?(p(),st(Fy,{key:4,onClose:it})):U("",!0),b.value&&y.value?(p(),st(sb,{key:5,post:y.value,onClose:Et,onForward:Wt},null,8,["post"])):U("",!0)],512),e("div",Yb,[e("div",{class:Ie(["bottom-nav-item clickable",{active:a.value==="timeline"}]),onClick:X[10]||(X[10]=ie=>be("timeline"))},[...X[18]||(X[18]=[e("div",{class:"bottom-nav-icon nav-home"},null,-1),e("div",{class:"bottom-nav-text"},"",-1)])],2),e("div",{class:Ie(["bottom-nav-item clickable",{active:a.value==="mypage"}]),onClick:X[11]||(X[11]=ie=>be("mypage"))},[...X[19]||(X[19]=[e("div",{class:"bottom-nav-icon nav-profile-icon"},null,-1),e("div",{class:"bottom-nav-text"},"",-1)])],2)]),a.value==="timeline"?(p(),m("button",{key:0,class:"floating-add-btn clickable",onClick:je(bt,["stop"])},"  ")):U("",!0)])]))}},Qb=Ze(Xb,[["__scopeId","data-v-35d1e54a"]]),ew={class:"phone-container"},tw={class:"status-bar"},sw={class:"status-bar-left"},ow={class:"profile-actions"},nw={class:"profile-info"},aw={class:"profile-name"},lw={class:"profile-username"},iw=["innerHTML"],rw={class:"profile-stats"},cw={class:"timeline"},dw={key:0,class:"empty-tip"},uw={class:"tweet-header"},vw={class:"tweet-info"},pw={class:"tweet-name"},fw={class:"tweet-username"},mw={class:"tweet-content"},gw={class:"tweet-actions"},_l="https://files.catbox.moe/3ehyu8.jpg",hw={__name:"FriendProfile",props:{friendId:{type:[Number,String],required:!0}},emits:["back","chat","view-moment"],setup(t,{emit:s}){const o=t,n=s,a=["https://img.wjwj.top/2025/09/20/c79dad0096c2a31251bb902937bc43a0.md.jpeg","https://img.wjwj.top/2025/09/20/b1044b1c2e905c330221bbbeacc01957.md.jpeg","https://img.wjwj.top/2025/09/20/98a5930ce3f395d114a7f85e6c024cf6.md.jpeg","https://img.wjwj.top/2025/09/20/af4941e4c72905dcb2cba3aa82fac095.md.jpeg","https://img.wjwj.top/2025/09/20/ea7d55a780d9fbdba22daa74748a5a60.md.jpeg","https://img.wjwj.top/2025/09/20/eca46641ccd93b8dd7c4d51b84dbfe2b.md.jpeg","https://img.wjwj.top/2025/09/20/172e684ef05b86970a5296fcd0c52af5.md.jpeg","https://img.wjwj.top/2025/09/20/f7bd58cedc93acbd6aa494f0d52dfd78.md.jpeg","https://img.wjwj.top/2025/09/20/95d7aad7ac39673f623db41cfa778362.md.jpeg","https://img.wjwj.top/2025/09/20/5161b97a59edae631ef3357fb712dcdc.md.jpeg","https://img.wjwj.top/2025/09/20/912a2b17970ac6f8c50b3320cef8a305.md.jpeg","https://img.wjwj.top/2025/09/20/de3daed188f680c0409842c5d41245cf.md.jpeg","https://img.wjwj.top/2025/09/20/46ba0d49665e543804251cd0c80f3bf2.md.jpeg","https://img.wjwj.top/2025/09/20/b23bd89f24f84e1abb1aa5548dd1c70f.md.jpeg","https://img.wjwj.top/2025/09/20/17565c98c9693c56b25bd7461e98bf63.md.png","https://img.wjwj.top/2025/09/20/f3d6d56ce9560a8aa7517d3a301d707d.md.jpg","https://img.wjwj.top/2025/09/20/95aebff98bff0ceaf9f6ee30c6b81b68.md.jpg","https://img.wjwj.top/2025/09/20/840470043e498b2c2e4847f377318341.md.jpg","https://img.wjwj.top/2025/09/20/61f07c146262ab82dad6a1d46fbba435.md.png","https://img.wjwj.top/2025/09/20/ef653a1f9ac2a3e7689c68f06649ef26.md.jpg","https://img.wjwj.top/2025/09/20/0504d1f18b923eedebf3f43c8e13d1a6.md.jpg","https://img.wjwj.top/2025/09/20/9f0e3713a5243f93ec25920bdb105393.md.jpeg","https://img.wjwj.top/2025/09/20/dab3b3bd421aa4f9c70a16a88a16113d.md.jpeg","https://img.wjwj.top/2025/09/20/de50636930b9ab33fbd085df44816f7d.md.jpeg","https://img.wjwj.top/2025/09/20/b6771b6b291069550b2a8974021380e6.md.jpeg","https://img.wjwj.top/2025/09/20/b896a58e41590c942a8a564dca615b3d.md.jpeg","https://img.wjwj.top/2025/09/20/7c5cf7497e1f7716425b670238e8b564.md.jpeg","https://img.wjwj.top/2025/09/20/5a820c723cca1413c28a6fd2b402e475.md.jpeg","https://img.wjwj.top/2025/09/20/938ee29f9eca8818253b44801fe8473c.md.jpeg","https://img.wjwj.top/2025/09/20/c923c0602d5893948b5dcab392e2e195.md.jpeg","https://img.wjwj.top/2025/09/20/2e88422d8eac2fe69f72b8d06dc0cf9d.md.jpeg","https://img.wjwj.top/2025/09/20/eece3302d2c86512f096ffcd61b7618d.md.jpeg","https://img.wjwj.top/2025/09/20/5d86b06a04fe296405369b189fd58e69.md.jpeg","https://img.wjwj.top/2025/09/20/10eeecfda9479e298df8e24b6cee21bc.md.jpeg","https://img.wjwj.top/2025/09/20/676b47dd6983100aeb0df67d8957b296.md.jpeg","https://img.wjwj.top/2025/09/20/33d809942ee846a9da8128242e843d86.md.jpeg","https://img.wjwj.top/2025/09/20/2ba5a1fe00579149bca88a3eb151e8f8.md.jpeg","https://img.wjwj.top/2025/09/20/4dcce95b587e06905c43ddae611b610a.md.jpeg","https://img.wjwj.top/2025/09/20/ab838c8200f3db03d541388969d87d0c.md.jpeg","https://img.wjwj.top/2025/09/20/e8da41f958b12b0402214797cf3f4d7f.md.jpeg","https://img.wjwj.top/2025/09/20/66f1e6beeed44d938d6cfe5fc58d2789.md.jpg","https://img.wjwj.top/2025/09/20/06b549f5fd8f95275e91cd1b2abf03c2.md.jpg","https://img.wjwj.top/2025/09/20/031bd78025b4b803ce48ef32f2f415a6.md.jpg","https://img.wjwj.top/2025/09/20/5685254b3c2ae1f88e711a1f54daf98b.md.jpeg","https://img.wjwj.top/2025/09/20/1138a612f59468680dae991b03d08b55.md.jpeg","https://img.wjwj.top/2025/09/20/9e02e72edb5c218d6fcc146e10125a98.md.gif","https://img.wjwj.top/2025/09/20/412db762d5a53288e11d7ddc15a75fea.md.jpg","https://img.wjwj.top/2025/09/20/f3d1e84a036a64d8854f7d59dcdb4380.md.jpg","https://img.wjwj.top/2025/09/20/191389d77cc33b82ffde129e09661cfa.md.jpg","https://img.wjwj.top/2025/09/20/77483cb06fbd839d5575c694a84e0c42.md.jpg","https://img.wjwj.top/2025/09/20/52b153768120cc3cca048714a89f3810.md.jpeg","https://img.wjwj.top/2025/09/20/08647ccd11c0e35c02647f9741e72021.md.jpg","https://img.wjwj.top/2025/09/20/7376ef34d2044810cc4904cdfb6e343c.md.jpg","https://img.wjwj.top/2025/09/20/2a4443aac2e3762566e668331e20c7f6.md.jpg","https://img.wjwj.top/2025/09/20/7a217da940ba79d1e2764076111d91dd.md.jpg","https://img.wjwj.top/2025/09/20/26b5eec32e35a495b8ec44a5bc87e77b.md.jpg","https://img.wjwj.top/2025/09/20/cb493060306e253811f79ebeb5d23790.md.jpg","https://img.wjwj.top/2025/09/20/bc5b814d2e35dc6e56e016a9e8107448.md.png","https://img.wjwj.top/2025/09/20/ad8b3eb78534bf55da025c5c28e51889.md.jpg","https://img.wjwj.top/2025/09/20/7a913fb7f09cf6760b46c2dd3b547fe6.md.png","https://img.wjwj.top/2025/09/20/917479be6301660b739eb00b851b43f8.md.png"],l=h("12:00"),i=h(""),r=h(null),c=h(null),d=h({id:null,name:"",username:"",avatar:"",bioHtml:"",stats:{following:128,followers:"9.9k",likes:"2.5w"},posts:[]});let u=null,v=null;nt(async()=>{b(),u=setInterval(b,6e4),r.value=new Audio("https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"),await _e.init(),await $(),await T(),v=async f=>{var H;const g=(f==null?void 0:f.detail)||{};if(g.storeName==="contacts"){const K=y(o.friendId);K!=null&&((g==null?void 0:g.key)===K||((H=g==null?void 0:g.data)==null?void 0:H.id)===K)&&await I()}g.storeName==="momentPosts"&&await _()},window.addEventListener("idb-change",v)}),Dt(()=>{u&&clearInterval(u),v&&window.removeEventListener("idb-change",v)}),Pt(()=>o.friendId,async()=>{await $(),await T()});const b=()=>{const f=new Date;l.value=`${String(f.getHours()).padStart(2,"0")}:${String(f.getMinutes()).padStart(2,"0")}`},y=f=>{if(f==null||f==="")return null;if(typeof f=="number")return f;const g=Number(f);return Number.isFinite(g)?g:f},M=(f="")=>String(f).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),A=(f="")=>M(f||"").replace(/\n/g,"<br>"),w=f=>{const g=(f||"").trim();return g?`@${g.toLowerCase().replace(/\s+/g,"_")}`:"@user"},k=f=>{const g=Number(f||0);if(!g)return"";const H=Date.now()-g,K=Math.floor(H/6e4);if(K<1)return"";if(K<60)return`${K}`;const F=Math.floor(K/60);return F<24?`${F}`:`${Math.floor(F/24)}`},I=async()=>{const f=y(o.friendId);if(f!=null)try{const g=await C.getContact(f);if(!g){d.value={...d.value,id:f,name:"",username:"",avatar:"",bioHtml:""};return}d.value={...d.value,id:f,name:(g==null?void 0:g.name)||"Unknown",username:(g==null?void 0:g.username)||w(g==null?void 0:g.name),avatar:(g==null?void 0:g.avatar)||"",bioHtml:A((g==null?void 0:g.bio)||"")}}catch(g){console.error(":",g)}},_=async()=>{const f=y(o.friendId);if(f!=null)try{const H=(await C.getMomentPosts()||[]).filter(K=>K&&K.author_id===f).sort((K,F)=>(F.createdAt||0)-(K.createdAt||0)).map(K=>({id:K.id,time:k(K.createdAt),content:K.content||"",image:K.image||"",likes:K.likes||0,comments:(K.comments||[]).length,shares:K.shares||0}));d.value={...d.value,posts:H}}catch(g){console.error(":",g)}},$=async()=>{await I(),await _()},T=async()=>{const f=y(o.friendId);if(f==null){i.value=a[Math.floor(Math.random()*a.length)];return}try{const H=(await C.getSetting("moment_contact_cards")||{})[f]||[];if(H.length>0){i.value=H[Math.floor(Math.random()*H.length)];return}const K=await C.getSetting("moment_public_cards")||[];if(K.length>0){i.value=K[Math.floor(Math.random()*K.length)];return}i.value=a[Math.floor(Math.random()*a.length)]}catch(g){console.error(":",g),i.value=a[Math.floor(Math.random()*a.length)]}},q=()=>{r.value&&(r.value.currentTime=0,r.value.play().catch(f=>console.log("Audio disabled")))},oe=f=>{const g=document.createElement("div");g.className="heart-effect",g.innerHTML="",g.style.left=f.clientX+"px",g.style.top=f.clientY+"px",document.body.appendChild(g),setTimeout(()=>g.remove(),3e3)},se=f=>{if(q(),f===""){n("chat",y(o.friendId)),P(" TA ");return}P(`${f}`)},J=()=>{q(),P("..."),n("back")},N=f=>{f.target.scrollTop},P=f=>{const g=document.createElement("div");g.className="kawaii-toast-view",g.textContent=f,document.body.appendChild(g),setTimeout(()=>g.classList.add("show"),10),setTimeout(()=>{g.classList.remove("show"),setTimeout(()=>g.remove(),300)},2e3)};return(f,g)=>(p(),m("div",{class:"kawaii-container",onClick:oe},[e("div",ew,[e("div",tw,[e("div",sw,[e("span",null,S(l.value),1)]),g[8]||(g[8]=dt('<div class="status-bar-right" data-v-6f498a44><svg class="status-icon-svg" viewBox="0 0 24 24" data-v-6f498a44><path d="M20,20h2v-2h-2V20z M18,20h-2v-4h2V20z M14,20h-2v-6h2V20z M10,20H8v-8h2V20z M6,20H4v-10h2V20z" data-v-6f498a44></path></svg><svg class="status-icon-svg" viewBox="0 0 24 24" data-v-6f498a44><path d="M12,3C7.41,3,3.86,4.53,0.96,7.03L2.37,8.44C4.89,6.31,8.06,5,12,5s7.11,1.31,9.63,3.44l1.41-1.41C20.14,4.53,16.59,3,12,3z M12,7C9.3,7,6.81,7.89,4.8,9.4l1.4,1.4C7.6,9.67,9.69,9,12,9s4.4,0.67,5.8,1.8l1.4-1.4C17.19,7.89,14.7,7,12,7z M12,11c-1.94,0-3.5,0.5-4.7,1.3l1.4,1.4c0.8-0.5,2-0.7,3.3-0.7s2.5,0.2,3.3,0.7l1.4-1.4C15.5,11.5,13.94,11,12,11z M12,15c-0.85,0-1.5,0.15-2,0.4l2,2l2-2C13.5,15.15,12.85,15,12,15z" data-v-6f498a44></path></svg><svg class="status-icon-svg" viewBox="0 0 24 24" data-v-6f498a44><path d="M15.67,4H14V2h-4v2H8.33C7.6,4,7,4.6,7,5.33v15.33C7,21.4,7.6,22,8.33,22h7.33c0.74,0,1.33-0.6,1.33-1.33V5.33C17,4.6,16.4,4,15.67,4z M15,20H9V6h6V20z" data-v-6f498a44></path></svg></div>',1))]),e("div",{class:"app-container",onScroll:N,ref_key:"scrollArea",ref:c},[e("div",{class:"profile-section",style:Re({backgroundImage:`url(${i.value})`})},[e("div",{class:"back-button clickable",onClick:J},[...g[9]||(g[9]=[e("span",null,"",-1)])]),g[10]||(g[10]=e("div",{class:"profile-header-overlay"},null,-1)),e("div",{class:"profile-avatar",style:Re({backgroundImage:`url(${d.value.avatar||_l})`})},null,4),e("div",ow,[e("button",{class:"profile-action-btn clickable",onClick:g[0]||(g[0]=H=>se(""))},""),e("button",{class:"profile-action-btn clickable",onClick:g[1]||(g[1]=H=>se(""))},"")])],4),e("div",nw,[e("div",aw,S(d.value.name),1),e("div",lw,S(d.value.username),1),e("div",{class:"profile-bio",innerHTML:d.value.bioHtml},null,8,iw),e("div",rw,[e("div",{class:"stat-item clickable",onClick:g[2]||(g[2]=H=>se(""))},[e("span",null,S(d.value.stats.following),1),g[11]||(g[11]=e("span",null,"",-1))]),e("div",{class:"stat-item clickable",onClick:g[3]||(g[3]=H=>se(""))},[e("span",null,S(d.value.stats.followers),1),g[12]||(g[12]=e("span",null,"",-1))]),e("div",{class:"stat-item clickable",onClick:g[4]||(g[4]=H=>se(""))},[e("span",null,S(d.value.stats.likes),1),g[13]||(g[13]=e("span",null,"",-1))])])]),e("div",cw,[d.value.posts.length===0?(p(),m("div",dw," TA  ")):U("",!0),(p(!0),m(Pe,null,Fe(d.value.posts,H=>(p(),m("div",{key:H.id,class:"tweet fade-in"},[e("div",uw,[e("div",{class:"tweet-avatar",style:Re({backgroundImage:`url(${d.value.avatar||_l})`})},null,4),e("div",vw,[e("div",pw,S(d.value.name),1),e("div",fw,S(H.time),1)])]),e("div",mw,S(H.content),1),H.image?(p(),m("div",{key:0,class:"tweet-image",style:Re({backgroundImage:`url(${H.image})`})},null,4)):U("",!0),e("div",gw,[e("div",{class:"tweet-action clickable",onClick:g[5]||(g[5]=K=>se(""))}," "+S(H.likes),1),e("div",{class:"tweet-action clickable",onClick:g[6]||(g[6]=K=>se(""))}," "+S(H.comments),1),e("div",{class:"tweet-action clickable",onClick:g[7]||(g[7]=K=>se(""))}," "+S(H.shares),1)])]))),128))])],544)])]))}},yw=Ze(hw,[["__scopeId","data-v-6f498a44"]]),bw={class:"phone-container"},ww={class:"worldbook-container"},kw={class:"worldbook-header"},xw={class:"header-actions"},Cw={class:"worldbook-content"},$w={key:0,class:"empty-state"},_w={class:"empty-actions"},Mw={key:1,class:"book-list"},Sw=["onClick"],Iw={class:"book-info"},Aw={class:"book-name"},Lw={class:"book-meta"},Tw=["onClick"],jw={class:"modal-content"},Pw={class:"import-area"},Ew={key:0},Bw={key:1,class:"file-name"},Vw={key:0,class:"file-info"},Hw={class:"modal-actions"},Dw=["disabled"],Fw={class:"modal-content"},Uw={class:"modal-actions"},Nw={key:2,class:"book-editor-fullscreen"},Ow={class:"editor-header"},Rw={class:"editor-body"},zw={key:0,class:"empty-entries"},Ww={key:1,class:"entry-list-mobile"},Kw=["onClick","onTouchstart","onMousedown"],Gw={class:"entry-card-info"},qw={class:"entry-number"},Zw=["onClick","title"],Jw={key:0,viewBox:"0 0 24 24",width:"16",height:"16"},Yw={key:1,viewBox:"0 0 24 24",width:"16",height:"16"},Xw={class:"entry-keys"},Qw={class:"entry-card-actions"},e4={key:0,class:"entry-edit-area"},t4={class:"form-group"},s4={class:"form-group"},o4={class:"form-group"},n4={class:"form-group"},a4={class:"checkbox-label"},l4={class:"form-group"},i4={class:"checkbox-label"},r4={key:1,class:"entry-preview"},c4={key:3,class:"toast"},d4={__name:"WorldBook",emits:["back"],setup(t,{emit:s}){const o=s,n=h([]),a=h([]),l=h(!1),i=h(!1),r=h(""),c=h(null),d=h([]),u=h(null),v=h(""),b=h(""),y=h(""),M=h(!0),A=h(!1),w=h(!1),k=h(""),I=h(null),_=h(null),$=h(null),T=h(null),q=h(!1),oe=W=>a.value.filter(B=>B.bookName===W).length,se=W=>!W||W.length===0?"":W.slice(0,3).join(", ")+(W.length>3?"...":""),J=W=>W<1024?W+" B":W<1024*1024?(W/1024).toFixed(2)+" KB":(W/(1024*1024)).toFixed(2)+" MB",N=W=>{k.value=W,w.value=!0,setTimeout(()=>{w.value=!1},2e3)},P=async()=>{try{n.value=await C.getWorldBookNames(),a.value=await C.getAllWorldBooks()}catch(W){console.error(":",W)}},f=async()=>{const W=r.value.trim();if(!W){N("");return}if(n.value.includes(W)){N("");return}try{await C.addWorldBookEntry({bookName:W,keys:[""],content:`"${W}"



"+"`,enabled:!0,createdAt:Date.now()}),l.value=!1,r.value="",await P(),N(` "${W}"`),F(W)}catch(B){console.error(":",B),N(""+B.message)}},g=W=>{const B=W.target.files[0];B&&(I.value=B)},H=()=>{i.value=!1,I.value=null,_.value&&(_.value.value="")},K=async()=>{if(!I.value){N("");return}try{const W=await I.value.text(),B=JSON.parse(W);if(!B.entries||typeof B.entries!="object"){N(" ");return}let D=I.value.name.replace(".json","").replace("","").trim();D||(D="_"+Date.now()),n.value.includes(D)&&(confirm(`"${D}"`)?await C.deleteWorldBook(D):D=D+"_"+Date.now());let xe=0;const V=Object.values(B.entries);for(const O of V)try{const z={bookName:D,keys:O.key||[],content:O.content||"",comment:O.comment||"",enabled:O.disable!==!0,constant:O.constant||!1,selective:O.selective!==!1,createdAt:Date.now()};await C.addWorldBookEntry(z),xe++}catch(z){console.error(":",z)}H(),await P(),N(`  ${xe} "${D}"`),F(D)}catch(W){console.error(":",W),N(" "+W.message)}},F=async W=>{c.value=W,d.value=await C.getWorldBookEntries(W),u.value=null},x=()=>{c.value=null,d.value=[],u.value=null},L=async()=>{const W={bookName:c.value,keys:[],content:"",comment:"",enabled:!0,createdAt:Date.now()},B=await C.addWorldBookEntry(W);d.value=await C.getWorldBookEntries(c.value);const D=d.value.find(xe=>xe.id===B.id);D&&ae(D),N("")},ae=W=>{var B;((B=u.value)==null?void 0:B.id)===W.id?u.value=null:(u.value=W,v.value=W.keys.join(", "),b.value=W.comment||"",y.value=W.content,M.value=W.enabled!==!1,A.value=W.constant===!0)},de=async W=>{const B=!W.constant,D={...W,constant:B,updatedAt:Date.now()};await C.updateWorldBookEntry(D),d.value=await C.getWorldBookEntries(c.value),N(B?" ":" ")},ue=W=>{q.value=!1,T.value=W,$.value=setTimeout(()=>{q.value||(he(W),$.value=null)},800)},$e=()=>{$.value&&(clearTimeout($.value),$.value=null),T.value=null,q.value=!1},ne=()=>{q.value=!0,$.value&&(clearTimeout($.value),$.value=null)},G=async()=>{if(!u.value)return;const W=v.value.split(",").map(D=>D.trim()).filter(D=>D),B={...u.value,keys:W,comment:b.value,content:y.value,enabled:M.value,constant:A.value,updatedAt:Date.now()};await C.updateWorldBookEntry(B),d.value=await C.getWorldBookEntries(c.value),u.value=B,N(" ")},he=async W=>{var B;confirm("")&&(await C.deleteWorldBookEntry(W),d.value=await C.getWorldBookEntries(c.value),((B=u.value)==null?void 0:B.id)===W&&(u.value=null),N(""))},j=async W=>{confirm(`"${W}"`)&&(await C.deleteWorldBook(W),await P(),N(""))},Q=()=>{o("back")};return nt(()=>{P()}),(W,B)=>(p(),m("div",bw,[e("div",ww,[e("div",kw,[e("div",{class:"back-btn",onClick:Q},[...B[14]||(B[14]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})],-1)])]),B[17]||(B[17]=e("h1",{class:"worldbook-title"},"",-1)),e("div",xw,[e("button",{class:"import-btn",onClick:B[0]||(B[0]=D=>i.value=!0),title:""},[...B[15]||(B[15]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12,19L8,15H10.5V12H13.5V15H16L12,19Z"})],-1)])]),e("button",{class:"add-book-btn",onClick:B[1]||(B[1]=D=>l.value=!0),title:""},[...B[16]||(B[16]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})],-1)])])])]),e("div",Cw,[n.value.length===0?(p(),m("div",$w,[B[20]||(B[20]=dt('<div class="empty-icon" data-v-11b56761></div><p class="empty-title" data-v-11b56761></p><p class="empty-hint" data-v-11b56761></p><div class="empty-tips" data-v-11b56761><div class="tip-item" data-v-11b56761><span class="tip-icon" data-v-11b56761>1</span><span class="tip-text" data-v-11b56761> JSON </span></div><div class="tip-item" data-v-11b56761><span class="tip-icon" data-v-11b56761>2</span><span class="tip-text" data-v-11b56761> + </span></div></div>',4)),e("div",_w,[e("button",{class:"btn-action",onClick:B[2]||(B[2]=D=>i.value=!0)},[...B[18]||(B[18]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12,19L8,15H10.5V12H13.5V15H16L12,19Z"})],-1),Qe("  ",-1)])]),e("button",{class:"btn-action primary",onClick:B[3]||(B[3]=D=>l.value=!0)},[...B[19]||(B[19]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})],-1),Qe("  ",-1)])])])])):(p(),m("div",Mw,[(p(!0),m(Pe,null,Fe(n.value,D=>(p(),m("div",{key:D,class:"book-item",onClick:xe=>F(D)},[B[22]||(B[22]=e("div",{class:"book-icon"},"",-1)),e("div",Iw,[e("div",Aw,S(D),1),e("div",Lw,S(oe(D))+" ",1)]),e("button",{class:"delete-btn",onClick:je(xe=>j(D),["stop"])},[...B[21]||(B[21]=[e("svg",{viewBox:"0 0 24 24",width:"18",height:"18"},[e("path",{fill:"currentColor",d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"})],-1)])],8,Tw)],8,Sw))),128))]))]),i.value?(p(),m("div",{key:0,class:"modal-overlay",onClick:B[5]||(B[5]=je(D=>i.value=!1,["self"]))},[e("div",jw,[B[24]||(B[24]=e("h3",null,"",-1)),e("div",Pw,[e("input",{ref_key:"fileInput",ref:_,type:"file",accept:".json",onChange:g,style:{display:"none"}},null,544),e("div",{class:"file-select-btn",onClick:B[4]||(B[4]=D=>W.$refs.fileInput.click())},[B[23]||(B[23]=e("svg",{viewBox:"0 0 24 24",width:"32",height:"32"},[e("path",{fill:"currentColor",d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12,19L8,15H10.5V12H13.5V15H16L12,19Z"})],-1)),I.value?(p(),m("p",Bw,S(I.value.name),1)):(p(),m("p",Ew," JSON "))]),I.value?(p(),m("div",Vw,[e("p",null,": "+S(J(I.value.size)),1)])):U("",!0)]),e("div",Hw,[e("button",{class:"btn btn-cancel",onClick:H},""),e("button",{class:"btn btn-confirm",onClick:K,disabled:!I.value},"",8,Dw)])])])):U("",!0),l.value?(p(),m("div",{key:1,class:"modal-overlay",onClick:B[8]||(B[8]=je(D=>l.value=!1,["self"]))},[e("div",Fw,[B[25]||(B[25]=e("h3",null,"",-1)),we(e("input",{"onUpdate:modelValue":B[6]||(B[6]=D=>r.value=D),type:"text",placeholder:"",class:"modal-input",onKeyup:Xt(f,["enter"])},null,544),[[Te,r.value]]),e("div",Uw,[e("button",{class:"btn btn-cancel",onClick:B[7]||(B[7]=D=>l.value=!1)},""),e("button",{class:"btn btn-confirm",onClick:f},"")])])])):U("",!0),c.value?(p(),m("div",Nw,[e("div",Ow,[e("button",{class:"back-btn",onClick:x},[...B[26]||(B[26]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{fill:"currentColor",d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})],-1)])]),e("h2",null,S(c.value),1),e("button",{class:"btn-add-entry-header",onClick:L},[...B[27]||(B[27]=[e("svg",{viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{fill:"currentColor",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})],-1)])])]),e("div",Rw,[d.value.length===0?(p(),m("div",zw,[B[28]||(B[28]=e("div",{class:"empty-icon"},"",-1)),B[29]||(B[29]=e("p",null,"",-1)),e("button",{class:"btn-add-first",onClick:L},"")])):(p(),m("div",Ww,[B[40]||(B[40]=e("div",{class:"entry-hint"}," ",-1)),(p(!0),m(Pe,null,Fe(d.value,(D,xe)=>{var V,O;return p(),m("div",{key:D.id,class:"entry-card"},[e("div",{class:"entry-card-header",onClick:z=>ae(D),onTouchstart:z=>ue(D.id),onTouchend:$e,onTouchmove:ne,onMousedown:z=>ue(D.id),onMouseup:$e,onMouseleave:$e},[e("div",Gw,[e("span",qw,"#"+S(xe+1),1),e("button",{class:Ie(["constant-toggle-btn",{active:D.constant}]),onClick:je(z=>de(D),["stop"]),title:D.constant?"":""},[D.constant?(p(),m("svg",Jw,[...B[30]||(B[30]=[e("path",{fill:"currentColor",d:"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"},null,-1)])])):(p(),m("svg",Yw,[...B[31]||(B[31]=[e("path",{fill:"currentColor",d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},null,-1)])]))],10,Zw),e("span",Xw,S(se(D.keys)),1)]),e("div",Qw,[(p(),m("svg",{class:Ie(["expand-icon",{expanded:((V=u.value)==null?void 0:V.id)===D.id}]),viewBox:"0 0 24 24",width:"20",height:"20"},[...B[32]||(B[32]=[e("path",{fill:"currentColor",d:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},null,-1)])],2))])],40,Kw),((O=u.value)==null?void 0:O.id)===D.id?(p(),m("div",e4,[e("div",t4,[B[33]||(B[33]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":B[9]||(B[9]=z=>v.value=z),type:"text",placeholder:",,",class:"form-input"},null,512),[[Te,v.value]])]),e("div",s4,[B[34]||(B[34]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":B[10]||(B[10]=z=>b.value=z),type:"text",placeholder:"",class:"form-input"},null,512),[[Te,b.value]])]),e("div",o4,[B[35]||(B[35]=e("label",null,"",-1)),we(e("textarea",{"onUpdate:modelValue":B[11]||(B[11]=z=>y.value=z),placeholder:"...",class:"form-textarea",rows:"8"},null,512),[[Te,y.value]])]),e("div",n4,[e("label",a4,[we(e("input",{type:"checkbox","onUpdate:modelValue":B[12]||(B[12]=z=>M.value=z)},null,512),[[es,M.value]]),B[36]||(B[36]=e("span",null,"",-1))])]),e("div",l4,[e("label",i4,[we(e("input",{type:"checkbox","onUpdate:modelValue":B[13]||(B[13]=z=>A.value=z)},null,512),[[es,A.value]]),B[37]||(B[37]=e("span",null," ",-1))]),B[38]||(B[38]=e("p",{class:"form-hint"},"",-1))]),e("button",{class:"btn-save-entry",onClick:G},[...B[39]||(B[39]=[e("svg",{viewBox:"0 0 24 24",width:"18",height:"18"},[e("path",{fill:"currentColor",d:"M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"})],-1),Qe("  ",-1)])])])):(p(),m("div",r4,S(D.content.substring(0,80))+S(D.content.length>80?"...":""),1))])}),128))]))])])):U("",!0),w.value?(p(),m("div",c4,S(k.value),1)):U("",!0)])]))}},u4=Ze(d4,[["__scopeId","data-v-11b56761"]]),v4={key:0,class:"ph-view"},p4={class:"ph-header"},f4={class:"header-left"},m4=["disabled"],g4={key:0,viewBox:"0 0 24 24"},h4={key:1,viewBox:"0 0 24 24",class:"loading"},y4={class:"ph-content"},b4=["onClick"],w4={class:"thumb-wrap"},k4=["src"],x4={class:"duration"},C4={class:"video-info"},$4={class:"title"},_4={class:"meta"},M4={class:"views"},S4={class:"rating"},I4={__name:"pornhuview",props:{isVisible:Boolean},emits:["close","go-to-profile","open-video"],setup(t,{emit:s}){const o=s,n=h([]),a=h(!1);nt(async()=>{await l()});const l=async()=>{try{const v=await C.getSetting("pornhub_videos");v&&v.length>0?n.value=v:n.value=[{id:1,title:" -  1",thumb:"https://picsum.photos/seed/ph1/400/225",duration:"12:45",views:"123K",time:"2",rating:98},{id:2,title:" Vue ",thumb:"https://picsum.photos/seed/ph2/400/225",duration:"08:20",views:"85K",time:"1",rating:95}]}catch(v){console.error(":",v)}},i=async()=>{if(!a.value)try{a.value=!0;const{aiService:v}=await ls(async()=>{const{aiService:_}=await Promise.resolve().then(()=>ca);return{aiService:_}},void 0),b=await v.getApiConfig();if(!b.apiKey||!b.model){alert(" AI API"),a.value=!1;return}if(!await C.getSetting("pornhub_generation_prompt")){alert(" "),a.value=!1;return}const M=await C.getContacts();if(!M||M.length===0){alert(" "),a.value=!1;return}const A=await C.getSetting("pornhub_writing_style")||"",w=await C.getSetting("userNickname")||"",k=[];let I=Date.now();for(const _ of M){const $=Math.random()>.5?2:1,T=await C.getSetting(`pornhub_${_.id}_videoTypes`)||"",q=await C.getSetting(`pornhub_${_.id}_style`)||"";for(let oe=0;oe<$;oe++){const se=await r(_.name,T,b),J={id:I++,contactId:_.id,contactName:_.name,title:se||`${_.name} - ${new Date().toLocaleDateString()}`,thumb:`https://picsum.photos/seed/ph${I}/400/225`,duration:`${Math.floor(Math.random()*20+5)}:${String(Math.floor(Math.random()*60)).padStart(2,"0")}`,views:`${Math.floor(Math.random()*500+50)}K`,time:["","1","","","2"][Math.floor(Math.random()*5)],rating:Math.floor(Math.random()*10+90),videoTypes:T,contentStyle:q,writingStyle:A,partnerName:w};k.push(J)}}n.value=k,await C.setSetting("pornhub_videos",k),alert(`  ${k.length} 

""`)}catch(v){console.error(":",v),alert(` ${v.message}`)}finally{a.value=!1}},r=async(v,b,y)=>{try{let M=y.baseUrl||"";M.endsWith("/v1")?M=M.slice(0,-3):M.endsWith("/")&&(M=M.slice(0,-1));const w=`${{deepseek:M||"https://api.deepseek.com",gemini:M||"https://generativelanguage.googleapis.com",openai:M||"https://api.openai.com"}[y.provider]}/v1/chat/completions`,k=await fetch(w,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y.apiKey}`},body:JSON.stringify({model:y.model,messages:[{role:"system",content:""},{role:"user",content:`15-30
${v}
${b}

`}],temperature:.9,max_tokens:100})});if(k.ok)return(await k.json()).choices[0].message.content.trim()}catch(M){console.error(":",M)}return null},c=()=>{o("close")},d=()=>{o("go-to-profile")},u=v=>{o("open-video",v)};return(v,b)=>t.isVisible?(p(),m("div",v4,[e("header",p4,[e("div",f4,[e("div",{class:"ph-logo",onClick:c},[...b[0]||(b[0]=[Qe(" Porn",-1),e("span",null,"hub",-1)])]),e("button",{onClick:i,class:"ai-generate-icon",disabled:a.value,title:"AI"},[a.value?(p(),m("svg",h4,[...b[2]||(b[2]=[e("path",{fill:"currentColor",d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"},null,-1)])])):(p(),m("svg",g4,[...b[1]||(b[1]=[e("path",{fill:"currentColor",d:"M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.64 6.35,17.66C9.37,20.67 14.19,20.78 17.33,17.97Z"},null,-1)])]))],8,m4)]),e("div",{class:"close-btn",onClick:c},"")]),e("div",y4,[(p(!0),m(Pe,null,Fe(n.value,y=>(p(),m("div",{key:y.id,class:"video-card",onClick:M=>u(y)},[e("div",w4,[e("img",{src:y.thumb,alt:"thumb"},null,8,k4),e("span",x4,S(y.duration),1)]),e("div",C4,[e("h4",$4,S(y.title),1),e("div",_4,[e("span",M4,S(y.views)+"   "+S(y.time),1),e("span",S4,S(y.rating)+"%",1)])])],8,b4))),128))]),e("footer",{class:"ph-tabbar"},[b[4]||(b[4]=dt('<div class="tab-item active" data-v-b1d922cb><svg viewBox="0 0 24 24" class="icon" data-v-b1d922cb><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" data-v-b1d922cb></path></svg><span data-v-b1d922cb></span></div><div class="tab-item" data-v-b1d922cb><div class="upload-btn" data-v-b1d922cb>+</div><span data-v-b1d922cb></span></div>',2)),e("div",{class:"tab-item",onClick:d},[...b[3]||(b[3]=[e("svg",{viewBox:"0 0 24 24",class:"icon"},[e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"})],-1),e("span",null,"",-1)])])])])):U("",!0)}},A4=Ze(I4,[["__scopeId","data-v-b1d922cb"]]),L4={key:0,class:"ph-profile-view"},T4={class:"user-info-card"},j4=["src"],P4={class:"user-details"},E4={class:"name-badge-wrapper"},B4={class:"stats-bar"},V4={class:"stat-item"},H4={class:"stat-value"},D4={class:"stat-value"},F4={class:"stat-item"},U4={class:"stat-value"},N4={__name:"pornhubprofile",props:{isVisible:Boolean},emits:["back-to-home","go-to-settings","go-to-favorites"],setup(t,{emit:s}){const o=s,n=h(""),a=h("https://api.dicebear.com/7.x/avataaars/svg?seed=Lucky"),l=h("linear-gradient(180deg, #333 0%, #1b1b1b 100%)"),i=h(null),r=h(null),c=h(0),d=h("0"),u=h(0);nt(async()=>{try{const $=await C.getSetting("pornhub_username"),T=await C.getSetting("pornhub_avatar"),q=await C.getSetting("pornhub_background"),oe=await C.getSetting("pornhub_subscribers"),se=await C.getSetting("pornhub_upload_count"),J=await C.getSetting("pornhub_favorite_count");$&&(n.value=$),T&&(a.value=T),q&&(l.value=q),oe&&(d.value=oe),se!==void 0&&(c.value=se),J!==void 0&&(u.value=J)}catch($){console.error(":",$)}});const v=()=>{var $;($=i.value)==null||$.click()},b=async $=>{const T=$.target.files[0];if(T){const q=new FileReader;q.onload=async oe=>{a.value=oe.target.result;try{await C.setSetting("pornhub_avatar",oe.target.result),console.log("")}catch(se){console.error(":",se)}},q.readAsDataURL(T)}},y=()=>{var $;($=r.value)==null||$.click()},M=async $=>{const T=$.target.files[0];if(T){const q=new FileReader;q.onload=async oe=>{l.value=oe.target.result;try{await C.setSetting("pornhub_background",oe.target.result),console.log("")}catch(se){console.error(":",se)}},q.readAsDataURL(T)}},A=async()=>{if(n.value&&n.value.trim())try{await C.setSetting("pornhub_username",n.value.trim()),console.log("")}catch($){console.error(":",$)}},w=async()=>{const $=prompt(":",d.value);if($!==null&&$.trim()){d.value=$.trim();try{await C.setSetting("pornhub_subscribers",$.trim()),console.log("")}catch(T){console.error(":",T)}}},k=()=>{o("back-to-home")},I=()=>{o("go-to-settings")},_=()=>{o("go-to-favorites")};return($,T)=>t.isVisible?(p(),m("div",L4,[e("div",{class:"profile-header-bg",onClick:y,style:Re({backgroundImage:`url(${l.value})`})},[T[1]||(T[1]=e("div",{class:"bg-overlay"},[e("svg",{viewBox:"0 0 24 24",class:"camera-icon"},[e("path",{fill:"currentColor",d:"M4,4H7L9,2H15L17,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4A2,2 0 0,1 2,18V6A2,2 0 0,1 4,4M12,7A5,5 0 0,0 7,12A5,5 0 0,0 12,17A5,5 0 0,0 17,12A5,5 0 0,0 12,7M12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9Z"})])],-1)),e("input",{type:"file",ref_key:"backgroundInput",ref:r,onChange:M,accept:"image/*",style:{display:"none"}},null,544)],4),e("div",T4,[e("div",{class:"avatar-container",onClick:v},[e("img",{src:a.value,alt:"Avatar"},null,8,j4),T[2]||(T[2]=e("div",{class:"avatar-overlay"},[e("svg",{viewBox:"0 0 24 24",class:"camera-icon"},[e("path",{fill:"currentColor",d:"M4,4H7L9,2H15L17,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4A2,2 0 0,1 2,18V6A2,2 0 0,1 4,4M12,7A5,5 0 0,0 7,12A5,5 0 0,0 12,17A5,5 0 0,0 17,12A5,5 0 0,0 12,7M12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9Z"})])],-1)),e("input",{type:"file",ref_key:"avatarInput",ref:i,onChange:b,accept:"image/*",style:{display:"none"}},null,544)]),e("div",P4,[e("div",E4,[we(e("input",{"onUpdate:modelValue":T[0]||(T[0]=q=>n.value=q),onBlur:A,onKeyup:Xt(A,["enter"]),class:"user-name-input",placeholder:""},null,544),[[Te,n.value]]),T[3]||(T[3]=e("span",{class:"vip-badge"},"Premium",-1))])]),e("div",B4,[e("div",V4,[e("div",H4,S(c.value),1),T[4]||(T[4]=e("div",{class:"stat-label"},"",-1))]),e("div",{class:"stat-item",onClick:w},[e("div",D4,S(d.value),1),T[5]||(T[5]=e("div",{class:"stat-label"},"",-1))]),e("div",F4,[e("div",U4,S(u.value),1),T[6]||(T[6]=e("div",{class:"stat-label"},"",-1))])])]),e("div",{class:"menu-section"},[e("div",{class:"menu-group"},[T[8]||(T[8]=dt('<div class="menu-item" data-v-0096e537><div class="menu-left" data-v-0096e537><svg class="menu-icon" viewBox="0 0 24 24" data-v-0096e537><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm4.59-12.42L10 14.17l-2.59-2.58L6 13l4 4 8-8z" data-v-0096e537></path></svg><span class="menu-text" data-v-0096e537></span></div><div class="menu-right" data-v-0096e537></div></div>',1)),e("div",{class:"menu-item",onClick:_},[...T[7]||(T[7]=[dt('<div class="menu-left" data-v-0096e537><svg class="menu-icon" viewBox="0 0 24 24" data-v-0096e537><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" data-v-0096e537></path></svg><span class="menu-text" data-v-0096e537></span></div><div class="menu-right" data-v-0096e537></div>',2)])])]),e("div",{class:"menu-group"},[e("div",{class:"menu-item",onClick:I},[...T[9]||(T[9]=[dt('<div class="menu-left" data-v-0096e537><svg class="menu-icon" viewBox="0 0 24 24" data-v-0096e537><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z" data-v-0096e537></path></svg><span class="menu-text" data-v-0096e537></span></div><div class="menu-right" data-v-0096e537></div>',2)])])])]),T[12]||(T[12]=e("div",{class:"logout-btn"},"",-1)),e("footer",{class:"ph-tabbar"},[e("div",{class:"tab-item",onClick:k},[...T[10]||(T[10]=[e("svg",{viewBox:"0 0 24 24"},[e("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})],-1),e("span",null,"",-1)])]),T[11]||(T[11]=dt('<div class="tab-item" data-v-0096e537><div class="upload-btn" data-v-0096e537>+</div><span data-v-0096e537></span></div><div class="tab-item active" data-v-0096e537><svg viewBox="0 0 24 24" data-v-0096e537><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" data-v-0096e537></path></svg><span data-v-0096e537></span></div>',2))])])):U("",!0)}},O4=Ze(N4,[["__scopeId","data-v-0096e537"]]),R4={key:0,class:"ph-settings-view"},z4={class:"settings-content"},W4={class:"character-list"},K4=["onClick"],G4=["src","alt"],q4={class:"character-info"},Z4={class:"character-name"},J4={class:"character-desc"},Y4={class:"writing-style-section"},X4={class:"setting-group"},Q4={class:"generation-rules-section"},e5={class:"setting-group"},t5={class:"setting-group"},s5=`


- {}
- {}
- {}
- {}
- {}


1. 800-1500
2. 
3. 
4. 
5. 
6. 


- 
- 
- 
- 
- 

`,o5=`4-51-2


1. 20-60
2. 
3. 
4. 
5. 
6. HTML<br><p>


1. 1-2
2. 
3. 
4. @ 


|
|@ 


|
_99|
|
{}|@ ~
|
|


- HTML
- 
- 
- {}`,n5={__name:"pornhubsetting",props:{isVisible:Boolean},emits:["back","edit-character"],setup(t,{emit:s}){const o=s,n=h([]),a=h(""),l=h(""),i=h(""),r=h("");nt(async()=>{try{n.value=await C.getContacts();const b=await C.getSetting("userNickname");b&&(a.value=b);const y=await C.getSetting("pornhub_writing_style");y?l.value=y:l.value="";const M=await C.getSetting("pornhub_generation_prompt");M?i.value=M:i.value=s5;const A=await C.getSetting("pornhub_comment_prompt");A?r.value=A:r.value=o5}catch(b){console.error(":",b)}});const c=b=>{o("edit-character",b)},d=async()=>{try{await C.setSetting("pornhub_writing_style",l.value),console.log(""),alert(" ")}catch(b){console.error(":",b),alert("")}},u=async()=>{try{await C.setSetting("pornhub_generation_prompt",i.value),await C.setSetting("pornhub_comment_prompt",r.value),console.log(""),alert(` AI

AI`)}catch(b){console.error(":",b),alert("")}},v=()=>{o("back")};return(b,y)=>t.isVisible?(p(),m("div",R4,[e("header",{class:"ph-header"},[e("div",{class:"back-btn",onClick:v},[...y[3]||(y[3]=[e("svg",{viewBox:"0 0 24 24",class:"icon"},[e("path",{fill:"currentColor",d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})],-1)])]),y[4]||(y[4]=e("h2",{class:"header-title"},"",-1)),y[5]||(y[5]=e("div",{class:"placeholder"},null,-1))]),e("div",z4,[y[17]||(y[17]=e("div",{class:"section-title"},"",-1)),e("div",W4,[(p(!0),m(Pe,null,Fe(n.value,M=>(p(),m("div",{key:M.id,class:"character-card",onClick:A=>c(M)},[e("img",{src:M.avatar,alt:M.name,class:"character-avatar"},null,8,G4),e("div",q4,[e("div",Z4,S(M.name),1),e("div",J4,S(M.description||""),1)]),y[6]||(y[6]=e("svg",{viewBox:"0 0 24 24",class:"arrow-icon"},[e("path",{fill:"currentColor",d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"})],-1))],8,K4))),128))]),e("div",Y4,[y[10]||(y[10]=e("div",{class:"section-title"},"",-1)),e("div",X4,[y[7]||(y[7]=e("label",{class:"setting-label"},"",-1)),we(e("textarea",{"onUpdate:modelValue":y[0]||(y[0]=M=>l.value=M),class:"setting-textarea",placeholder:"AI",rows:"4"},null,512),[[Te,l.value]]),y[8]||(y[8]=e("div",{class:"setting-hint"}," ",-1))]),e("button",{onClick:d,class:"save-btn"},[...y[9]||(y[9]=[e("svg",{viewBox:"0 0 24 24",class:"btn-icon"},[e("path",{fill:"currentColor",d:"M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"})],-1),Qe("  ",-1)])])]),e("div",Q4,[y[15]||(y[15]=e("div",{class:"section-title"},[e("svg",{viewBox:"0 0 24 24",class:"title-icon"},[e("path",{fill:"currentColor",d:"M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.64 6.35,17.66C9.37,20.67 14.19,20.78 17.33,17.97Z"})]),Qe(" AI ")],-1)),y[16]||(y[16]=e("div",{class:"rules-description"},[e("p",null," AI"),e("p",null,"AI")],-1)),e("div",e5,[y[11]||(y[11]=e("label",{class:"setting-label"},"",-1)),we(e("textarea",{"onUpdate:modelValue":y[1]||(y[1]=M=>i.value=M),class:"setting-textarea large",placeholder:`AI


- {}
- {}
- {}
- {}
- {}


1. 
2. 
3. 500-1000
4. 

AI`,rows:"12"},null,512),[[Te,i.value]]),y[12]||(y[12]=e("div",{class:"setting-hint"},"   {}{}{}{}{} ",-1))]),e("div",t5,[y[13]||(y[13]=e("label",{class:"setting-label"},"",-1)),we(e("textarea",{"onUpdate:modelValue":y[2]||(y[2]=M=>r.value=M),class:"setting-textarea",placeholder:`

3-5
1. 
2. 
3. 20-50
4. `,rows:"6"},null,512),[[Te,r.value]])]),e("button",{onClick:u,class:"save-btn"},[...y[14]||(y[14]=[e("svg",{viewBox:"0 0 24 24",class:"btn-icon"},[e("path",{fill:"currentColor",d:"M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"})],-1),Qe("  ",-1)])])])])])):U("",!0)}},a5=Ze(n5,[["__scopeId","data-v-3bcc7e68"]]),l5={key:0,class:"video-detail-view"},i5=["src"],r5={key:1,class:"video-content-text"},c5={class:"content-scroll-area"},d5={key:0,class:"content-text"},u5={key:1,class:"content-placeholder"},v5=["disabled"],p5={key:0,viewBox:"0 0 24 24",class:"btn-icon"},f5={key:1,viewBox:"0 0 24 24",class:"btn-icon loading"},m5={key:2,class:"play-button-overlay"},g5={class:"player-controls"},h5={class:"play-pause-icon",viewBox:"0 0 24 24"},y5={key:0,d:"M8 5v14l11-7z"},b5={key:1,d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"},w5={class:"progress-bar"},k5={class:"time-display"},x5={class:"video-details"},C5={class:"video-title"},$5={class:"video-meta-info"},_5={class:"action-bar"},M5={class:"channel-info"},S5={class:"channel-left"},I5={class:"channel-avatar"},A5=["src","alt"],L5={class:"channel-name"},T5={class:"subscriber-count"},j5={class:"comments-section"},P5={class:"comments-header"},E5={class:"comments-count"},B5={class:"comment-input-area"},V5={class:"user-mini-avatar"},H5=["src"],D5={class:"input-wrapper"},F5={key:0,class:"replying-to"},U5=["placeholder"],N5={class:"comment-list"},O5={class:"user-mini-avatar"},R5=["src"],z5={class:"comment-right"},W5={key:0,class:"creator-badge"},K5={class:"comment-text"},G5={class:"comment-footer"},q5=["onClick"],Z5=["onClick"],J5={key:0,class:"replies-list"},Y5={class:"user-mini-avatar-small"},X5=["src"],Q5={class:"reply-right"},ek={class:"comment-user"},tk={class:"comment-text"},sk={class:"comment-footer"},ok=["onClick"],nk={__name:"videodetail",props:{isVisible:Boolean,video:{type:Object,default:()=>({id:1,title:" UI ",thumb:"https://picsum.photos/seed/video1/800/450",duration:"12:45",views:"1,284,502",time:"2",rating:98})}},emits:["back"],setup(t,{emit:s}){const o=t,n=s,a=h(!1),l=h(!1),i=h(!1),r=h(!1),c=h(""),d=h(""),u=h(null),v=h("https://api.dicebear.com/7.x/avataaars/svg?seed=Lucky"),b=h([]),y=h("https://api.dicebear.com/7.x/avataaars/svg?seed=Channel"),M=h(""),A=h("0 ");nt(async()=>{try{const P=await C.getSetting("pornhub_avatar");if(P&&(v.value=P),o.video.contactId){const L=await C.getContact(o.video.contactId);L&&(M.value=L.name,y.value=L.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${L.name}`,A.value=`${Math.floor(Math.random()*500+100)}K `)}else o.video.contactName&&(M.value=o.video.contactName,y.value=`https://api.dicebear.com/7.x/avataaars/svg?seed=${o.video.contactName}`,A.value=`${Math.floor(Math.random()*500+100)}K `);const f=`pornhub_favorite_${o.video.id}`;await C.getSetting(f)&&(l.value=!0);const H=`pornhub_like_${o.video.id}`;await C.getSetting(H)&&(a.value=!0);const F=`pornhub_content_${o.video.id}`,x=await C.getSetting(F);if(x){c.value=x;const L=`pornhub_comments_${o.video.id}`,ae=await C.getSetting(L);ae&&(b.value=ae)}}catch(P){console.error(":",P)}});const w=()=>{i.value=!i.value},k=async()=>{if(!r.value)try{r.value=!0;const P=await C.getSetting("pornhub_generation_prompt");if(!P){alert(" AI"),r.value=!1;return}const f=await C.getSetting("pornhub_writing_style")||"";let g="",H="",K="",F=await C.getSetting("userNickname")||"";if(o.video.contactId){const Q=await C.getContact(o.video.contactId);Q&&(g=Q.name,H=await C.getSetting(`pornhub_${Q.id}_videoTypes`)||"",K=await C.getSetting(`pornhub_${Q.id}_style`)||"")}else o.video.contactName&&(g=o.video.contactName,H=o.video.videoTypes||"",K=o.video.contentStyle||"",F=o.video.partnerName||F);let x=P.replace(/\{\}/g,g).replace(/\{\}/g,F).replace(/\{\}/g,H).replace(/\{\}/g,K).replace(/\{\}/g,f);const{aiService:L}=await ls(async()=>{const{aiService:Q}=await Promise.resolve().then(()=>ca);return{aiService:Q}},void 0),ae=await L.getApiConfig();if(!ae.apiKey||!ae.model){alert(" AI API"),r.value=!1;return}let de=ae.baseUrl||"";de.endsWith("/v1")?de=de.slice(0,-3):de.endsWith("/")&&(de=de.slice(0,-1));const $e=`${{deepseek:de||"https://api.deepseek.com",gemini:de||"https://generativelanguage.googleapis.com",openai:de||"https://api.openai.com"}[ae.provider]}/v1/chat/completions`,ne=await fetch($e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ae.apiKey}`},body:JSON.stringify({model:ae.model,messages:[{role:"system",content:""},{role:"user",content:x}],temperature:.9,max_tokens:2e3})});if(!ne.ok)throw new Error(`HTTP error! status: ${ne.status}`);const he=(await ne.json()).choices[0].message.content;c.value=he;const j=`pornhub_content_${o.video.id}`;await C.setSetting(j,he),console.log(""),await _(he)}catch(P){console.error(":",P),alert(`${P.message}`)}finally{r.value=!1}},I=P=>P?P.replace(/<[^>]*>/g,"").trim():"",_=async P=>{try{let f=await C.getSetting("pornhub_comment_prompt");if(!f)return;let g=M.value;f=f.replace(/\{\}/g,g);const{aiService:H}=await ls(async()=>{const{aiService:de}=await Promise.resolve().then(()=>ca);return{aiService:de}},void 0),K=await H.getApiConfig();if(!K.apiKey||!K.model)return;let F=K.baseUrl||"";F.endsWith("/v1")?F=F.slice(0,-3):F.endsWith("/")&&(F=F.slice(0,-1));const L=`${{deepseek:F||"https://api.deepseek.com",gemini:F||"https://generativelanguage.googleapis.com",openai:F||"https://api.openai.com"}[K.provider]}/v1/chat/completions`,ae=await fetch(L,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${K.apiKey}`},body:JSON.stringify({model:K.model,messages:[{role:"system",content:"HTML"},{role:"user",content:`${f}

${o.video.title}

${P.substring(0,300)}...`}],temperature:.8,max_tokens:800})});if(ae.ok){const ue=(await ae.json()).choices[0].message.content;console.log(":",ue);const $e=ue.split(`
`).filter(G=>G.trim()),ne=[];for(const G of $e){const he=G.split("|");if(he.length>=2){const j=he[0].trim();let Q=he.slice(1).join("|").trim();if(Q=I(Q),j&&Q){const W=j===g;ne.push({id:Date.now()+Math.random(),username:j,avatar:W?y.value:`https://api.dicebear.com/7.x/avataaars/svg?seed=${j}`,text:Q,time:["","1","5","10","15"][Math.floor(Math.random()*5)],likes:Math.floor(Math.random()*1e3),isCharacter:W,replies:[]})}}}if(ne.length>0){b.value=ne;const G=`pornhub_comments_${o.video.id}`;await C.setSetting(G,ne)}}}catch(f){console.error(":",f)}},$=async()=>{a.value=!a.value;try{const P=`pornhub_like_${o.video.id}`;await C.setSetting(P,a.value)}catch(P){console.error(":",P)}},T=async()=>{l.value=!l.value;try{const P=`pornhub_favorite_${o.video.id}`;if(await C.setSetting(P,l.value),l.value){let f=await C.getSetting("pornhub_favorite_list")||[];const g={...o.video,favoritedAt:Date.now()};f.unshift(g),await C.setSetting("pornhub_favorite_list",f),await C.setSetting("pornhub_favorite_count",f.length)}else{let f=await C.getSetting("pornhub_favorite_list")||[];f=f.filter(g=>g.id!==o.video.id),await C.setSetting("pornhub_favorite_list",f),await C.setSetting("pornhub_favorite_count",f.length)}}catch(P){console.error(":",P)}},q=()=>{if(d.value.trim()){const P={id:Date.now(),username:"",avatar:v.value,text:d.value.trim(),time:"",likes:0,isCharacter:!1,replies:[]};if(u.value){const g=b.value.find(H=>H.id===u.value);g&&(g.replies||(g.replies=[]),g.replies.push(P)),u.value=null}else b.value.unshift(P);d.value="";const f=`pornhub_comments_${o.video.id}`;C.setSetting(f,b.value)}},oe=P=>{var f;u.value=P.id,d.value=`@${P.username} `,(f=document.querySelector(".comment-input-box"))==null||f.focus()},se=()=>{u.value=null,d.value=""},J=P=>{const f=b.value.find(g=>g.id===P);f&&(f.likes+=1)},N=()=>{n("back")};return(P,f)=>t.isVisible?(p(),m("div",l5,[e("div",{class:"nav-header"},[e("div",{class:"back-btn",onClick:N},""),f[1]||(f[1]=e("div",{class:"ph-logo-small"},[Qe("Porn"),e("span",null,"hub")],-1))]),e("div",{class:"video-player-container",onClick:w},[i.value?U("",!0):(p(),m("img",{key:0,src:t.video.thumb,alt:"Video Cover"},null,8,i5)),i.value?(p(),m("div",r5,[e("div",c5,[c.value?(p(),m("div",d5,S(c.value),1)):(p(),m("div",u5,[f[4]||(f[4]=e("svg",{viewBox:"0 0 24 24",class:"placeholder-icon"},[e("path",{fill:"currentColor",d:"M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.64 6.35,17.66C9.37,20.67 14.19,20.78 17.33,17.97Z"})],-1)),f[5]||(f[5]=e("p",{class:"placeholder-title"}," AI",-1)),f[6]||(f[6]=e("p",{class:"hint-text"},"AI",-1)),e("button",{onClick:k,class:"generate-content-btn",disabled:r.value},[r.value?(p(),m("svg",f5,[...f[3]||(f[3]=[e("path",{fill:"currentColor",d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"},null,-1)])])):(p(),m("svg",p5,[...f[2]||(f[2]=[e("path",{fill:"currentColor",d:"M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.64 6.35,17.66C9.37,20.67 14.19,20.78 17.33,17.97Z"},null,-1)])])),Qe(" "+S(r.value?"...":" "),1)],8,v5)]))])])):U("",!0),i.value?U("",!0):(p(),m("div",m5,[...f[7]||(f[7]=[e("svg",{class:"play-icon-large",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M8 5v14l11-7z"})],-1)])])),e("div",g5,[(p(),m("svg",h5,[i.value?(p(),m("path",b5)):(p(),m("path",y5))])),e("div",w5,[e("div",{class:"progress-current",style:Re({width:i.value?"100%":"0%"})},null,4)]),e("div",k5,S(t.video.duration),1)])]),e("div",x5,[e("h1",C5,S(t.video.title),1),e("div",$5,S(t.video.views)+"   "+S(t.video.time),1)]),e("div",_5,[e("div",{class:Ie(["action-item",{active:a.value}]),onClick:$},[f[8]||(f[8]=e("svg",{viewBox:"0 0 24 24"},[e("path",{d:"M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"})],-1)),e("span",null,S(t.video.rating)+"%",1)],2),f[10]||(f[10]=dt('<div class="action-item" data-v-9ec8ad43><svg viewBox="0 0 24 24" data-v-9ec8ad43><path d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.37-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z" data-v-9ec8ad43></path></svg><span data-v-9ec8ad43></span></div><div class="action-item" data-v-9ec8ad43><svg viewBox="0 0 24 24" data-v-9ec8ad43><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z" data-v-9ec8ad43></path></svg><span data-v-9ec8ad43></span></div><div class="action-item" data-v-9ec8ad43><svg viewBox="0 0 24 24" data-v-9ec8ad43><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" data-v-9ec8ad43></path></svg><span data-v-9ec8ad43></span></div>',3)),e("div",{class:Ie(["action-item",{active:l.value}]),onClick:T},[f[9]||(f[9]=e("svg",{viewBox:"0 0 24 24"},[e("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2zm0 15l-5-2.18L7 18V5h10v13z"})],-1)),e("span",null,S(l.value?"":""),1)],2)]),e("div",M5,[e("div",S5,[e("div",I5,[e("img",{src:y.value,alt:M.value},null,8,A5)]),e("div",null,[e("div",L5,S(M.value),1),e("div",T5,S(A.value),1)])]),f[11]||(f[11]=e("div",{class:"subscribe-btn"},"",-1))]),e("div",j5,[e("div",P5,[e("div",E5," ("+S(b.value.length)+")",1),f[12]||(f[12]=e("div",{style:{"font-size":"12px",color:"#888"}}," ",-1))]),e("div",B5,[e("div",V5,[e("img",{src:v.value,alt:"Me",style:{width:"100%",height:"100%","border-radius":"50%"}},null,8,H5)]),e("div",D5,[u.value?(p(),m("div",F5,[f[13]||(f[13]=e("span",null,"...",-1)),e("button",{onClick:se,class:"cancel-reply"},"")])):U("",!0),we(e("input",{type:"text",class:"comment-input-box",placeholder:u.value?"...":"...","onUpdate:modelValue":f[0]||(f[0]=g=>d.value=g),onKeyup:Xt(q,["enter"])},null,40,U5),[[Te,d.value]])])]),e("div",N5,[(p(!0),m(Pe,null,Fe(b.value,g=>(p(),m("div",{key:g.id,class:"comment-item"},[e("div",O5,[e("img",{src:g.avatar,alt:"User",style:{width:"100%",height:"100%","border-radius":"50%"}},null,8,R5)]),e("div",z5,[e("div",{class:Ie(["comment-user",{"is-character":g.isCharacter}])},[Qe(S(g.username)+" ",1),g.isCharacter?(p(),m("span",W5,"")):U("",!0)],2),e("div",K5,S(g.text),1),e("div",G5,[e("span",null,S(g.time),1),e("div",{class:"comment-action",onClick:H=>J(g.id)},[f[14]||(f[14]=e("svg",{viewBox:"0 0 24 24"},[e("path",{d:"M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"})],-1)),e("span",null,S(g.likes),1)],8,q5),e("span",{onClick:H=>oe(g),class:"reply-btn"},"",8,Z5)]),g.replies&&g.replies.length>0?(p(),m("div",J5,[(p(!0),m(Pe,null,Fe(g.replies,H=>(p(),m("div",{key:H.id,class:"reply-item"},[e("div",Y5,[e("img",{src:H.avatar,alt:"User",style:{width:"100%",height:"100%","border-radius":"50%"}},null,8,X5)]),e("div",Q5,[e("div",ek,S(H.username),1),e("div",tk,S(H.text),1),e("div",sk,[e("span",null,S(H.time),1),e("div",{class:"comment-action",onClick:K=>J(H.id)},[f[15]||(f[15]=e("svg",{viewBox:"0 0 24 24"},[e("path",{d:"M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"})],-1)),e("span",null,S(H.likes),1)],8,ok)])])]))),128))])):U("",!0)])]))),128))])]),f[16]||(f[16]=e("div",{style:{height:"50px"}},null,-1))])):U("",!0)}},ak=Ze(nk,[["__scopeId","data-v-9ec8ad43"]]),lk={class:"character-edit-page"},ik={class:"top-nav"},rk={class:"content"},ck={class:"character-header"},dk=["src","alt"],uk={class:"character-name-large"},vk={class:"character-desc-large"},pk={class:"settings-form"},fk={class:"setting-group"},mk={class:"setting-group"},gk={class:"setting-group"},hk={class:"setting-group"},yk={class:"setting-group"},bk={class:"partner-info"},wk={class:"partner-display"},kk={__name:"characteredit",props:{character:{type:Object,required:!0}},emits:["back"],setup(t,{emit:s}){const o=t,n=s,a=h(""),l=h("medium"),i=h(""),r=h(""),c=h("");nt(async()=>{try{const u=await(void 0)("userNickname");u&&(c.value=u);const v=await(void 0)(`pornhub_${o.character.id}_videoTypes`),b=await(void 0)(`pornhub_${o.character.id}_frequency`),y=await(void 0)(`pornhub_${o.character.id}_style`),M=await(void 0)(`pornhub_${o.character.id}_tags`);a.value=v||"",l.value=b||"medium",i.value=y||"",r.value=M||""}catch(u){console.error(":",u)}});const d=async()=>{try{await(void 0)(`pornhub_${o.character.id}_videoTypes`,a.value),await(void 0)(`pornhub_${o.character.id}_frequency`,l.value),await(void 0)(`pornhub_${o.character.id}_style`,i.value),await(void 0)(`pornhub_${o.character.id}_tags`,r.value),await(void 0)(`pornhub_${o.character.id}_partner`,"user"),await(void 0)(`pornhub_${o.character.id}_partnerName`,c.value),console.log("",{:o.character.name,:c.value}),alert(` 

${o.character.name}
${c.value}`)}catch(u){console.error(":",u),alert("")}};return(u,v)=>(p(),m("div",lk,[e("div",ik,[e("button",{onClick:v[0]||(v[0]=b=>n("back")),class:"back-btn"},[...v[5]||(v[5]=[e("svg",{viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})],-1)])]),v[6]||(v[6]=e("span",{class:"nav-title"},"",-1)),v[7]||(v[7]=e("div",{class:"placeholder"},null,-1))]),e("div",rk,[e("div",ck,[e("img",{src:t.character.avatar,alt:t.character.name,class:"character-avatar-large"},null,8,dk),e("div",uk,S(t.character.name),1),e("div",vk,S(t.character.description||""),1)]),e("div",pk,[e("div",fk,[v[8]||(v[8]=e("label",{class:"setting-label"},[e("svg",{viewBox:"0 0 24 24",class:"label-icon"},[e("path",{fill:"currentColor",d:"M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z"})]),Qe("  ")],-1)),we(e("textarea",{"onUpdate:modelValue":v[1]||(v[1]=b=>a.value=b),class:"setting-textarea",placeholder:"vlog",rows:"4"},null,512),[[Te,a.value]]),v[9]||(v[9]=e("div",{class:"setting-hint"},"",-1))]),e("div",mk,[v[11]||(v[11]=e("label",{class:"setting-label"},[e("svg",{viewBox:"0 0 24 24",class:"label-icon"},[e("path",{fill:"currentColor",d:"M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z"})]),Qe("  ")],-1)),we(e("select",{"onUpdate:modelValue":v[2]||(v[2]=b=>l.value=b),class:"setting-select"},[...v[10]||(v[10]=[dt('<option value="very_high" data-v-9dccd63f></option><option value="high" data-v-9dccd63f>1-2</option><option value="medium" data-v-9dccd63f>3-5</option><option value="low" data-v-9dccd63f>1-2</option><option value="very_low" data-v-9dccd63f></option>',5)])],512),[[Ls,l.value]])]),e("div",gk,[v[12]||(v[12]=e("label",{class:"setting-label"},[e("svg",{viewBox:"0 0 24 24",class:"label-icon"},[e("path",{fill:"currentColor",d:"M20.71,4.63L19.37,3.29C19,2.9 18.35,2.9 17.96,3.29L9,12.25L11.75,15L20.71,6.04C21.1,5.65 21.1,5 20.71,4.63M7,14A3,3 0 0,0 4,17C4,18.31 2.84,19 2,19C2.92,20.22 4.5,21 6,21A4,4 0 0,0 10,17A3,3 0 0,0 7,14Z"})]),Qe("  ")],-1)),we(e("textarea",{"onUpdate:modelValue":v[3]||(v[3]=b=>i.value=b),class:"setting-textarea",placeholder:"",rows:"3"},null,512),[[Te,i.value]]),v[13]||(v[13]=e("div",{class:"setting-hint"},"",-1))]),e("div",hk,[v[14]||(v[14]=e("label",{class:"setting-label"},[e("svg",{viewBox:"0 0 24 24",class:"label-icon"},[e("path",{fill:"currentColor",d:"M5.5,7A1.5,1.5 0 0,1 4,5.5A1.5,1.5 0 0,1 5.5,4A1.5,1.5 0 0,1 7,5.5A1.5,1.5 0 0,1 5.5,7M21.41,11.58L12.41,2.58C12.05,2.22 11.55,2 11,2H4C2.89,2 2,2.89 2,4V11C2,11.55 2.22,12.05 2.59,12.41L11.58,21.41C11.95,21.77 12.45,22 13,22C13.55,22 14.05,21.77 14.41,21.41L21.41,14.41C21.77,14.05 22,13.55 22,13C22,12.45 21.77,11.95 21.41,11.58Z"})]),Qe("  ")],-1)),we(e("input",{"onUpdate:modelValue":v[4]||(v[4]=b=>r.value=b),type:"text",class:"setting-input",placeholder:"# # #"},null,512),[[Te,r.value]])]),e("div",yk,[v[17]||(v[17]=e("label",{class:"setting-label"},[e("svg",{viewBox:"0 0 24 24",class:"label-icon"},[e("path",{fill:"currentColor",d:"M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"})]),Qe("  ")],-1)),e("div",bk,[e("div",wk,[v[15]||(v[15]=e("svg",{viewBox:"0 0 24 24",class:"partner-icon"},[e("path",{fill:"currentColor",d:"M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"})],-1)),e("span",null,S(c.value||""),1)]),v[16]||(v[16]=e("div",{class:"setting-hint"},"   ",-1))])]),e("button",{onClick:d,class:"save-btn"},[...v[18]||(v[18]=[e("svg",{viewBox:"0 0 24 24",class:"btn-icon"},[e("path",{fill:"currentColor",d:"M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"})],-1),Qe("  ",-1)])])])])]))}},xk=Ze(kk,[["__scopeId","data-v-9dccd63f"]]),Ck={key:0,class:"favorites-view"},$k={class:"top-nav"},_k={class:"content"},Mk={key:0,class:"empty-state"},Sk={key:1,class:"video-list"},Ik=["onClick"],Ak={class:"thumb-wrap"},Lk=["src"],Tk={class:"duration"},jk={class:"video-info"},Pk={class:"title"},Ek={class:"meta"},Bk={class:"views"},Vk=["onClick"],Hk={__name:"favoritelist",props:{isVisible:Boolean},emits:["back","open-video"],setup(t,{emit:s}){const o=s,n=h([]);nt(async()=>{await a()});const a=async()=>{try{const r=await C.getSetting("pornhub_favorite_list")||[];n.value=r}catch(r){console.error(":",r)}},l=async r=>{try{n.value=n.value.filter(d=>d.id!==r.id),await C.setSetting("pornhub_favorite_list",n.value);const c=`pornhub_favorite_${r.id}`;await C.setSetting(c,!1),await C.setSetting("pornhub_favorite_count",n.value.length)}catch(c){console.error(":",c)}},i=r=>{o("open-video",r)};return(r,c)=>t.isVisible?(p(),m("div",Ck,[e("div",$k,[e("button",{onClick:c[0]||(c[0]=d=>o("back")),class:"back-btn"},[...c[1]||(c[1]=[e("svg",{viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})],-1)])]),c[2]||(c[2]=e("span",{class:"nav-title"},"",-1)),c[3]||(c[3]=e("div",{class:"placeholder"},null,-1))]),e("div",_k,[n.value.length===0?(p(),m("div",Mk,[...c[4]||(c[4]=[e("svg",{viewBox:"0 0 24 24",class:"empty-icon"},[e("path",{fill:"currentColor",d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})],-1),e("p",null,"",-1),e("p",{class:"hint"},"",-1)])])):(p(),m("div",Sk,[(p(!0),m(Pe,null,Fe(n.value,d=>(p(),m("div",{key:d.id,class:"video-card",onClick:u=>i(d)},[e("div",Ak,[e("img",{src:d.thumb,alt:"thumb"},null,8,Lk),e("span",Tk,S(d.duration),1)]),e("div",jk,[e("h4",Pk,S(d.title),1),e("div",Ek,[e("span",Bk,S(d.views)+"   "+S(d.time),1),e("button",{onClick:je(u=>l(d),["stop"]),class:"remove-btn"},[...c[5]||(c[5]=[e("svg",{viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})],-1)])],8,Vk)])])],8,Ik))),128))]))])])):U("",!0)}},Dk=Ze(Hk,[["__scopeId","data-v-337d5640"]]),Fk={class:"top-nav"},Uk={class:"user-section"},Nk=["src"],Ok={class:"user-stats"},Rk={class:"stat-item"},zk={class:"stat-value"},Wk={class:"stat-item"},Kk={class:"stat-value"},Gk={class:"stat-item"},qk={class:"stat-value"},Zk={class:"feature-tabs"},Jk={class:"content-section"},Yk={key:0},Xk={class:"section-header-row"},Qk={class:"playlist-grid"},e3=["onClick"],t3={class:"playlist-cover"},s3=["src"],o3={class:"playlist-name"},n3={class:"playlist-count"},a3={key:0,class:"empty-state"},l3={key:1,class:"dynamics-list"},i3={class:"player-cover"},r3=["src"],c3={class:"player-info"},d3={class:"player-track-name"},u3={class:"player-artist"},v3={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},p3={key:1,width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},f3={class:"form-group"},m3={class:"form-group"},g3={class:"form-group"},h3={class:"modal-buttons"},y3={class:"settings-header"},b3={class:"setting-group"},w3={class:"setting-group"},k3={class:"setting-label"},x3={class:"control-row"},C3={class:"color-picker"},$3={class:"setting-group"},_3={class:"control-row"},M3={class:"color-picker"},S3={__name:"PersonalHome",emits:["back","navigate","play-song"],setup(t,{emit:s}){const o=s,n=zo,a=h(!1),l=h(!1),i=h("playlist"),r=h({name:!1,signature:!1}),c=h({wallpaper:"https://picsum.photos/1080/1920?random=33",avatar:"https://picsum.photos/200/200?random=66",uiColor:"#000000",opacity:.4,textColor:"#ffffff",userName:"",signature:" "}),d=h([]),u=h(0),v=h({name:"",description:"",cover:""}),b=h(null),y=h(null),M=h(null),A=h(null),w=F=>{r.value[F]=!0,zt(()=>{var x,L;F==="name"&&((x=b.value)==null||x.focus()),F==="signature"&&((L=y.value)==null||L.focus())})},k=F=>{r.value[F]=!1,H()},I=F=>{const x=parseInt(F.slice(1,3),16),L=parseInt(F.slice(3,5),16),ae=parseInt(F.slice(5,7),16);return x+", "+L+", "+ae},_=ot(()=>({backgroundColor:"rgba("+I(c.value.uiColor)+", "+c.value.opacity+")",color:c.value.textColor,"--text-color":c.value.textColor})),$=()=>{var F;return(F=M.value)==null?void 0:F.click()},T=F=>{const x=F.target.files[0];if(x){const L=new FileReader;L.onload=ae=>{c.value.wallpaper=ae.target.result,H()},L.readAsDataURL(x)}},q=()=>{var F;return(F=A.value)==null?void 0:F.click()},oe=F=>{const x=F.target.files[0];if(x){const L=new FileReader;L.onload=ae=>{c.value.avatar=ae.target.result,H()},L.readAsDataURL(x)}},se=async()=>{try{const F=await Ct.getUserConfig();F&&(c.value={...c.value,...F})}catch(F){console.error(":",F)}},J=async()=>{try{const F=await Ct.getAllPlaylists();for(const x of F){const L=await Ct.getSongsInPlaylist(x.id);x.songs=L}d.value=F}catch(F){console.error(":",F)}},N=async()=>{try{const{db:F}=await ls(async()=>{const{db:L}=await Promise.resolve().then(()=>Fs);return{db:L}},void 0),x=await F.getContacts();u.value=x.length}catch(F){console.error(":",F)}},P=F=>{o("navigate","playlist-manager",F.id)},f=()=>{n.currentSong&&o("play-song",n.currentSong)},g=async()=>{if(!v.value.name.trim()){alert("");return}try{const F=await Ct.createPlaylist({name:v.value.name,description:v.value.description,cover:v.value.cover||`https://picsum.photos/200/200?random=${Date.now()}`,creator:c.value.userName});d.value.push(F),v.value={name:"",description:"",cover:""},l.value=!1}catch(F){console.error(":",F),alert("")}},H=async()=>{try{await Ct.saveUserConfig(c.value)}catch(F){console.error(":",F)}};Pt(c,()=>{H()},{deep:!0});let K=null;return nt(()=>{se(),J(),N(),K=setInterval(()=>{J()},3e3)}),Dt(()=>{K&&clearInterval(K)}),(F,x)=>(p(),m("div",{class:"personal-home",style:Re({backgroundImage:"url("+c.value.wallpaper+")"})},[e("div",{class:"ui-overlay",style:Re(_.value)},[e("nav",Fk,[e("button",{class:"icon-btn",onClick:x[0]||(x[0]=L=>F.$emit("back"))},[...x[29]||(x[29]=[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])]),e("button",{class:"icon-btn",onClick:x[1]||(x[1]=L=>a.value=!0)},[...x[30]||(x[30]=[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[e("circle",{cx:"12",cy:"12",r:"1",fill:"currentColor"}),e("circle",{cx:"12",cy:"5",r:"1",fill:"currentColor"}),e("circle",{cx:"12",cy:"19",r:"1",fill:"currentColor"})],-1)])])]),e("section",Uk,[e("div",{class:"user-avatar",onClick:q},[e("img",{src:c.value.avatar,alt:""},null,8,Nk)]),r.value.name?we((p(),m("input",{key:1,ref_key:"nameInputRef",ref:b,class:"edit-input name-input","onUpdate:modelValue":x[3]||(x[3]=L=>c.value.userName=L),onBlur:x[4]||(x[4]=L=>k("name")),onKeyup:x[5]||(x[5]=Xt(L=>k("name"),["enter"]))},null,544)),[[Te,c.value.userName]]):(p(),m("div",{key:0,class:"user-name editable-text",onClick:x[2]||(x[2]=L=>w("name"))},S(c.value.userName),1)),r.value.signature?we((p(),m("input",{key:3,ref_key:"signatureInputRef",ref:y,class:"edit-input signature-input","onUpdate:modelValue":x[7]||(x[7]=L=>c.value.signature=L),onBlur:x[8]||(x[8]=L=>k("signature")),onKeyup:x[9]||(x[9]=Xt(L=>k("signature"),["enter"]))},null,544)),[[Te,c.value.signature]]):(p(),m("div",{key:2,class:"user-signature editable-text",onClick:x[6]||(x[6]=L=>w("signature"))},S(c.value.signature),1)),e("div",Ok,[e("div",Rk,[e("div",zk,S(u.value),1),x[31]||(x[31]=e("div",{class:"stat-label"},"",-1))]),x[34]||(x[34]=e("div",{class:"stat-divider"},null,-1)),e("div",Wk,[e("div",Kk,S(u.value),1),x[32]||(x[32]=e("div",{class:"stat-label"},"",-1))]),x[35]||(x[35]=e("div",{class:"stat-divider"},null,-1)),e("div",Gk,[e("div",qk,S(d.value.length),1),x[33]||(x[33]=e("div",{class:"stat-label"},"",-1))])])]),e("div",Zk,[e("div",{class:Ie(["tab-item",{active:i.value==="playlist"}]),onClick:x[10]||(x[10]=L=>i.value="playlist")},"  ",2),e("div",{class:Ie(["tab-item",{active:i.value==="dynamics"}]),onClick:x[11]||(x[11]=L=>i.value="dynamics")},"  ",2)]),e("main",Jk,[i.value==="playlist"?(p(),m("div",Yk,[e("div",Xk,[x[37]||(x[37]=e("h3",{class:"section-header"},"",-1)),e("button",{class:"add-playlist-btn",onClick:x[12]||(x[12]=L=>l.value=!0)},[...x[36]||(x[36]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),e("div",Qk,[(p(!0),m(Pe,null,Fe(d.value,L=>{var ae;return p(),m("div",{key:L.id,class:"playlist-card",onClick:de=>P(L)},[e("div",t3,[e("img",{src:L.cover||"https://picsum.photos/200/200?random="+L.id},null,8,s3)]),e("div",o3,S(L.name),1),e("div",n3,S(((ae=L.songs)==null?void 0:ae.length)||0)+" ",1)],8,e3)}),128)),d.value.length===0?(p(),m("div",a3,[x[38]||(x[38]=e("p",null,"",-1)),e("button",{class:"create-first-btn",onClick:x[13]||(x[13]=L=>l.value=!0)},"")])):U("",!0)])])):(p(),m("div",l3,[x[40]||(x[40]=e("h3",{class:"section-header"},"",-1)),(p(),m(Pe,null,Fe(3,L=>e("div",{key:L,class:"dynamic-item"},[...x[39]||(x[39]=[Qe("  ",-1),e("div",{class:"dynamic-time"},"2",-1)])])),64))]))])],4),Ue(n).currentSong?(p(),m("footer",{key:0,class:"music-player",style:Re(_.value),onClick:f},[e("div",i3,[e("img",{src:Ue(n).currentSong.cover||"https://picsum.photos/100/100?random=music_cover",alt:"cover"},null,8,r3)]),e("div",c3,[e("div",d3,S(Ue(n).currentSong.title||""),1),e("div",u3,S(Ue(n).currentSong.artist||""),1)]),e("div",{class:"player-controls",onClick:x[17]||(x[17]=je(()=>{},["stop"]))},[e("button",{class:"control-btn",onClick:x[14]||(x[14]=L=>Ue($t).previous())},[...x[41]||(x[41]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"})],-1)])]),e("button",{class:"control-btn play-pause-btn",onClick:x[15]||(x[15]=L=>Ue($t).togglePlay())},[Ue(n).isPlaying?(p(),m("svg",p3,[...x[43]||(x[43]=[e("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"},null,-1)])])):(p(),m("svg",v3,[...x[42]||(x[42]=[e("path",{d:"M8 5v14l11-7z"},null,-1)])]))]),e("button",{class:"control-btn",onClick:x[16]||(x[16]=L=>Ue($t).next())},[...x[44]||(x[44]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M6 18l8.5-6L6 6zm9-12v12h2V6z"})],-1)])])])],4)):U("",!0),l.value?(p(),m("div",{key:1,class:"modal-overlay",onClick:x[23]||(x[23]=L=>l.value=!1)},[e("div",{class:"modal-content",onClick:x[22]||(x[22]=je(()=>{},["stop"]))},[x[48]||(x[48]=e("h3",{class:"modal-title"},"",-1)),e("div",f3,[x[45]||(x[45]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":x[18]||(x[18]=L=>v.value.name=L),type:"text",class:"form-input",placeholder:""},null,512),[[Te,v.value.name]])]),e("div",m3,[x[46]||(x[46]=e("label",null,"",-1)),we(e("textarea",{"onUpdate:modelValue":x[19]||(x[19]=L=>v.value.description=L),class:"form-textarea",placeholder:""},null,512),[[Te,v.value.description]])]),e("div",g3,[x[47]||(x[47]=e("label",null,"URL",-1)),we(e("input",{"onUpdate:modelValue":x[20]||(x[20]=L=>v.value.cover=L),type:"text",class:"form-input",placeholder:"URL"},null,512),[[Te,v.value.cover]])]),e("div",h3,[e("button",{class:"modal-btn cancel-btn",onClick:x[21]||(x[21]=L=>l.value=!1)},""),e("button",{class:"modal-btn confirm-btn",onClick:g},"")])])])):U("",!0),a.value?(p(),m("div",{key:2,class:"settings-mask",onClick:x[24]||(x[24]=L=>a.value=!1)})):U("",!0),e("aside",{class:Ie(["settings-panel",{active:a.value}])},[e("div",y3,[x[49]||(x[49]=e("h3",null,"",-1)),e("span",{onClick:x[25]||(x[25]=L=>a.value=!1),class:"finish-btn"},"")]),e("div",b3,[x[50]||(x[50]=e("label",{class:"setting-label"},"",-1)),e("div",{class:"upload-grid"},[e("button",{class:"upload-btn",onClick:$}," "),e("button",{class:"upload-btn",onClick:q}," ")]),e("input",{type:"file",ref_key:"wallpaperInput",ref:M,style:{display:"none"},accept:"image/*",onChange:T},null,544),e("input",{type:"file",ref_key:"avatarInput",ref:A,style:{display:"none"},accept:"image/*",onChange:oe},null,544)]),e("div",w3,[e("label",k3,"UI  &  ("+S(Math.round(c.value.opacity*100))+"%)",1),e("div",x3,[e("div",C3,[we(e("input",{type:"color","onUpdate:modelValue":x[26]||(x[26]=L=>c.value.uiColor=L)},null,512),[[Te,c.value.uiColor]])]),we(e("input",{type:"range","onUpdate:modelValue":x[27]||(x[27]=L=>c.value.opacity=L),min:"0",max:"1",step:"0.01",class:"range-input"},null,512),[[Te,c.value.opacity]])])]),e("div",$3,[x[52]||(x[52]=e("label",{class:"setting-label"},"",-1)),e("div",_3,[e("div",M3,[we(e("input",{type:"color","onUpdate:modelValue":x[28]||(x[28]=L=>c.value.textColor=L)},null,512),[[Te,c.value.textColor]])]),x[51]||(x[51]=e("span",{class:"hint-text"},"",-1))])])],2)],4))}},I3=Ze(S3,[["__scopeId","data-v-959f2b51"]]),A3={class:"listen-together"},L3={class:"header"},T3={class:"room-info"},j3={class:"room-id"},P3={class:"online-count"},E3={key:0,class:"listen-time"},B3={class:"music-section"},V3={class:"album-wrapper"},H3=["src","alt"],D3={class:"song-info"},F3={class:"song-title"},U3={class:"song-artist"},N3={class:"progress-section"},O3={class:"time"},R3={class:"time"},z3={class:"controls"},W3={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},K3={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},G3={class:"users-section"},q3={class:"users-list"},Z3={class:"user-avatar"},J3=["src","alt"],Y3={key:0,class:"host-badge"},X3={class:"user-info"},Q3={class:"user-name"},ex={class:"chat-section"},tx=["src","alt"],sx={class:"message-content"},ox={class:"message-name"},nx={class:"message-text"},ax={class:"message-time"},lx={class:"chat-input-wrapper"},ix=["disabled"],rx={class:"invite-code"},cx={class:"code-value"},dx={__name:"ListenTogether",emits:["back"],setup(t){const s=zo,o=ot(()=>s.listenTogether.roomId||"888888"),n=h(!1),a=h([{id:1,name:"",avatar:"https://picsum.photos/100/100?random=u1",isHost:!0,isListening:!0},{id:2,name:"",avatar:"https://picsum.photos/100/100?random=u2",isHost:!1,isListening:!0},{id:3,name:"",avatar:"https://picsum.photos/100/100?random=u3",isHost:!1,isListening:!1},{id:4,name:"",avatar:"https://picsum.photos/100/100?random=u4",isHost:!1,isListening:!0}]),l=h([{id:1,userName:"",avatar:"https://picsum.photos/100/100?random=u2",text:"",time:"14:20",isSelf:!1},{id:2,userName:"",avatar:"https://picsum.photos/100/100?random=u1",text:"",time:"14:21",isSelf:!0},{id:3,userName:"",avatar:"https://picsum.photos/100/100?random=u3",text:"",time:"14:22",isSelf:!1}]),i=h(""),r=h(null),c=ot(()=>s.duration?s.currentTime/s.duration*100:0),d=()=>{$t.togglePlay()},u=()=>{$t.previous()},v=()=>{$t.next()},b=k=>{const I=k.currentTarget.getBoundingClientRect(),T=(k.clientX-I.left)/I.width*s.duration;$t.seek(T)},y=k=>$t.formatTime(k),M=k=>{if(!k)return"0";const I=Math.floor(k/3600),_=Math.floor(k%3600/60);return I>0?`${I}${_}`:`${_}`},A=()=>{if(!i.value.trim())return;const k={id:Date.now(),userName:"",avatar:"https://picsum.photos/100/100?random=u1",text:i.value,time:new Date().toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),isSelf:!0};l.value.push(k),i.value="",zt(()=>{r.value&&(r.value.scrollTop=r.value.scrollHeight)})},w=()=>{navigator.clipboard.writeText(o.value).then(()=>{alert("")})};return nt(()=>{if(s.listenTogether.isActive||$t.startListenTogether({name:""}),!s.currentSong){const k={id:1,title:"",artist:"",cover:"https://picsum.photos/400/400?random=1",duration:269,url:""};$t.playSong(k)}}),Dt(()=>{}),(k,I)=>{var _,$,T,q;return p(),m("div",A3,[e("div",L3,[e("button",{class:"back-btn",onClick:I[0]||(I[0]=oe=>k.$emit("back"))},[...I[6]||(I[6]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),I[8]||(I[8]=e("h1",{class:"title"},"",-1)),e("button",{class:"invite-btn",onClick:I[1]||(I[1]=oe=>n.value=!0)},[...I[7]||(I[7]=[dt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-771bdb6b><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-771bdb6b></path><circle cx="8.5" cy="7" r="4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-771bdb6b></circle><line x1="20" y1="8" x2="20" y2="14" stroke-width="2" stroke-linecap="round" data-v-771bdb6b></line><line x1="23" y1="11" x2="17" y2="11" stroke-width="2" stroke-linecap="round" data-v-771bdb6b></line></svg>',1)])])]),e("div",T3,[e("div",j3,": "+S(o.value),1),e("div",P3,[I[9]||(I[9]=e("span",{class:"dot"},null,-1)),Qe(" "+S(a.value.length)+"  ",1)]),Ue(s).listenTogether.isActive?(p(),m("div",E3," : "+S(M(Ue(s).listenTogether.elapsedTime)),1)):U("",!0)]),e("div",B3,[e("div",V3,[e("div",{class:Ie(["album-cover",{rotating:Ue(s).isPlaying}])},[e("img",{src:((_=Ue(s).currentSong)==null?void 0:_.cover)||"https://picsum.photos/400/400?random=1",alt:($=Ue(s).currentSong)==null?void 0:$.title},null,8,H3)],2),I[10]||(I[10]=e("div",{class:"vinyl-effect"},null,-1))]),e("div",D3,[e("h2",F3,S(((T=Ue(s).currentSong)==null?void 0:T.title)||""),1),e("p",U3,S(((q=Ue(s).currentSong)==null?void 0:q.artist)||""),1)]),e("div",N3,[e("span",O3,S(y(Ue(s).currentTime)),1),e("div",{class:"progress-bar",onClick:b},[e("div",{class:"progress-fill",style:Re({width:c.value+"%"})},null,4),e("div",{class:"progress-thumb",style:Re({left:c.value+"%"})},null,4)]),e("span",R3,S(y(Ue(s).duration)),1)]),e("div",z3,[e("button",{class:"control-btn",onClick:u},[...I[11]||(I[11]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("polygon",{points:"19 20 9 12 19 4 19 20","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("line",{x1:"5",y1:"19",x2:"5",y2:"5","stroke-width":"2","stroke-linecap":"round"})],-1)])]),e("button",{class:"control-btn play-btn",onClick:d},[Ue(s).isPlaying?(p(),m("svg",W3,[...I[12]||(I[12]=[e("rect",{x:"6",y:"4",width:"4",height:"16","stroke-width":"2","stroke-linecap":"round"},null,-1),e("rect",{x:"14",y:"4",width:"4",height:"16","stroke-width":"2","stroke-linecap":"round"},null,-1)])])):(p(),m("svg",K3,[...I[13]||(I[13]=[e("polygon",{points:"5 3 19 12 5 21 5 3","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))]),e("button",{class:"control-btn",onClick:v},[...I[14]||(I[14]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("polygon",{points:"5 4 15 12 5 20 5 4","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("line",{x1:"19",y1:"5",x2:"19",y2:"19","stroke-width":"2","stroke-linecap":"round"})],-1)])])])]),e("div",G3,[I[15]||(I[15]=e("h3",{class:"section-title"},"",-1)),e("div",q3,[(p(!0),m(Pe,null,Fe(a.value,oe=>(p(),m("div",{key:oe.id,class:"user-item"},[e("div",Z3,[e("img",{src:oe.avatar,alt:oe.name},null,8,J3),oe.isHost?(p(),m("span",Y3,"")):U("",!0)]),e("div",X3,[e("div",Q3,S(oe.name),1),e("div",{class:Ie(["user-status",{listening:oe.isListening}])},S(oe.isListening?"":""),3)])]))),128))])]),e("div",ex,[I[17]||(I[17]=e("h3",{class:"section-title"},"",-1)),e("div",{class:"chat-messages",ref_key:"chatMessages",ref:r},[(p(!0),m(Pe,null,Fe(l.value,oe=>(p(),m("div",{key:oe.id,class:Ie(["message-item",{self:oe.isSelf}])},[e("img",{src:oe.avatar,alt:oe.userName,class:"message-avatar"},null,8,tx),e("div",sx,[e("div",ox,S(oe.userName),1),e("div",nx,S(oe.text),1),e("div",ax,S(oe.time),1)])],2))),128))],512),e("div",lx,[we(e("input",{"onUpdate:modelValue":I[2]||(I[2]=oe=>i.value=oe),type:"text",placeholder:"...",class:"chat-input",onKeyup:Xt(A,["enter"])},null,544),[[Te,i.value]]),e("button",{class:"send-btn",onClick:A,disabled:!i.value.trim()},[...I[16]||(I[16]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("line",{x1:"22",y1:"2",x2:"11",y2:"13","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("polygon",{points:"22 2 15 22 11 13 2 9 22 2","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])],8,ix)])]),n.value?(p(),m("div",{key:0,class:"modal-overlay",onClick:I[5]||(I[5]=oe=>n.value=!1)},[e("div",{class:"modal-content",onClick:I[4]||(I[4]=je(()=>{},["stop"]))},[I[19]||(I[19]=e("h3",{class:"modal-title"},"",-1)),e("div",rx,[I[18]||(I[18]=e("div",{class:"code-label"},"",-1)),e("div",cx,S(o.value),1)]),I[20]||(I[20]=e("div",{class:"qr-code"},[e("div",{class:"qr-placeholder"},"")],-1)),e("button",{class:"copy-btn",onClick:w},"  "),e("button",{class:"close-btn",onClick:I[3]||(I[3]=oe=>n.value=!1)},"")])])):U("",!0)])}}},ux=Ze(dx,[["__scopeId","data-v-771bdb6b"]]),Ml=["https://files.catbox.moe/0g3kqu.jpg","https://files.catbox.moe/d5b7k6.jpg","https://files.catbox.moe/0yrhh6.jpg","https://files.catbox.moe/8mjvdg.jpg","https://files.catbox.moe/fvidas.jpg","https://files.catbox.moe/q6so2i.jpg","https://files.catbox.moe/5a96cp.jpg","https://files.catbox.moe/0mp6h0.jpg","https://files.catbox.moe/epcn03.jpg","https://files.catbox.moe/7jzdp7.jpg","https://files.catbox.moe/jrmu6w.jpg","https://files.catbox.moe/c0bwhn.jpg","https://files.catbox.moe/0blxme.jpg","https://files.catbox.moe/qicobr.jpg","https://files.catbox.moe/n94ztu.jpg"];function Uo(){return Ml[Math.floor(Math.random()*Ml.length)]}const vx={class:"header"},px={class:"title"},fx={class:"playlist-info"},mx=["src","alt"],gx={class:"playlist-details"},hx={class:"playlist-name"},yx={class:"playlist-creator"},bx={class:"playlist-desc"},wx={class:"playlist-stats"},kx={class:"action-buttons"},xx={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},Cx=["fill"],$x={class:"search-section"},_x={class:"search-box"},Mx={class:"songs-section"},Sx={class:"section-header"},Ix={class:"songs-list"},Ax=["onClick"],Lx={class:"song-index"},Tx={class:"song-cover"},jx=["src","alt"],Px={key:0,class:"playing-indicator"},Ex={class:"song-info"},Bx={class:"song-title"},Vx={class:"song-artist"},Hx=["onClick"],Dx={class:"menu-header"},Fx={class:"menu-header"},Ux={class:"form-group"},Nx={class:"form-group"},Ox={class:"form-group"},Rx={class:"modal-buttons"},zx={class:"form-group"},Wx={class:"form-group"},Kx={class:"form-group"},Gx={class:"cover-upload-section"},qx=["src"],Zx={class:"modal-buttons"},Jx={__name:"PlaylistManager",props:{playlistId:{type:Number,required:!0}},emits:["back","navigate","play-song"],setup(t,{emit:s}){const o=t,n=s,a=zo,l=h(!1),i=h(!1),r=h(!1),c=h(!1),d=h(!1),u=h(null),v=h(-1),b=h(""),y=h(null),M=h(null),A=h({wallpaper:"https://picsum.photos/1080/1920?random=33",uiColor:"#000000",opacity:.4,textColor:"#ffffff"}),w=h({id:null,name:"",creator:"",description:"",cover:"",playCount:0,isCollected:!1,songs:[]}),k=h({name:"",description:"",cover:""}),I=h({title:"",artist:"",cover:""}),_=he=>{const j=parseInt(he.slice(1,3),16),Q=parseInt(he.slice(3,5),16),W=parseInt(he.slice(5,7),16);return`${j}, ${Q}, ${W}`},$=ot(()=>({backgroundColor:`rgba(${_(A.value.uiColor)}, ${A.value.opacity})`,color:A.value.textColor,"--text-color":A.value.textColor})),T=async()=>{try{const he=await Ct.getUserConfig();A.value={wallpaper:he.wallpaper,uiColor:he.uiColor,opacity:he.opacity,textColor:he.textColor}}catch(he){console.error(":",he)}},q=async()=>{try{const he=await Ct.getPlaylist(o.playlistId);if(he){const j=await Ct.getSongsInPlaylist(o.playlistId);w.value={...he,songs:j}}}catch(he){console.error(":",he)}},oe=()=>{var he;(he=y.value)==null||he.click()},se=async he=>{const j=he.target.files[0];if(j){const Q=URL.createObjectURL(j);try{await Ct.updatePlaylist(o.playlistId,{cover:Q}),w.value.cover=Q}catch(W){console.error(":",W),alert("")}}};nt(()=>{T(),q()}),Pt(()=>o.playlistId,()=>{q()});const J=async()=>{if(w.value.songs.length!==0){$t.setPlaylist(w.value.songs,0),console.log("");try{await Ct.incrementPlayCount(o.playlistId),w.value.playCount++}catch(he){console.error(":",he)}}},N=he=>{const j=w.value.songs[he];$t.setPlaylist(w.value.songs,he),n("play-song",j),console.log(":",j.title)},P=()=>{n("navigate","music-add",o.playlistId)},f=async()=>{try{await Ct.updatePlaylist(o.playlistId,{isCollected:!w.value.isCollected}),w.value.isCollected=!w.value.isCollected}catch(he){console.error(":",he)}},g=()=>{console.log("")},H=()=>{k.value={name:w.value.name,description:w.value.description,cover:w.value.cover},l.value=!1,c.value=!0},K=async()=>{try{await Ct.updatePlaylist(o.playlistId,{name:k.value.name,description:k.value.description,cover:k.value.cover}),w.value.name=k.value.name,w.value.description=k.value.description,w.value.cover=k.value.cover,c.value=!1}catch(he){console.error(":",he),alert("")}},F=async()=>{if(confirm(""))try{await Ct.deletePlaylist(o.playlistId),l.value=!1,n("back")}catch(he){console.error(":",he),alert("")}l.value=!1},x=(he,j)=>{u.value=he,v.value=j,i.value=!0},L=()=>{console.log(":",u.value.title),i.value=!1},ae=()=>{console.log(""),i.value=!1},de=async()=>{if(confirm(`${u.value.title}`))try{await Ct.deleteSongFromPlaylist(u.value.id),w.value.songs.splice(v.value,1)}catch(he){console.error(":",he),alert("")}i.value=!1},ue=()=>{I.value={title:u.value.title,artist:u.value.artist,cover:u.value.cover},i.value=!1,d.value=!0},$e=()=>{var he;(he=M.value)==null||he.click()},ne=async he=>{const j=he.target.files[0];if(j){const Q=new FileReader;Q.onload=W=>{I.value.cover=W.target.result},Q.readAsDataURL(j)}},G=async()=>{try{const he=await Ct.getSongsInPlaylist(o.playlistId),j=he.findIndex(Q=>Q.id===u.value.id);if(j!==-1){he[j]={...he[j],title:I.value.title,artist:I.value.artist,cover:I.value.cover};const Q=await Ct.getUserConfig().then(()=>Ct.getSongsInPlaylist(o.playlistId)),B=(await ls(async()=>{const{db:D}=await Promise.resolve().then(()=>Fs);return{db:D}},void 0).then(({db:D})=>D.getSetting("musicSongs"))).map(D=>D.id===u.value.id?{...D,title:I.value.title,artist:I.value.artist,cover:I.value.cover}:D);await ls(async()=>{const{db:D}=await Promise.resolve().then(()=>Fs);return{db:D}},void 0).then(({db:D})=>D.setSetting("musicSongs",B)),w.value.songs[v.value]={...w.value.songs[v.value],title:I.value.title,artist:I.value.artist,cover:I.value.cover},d.value=!1,alert("")}}catch(he){console.error(":",he),alert("")}};return(he,j)=>{var Q;return p(),m("div",{class:"playlist-manager",style:Re({backgroundImage:`url(${A.value.wallpaper})`})},[e("div",{class:"ui-overlay",style:Re($.value)},[e("div",vx,[e("button",{class:"back-btn",onClick:j[0]||(j[0]=W=>he.$emit("back"))},[...j[20]||(j[20]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),e("h1",px,S(w.value.name),1),e("button",{class:"more-btn",onClick:j[1]||(j[1]=W=>l.value=!0)},[...j[21]||(j[21]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("circle",{cx:"12",cy:"12",r:"1",fill:"currentColor"}),e("circle",{cx:"12",cy:"5",r:"1",fill:"currentColor"}),e("circle",{cx:"12",cy:"19",r:"1",fill:"currentColor"})],-1)])])]),e("div",fx,[e("div",{class:"playlist-cover",onClick:oe},[e("img",{src:w.value.cover||Ue(Uo)(),alt:w.value.name},null,8,mx),j[23]||(j[23]=dt('<div class="cover-overlay" data-v-de75dc06><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-de75dc06><rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke-width="2" data-v-de75dc06></rect><circle cx="8.5" cy="8.5" r="1.5" stroke-width="2" data-v-de75dc06></circle><polyline points="21 15 16 10 5 21" stroke-width="2" data-v-de75dc06></polyline></svg><span data-v-de75dc06></span></div>',1)),e("button",{class:"play-all-btn",onClick:je(J,["stop"])},[...j[22]||(j[22]=[e("svg",{viewBox:"0 0 24 24",fill:"white"},[e("polygon",{points:"8 5 19 12 8 19 8 5"})],-1)])])]),e("input",{type:"file",ref_key:"coverInput",ref:y,style:{display:"none"},accept:"image/*",onChange:se},null,544),e("div",gx,[e("h2",hx,S(w.value.name),1),e("p",yx,": "+S(w.value.creator),1),e("p",bx,S(w.value.description),1),e("div",wx,[e("span",null,S(w.value.songs.length)+" ",1),e("span",null," "+S(w.value.playCount)+" ",1)])])]),e("div",kx,[e("button",{class:"action-btn",onClick:P},[...j[24]||(j[24]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("line",{x1:"12",y1:"5",x2:"12",y2:"19","stroke-width":"2","stroke-linecap":"round"}),e("line",{x1:"5",y1:"12",x2:"19",y2:"12","stroke-width":"2","stroke-linecap":"round"})],-1),e("span",null,"",-1)])]),e("button",{class:"action-btn",onClick:f},[(p(),m("svg",xx,[e("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z",fill:w.value.isCollected?"currentColor":"none","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,8,Cx)])),e("span",null,S(w.value.isCollected?"":""),1)]),e("button",{class:"action-btn",onClick:g},[...j[25]||(j[25]=[dt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-de75dc06><circle cx="18" cy="5" r="3" stroke-width="2" data-v-de75dc06></circle><circle cx="6" cy="12" r="3" stroke-width="2" data-v-de75dc06></circle><circle cx="18" cy="19" r="3" stroke-width="2" data-v-de75dc06></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49" stroke-width="2" data-v-de75dc06></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49" stroke-width="2" data-v-de75dc06></line></svg><span data-v-de75dc06></span>',2)])])]),e("div",$x,[e("div",_x,[j[27]||(j[27]=e("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("circle",{cx:"11",cy:"11",r:"8","stroke-width":"2"}),e("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65","stroke-width":"2","stroke-linecap":"round"})],-1)),we(e("input",{"onUpdate:modelValue":j[2]||(j[2]=W=>b.value=W),type:"text",placeholder:"",class:"search-input"},null,512),[[Te,b.value]]),b.value?(p(),m("button",{key:0,class:"clear-btn",onClick:j[3]||(j[3]=W=>b.value="")},[...j[26]||(j[26]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18","stroke-width":"2"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18","stroke-width":"2"})],-1)])])):U("",!0)])]),e("div",Mx,[e("div",Sx,[j[29]||(j[29]=e("h3",null,"",-1)),e("button",{class:"sort-btn",onClick:j[4]||(j[4]=W=>r.value=!0)},[...j[28]||(j[28]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("line",{x1:"3",y1:"6",x2:"21",y2:"6","stroke-width":"2","stroke-linecap":"round"}),e("line",{x1:"3",y1:"12",x2:"21",y2:"12","stroke-width":"2","stroke-linecap":"round"}),e("line",{x1:"3",y1:"18",x2:"21",y2:"18","stroke-width":"2","stroke-linecap":"round"})],-1)])])]),e("div",Ix,[(p(!0),m(Pe,null,Fe(w.value.songs,(W,B)=>{var D;return p(),m("div",{key:W.id,class:"song-item",onClick:xe=>N(B)},[e("div",Lx,S(B+1),1),e("div",Tx,[e("img",{src:W.cover||Ue(Uo)(),alt:W.title},null,8,jx),((D=Ue(a).currentSong)==null?void 0:D.id)===W.id&&Ue(a).isPlaying?(p(),m("div",Px,[...j[30]||(j[30]=[e("div",{class:"bar"},null,-1),e("div",{class:"bar"},null,-1),e("div",{class:"bar"},null,-1)])])):U("",!0)]),e("div",Ex,[e("div",Bx,S(W.title),1),e("div",Vx,S(W.artist),1)]),e("button",{class:"song-more-btn",onClick:je(xe=>x(W,B),["stop"])},[...j[31]||(j[31]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("circle",{cx:"12",cy:"12",r:"1",fill:"currentColor"}),e("circle",{cx:"19",cy:"12",r:"1",fill:"currentColor"}),e("circle",{cx:"5",cy:"12",r:"1",fill:"currentColor"})],-1)])],8,Hx)],8,Ax)}),128))])]),l.value?(p(),m("div",{key:0,class:"menu-overlay",onClick:j[5]||(j[5]=W=>l.value=!1)})):U("",!0),e("div",{class:Ie(["menu-panel",{active:l.value}])},[e("div",Dx,[j[32]||(j[32]=e("h3",null,"",-1)),e("button",{onClick:j[6]||(j[6]=W=>l.value=!1)},"")]),e("div",{class:"menu-items"},[e("div",{class:"menu-item",onClick:H},[...j[33]||(j[33]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7","stroke-width":"2"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z","stroke-width":"2"})],-1),e("span",null,"",-1)])]),e("div",{class:"menu-item",onClick:F},[...j[34]||(j[34]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("polyline",{points:"3 6 5 6 21 6","stroke-width":"2"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2","stroke-width":"2"})],-1),e("span",null,"",-1)])])])],2),i.value?(p(),m("div",{key:1,class:"menu-overlay",onClick:j[7]||(j[7]=W=>i.value=!1)})):U("",!0),e("div",{class:Ie(["menu-panel",{active:i.value}])},[e("div",Fx,[e("h3",null,S((Q=u.value)==null?void 0:Q.title),1),e("button",{onClick:j[8]||(j[8]=W=>i.value=!1)},"")]),e("div",{class:"menu-items"},[e("div",{class:"menu-item",onClick:ue},[...j[35]||(j[35]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7","stroke-width":"2"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z","stroke-width":"2"})],-1),e("span",null,"",-1)])]),e("div",{class:"menu-item",onClick:L},[...j[36]||(j[36]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4","stroke-width":"2"}),e("polyline",{points:"7 10 12 15 17 10","stroke-width":"2"}),e("line",{x1:"12",y1:"15",x2:"12",y2:"3","stroke-width":"2"})],-1),e("span",null,"",-1)])]),e("div",{class:"menu-item",onClick:ae},[...j[37]||(j[37]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z","stroke-width":"2"})],-1),e("span",null,"",-1)])]),e("div",{class:"menu-item danger",onClick:de},[...j[38]||(j[38]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18","stroke-width":"2"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18","stroke-width":"2"})],-1),e("span",null,"",-1)])])])],2),c.value?(p(),m("div",{key:2,class:"modal-overlay",onClick:j[14]||(j[14]=W=>c.value=!1)},[e("div",{class:"modal-content",onClick:j[13]||(j[13]=je(()=>{},["stop"]))},[j[42]||(j[42]=e("h3",{class:"modal-title"},"",-1)),e("div",Ux,[j[39]||(j[39]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":j[9]||(j[9]=W=>k.value.name=W),type:"text",class:"form-input",placeholder:""},null,512),[[Te,k.value.name]])]),e("div",Nx,[j[40]||(j[40]=e("label",null,"",-1)),we(e("textarea",{"onUpdate:modelValue":j[10]||(j[10]=W=>k.value.description=W),class:"form-textarea",placeholder:""},null,512),[[Te,k.value.description]])]),e("div",Ox,[j[41]||(j[41]=e("label",null,"URL",-1)),we(e("input",{"onUpdate:modelValue":j[11]||(j[11]=W=>k.value.cover=W),type:"text",class:"form-input",placeholder:"URL"},null,512),[[Te,k.value.cover]])]),e("div",Rx,[e("button",{class:"modal-btn cancel-btn",onClick:j[12]||(j[12]=W=>c.value=!1)},""),e("button",{class:"modal-btn confirm-btn",onClick:K},"")])])])):U("",!0),d.value?(p(),m("div",{key:3,class:"modal-overlay",onClick:j[19]||(j[19]=W=>d.value=!1)},[e("div",{class:"modal-content",onClick:j[18]||(j[18]=je(()=>{},["stop"]))},[j[47]||(j[47]=e("h3",{class:"modal-title"},"",-1)),e("div",zx,[j[43]||(j[43]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":j[15]||(j[15]=W=>I.value.title=W),type:"text",class:"form-input",placeholder:""},null,512),[[Te,I.value.title]])]),e("div",Wx,[j[44]||(j[44]=e("label",null,"",-1)),we(e("input",{"onUpdate:modelValue":j[16]||(j[16]=W=>I.value.artist=W),type:"text",class:"form-input",placeholder:""},null,512),[[Te,I.value.artist]])]),e("div",Kx,[j[46]||(j[46]=e("label",null,"",-1)),e("div",Gx,[e("div",{class:"current-cover",onClick:$e},[e("img",{src:I.value.cover,alt:""},null,8,qx),j[45]||(j[45]=dt('<div class="cover-upload-overlay" data-v-de75dc06><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-de75dc06><rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke-width="2" data-v-de75dc06></rect><circle cx="8.5" cy="8.5" r="1.5" stroke-width="2" data-v-de75dc06></circle><polyline points="21 15 16 10 5 21" stroke-width="2" data-v-de75dc06></polyline></svg><span data-v-de75dc06></span></div>',1))]),e("input",{type:"file",ref_key:"songCoverInput",ref:M,style:{display:"none"},accept:"image/*",onChange:ne},null,544)])]),e("div",Zx,[e("button",{class:"modal-btn cancel-btn",onClick:j[17]||(j[17]=W=>d.value=!1)},""),e("button",{class:"modal-btn confirm-btn",onClick:G},"")])])])):U("",!0)],4)],4)}}},Yx=Ze(Jx,[["__scopeId","data-v-de75dc06"]]),Xx={class:"header"},Qx={class:"tabs"},eC={class:"content"},tC={key:0,class:"tab-content"},sC={class:"search-box"},oC=["disabled"],nC={key:0,class:"loading"},aC={key:1,class:"results-list"},lC={class:"song-cover"},iC=["src","alt"],rC={class:"song-info"},cC={class:"song-name"},dC={key:0,class:"vip-badge"},uC={class:"song-artist"},vC=["onClick","disabled"],pC={key:1,class:"disabled-text"},fC={key:2,class:"empty-state"},mC={key:1,class:"tab-content"},gC={class:"input-group"},hC=["disabled"],yC={key:0,class:"loading"},bC={key:1,class:"import-preview"},wC={class:"preview-header"},kC={class:"results-list"},xC={class:"song-cover"},CC=["src","alt"],$C={class:"song-info"},_C={class:"song-name"},MC={class:"song-artist"},SC={key:2,class:"tab-content"},IC={key:0,class:"uploaded-list"},AC=["onClick"],LC=["src","alt"],TC={key:1,class:"cover-placeholder"},jC={class:"file-info"},PC={class:"file-title"},EC={class:"file-artist"},BC={class:"file-meta"},VC={key:0},HC={key:1,class:"has-lyrics"},DC={key:2,class:"has-cover"},FC={class:"file-actions"},UC=["onClick"],NC=["onClick"],OC=["onClick"],RC={__name:"musicadd",props:{playlistId:{type:Number,required:!0}},emits:["back","songAdded"],setup(t,{emit:s}){const o=t,n=s,a=["https://netease-cloud-music-api-psi-ten.vercel.app","https://netease-cloud-music-api-gilt-five.vercel.app","https://netease-cloud-music-api-dusky-ten.vercel.app","https://netease-cloud-music-api-pi-wine.vercel.app"];let l=0;const i=h(a[0]),r=()=>{l=(l+1)%a.length,i.value=a[l],console.log("API:",i.value)},c=h({wallpaper:"https://picsum.photos/1080/1920?random=33",uiColor:"#000000",opacity:.4,textColor:"#ffffff"}),d=h("search"),u=h(""),v=h(!1),b=h([]),y=h([]),M=h(""),A=h(!1),w=h([]),k=h(null),I=h(null),_=h(null),$=h([]),T=h(-1),q=j=>{const Q=parseInt(j.slice(1,3),16),W=parseInt(j.slice(3,5),16),B=parseInt(j.slice(5,7),16);return`${Q}, ${W}, ${B}`},oe=ot(()=>({backgroundColor:`rgba(${q(c.value.uiColor)}, ${c.value.opacity})`,color:c.value.textColor})),se=async()=>{try{const j=await Ct.getUserConfig();c.value={wallpaper:j.wallpaper,uiColor:j.uiColor,opacity:j.opacity,textColor:j.textColor}}catch(j){console.error(":",j)}},J=async()=>{if(u.value.trim()){v.value=!0;for(let j=0;j<a.length;j++)try{console.log("API:",i.value);const Q=await fetch(`${i.value}/cloudsearch?keywords=${encodeURIComponent(u.value)}`,{mode:"cors",headers:{Accept:"application/json"}});if(!Q.ok)throw new Error("API");const W=await Q.json();if(W.result&&W.result.songs){b.value=W.result.songs,v.value=!1;return}else{b.value=[],alert(""),v.value=!1;return}}catch(Q){console.error("API:",i.value,Q),j<a.length-1&&r()}v.value=!1,alert(`API 


1. 
2. 
3. `)}},N=async j=>{y.value.push(j.id);try{const W=await(await fetch(`${i.value}/song/url?id=${j.id}`,{mode:"cors",headers:{Accept:"application/json"}})).json();if(W.data&&W.data[0]&&W.data[0].url){const B={title:j.name,artist:j.ar.map(D=>D.name).join(" / "),cover:j.al.picUrl,duration:Math.floor(j.dt/1e3),url:W.data[0].url};await Ct.addSongToPlaylist(o.playlistId,B),n("songAdded"),alert("")}else alert("VIP")}catch(Q){console.error(":",Q),alert("")}finally{y.value=y.value.filter(Q=>Q!==j.id)}},P=async()=>{if(!M.value.trim())return;let j=M.value.trim();const Q=M.value.match(/id=(\d+)/);Q&&(j=Q[1]),A.value=!0;try{const W=await fetch(`${i.value}/playlist/detail?id=${j}`,{mode:"cors",headers:{Accept:"application/json"}});if(!W.ok)throw new Error("API");const B=await W.json();B.playlist&&B.playlist.tracks?(w.value=B.playlist.tracks.filter(D=>D.fee!==1),w.value.length===0&&alert("")):alert("ID")}catch(W){console.error(":",W),alert(`API


1. ID
2. 
3. `)}finally{A.value=!1}},f=async()=>{if(w.value.length===0)return;const j=w.value.length;let Q=0;for(const W of w.value)try{const D=await(await fetch(`${i.value}/song/url?id=${W.id}`,{mode:"cors",headers:{Accept:"application/json"}})).json();if(D.data&&D.data[0]&&D.data[0].url){const xe={title:W.name,artist:W.ar.map(V=>V.name).join(" / "),cover:W.al.picUrl,duration:Math.floor(W.dt/1e3),url:D.data[0].url};await Ct.addSongToPlaylist(o.playlistId,xe),Q++}}catch(B){console.error(":",W.name,B)}n("songAdded"),alert(` ${Q}/${j} `),w.value=[],M.value=""},g=()=>{var j;(j=k.value)==null||j.click()},H=async j=>{const Q=Array.from(j.target.files);for(const W of Q)try{const B=await K(W);$.value.push({file:W,name:W.name,size:W.size,title:B.title||W.name.replace(/\.[^/.]+$/,""),artist:B.artist||"",album:B.album||"",cover:B.cover||Uo(),customCover:null,duration:B.duration||0,lyrics:"",url:URL.createObjectURL(W)})}catch(B){console.error(":",W.name,B)}j.target.value=""},K=j=>new Promise(Q=>{const W=new Audio,B=URL.createObjectURL(j);W.addEventListener("loadedmetadata",()=>{const D=j.name.replace(/\.[^/.]+$/,"");let xe=D,V="";if(D.includes(" - ")){const O=D.split(" - ");V=O[0].trim(),xe=O[1].trim()}else if(D.includes("-")){const O=D.split("-");V=O[0].trim(),xe=O[1].trim()}Q({title:xe,artist:V,album:"",cover:"",duration:Math.floor(W.duration)}),URL.revokeObjectURL(B)}),W.addEventListener("error",()=>{Q({title:j.name.replace(/\.[^/.]+$/,""),artist:"",album:"",cover:"",duration:0}),URL.revokeObjectURL(B)}),W.src=B}),F=j=>{var Q;T.value=j,(Q=I.value)==null||Q.click()},x=async j=>{const Q=j.target.files[0];if(!(!Q||T.value===-1)){try{const W=await Q.text();$.value[T.value].lyrics=W,alert("")}catch(W){console.error(":",W),alert("")}j.target.value="",T.value=-1}},L=j=>{var Q;T.value=j,(Q=_.value)==null||Q.click()},ae=async j=>{const Q=j.target.files[0];if(!(!Q||T.value===-1)){try{const W=await he(Q);$.value[T.value].customCover=W,alert("")}catch(W){console.error(":",W),alert("")}j.target.value="",T.value=-1}},de=j=>{const Q=$.value[j],W=prompt(":",Q.title);W!==null&&(Q.title=W.trim()||Q.title);const B=prompt(":",Q.artist);B!==null&&(Q.artist=B.trim()||Q.artist)},ue=j=>{$.value.splice(j,1)},$e=j=>j<1024?j+" B":j<1024*1024?(j/1024).toFixed(2)+" KB":(j/(1024*1024)).toFixed(2)+" MB",ne=j=>{const Q=Math.floor(j/60),W=Math.floor(j%60);return`${Q}:${W.toString().padStart(2,"0")}`},G=async()=>{if($.value.length===0)return;let j=0;const Q=$.value.length,W=` 0/${Q} ...`;console.log(W);for(let B=0;B<$.value.length;B++){const D=$.value[B];try{const xe=await he(D.file);let V=D.customCover||D.cover||Uo();const O={title:D.title,artist:D.artist,cover:V,duration:D.duration,url:xe,lyrics:D.lyrics||""};await Ct.addSongToPlaylist(o.playlistId,O),j++,console.log(` ${j}/${Q}: ${D.title}`)}catch(xe){console.error(":",D.name,xe)}}n("songAdded"),alert(` ${j}/${Q} 

 Base64 `),$.value=[]},he=j=>new Promise((Q,W)=>{const B=new FileReader;B.onload=()=>Q(B.result),B.onerror=W,B.readAsDataURL(j)});return nt(()=>{se()}),(j,Q)=>(p(),m("div",{class:"music-add",style:Re({backgroundImage:`url(${c.value.wallpaper})`})},[e("div",{class:"ui-overlay",style:Re(oe.value)},[e("div",Xx,[e("button",{class:"back-btn",onClick:Q[0]||(Q[0]=W=>j.$emit("back"))},[...Q[6]||(Q[6]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),Q[7]||(Q[7]=e("h1",{class:"title"},"",-1)),Q[8]||(Q[8]=e("div",{class:"placeholder"},null,-1))]),e("div",Qx,[e("div",{class:Ie(["tab-item",{active:d.value==="search"}]),onClick:Q[1]||(Q[1]=W=>d.value="search")},[...Q[9]||(Q[9]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("circle",{cx:"11",cy:"11",r:"8","stroke-width":"2"}),e("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65","stroke-width":"2"})],-1),e("span",null,"",-1)])],2),e("div",{class:Ie(["tab-item",{active:d.value==="playlist"}]),onClick:Q[2]||(Q[2]=W=>d.value="playlist")},[...Q[10]||(Q[10]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z","stroke-width":"2"})],-1),e("span",null,"",-1)])],2),e("div",{class:Ie(["tab-item",{active:d.value==="upload"}]),onClick:Q[3]||(Q[3]=W=>d.value="upload")},[...Q[11]||(Q[11]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4","stroke-width":"2"}),e("polyline",{points:"17 8 12 3 7 8","stroke-width":"2"}),e("line",{x1:"12",y1:"3",x2:"12",y2:"15","stroke-width":"2"})],-1),e("span",null,"",-1)])],2)]),e("div",eC,[d.value==="search"?(p(),m("div",tC,[e("div",sC,[Q[12]||(Q[12]=e("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("circle",{cx:"11",cy:"11",r:"8","stroke-width":"2"}),e("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65","stroke-width":"2"})],-1)),we(e("input",{"onUpdate:modelValue":Q[4]||(Q[4]=W=>u.value=W),type:"text",placeholder:"",class:"search-input",onKeyup:Xt(J,["enter"])},null,544),[[Te,u.value]]),e("button",{class:"search-btn",onClick:J,disabled:v.value},S(v.value?"...":""),9,oC)]),v.value?(p(),m("div",nC,[...Q[13]||(Q[13]=[e("div",{class:"spinner"},null,-1),e("p",null,"...",-1)])])):b.value.length>0?(p(),m("div",aC,[(p(!0),m(Pe,null,Fe(b.value,W=>(p(),m("div",{key:W.id,class:Ie(["song-item",{disabled:W.fee===1}])},[e("div",lC,[e("img",{src:W.al.picUrl+"?param=100y100",alt:W.name},null,8,iC)]),e("div",rC,[e("div",cC,[Qe(S(W.name)+" ",1),W.fee===1?(p(),m("span",dC,"VIP")):U("",!0)]),e("div",uC,S(W.ar.map(B=>B.name).join(" / ")),1)]),W.fee!==1?(p(),m("button",{key:0,class:"add-btn",onClick:B=>N(W),disabled:y.value.includes(W.id)},S(y.value.includes(W.id)?"...":""),9,vC)):(p(),m("span",pC,"VIP"))],2))),128))])):u.value&&!v.value?(p(),m("div",fC,[...Q[14]||(Q[14]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("circle",{cx:"11",cy:"11",r:"8","stroke-width":"2"}),e("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65","stroke-width":"2"})],-1),e("p",null,"",-1)])])):U("",!0)])):U("",!0),d.value==="playlist"?(p(),m("div",mC,[e("div",gC,[Q[15]||(Q[15]=e("label",null,"ID",-1)),we(e("input",{"onUpdate:modelValue":Q[5]||(Q[5]=W=>M.value=W),type:"text",placeholder:": 7452421450 ",class:"text-input"},null,512),[[Te,M.value]]),e("button",{class:"primary-btn",onClick:P,disabled:A.value},S(A.value?"...":""),9,hC)]),A.value?(p(),m("div",yC,[...Q[16]||(Q[16]=[e("div",{class:"spinner"},null,-1),e("p",null,"...",-1)])])):w.value.length>0?(p(),m("div",bC,[e("div",wC,[Q[17]||(Q[17]=e("h3",null,"",-1)),e("p",null," "+S(w.value.length)+" VIP",1)]),e("div",kC,[(p(!0),m(Pe,null,Fe(w.value,W=>(p(),m("div",{key:W.id,class:"song-item"},[e("div",xC,[e("img",{src:W.al.picUrl+"?param=100y100",alt:W.name},null,8,CC)]),e("div",$C,[e("div",_C,S(W.name),1),e("div",MC,S(W.ar.map(B=>B.name).join(" / ")),1)])]))),128))]),e("button",{class:"primary-btn full-width",onClick:f},"  ")])):U("",!0)])):U("",!0),d.value==="upload"?(p(),m("div",SC,[e("div",{class:"upload-area",onClick:g},[e("input",{type:"file",ref_key:"fileInput",ref:k,accept:"audio/*",multiple:"",style:{display:"none"},onChange:H},null,544),Q[18]||(Q[18]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4","stroke-width":"2"}),e("polyline",{points:"17 8 12 3 7 8","stroke-width":"2"}),e("line",{x1:"12",y1:"3",x2:"12",y2:"15","stroke-width":"2"})],-1)),Q[19]||(Q[19]=e("p",null,"",-1)),Q[20]||(Q[20]=e("span",null," MP3, FLAC, WAV ",-1))]),$.value.length>0?(p(),m("div",IC,[e("h3",null," ("+S($.value.length)+")",1),(p(!0),m(Pe,null,Fe($.value,(W,B)=>(p(),m("div",{key:B,class:"upload-item"},[e("div",{class:"file-cover",onClick:D=>L(B),title:""},[W.customCover||W.cover?(p(),m("img",{key:0,src:W.customCover||W.cover,alt:W.title},null,8,LC)):(p(),m("div",TC,[...Q[21]||(Q[21]=[dt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-62ae35c9><path d="M9 18V5l12-2v13" stroke-width="2" data-v-62ae35c9></path><circle cx="6" cy="18" r="3" stroke-width="2" data-v-62ae35c9></circle><circle cx="18" cy="16" r="3" stroke-width="2" data-v-62ae35c9></circle></svg><span class="upload-hint" data-v-62ae35c9></span>',2)])]))],8,AC),e("div",jC,[e("div",PC,S(W.title),1),e("div",EC,S(W.artist),1),e("div",BC,[e("span",null,S($e(W.size)),1),W.duration?(p(),m("span",VC,S(ne(W.duration)),1)):U("",!0),W.lyrics?(p(),m("span",HC," ")):U("",!0),W.customCover?(p(),m("span",DC," ")):U("",!0)])]),e("div",FC,[e("button",{class:"action-icon-btn",onClick:D=>F(B),title:""},[...Q[22]||(Q[22]=[dt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-62ae35c9><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke-width="2" data-v-62ae35c9></path><polyline points="14 2 14 8 20 8" stroke-width="2" data-v-62ae35c9></polyline><line x1="16" y1="13" x2="8" y2="13" stroke-width="2" data-v-62ae35c9></line><line x1="16" y1="17" x2="8" y2="17" stroke-width="2" data-v-62ae35c9></line><polyline points="10 9 9 9 8 9" stroke-width="2" data-v-62ae35c9></polyline></svg>',1)])],8,UC),e("button",{class:"action-icon-btn",onClick:D=>de(B),title:""},[...Q[23]||(Q[23]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7","stroke-width":"2"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z","stroke-width":"2"})],-1)])],8,NC),e("button",{class:"action-icon-btn danger",onClick:D=>ue(B),title:""},[...Q[24]||(Q[24]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18","stroke-width":"2"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18","stroke-width":"2"})],-1)])],8,OC)])]))),128)),e("button",{class:"primary-btn full-width",onClick:G},"  ("+S($.value.length)+" ) ",1)])):U("",!0),e("input",{type:"file",ref_key:"lyricsInput",ref:I,accept:".lrc",style:{display:"none"},onChange:x},null,544),e("input",{type:"file",ref_key:"coverInput",ref:_,accept:"image/*",style:{display:"none"},onChange:ae},null,544)])):U("",!0)])],4)],4))}},zC=Ze(RC,[["__scopeId","data-v-62ae35c9"]]);class Sl{static parse(s){if(!s||typeof s!="string")return[];const o=s.split(`
`),n=[];for(const a of o){const l=/\[(\d{2}):(\d{2})(?:\.(\d{2,3}))?\]/g,i=[...a.matchAll(l)];if(i.length>0){const r=a.replace(/\[(\d{2}):(\d{2})(?:\.(\d{2,3}))?\]/g,"").trim();if(!r||r.startsWith("["))continue;for(const c of i){const d=parseInt(c[1]),u=parseInt(c[2]),v=c[3]?parseInt(c[3].padEnd(3,"0")):0,b=d*60+u+v/1e3;n.push({time:b,text:r})}}}return n.sort((a,l)=>a.time-l.time),n}static getCurrentIndex(s,o){if(!s||s.length===0)return-1;for(let n=s.length-1;n>=0;n--)if(s[n].time<=o)return n;return-1}static formatTime(s){const o=Math.floor(s/60),n=Math.floor(s%60);return`${o.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}}class WC{async getCharacterListenTime(s){try{return await C.getSetting(`listenTogether_${s}`)||0}catch(o){return console.error(":",o),0}}async saveCharacterListenTime(s,o){try{await C.setSetting(`listenTogether_${s}`,o)}catch(n){console.error(":",n)}}async addCharacterListenTime(s,o){try{const a=await this.getCharacterListenTime(s)+o;return await this.saveCharacterListenTime(s,a),a}catch(n){return console.error(":",n),0}}formatTime(s){if(!s||s<0)return"0";const o=Math.floor(s/3600),n=Math.floor(s%3600/60);return o>0?`${o}${n}`:`${n}`}}const Es=new WC,KC={class:"music-header"},GC={class:"song-info-header"},qC={class:"song-title-small"},ZC={class:"artist-name-small"},JC={class:"album-section"},YC={key:0,class:"listen-together-avatars"},XC={class:"avatar-item left"},QC=["src","alt"],e6={class:"avatar-item right"},t6=["src"],s6={key:1,class:"listen-time-display"},o6={class:"vinyl-disc"},n6=["src","alt"],a6={class:"lyrics-container"},l6={key:0},i6={key:1,class:"no-lyrics"},r6={class:"progress-section"},c6={class:"progress-bar-bg"},d6={class:"time-display"},u6={class:"current-time"},v6={class:"total-time"},p6={class:"controls-section"},f6={class:"control-buttons"},m6={key:0,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},g6={key:1,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},h6={key:2,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},y6={key:0,width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor"},b6={key:1,width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",style:{"margin-left":"2px"}},w6={class:"menu-header"},k6={class:"menu-items"},x6={class:"friends-list"},C6=["onClick"],$6=["src","alt"],_6={class:"friend-name"},M6={key:0,class:"empty-friends"},S6={class:"modal-buttons"},I6={class:"playlist-songs"},A6=["onClick"],L6={class:"song-index"},T6=["src","alt"],j6={class:"song-info-small"},P6={class:"song-title-small"},E6={class:"song-artist-small"},B6={key:0,class:"playing-indicator-small"},V6={key:0,class:"empty-playlist"},H6={class:"modal-buttons"},D6={__name:"music",props:{song:{type:Object,required:!0}},emits:["back"],setup(t,{emit:s}){const o=zo,n=h(!1),a=h(0),l=h(!1),i=h(!1),r=h(!1),c=h([]),d=h("https://via.placeholder.com/50"),u=h(0),v=h(0),b=h({show:!1,message:""}),y=h({wallpaper:"https://picsum.photos/1080/1920?random=33",uiColor:"#000000",opacity:.4,textColor:"#ffffff"}),M=ot(()=>{var ne;return(ne=o.currentSong)!=null&&ne.lyrics?Sl.parse(o.currentSong.lyrics):[]}),A=ot(()=>Sl.getCurrentIndex(M.value,o.currentTime)),w=ot(()=>{const ne=u.value+v.value;return Es.formatTime(ne)}),k=ot(()=>(_(y.value.uiColor),{backgroundImage:`url(${y.value.wallpaper})`,backgroundSize:"cover",backgroundPosition:"center"})),I=ot(()=>({backgroundColor:`rgba(${_(y.value.uiColor)}, ${y.value.opacity})`})),_=ne=>{const G=parseInt(ne.slice(1,3),16),he=parseInt(ne.slice(3,5),16),j=parseInt(ne.slice(5,7),16);return`${G}, ${he}, ${j}`},$=ot(()=>o.duration?o.currentTime/o.duration*100:0),T=()=>{$t.togglePlay()},q=()=>{n.value=!n.value},oe=()=>{$t.toggleGlobalLyrics(),g(o.showGlobalLyrics?"":"")},se=()=>{const ne={list:"",random:"",single:""},G=$t.toggleLoopMode();g(ne[G])},J=()=>{$t.previous(),g("")},N=()=>{$t.next(),g("")},P=ne=>{const G=ne.currentTarget.getBoundingClientRect(),Q=(ne.clientX-G.left)/G.width*o.duration;$t.seek(Q)},f=ne=>$t.formatTime(ne),g=ne=>{b.value.message=ne,b.value.show=!0,setTimeout(()=>{b.value.show=!1},1500)},H=()=>{g("")},K=async()=>{l.value=!1;try{const{db:ne}=await ls(async()=>{const{db:he}=await Promise.resolve().then(()=>Fs);return{db:he}},void 0),G=await ne.getContacts();c.value=G,i.value=!0}catch(ne){console.error(":",ne),g("")}},F=async ne=>{i.value=!1,$t.startListenTogether(ne,o.currentSong),u.value=await Es.getCharacterListenTime(ne.id),v.value=0;try{const{db:G}=await ls(async()=>{const{db:j}=await Promise.resolve().then(()=>Fs);return{db:j}},void 0),he=await G.getUserSetting(ne.id,"avatar");he?d.value=he:d.value="https://via.placeholder.com/50"}catch(G){console.error(":",G)}g(` ${ne.name} `)},x=async()=>{if(o.listenTogether.active&&o.listenTogether.character){const ne=o.listenTogether.character.id;await Es.addCharacterListenTime(ne,v.value),$t.endListenTogether(),u.value=0,v.value=0,g("")}},L=()=>{l.value=!1,r.value=!0},ae=(ne,G)=>{r.value=!1,o.playlist&&o.playlist.length>0?$t.setPlaylist(o.playlist,G):$t.playSong(ne),g(`: ${ne.title}`)},de=async()=>{try{const ne=await Ct.getUserConfig();if(ne&&(y.value=ne),ne.avatar)d.value=ne.avatar;else{const{db:G}=await ls(async()=>{const{db:j}=await Promise.resolve().then(()=>Fs);return{db:j}},void 0),he=await G.getContacts();if(he.length>0){const j=await G.getUserSetting(he[0].id,"avatar");j&&(d.value=j)}}}catch(ne){console.error(":",ne)}},ue=async()=>{try{await Ct.saveUserConfig(y.value)}catch(ne){console.error(":",ne)}};Pt(y,()=>{ue()},{deep:!0});let $e=null;return nt(async()=>{if(await de(),o.listenTogether.active&&o.listenTogether.character){u.value=await Es.getCharacterListenTime(o.listenTogether.character.id),v.value=o.listenTogether.elapsedTime||0;try{const{db:ne}=await ls(async()=>{const{db:he}=await Promise.resolve().then(()=>Fs);return{db:he}},void 0),G=await ne.getUserSetting(o.listenTogether.character.id,"avatar");G&&(d.value=G)}catch(ne){console.error(":",ne)}}$e=setInterval(async()=>{if(o.listenTogether.active&&o.listenTogether.character&&o.isPlaying&&(v.value++,v.value%60===0)){const ne=o.listenTogether.character.id;await Es.saveCharacterListenTime(ne,u.value+v.value)}},1e3)}),Dt(async()=>{if($e&&clearInterval($e),o.listenTogether.active&&o.listenTogether.character&&v.value>0){const ne=o.listenTogether.character.id;await Es.addCharacterListenTime(ne,v.value)}}),Pt(()=>o.currentSong,ne=>{ne&&(a.value=0)}),Pt(()=>o.listenTogether.active,async ne=>{if(ne&&o.listenTogether.character){u.value=await Es.getCharacterListenTime(o.listenTogether.character.id),v.value=0;try{const{db:G}=await ls(async()=>{const{db:j}=await Promise.resolve().then(()=>Fs);return{db:j}},void 0),he=await G.getUserSetting(o.listenTogether.character.id,"avatar");he?d.value=he:d.value="https://via.placeholder.com/50"}catch(G){console.error(":",G)}}else v.value>0&&o.listenTogether.character&&await Es.addCharacterListenTime(o.listenTogether.character.id,v.value),u.value=0,v.value=0,d.value="https://via.placeholder.com/50"}),(ne,G)=>{var he,j,Q,W;return p(),m("div",{class:"music-player-page",style:Re(k.value)},[e("div",{class:"page-overlay",style:Re(I.value)},null,4),e("header",KC,[e("button",{class:"back-btn",onClick:G[0]||(G[0]=B=>ne.$emit("back"))},[...G[10]||(G[10]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])]),e("div",GC,[e("div",qC,S(((he=Ue(o).currentSong)==null?void 0:he.title)||""),1),e("div",ZC,S(((j=Ue(o).currentSong)==null?void 0:j.artist)||""),1)]),e("button",{class:"more-btn",onClick:G[1]||(G[1]=B=>l.value=!0)},[...G[11]||(G[11]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[e("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"}),e("circle",{cx:"12",cy:"5",r:"1.5",fill:"currentColor"}),e("circle",{cx:"12",cy:"19",r:"1.5",fill:"currentColor"})],-1)])])]),e("section",JC,[Ue(o).listenTogether.active&&Ue(o).listenTogether.character&&!n.value?(p(),m("div",YC,[e("div",XC,[e("img",{src:Ue(o).listenTogether.character.avatar,alt:Ue(o).listenTogether.character.name},null,8,QC)]),e("div",e6,[e("img",{src:d.value,alt:""},null,8,t6)])])):U("",!0),Ue(o).listenTogether.active&&Ue(o).listenTogether.character&&!n.value?(p(),m("div",s6,[e("span",null," "+S(w.value),1)])):U("",!0),we(e("div",{class:Ie(["album-cover-wrapper",{rotating:Ue(o).isPlaying}]),onClick:q},[e("div",o6,[e("img",{src:((Q=Ue(o).currentSong)==null?void 0:Q.cover)||Ue(Uo)(),alt:(W=Ue(o).currentSong)==null?void 0:W.title,class:"album-image"},null,8,n6)])],2),[[vo,!n.value]]),e("div",{class:Ie(["lyrics-overlay",{visible:n.value}]),onClick:q},[e("div",a6,[M.value.length>0?(p(),m("div",l6,[(p(!0),m(Pe,null,Fe(M.value,(B,D)=>(p(),m("div",{key:D,class:Ie(["lyric-line",{active:D===A.value}])},S(B.text),3))),128))])):(p(),m("div",i6,[...G[12]||(G[12]=[e("p",null,"",-1)])]))])],2)]),e("section",{class:"chat-section"},[e("button",{class:"chat-btn",onClick:H},[...G[13]||(G[13]=[e("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})],-1)])])]),e("section",r6,[e("div",{class:"progress-bar-wrapper",onClick:P},[e("div",c6,[e("div",{class:"progress-bar-fill",style:Re({width:$.value+"%"})},[...G[14]||(G[14]=[e("div",{class:"progress-dot"},null,-1)])],4)])]),e("div",d6,[e("span",u6,S(f(Ue(o).currentTime)),1),e("span",v6,S(f(Ue(o).duration)),1)])]),e("section",p6,[e("div",f6,[e("button",{class:"control-icon",onClick:oe},[...G[15]||(G[15]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})],-1)])]),e("button",{class:"control-icon",onClick:se},[Ue(o).loopMode==="list"?(p(),m("svg",m6,[...G[16]||(G[16]=[e("polyline",{points:"17 1 21 5 17 9"},null,-1),e("path",{d:"M3 11V9a4 4 0 0 1 4-4h14"},null,-1),e("polyline",{points:"7 23 3 19 7 15"},null,-1),e("path",{d:"M21 13v2a4 4 0 0 1-4 4H3"},null,-1)])])):Ue(o).loopMode==="random"?(p(),m("svg",g6,[...G[17]||(G[17]=[dt('<polyline points="16 3 21 3 21 8" data-v-f4bc7f52></polyline><line x1="4" y1="20" x2="21" y2="3" data-v-f4bc7f52></line><polyline points="21 16 21 21 16 21" data-v-f4bc7f52></polyline><line x1="15" y1="15" x2="21" y2="21" data-v-f4bc7f52></line><line x1="4" y1="4" x2="9" y2="9" data-v-f4bc7f52></line>',5)])])):(p(),m("svg",h6,[...G[18]||(G[18]=[dt('<polyline points="17 1 21 5 17 9" data-v-f4bc7f52></polyline><path d="M3 11V9a4 4 0 0 1 4-4h14" data-v-f4bc7f52></path><polyline points="7 23 3 19 7 15" data-v-f4bc7f52></polyline><path d="M21 13v2a4 4 0 0 1-4 4H3" data-v-f4bc7f52></path><text x="10.5" y="14.5" fill="currentColor" style="font-size:8px;font-weight:bold;" data-v-f4bc7f52>1</text>',5)])]))]),e("button",{class:"control-icon",onClick:J},[...G[19]||(G[19]=[e("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"})],-1)])]),e("button",{class:"play-pause-btn",onClick:T},[Ue(o).isPlaying?(p(),m("svg",y6,[...G[20]||(G[20]=[e("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"},null,-1)])])):(p(),m("svg",b6,[...G[21]||(G[21]=[e("path",{d:"M8 5v14l11-7z"},null,-1)])]))]),e("button",{class:"control-icon",onClick:N},[...G[22]||(G[22]=[e("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M6 18l8.5-6L6 6zm9-12v12h2V6z"})],-1)])]),e("button",{class:"control-icon",onClick:L},[...G[23]||(G[23]=[dt('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-f4bc7f52><line x1="8" y1="6" x2="21" y2="6" data-v-f4bc7f52></line><line x1="8" y1="12" x2="21" y2="12" data-v-f4bc7f52></line><line x1="8" y1="18" x2="21" y2="18" data-v-f4bc7f52></line><line x1="3" y1="6" x2="3.01" y2="6" data-v-f4bc7f52></line><line x1="3" y1="12" x2="3.01" y2="12" data-v-f4bc7f52></line><line x1="3" y1="18" x2="3.01" y2="18" data-v-f4bc7f52></line></svg>',1)])])])]),e("div",{class:Ie(["toast",{show:b.value.show}])},S(b.value.message),3),l.value?(p(),m("div",{key:0,class:"menu-overlay",onClick:G[2]||(G[2]=B=>l.value=!1)})):U("",!0),e("div",{class:Ie(["menu-panel",{active:l.value}])},[e("div",w6,[G[24]||(G[24]=e("h3",null,"",-1)),e("button",{onClick:G[3]||(G[3]=B=>l.value=!1)},"")]),e("div",k6,[Ue(o).listenTogether.active?(p(),m("div",{key:1,class:"menu-item",onClick:x},[...G[26]||(G[26]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),e("span",null,"",-1)])])):(p(),m("div",{key:0,class:"menu-item",onClick:K},[...G[25]||(G[25]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 18V5l12-2v13"}),e("circle",{cx:"6",cy:"18",r:"3"}),e("circle",{cx:"18",cy:"16",r:"3"})],-1),e("span",null,"",-1)])]))])],2),i.value?(p(),m("div",{key:1,class:"modal-overlay",onClick:G[6]||(G[6]=B=>i.value=!1)},[e("div",{class:"modal-content",onClick:G[5]||(G[5]=je(()=>{},["stop"]))},[G[28]||(G[28]=e("h3",{class:"modal-title"},"",-1)),e("div",x6,[(p(!0),m(Pe,null,Fe(c.value,B=>(p(),m("div",{key:B.id,class:"friend-item",onClick:D=>F(B)},[e("img",{src:B.avatar,alt:B.name,class:"friend-avatar"},null,8,$6),e("div",_6,S(B.name),1)],8,C6))),128)),c.value.length===0?(p(),m("div",M6,[...G[27]||(G[27]=[e("p",null,"",-1),e("p",{class:"hint"},"",-1)])])):U("",!0)]),e("div",S6,[e("button",{class:"modal-btn cancel-btn",onClick:G[4]||(G[4]=B=>i.value=!1)},"")])])])):U("",!0),r.value?(p(),m("div",{key:2,class:"modal-overlay",onClick:G[9]||(G[9]=B=>r.value=!1)},[e("div",{class:"modal-content playlist-modal",onClick:G[8]||(G[8]=je(()=>{},["stop"]))},[G[31]||(G[31]=e("h3",{class:"modal-title"},"",-1)),e("div",I6,[(p(!0),m(Pe,null,Fe(Ue(o).playlist,(B,D)=>(p(),m("div",{key:B.id,class:Ie(["playlist-song-item",{active:D===Ue(o).currentIndex}]),onClick:xe=>ae(B,D)},[e("div",L6,S(D+1),1),e("img",{src:B.cover,alt:B.title,class:"song-cover-small"},null,8,T6),e("div",j6,[e("div",P6,S(B.title),1),e("div",E6,S(B.artist),1)]),D===Ue(o).currentIndex&&Ue(o).isPlaying?(p(),m("div",B6,[...G[29]||(G[29]=[e("div",{class:"bar"},null,-1),e("div",{class:"bar"},null,-1),e("div",{class:"bar"},null,-1)])])):U("",!0)],10,A6))),128)),Ue(o).playlist.length===0?(p(),m("div",V6,[...G[30]||(G[30]=[e("p",null,"",-1)])])):U("",!0)]),e("div",H6,[e("button",{class:"modal-btn cancel-btn",onClick:G[7]||(G[7]=B=>r.value=!1)},"")])])])):U("",!0)],4)}}},F6=Ze(D6,[["__scopeId","data-v-f4bc7f52"]]),U6={class:"music-app-container"},N6={__name:"MusicApp",emits:["back"],setup(t){const s=h("home"),o=h(null),n=h("home"),a=h(null),l=h(null),i=(v,b)=>{s.value=v,(v==="playlist-manager"||v==="music-add")&&b&&(o.value=b.id||b)},r=v=>{n.value=s.value,a.value=o.value,l.value=v,s.value="player"},c=()=>{s.value="home",o.value=null},d=()=>{s.value="playlist-manager"},u=()=>{s.value=n.value,n.value==="playlist-manager"&&a.value&&(o.value=a.value)};return(v,b)=>(p(),m("div",U6,[s.value==="home"?(p(),st(I3,{key:0,onBack:b[0]||(b[0]=y=>v.$emit("back")),onNavigate:i,onPlaySong:r})):U("",!0),s.value==="listen-together"?(p(),st(ux,{key:1,onBack:c})):U("",!0),s.value==="playlist-manager"?(p(),st(Yx,{key:2,"playlist-id":o.value,onBack:c,onNavigate:i,onPlaySong:r},null,8,["playlist-id"])):U("",!0),s.value==="music-add"?(p(),st(zC,{key:3,"playlist-id":o.value,onBack:d,onSongAdded:d},null,8,["playlist-id"])):U("",!0),s.value==="player"?(p(),st(F6,{key:4,song:l.value,onBack:u},null,8,["song"])):U("",!0)]))}},O6=Ze(N6,[["__scopeId","data-v-e2b87268"]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R6=t=>{for(const s in t)if(s.startsWith("aria-")||s==="role"||s==="title")return!0;return!1};/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=t=>t==="";/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z6=(...t)=>t.filter((s,o,n)=>!!s&&s.trim()!==""&&n.indexOf(s)===o).join(" ").trim();/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Al=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W6=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,o,n)=>n?n.toUpperCase():o.toLowerCase());/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K6=t=>{const s=W6(t);return s.charAt(0).toUpperCase()+s.slice(1)};/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ko={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G6=({name:t,iconNode:s,absoluteStrokeWidth:o,"absolute-stroke-width":n,strokeWidth:a,"stroke-width":l,size:i=ko.width,color:r=ko.stroke,...c},{slots:d})=>mn("svg",{...ko,...c,width:i,height:i,stroke:r,"stroke-width":Il(o)||Il(n)||o===!0||n===!0?Number(a||l||ko["stroke-width"])*24/Number(i):a||l||ko["stroke-width"],class:z6("lucide",c.class,...t?[`lucide-${Al(K6(t))}-icon`,`lucide-${Al(t)}`]:["lucide-icon"]),...!d.default&&!R6(c)&&{"aria-hidden":"true"}},[...s.map(u=>mn(...u)),...d.default?[d.default()]:[]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=(t,s)=>(o,{slots:n,attrs:a})=>mn(G6,{...a,...o,iconNode:s,name:t},n);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=ds("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q6=ds("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z6=ds("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=ds("ghost",[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y6=ds("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X6=ds("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=ds("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=ds("navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=ds("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=ds("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e$=ds("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t$=ds("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),s$="ForumUserDB",o$=2,Vt="userProfile",kt="threads",no="replies";class n${constructor(){this.db=null}async init(){return new Promise((s,o)=>{const n=indexedDB.open(s$,o$);n.onerror=()=>o(n.error),n.onsuccess=()=>{this.db=n.result,s(this.db)},n.onupgradeneeded=a=>{const l=a.target.result;l.objectStoreNames.contains(Vt)||l.createObjectStore(Vt,{keyPath:"id"}),l.objectStoreNames.contains(kt)||l.createObjectStore(kt,{keyPath:"id"}).createIndex("category","category",{unique:!1}),l.objectStoreNames.contains(no)||l.createObjectStore(no,{keyPath:"id",autoIncrement:!0}).createIndex("threadId","threadId",{unique:!1})}})}async saveUserProfile(s){return this.db||await this.init(),new Promise((o,n)=>{const i=this.db.transaction([Vt],"readwrite").objectStore(Vt).put({id:"currentUser",...s});i.onsuccess=()=>o(i.result),i.onerror=()=>n(i.error)})}async getUserProfile(){return this.db||await this.init(),new Promise((s,o)=>{const l=this.db.transaction([Vt],"readonly").objectStore(Vt).get("currentUser");l.onsuccess=()=>{const i=l.result;s(i||{username:"DollyMoon",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Marshmallow"})},l.onerror=()=>o(l.error)})}async saveThread(s){return this.db||await this.init(),new Promise((o,n)=>{const l=this.db.transaction([kt],"readwrite").objectStore(kt),i={...s,isLocked:s.isLocked||!1,lockedReason:s.lockedReason||"",kickedUsers:s.kickedUsers||[],blockedUsers:s.blockedUsers||[]},r=l.put(i);r.onsuccess=()=>o(r.result),r.onerror=()=>n(r.error)})}async getAllThreads(){return this.db||await this.init(),new Promise((s,o)=>{const l=this.db.transaction([kt],"readonly").objectStore(kt).getAll();l.onsuccess=()=>s(l.result||[]),l.onerror=()=>o(l.error)})}async getThreadsByCategory(s){return this.db||await this.init(),new Promise((o,n)=>{const r=this.db.transaction([kt],"readonly").objectStore(kt).index("category").getAll(s);r.onsuccess=()=>o(r.result||[]),r.onerror=()=>n(r.error)})}async markThreadAsReplied(s){return this.db||await this.init(),new Promise(async(o,n)=>{try{const l=this.db.transaction([kt],"readwrite").objectStore(kt),i=l.get(s);i.onsuccess=()=>{const r=i.result;if(r){r.userReplied=!0,r.isLive=!0;const c=l.put(r);c.onsuccess=()=>o(),c.onerror=()=>n(c.error)}else o()},i.onerror=()=>n(i.error)}catch(a){n(a)}})}async favoriteThread(s){return this.db||await this.init(),new Promise(async(o,n)=>{try{const l=this.db.transaction([kt],"readwrite").objectStore(kt),i=l.get(s);i.onsuccess=()=>{const r=i.result;if(r){r.favorited=!r.favorited;const c=l.put(r);c.onsuccess=()=>o(r.favorited),c.onerror=()=>n(c.error)}else o(!1)},i.onerror=()=>n(i.error)}catch(a){n(a)}})}async blockThread(s){return this.db||await this.init(),new Promise(async(o,n)=>{try{const l=this.db.transaction([kt],"readwrite").objectStore(kt),i=l.get(s);i.onsuccess=()=>{const r=i.result;if(r){r.blocked=!r.blocked;const c=l.put(r);c.onsuccess=()=>o(r.blocked),c.onerror=()=>n(c.error)}else o(!1)},i.onerror=()=>n(i.error)}catch(a){n(a)}})}async deleteThread(s){return this.db||await this.init(),new Promise((o,n)=>{const i=this.db.transaction([kt],"readwrite").objectStore(kt).delete(s);i.onsuccess=()=>o(),i.onerror=()=>n(i.error)})}async saveReply(s){return this.db||await this.init(),new Promise((o,n)=>{const i=this.db.transaction([no],"readwrite").objectStore(no).add(s);i.onsuccess=()=>o(i.result),i.onerror=()=>n(i.error)})}async getRepliesByThreadId(s){return this.db||await this.init(),new Promise((o,n)=>{const r=this.db.transaction([no],"readonly").objectStore(no).index("threadId").getAll(s);r.onsuccess=()=>o(r.result||[]),r.onerror=()=>n(r.error)})}async initDefaultThreads(){(await this.getAllThreads()).length>0||console.log(" AI ")}async saveForumWorldView(s){return this.db||await this.init(),new Promise((o,n)=>{const i=this.db.transaction([Vt],"readwrite").objectStore(Vt).put({id:"forumWorldView",content:s});i.onsuccess=()=>o(i.result),i.onerror=()=>n(i.error)})}async getForumWorldView(){return this.db||await this.init(),new Promise((s,o)=>{const l=this.db.transaction([Vt],"readonly").objectStore(Vt).get("forumWorldView");l.onsuccess=()=>{const i=l.result;s(i?i.content:null)},l.onerror=()=>o(l.error)})}async saveSelectedWorldBook(s){return this.db||await this.init(),new Promise((o,n)=>{const i=this.db.transaction([Vt],"readwrite").objectStore(Vt).put({id:"selectedWorldBook",worldBookId:s});i.onsuccess=()=>o(i.result),i.onerror=()=>n(i.error)})}async getSelectedWorldBook(){return this.db||await this.init(),new Promise((s,o)=>{const l=this.db.transaction([Vt],"readonly").objectStore(Vt).get("selectedWorldBook");l.onsuccess=()=>{const i=l.result;s(i?i.worldBookId:null)},l.onerror=()=>o(l.error)})}async saveReplyCount(s){return this.db||await this.init(),new Promise((o,n)=>{const i=this.db.transaction([Vt],"readwrite").objectStore(Vt).put({id:"replyCount",count:s});i.onsuccess=()=>o(i.result),i.onerror=()=>n(i.error)})}async getReplyCount(){return this.db||await this.init(),new Promise((s,o)=>{const l=this.db.transaction([Vt],"readonly").objectStore(Vt).get("replyCount");l.onsuccess=()=>{const i=l.result;s(i?i.count:5)},l.onerror=()=>o(l.error)})}async deleteBlockedThreads(){return this.db||await this.init(),new Promise(async(s,o)=>{try{const a=(await this.getAllThreads()).filter(c=>c.blocked),i=this.db.transaction([kt],"readwrite").objectStore(kt);let r=0;for(const c of a){const d=i.delete(c.id);d.onsuccess=()=>{r++,r===a.length&&s(r)},d.onerror=()=>o(d.error)}a.length===0&&s(0)}catch(n){o(n)}})}async lockThread(s,o=""){return this.db||await this.init(),new Promise(async(n,a)=>{try{const i=this.db.transaction([kt],"readwrite").objectStore(kt),r=i.get(s);r.onsuccess=()=>{const c=r.result;if(c){c.isLocked=!0,c.lockedReason=o;const d=i.put(c);d.onsuccess=()=>n(),d.onerror=()=>a(d.error)}else n()},r.onerror=()=>a(r.error)}catch(l){a(l)}})}async kickUser(s,o){return this.db||await this.init(),new Promise(async(n,a)=>{try{const i=this.db.transaction([kt],"readwrite").objectStore(kt),r=i.get(s);r.onsuccess=()=>{const c=r.result;if(c){c.kickedUsers||(c.kickedUsers=[]),c.kickedUsers.includes(o)||c.kickedUsers.push(o);const d=i.put(c);d.onsuccess=()=>n(),d.onerror=()=>a(d.error)}else n()},r.onerror=()=>a(r.error)}catch(l){a(l)}})}async blockUser(s,o){return this.db||await this.init(),new Promise(async(n,a)=>{try{const i=this.db.transaction([kt],"readwrite").objectStore(kt),r=i.get(s);r.onsuccess=()=>{const c=r.result;if(c){c.blockedUsers||(c.blockedUsers=[]),c.blockedUsers.includes(o)||c.blockedUsers.push(o);const d=i.put(c);d.onsuccess=()=>n(),d.onerror=()=>a(d.error)}else n()},r.onerror=()=>a(r.error)}catch(l){a(l)}})}async getThreadById(s){return this.db||await this.init(),new Promise((o,n)=>{const i=this.db.transaction([kt],"readonly").objectStore(kt).get(s);i.onsuccess=()=>o(i.result||null),i.onerror=()=>n(i.error)})}}const rt=new n$,Pn=async(t,s,o=2e3,n=!0)=>{var d,u,v,b,y,M,A,w;const a=await Ut.getApiConfig();if(console.log(" API:",{provider:a.provider,model:a.model,hasApiKey:!!a.apiKey,baseUrl:a.baseUrl}),!(a!=null&&a.apiKey))throw new Error("API Key ");const i=`${(a.baseUrl||"").replace(/\/v1\/?$/,"").replace(/\/$/,"")||"https://generativelanguage.googleapis.com"}/v1/chat/completions`;console.log(" URL:",i);const r={model:a.model||"gemini-2.5-flash",messages:[{role:"system",content:t+(n?`

IMPORTANT: Return ONLY valid JSON format. No markdown, no explanations.`:"")},{role:"user",content:s}],temperature:.9,max_tokens:o,stream:!1};n&&(r.response_format={type:"json_object"}),console.log(" :",JSON.stringify(r,null,2));const c=2;for(let k=0;k<=c;k++)try{console.log(`  ( ${k+1}/${c+1})...`);const I=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.apiKey}`},body:JSON.stringify(r)});if(console.log(" :",I.status,I.statusText),!I.ok){const T=await I.text();throw console.error(` HTTP ${I.status}:`,T),new Error(`HTTP ${I.status}: ${T}`)}const _=await I.json();console.log(" :",JSON.stringify(_,null,2));const $=(((v=(u=(d=_.choices)==null?void 0:d[0])==null?void 0:u.message)==null?void 0:v.content)||((w=(A=(M=(y=(b=_.candidates)==null?void 0:b[0])==null?void 0:y.content)==null?void 0:M.parts)==null?void 0:A[0])==null?void 0:w.text)||"").trim();if(console.log(" :",$),!$)throw console.warn(" AI "),new Error("AI ");return $}catch(I){if(console.error(`  ( ${k+1}/${c+1}):`,I),k===c)throw I;await new Promise(_=>setTimeout(_,1e3*(k+1)))}},nr=async()=>{try{const t=await rt.getForumWorldView();if(t&&t.trim())return console.log(" :",t),t;const s=await rt.getSelectedWorldBook();if(console.log(" ID:",s),s){const o=await C.getWorldBookEntries(s);if(console.log(" :",o),o&&o.length>0){const n=o.filter(a=>a.enabled!==!1).map(a=>a.content).join(`

`);return console.log(" :",s,":",o.length),n}}return console.log(" "),null}catch(t){return console.error(" :",t),null}},a$=async(t,s=3)=>{const o={worldbook:{name:"",examples:["","",""]},ghost:{name:"",examples:["3 "," "," "]},daily:{name:"",examples:[" wwww"," "," "]},funny:{name:"",examples:[" wwww"," "," "]},rant:{name:"",examples:[" ",""," "]},diary:{name:"",examples:[" "," "," "]},food:{name:"",examples:[" "," "," "]}},n=o[t]||o.ghost,a=await nr();let l;if(t==="worldbook"||a){if(!a)return console.warn(" "),["","",""];l=` 2ch 


${a}

${n.name} ${s} 

 

1   80%
   - /
   - 
   - ""
   - ""
   - ""

2 -  20%
   - TA
   - 
   - 
   - "TA "


1. 
2. 80%20%
3. 
4.  20-30 
5. 
6. "TA"""""
7. 
8.  ${s} 

 ${s} `}else l=`${n.name}${s}


${n.examples.join(`
`)}


1. 
2. 
3. 20-30
4. 
5. `;l+=`

${s}`;try{console.log(` ${n.name}...`);let i;try{i=await Pn("",l,1e3,!1),console.log(" AI:",i)}catch(v){throw console.error(" AI:",v),v}const r=i.replace(/\\n/g,`
`).replace(/\\r/g,"\r").split(/[\n\r]+/).map(v=>v.trim()).filter(v=>v.length>=10&&v.length<=60&&!v.match(/^[\d\.\-\*\s]+$/)&&!v.includes("{")&&!v.includes("}")&&!v.includes("[")&&!v.includes("]")).map(v=>v.replace(/^\d+[\.\)]\s*/,"").replace(/^[\-\*]\s*/,"").replace(/^["']+/,"").replace(/["']+$/,"").trim()).filter(v=>v.length>=10);if(console.log(" :",r),r.length>=s){const v=r.slice(0,s);return console.log(" :",v),v}console.warn(`  ${r.length}  ${s} `);const c={worldbook:["","",""],ghost:["3",""," "],daily:[" wwww"," "," "],funny:[" "," wwww"," "],rant:[" ",""," "],diary:[" "," "," "],food:[" "," "," "]},d=c[t]||c.ghost,u=[...r,...d].slice(0,s);return console.log(" :",u),u}catch(i){console.error(" :",i);const r={worldbook:["","",""],ghost:["3",""," "],daily:[" wwww"," "," "],funny:[" "," wwww"," "],rant:[" ",""," "],diary:[" "," "," "],food:[" "," "," "]};return r[t]||r.ghost}},l$=async(t,s)=>{const o=await nr(),n={worldbook:{name:"",opStyle:"",opExamples:`......


TA
`,replyStyle:""},ghost:{name:"",opStyle:"",opExamples:`......
 6


 
`,replyStyle:""},daily:{name:"",opStyle:"",opExamples:`


" "

`,replyStyle:""},funny:{name:"",opStyle:"",opExamples:`wwww



"......"
`,replyStyle:"wwww"},rant:{name:"",opStyle:"",opExamples:`




`,replyStyle:""},diary:{name:"",opStyle:"////",opExamples:`......


 


`,replyStyle:""},food:{name:"",opStyle:"",opExamples:`



wwww
`,replyStyle:""}},a=n[t]||n.ghost;let l;t==="worldbook"||o?l=` 2ch ${a.name}


${o}


${s}

 


- 
- TA
- 
- 

TA
- /
- /

(OP)
- ${a.opStyle}
- 
- 
- 


- 80%
- 1-2
- ${a.replyStyle}
- 1-210-30
- """wwww"""""""
- 

5-8
---
[]
...
---
[]
1...
---
[]
2...
---

`:l=`2ch${a.name}

${s}
${a.name}

(OP)
- ${a.opStyle}
- 
- 


${a.opExamples}


- ${a.replyStyle}
- 1-210-30
- """wwww"""""""
- 

5-8
---
[]
...
---
[]
1...
---
[]
2...
---

`;try{console.log(" ...");const i=await Pn("",l,2e3,!1);console.log(" AI:",i);const r=[],c=i.split("---").map(d=>d.trim()).filter(d=>d.length>0);for(const d of c){const u=d.split(`
`).map(A=>A.trim()).filter(A=>A.length>0);if(u.length<2)continue;const v=u[0],b=u.slice(1).join(`
`),y=v.includes("")||v.includes("OP"),M=y?"":"";r.push({user:M,content:b,isOP:y})}return console.log(" :",r),r.length>0?r:(console.warn(" "),[{user:"",content:"...",isOP:!0}])}catch(i){return console.error(" :",i),[{user:"",content:"...",isOP:!0}]}},i$=async(t,s,o,n,a=!1)=>{const l=await rt.getReplyCount(),i=o.slice(-8).map(y=>`${y.isOP?"[OP]":"[]"}: ${y.content}`).join(`
`),r={ghost:"",daily:"",funny:"wwww",rant:"",diary:"",food:""},c=r[t]||r.ghost,d=n.includes("@"),u=/[!?]/.test(n)||n.length>30;let v;a?d||u?v=`${d?"":""}

2ch

${c}

 
- 70%""""""
- 20%""""""
- 10%"wwww"""

TA

1-2

  []  [OP]  [] `:v=`

2ch

${c}

1-2
- """wwww"""""""
- 
- """""wwww"""

  []  [OP]  [] `:v=`${t}

1-2`;const b=`2ch${t}

${v}


- 1-210-30
- """wwww"""""""
- 
- 
-  ${l} 


${i}

${n}

 
1. 20
   - [LOCK_THREAD:]
   
2. 
   - [KICK_USER:]

 ${l} 
---
[]
...
---
[]
...
---
[]
...
---

 ${l} 

`;try{console.log(" ..."),console.log(" :",l);const y=await Pn("",b,3e3,!1);console.log(" AI:",y);let M=!1,A="",w=!1,k="";if(y.includes("[LOCK_THREAD:")){const T=y.match(/\[LOCK_THREAD:([^\]]+)\]/);T&&(M=!0,A=T[1])}if(y.includes("[KICK_USER:")){const T=y.match(/\[KICK_USER:([^\]]+)\]/);T&&(w=!0,k=T[1])}const I=y.replace(/\[LOCK_THREAD:[^\]]+\]/g,"").replace(/\[KICK_USER:[^\]]+\]/g,""),_=[],$=I.split("---").map(T=>T.trim()).filter(T=>T.length>0);console.log(" sections:",$.length);for(const T of $){const q=T.split(`
`).map(P=>P.trim()).filter(P=>P.length>0);if(q.length<2)continue;const oe=q[0],se=q.slice(1).join(`
`);let J=oe.includes("")||oe.includes("OP");a&&J&&(console.warn("  AI "),J=!1);const N=J?"":"";_.push({user:N,content:se,isOP:J,shouldLock:M,lockReason:A,shouldKick:w,kickReason:k})}return console.log(" :",_.length,":",l),console.log(" :",_),_.length<l&&console.warn(` AI  ${_.length}  ${l} `),_}catch(y){return console.error(" :",y),[]}},r$=async(t,s,o="ghost")=>{const n={ghost:{name:"",style:""},daily:{name:"",style:""},funny:{name:"",style:"wwww"},rant:{name:"",style:""},diary:{name:"",style:"//"},food:{name:"",style:""}},a=n[o]||n.ghost,l=`${a.name}2ch

${a.name}
${a.style}

${t}
${s}


- 1-210-30
- """wwww"""""
- 
- 
- 
- 

5-8
---
[]
...
---
[]
...
---

`;try{console.log(" ...");const i=await Pn("",l,1500,!1);console.log(" AI:",i);const r=[],c=i.split("---").map(d=>d.trim()).filter(d=>d.length>0);for(const d of c){const u=d.split(`
`).map(b=>b.trim()).filter(b=>b.length>0);if(u.length<2)continue;const v=u.slice(1).join(`
`);r.push({user:"",content:v,isOP:!1})}return console.log(" :",r),r}catch(i){return console.error(" :",i),[]}},Co=()=>{const t="abcdefghijklmnopqrstuvwxyz0123456789";let s="";for(let o=0;o<4;o++)s+=t.charAt(Math.floor(Math.random()*t.length));return`anon/${s}`},Ys=()=>{const t=new Date;return`${t.getFullYear()}/${String(t.getMonth()+1).padStart(2,"0")}/${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},c$={class:"thread-detail-container animate-in"},d$={class:"detail-header"},u$={class:"thread-title-card"},v$={class:"title-text"},p$={class:"bubbles-list"},f$=["data-index","onTouchstart"],m$={class:"post-meta"},g$={class:"user-name"},h$={class:"post-id"},y$={key:0,class:"op-mascot"},b$={key:1,class:"kicked-message"},w$={class:"post-text"},k$={class:"post-footer"},x$={class:"post-time"},C$={key:0,class:"typing-indicator"},$$={class:"typing-text"},_$={key:1,class:"live-indicator"},M$={key:0,class:"op-actions"},S$={key:1,class:"locked-banner"},I$={class:"locked-content"},A$={class:"locked-text"},L$={class:"locked-reason"},T$={key:2,class:"kicked-banner"},j$=["onClick"],P$={key:4,class:"reply-footer"},E$={class:"input-wrapper"},B$=["disabled"],V$={__name:"forumdetail",props:{threadId:{type:Number,required:!0},threadTitle:{type:String,default:"..."},posts:{type:Array,default:()=>[]},isUserThread:{type:Boolean,default:!1},isUserOP:{type:Boolean,default:!1},category:{type:String,default:"ghost"}},emits:["back"],setup(t,{emit:s}){const o=t,n=h(""),a=h([]),l=h("Anonymous"),i=h(null),r=h(!1),c=h(""),d=h(!0),u=h(null),v=h(null),b=h(!1),y=h({x:0,y:0}),M=h([]),A=h(null),w=h(null),k=h(!1),I=h(!1),_=ot(()=>{var de,ue;const x=((de=w.value)==null?void 0:de.blockedUsers)||[],L=((ue=w.value)==null?void 0:ue.kickedUsers)||[],ae=[...o.posts,...a.value].filter($e=>!(x.includes($e.user)||x.includes($e.idCode))).map($e=>{const ne=L.includes($e.user)||L.includes($e.idCode);return{...$e,isKicked:ne}});return console.log(" :",l.value),console.log(" :",ae.map($e=>({user:$e.user,content:$e.content.substring(0,20)}))),ae}),$=async()=>{await zt(),i.value&&(i.value.scrollTop=i.value.scrollHeight)},T=async()=>{if(!n.value.trim())return;const x={threadId:o.threadId,user:l.value,isOP:o.isUserOP,date:Ys(),content:n.value.trim(),count:o.posts.length+a.value.length+1,idCode:Co()};console.log(" :",l.value,":",x);try{await rt.saveReply(x),await rt.markThreadAsReplied(o.threadId),a.value.push(x);const L=n.value.trim();n.value="",await $(),await q(L)}catch(L){console.error(":",L)}},q=async x=>{var L;try{console.log(" AI ...");const ae=_.value.length;r.value=!0,c.value=Math.random()>.5?"":"",await new Promise(ne=>setTimeout(ne,2e3+Math.random()*2e3)),console.log(" AI ...");const de=await i$(o.category,o.threadTitle,_.value,x,o.isUserOP);if(console.log("AI :",de),r.value=!1,!de||de.length===0){console.error("AI ");return}const ue=de[0];ue.shouldLock&&(await rt.lockThread(o.threadId,ue.lockReason),await N()),ue.shouldKick&&(await rt.kickUser(o.threadId,l.value),await N());for(const ne of de){const G={threadId:o.threadId,user:ne.user,isOP:ne.isOP,date:Ys(),content:ne.content,count:o.posts.length+a.value.length+1,idCode:Co(),aiGenerated:!0};console.log(" AI :",G),await rt.saveReply(G),a.value.push(G),await new Promise(he=>setTimeout(he,500))}await zt();const $e=(L=i.value)==null?void 0:L.querySelector(`[data-index="${ae}"]`);$e&&$e.scrollIntoView({behavior:"smooth",block:"start"}),console.log(" AI ")}catch(ae){console.error("AI :",ae),alert("AI : "+ae.message),r.value=!1}},oe=async()=>{var x;if(o.isUserThread&&a.value.length===0){try{r.value=!0,c.value="",console.log("...");const L=((x=o.posts[0])==null?void 0:x.content)||"",ae=await r$(o.threadTitle,L,o.category);console.log("AI :",ae);const de=ae.map((ue,$e)=>({...ue,id:Date.now()+$e,date:Ys(),count:o.posts.length+$e+1,idCode:Co(),threadId:o.threadId,isOP:!1}));for(const ue of de)await rt.saveReply(ue),a.value.push(ue),await new Promise($e=>setTimeout($e,800)),await $();r.value=!1,d.value=!1,console.log("")}catch(L){console.error(":",L),alert(": "+L.message),r.value=!1}return}if(o.posts.length===0&&a.value.length===0)try{r.value=!0,c.value="",console.log("...");const L=await l$(o.category,o.threadTitle);console.log("AI :",L);const ae=L.map(($e,ne)=>({...$e,id:Date.now()+ne,date:Ys(),count:ne+1,idCode:$e.idCode||Co(),threadId:o.threadId}));for(const $e of ae)await rt.saveReply($e),a.value.push($e);const ue=(await rt.getAllThreads()).find($e=>$e.id===o.threadId);ue&&(ue.replies=ae.length,await rt.saveThread(ue)),r.value=!1,d.value=!1,console.log("")}catch(L){console.error(" AI :",L),alert(": "+L.message),r.value=!1}else console.log(""),d.value=!1},se=async()=>{try{const x=await rt.getUserProfile();l.value=x.username||"Anonymous"}catch(x){console.error(":",x),l.value="Anonymous"}},J=async()=>{try{const x=await rt.getRepliesByThreadId(o.threadId);a.value=x}catch(x){console.error(":",x)}},N=async()=>{try{const x=await rt.getThreadById(o.threadId);w.value=x,k.value=(x==null?void 0:x.isLocked)||!1;const L=(x==null?void 0:x.kickedUsers)||[];I.value=L.includes(l.value)}catch(x){console.error(":",x)}},P=(x,L)=>{v.value=L,u.value=setTimeout(()=>{g(x,L)},500)},f=()=>{u.value&&(clearTimeout(u.value),u.value=null)},g=(x,L)=>{var $e;x.preventDefault(),A.value=L;const ae=(($e=x.touches)==null?void 0:$e[0])||x;y.value={x:ae.clientX||ae.pageX,y:ae.clientY||ae.pageY};const de=L.user===l.value,ue=L.isOP;if(de)M.value=[{id:"delete",label:" ",color:"red"}];else{const ne=[{id:"mention",label:" ",color:"blue"},{id:"block",label:" ",color:"orange"}];o.isUserOP&&!ue&&ne.push({id:"kick",label:" ",color:"red"}),M.value=ne}b.value=!0},H=()=>{b.value=!1,A.value=null},K=async()=>{const x=prompt("");if(x!==null)try{await rt.lockThread(o.threadId,x||""),await N(),alert("")}catch(L){console.error(":",L),alert(""+L.message)}},F=async x=>{const L=A.value;if(L)switch(H(),x){case"mention":n.value=`@${L.user} `;break;case"block":if(confirm(` ${L.user} TA`))try{await rt.blockUser(o.threadId,L.user),await N(),alert("")}catch(ae){console.error(":",ae),alert(""+ae.message)}break;case"kick":if(confirm(` ${L.user} TA""`))try{await rt.kickUser(o.threadId,L.user),await N(),alert("")}catch(ae){console.error(":",ae),alert(""+ae.message)}break;case"delete":if(confirm(""))try{const ae=a.value.findIndex(de=>de.id===L.id);ae!==-1&&a.value.splice(ae,1),alert("")}catch(ae){console.error(":",ae),alert(""+ae.message)}break}};return nt(async()=>{await se(),await N(),await J(),await oe(),await zt(),await $()}),(x,L)=>{var ae;return p(),m("div",c$,[e("div",d$,[e("button",{onClick:L[0]||(L[0]=de=>x.$emit("back")),class:"back-btn"},[...L[4]||(L[4]=[e("span",{class:"icon"},"",-1),Qe("  ",-1)])]),L[5]||(L[5]=e("div",{class:"thread-status"},[e("span",{class:"ghost-icon"},""),e("span",{class:"status-text"},"...")],-1))]),e("div",{class:"chat-viewport",ref_key:"chatViewport",ref:i},[e("div",u$,[L[6]||(L[6]=e("div",{class:"title-ribbon"},"LIVE STORY",-1)),e("h2",v$,S(t.threadTitle),1)]),e("div",p$,[(p(!0),m(Pe,null,Fe(_.value,(de,ue)=>(p(),m("div",{key:de.id,"data-index":ue,class:Ie(["bubble-wrapper",de.user===l.value&&!de.isOP?"visitor-align":"op-align"]),onTouchstart:$e=>P($e,de),onTouchend:f,onTouchcancel:f},[e("div",m$,[e("span",{class:Ie(["count-tag",{"op-tag":de.isOP}])},"#"+S(de.count),3),e("span",g$,S(de.isOP?" THREAD OWNER":de.user),1),e("span",h$,"ID:"+S(de.idCode),1)]),e("div",{class:Ie(["bubble-content",de.user===l.value&&!de.isOP?"my-bubble":de.isOP?"op-bubble":"other-bubble",{"kicked-bubble":de.isKicked}])},[de.isOP&&de.user!==l.value?(p(),m("div",y$,"")):U("",!0),de.isKicked?(p(),m("div",b$,[...L[7]||(L[7]=[e("span",{class:"kicked-icon"},"",-1),e("p",{class:"kicked-text"},"",-1)])])):(p(),m(Pe,{key:2},[e("p",w$,S(de.content),1),e("div",k$,[e("span",x$,S(de.date),1),L[8]||(L[8]=e("button",{class:"quote-btn"}," ",-1))])],64))],2)],42,f$))),128))]),r.value?(p(),m("div",C$,[L[9]||(L[9]=e("div",{class:"typing-bubble"},[e("span",{class:"typing-dot"}),e("span",{class:"typing-dot"}),e("span",{class:"typing-dot"})],-1)),e("p",$$,S(c.value)+" ...",1)])):(p(),m("div",_$,[...L[10]||(L[10]=[e("div",{class:"spinner"},null,-1),e("p",null,"... ( )",-1)])]))],512),o.isUserOP&&!k.value?(p(),m("div",M$,[e("button",{class:"op-action-btn lock-btn",onClick:K},[...L[11]||(L[11]=[e("svg",{viewBox:"0 0 24 24",width:"18",height:"18"},[e("path",{fill:"currentColor",d:"M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"})],-1),Qe("  ",-1)])])])):U("",!0),k.value?(p(),m("div",S$,[e("div",I$,[L[13]||(L[13]=e("span",{class:"locked-icon"},"",-1)),e("div",A$,[L[12]||(L[12]=e("p",{class:"locked-title"},"",-1)),e("p",L$,S(((ae=w.value)==null?void 0:ae.lockedReason)||""),1)])])])):U("",!0),I.value?(p(),m("div",T$,[L[14]||(L[14]=dt('<div class="kicked-content" data-v-a03c10bc><span class="kicked-icon" data-v-a03c10bc></span><div class="kicked-text" data-v-a03c10bc><p class="kicked-title" data-v-a03c10bc></p><p class="kicked-reason" data-v-a03c10bc></p></div></div>',1)),e("button",{onClick:L[1]||(L[1]=de=>x.$emit("back")),class:"back-to-forum-btn"},"")])):U("",!0),b.value?(p(),m("div",{key:3,class:"context-menu-overlay",onClick:H},[e("div",{class:"context-menu",style:Re({left:y.value.x+"px",top:y.value.y+"px"}),onClick:L[2]||(L[2]=je(()=>{},["stop"]))},[(p(!0),m(Pe,null,Fe(M.value,de=>(p(),m("button",{key:de.id,onClick:ue=>F(de.id),class:Ie(["context-menu-item",`color-${de.color}`])},S(de.label),11,j$))),128))],4)])):U("",!0),!k.value&&!I.value?(p(),m("div",P$,[e("div",E$,[we(e("input",{type:"text","onUpdate:modelValue":L[3]||(L[3]=de=>n.value=de),onKeyup:Xt(T,["enter"]),placeholder:"... (--`)",class:"reply-input"},null,544),[[Te,n.value]]),L[15]||(L[15]=e("div",{class:"input-actions"},[e("span",null,""),e("span",null,"")],-1))]),e("button",{onClick:T,class:"send-btn",disabled:!n.value.trim()},[...L[16]||(L[16]=[e("span",{class:"send-icon"},"",-1)])],8,B$)])):U("",!0)])}}},H$=Ze(V$,[["__scopeId","data-v-a03c10bc"]]),D$={class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4"},F$={class:"bg-white border-4 border-black rounded-2xl shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] w-full max-w-2xl max-h-[80vh] flex flex-col"},U$={class:"p-4 border-b-4 border-black flex justify-between items-center bg-pink-100"},N$={class:"flex-1 p-6 overflow-y-auto space-y-6"},O$={class:"border-2 border-black rounded-xl p-4 bg-pink-50"},R$=["disabled"],z$={class:"border-2 border-black rounded-xl p-4 bg-purple-50"},W$={class:"flex items-center gap-4"},K$={class:"w-16 text-center"},G$={class:"text-2xl font-black text-purple-600"},q$=["disabled"],Z$={class:"border-2 border-black rounded-xl p-4 bg-blue-50"},J$={key:0,class:"text-center py-8 text-gray-400"},Y$={key:1,class:"space-y-2"},X$=["onClick"],Q$={class:"flex items-center justify-between"},e8={class:"flex-1"},t8={class:"font-black text-sm"},s8={class:"text-xs opacity-70 mt-1"},o8={key:0,class:"text-xl"},n8={key:2,class:"mt-3 flex gap-3"},a8=["disabled"],l8=["disabled"],i8={class:"border-2 border-black rounded-xl p-4 bg-red-50"},r8={class:"space-y-3"},c8={class:"flex items-center gap-2"},d8={class:"font-bold"},u8={class:"text-gray-600"},v8={class:"text-red-500 font-black"},p8={class:"border-t-2 border-black/10 pt-3 flex items-center gap-3"},f8={class:"flex-1"},m8={class:"text-sm font-bold"},g8={class:"text-red-500"},h8=["disabled"],y8={class:"p-4 border-t-4 border-black flex justify-end"},b8={__name:"forumsetting",emits:["close","refresh"],setup(t,{emit:s}){const o=s,n=h(""),a=h([]),l=h(null),i=h(5),r=h([]),c=h(0),d=h(!1),u=h(!1),v=[{id:"worldbook",name:"",icon:""},{id:"ghost",name:"",icon:""},{id:"daily",name:"",icon:""},{id:"funny",name:"",icon:""},{id:"rant",name:"",icon:""},{id:"diary",name:"",icon:""},{id:"food",name:"",icon:""}],b=async()=>{try{const $=await C.getAllWorldBooks();console.log(":",$);const T={};$.forEach(q=>{q.bookName&&(T[q.bookName]||(T[q.bookName]={id:q.bookName,name:q.bookName,entries:[]}),T[q.bookName].entries.push(q))}),a.value=Object.values(T),console.log(":",a.value)}catch($){console.error(":",$)}},y=async()=>{try{const $=await rt.getForumWorldView();$&&(n.value=$);const T=await rt.getSelectedWorldBook();T&&(l.value=T);const q=await rt.getReplyCount();q&&(i.value=q);const oe=await rt.getAllThreads();let se=0;r.value=v.map(J=>{const N=oe.filter(f=>f.category===J.id&&!f.blocked).sort((f,g)=>{const H=new Date(f.createdAt||0).getTime();return new Date(g.createdAt||0).getTime()-H}),P=N.length>5?N.length-5:0;return se+=P,{...J,foldedCount:P}}),c.value=se}catch($){console.error(":",$)}},M=async()=>{if(!n.value.trim()){alert("");return}d.value=!0;try{await rt.saveForumWorldView(n.value.trim()),alert("")}catch($){console.error(":",$),alert(""+$.message)}finally{d.value=!1}},A=$=>{l.value=$},w=async()=>{if(!l.value){alert("");return}d.value=!0;try{await rt.saveSelectedWorldBook(l.value),alert("")}catch($){console.error(":",$),alert(""+$.message)}finally{d.value=!1}},k=async()=>{if(confirm("")){d.value=!0;try{await rt.saveSelectedWorldBook(null),l.value=null,alert("")}catch($){console.error(":",$),alert(""+$.message)}finally{d.value=!1}}},I=async()=>{d.value=!0;try{await rt.saveReplyCount(i.value),alert("")}catch($){console.error(":",$),alert(""+$.message)}finally{d.value=!1}},_=async()=>{if(c.value!==0&&confirm(` ${c.value} `)){u.value=!0;try{const $=await rt.getAllThreads();let T=0;for(const q of v){const oe=$.filter(se=>se.category===q.id&&!se.blocked).sort((se,J)=>{const N=new Date(se.createdAt||0).getTime();return new Date(J.createdAt||0).getTime()-N});if(oe.length>5){const se=oe.slice(5);for(const J of se)await rt.deleteThread(J.id),T++}}await y(),alert(` ${T} `),o("refresh")}catch($){console.error(":",$),alert(""+$.message)}finally{u.value=!1}}};return nt(async()=>{await b(),await y()}),($,T)=>(p(),m("div",D$,[e("div",F$,[e("div",U$,[T[4]||(T[4]=e("h2",{class:"text-xl font-black uppercase"}," ",-1)),e("button",{onClick:T[0]||(T[0]=q=>$.$emit("close")),class:"text-2xl font-black hover:text-pink-500 transition-colors"},"")]),e("div",N$,[e("div",O$,[T[5]||(T[5]=e("h3",{class:"text-lg font-black mb-3 flex items-center gap-2"},[e("span",null,""),e("span",null,"")],-1)),T[6]||(T[6]=e("p",{class:"text-xs text-gray-600 mb-3"},"AI ",-1)),we(e("textarea",{"onUpdate:modelValue":T[1]||(T[1]=q=>n.value=q),placeholder:"...",class:"w-full px-4 py-3 border-2 border-black rounded-lg font-mono text-sm h-32 resize-none focus:outline-none focus:ring-2 focus:ring-pink-400"},null,512),[[Te,n.value]]),e("button",{onClick:M,disabled:d.value,class:"mt-3 px-4 py-2 bg-pink-400 text-white font-black border-2 border-black rounded-lg shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] hover:translate-y-0.5 hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)] transition-all disabled:opacity-50"},S(d.value?"...":" "),9,R$)]),e("div",z$,[T[8]||(T[8]=e("h3",{class:"text-lg font-black mb-3 flex items-center gap-2"},[e("span",null,""),e("span",null,"")],-1)),T[9]||(T[9]=e("p",{class:"text-xs text-gray-600 mb-3"}," AI ",-1)),e("div",W$,[we(e("input",{type:"range","onUpdate:modelValue":T[2]||(T[2]=q=>i.value=q),min:"1",max:"10",class:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-purple-500"},null,512),[[Te,i.value,void 0,{number:!0}]]),e("div",K$,[e("span",G$,S(i.value),1),T[7]||(T[7]=e("span",{class:"text-xs text-gray-600 block"},"",-1))])]),e("button",{onClick:I,disabled:d.value,class:"mt-3 px-4 py-2 bg-purple-400 text-white font-black border-2 border-black rounded-lg shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] hover:translate-y-0.5 hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)] transition-all disabled:opacity-50"},S(d.value?"...":" "),9,q$)]),e("div",Z$,[T[11]||(T[11]=e("h3",{class:"text-lg font-black mb-3 flex items-center gap-2"},[e("span",null,""),e("span",null,"")],-1)),T[12]||(T[12]=e("p",{class:"text-xs text-gray-600 mb-3"},"",-1)),a.value.length===0?(p(),m("div",J$,[...T[10]||(T[10]=[e("p",{class:"text-sm"},"",-1),e("p",{class:"text-xs mt-2"},"",-1)])])):(p(),m("div",Y$,[(p(!0),m(Pe,null,Fe(a.value,q=>{var oe;return p(),m("div",{key:q.id,onClick:se=>A(q.id),class:Ie(["p-3 border-2 border-black rounded-lg cursor-pointer transition-all",l.value===q.id?"bg-blue-400 text-white shadow-[3px_3px_0px_0px_rgba(0,0,0,1)]":"bg-white hover:bg-blue-100"])},[e("div",Q$,[e("div",e8,[e("p",t8,S(q.name),1),e("p",s8,S(((oe=q.entries)==null?void 0:oe.length)||0)+" ",1)]),l.value===q.id?(p(),m("div",o8,"")):U("",!0)])],10,X$)}),128))])),a.value.length>0?(p(),m("div",n8,[e("button",{onClick:w,disabled:d.value||!l.value,class:"flex-1 px-4 py-2 bg-blue-400 text-white font-black border-2 border-black rounded-lg shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] hover:translate-y-0.5 hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)] transition-all disabled:opacity-50"},S(d.value?"...":" "),9,a8),e("button",{onClick:k,disabled:d.value||!l.value,class:"px-4 py-2 bg-gray-400 text-white font-black border-2 border-black rounded-lg shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] hover:translate-y-0.5 hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)] transition-all disabled:opacity-50"},S(d.value?"...":" "),9,l8)])):U("",!0)]),e("div",i8,[T[16]||(T[16]=e("h3",{class:"text-lg font-black mb-3 flex items-center gap-2"},[e("span",null,""),e("span",null,"")],-1)),T[17]||(T[17]=e("p",{class:"text-xs text-gray-600 mb-3"},"6",-1)),e("div",r8,[(p(!0),m(Pe,null,Fe(r.value,q=>(p(),m("div",{key:q.id,class:"flex items-center justify-between text-sm"},[e("div",c8,[e("span",null,S(q.icon),1),e("span",d8,S(q.name),1)]),e("span",u8,[T[13]||(T[13]=Qe(": ",-1)),e("span",v8,S(q.foldedCount),1),T[14]||(T[14]=Qe(" ",-1))])]))),128)),e("div",p8,[e("div",f8,[e("p",m8,[T[15]||(T[15]=Qe(": ",-1)),e("span",g8,S(c.value),1)])]),e("button",{onClick:_,disabled:u.value||c.value===0,class:"px-4 py-2 bg-red-500 text-white font-black border-2 border-black rounded-lg shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] hover:translate-y-0.5 hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)] transition-all disabled:opacity-50"},S(u.value?"...":" "),9,h8)])])])]),e("div",y8,[e("button",{onClick:T[3]||(T[3]=q=>$.$emit("close")),class:"px-6 py-3 bg-gray-200 text-black font-black border-2 border-black rounded-xl hover:bg-gray-300 transition-colors"},"  ")])])]))}},w8=Ze(b8,[["__scopeId","data-v-0c738226"]]),k8={class:"flex flex-col h-full w-full bg-white text-black font-mono selection:bg-pink-100 overflow-hidden relative"},x8={key:0,class:"flex flex-col h-full"},C8={class:"bg-black text-white px-3 py-1.5 flex justify-between items-center text-[10px] font-black tracking-widest z-50 uppercase"},$8={class:"flex items-center gap-2"},_8={class:"flex gap-2 items-center"},M8=["disabled"],S8={class:"flex-1 flex flex-col overflow-hidden relative"},I8={class:"bg-white border-b-4 border-black z-40 shadow-sm overflow-x-auto category-scroll flex-shrink-0"},A8={class:"flex p-4 gap-3 bg-white min-w-max"},L8=["onClick"],T8={class:"flex-1 p-4 space-y-6 bg-[#fcfcfc] overflow-y-auto pb-24 post-list-scroll"},j8={key:0,class:"absolute top-3 right-3 flex items-center gap-1"},P8={key:1,class:"absolute top-3 left-3"},E8={class:"flex items-center gap-2 mb-2"},B8={class:"text-[9px] font-black bg-white border-2 border-black px-1.5 py-0.5 uppercase"},V8={class:"text-[9px] font-bold opacity-30 italic font-mono"},H8=["onClick"],D8={class:"flex justify-between items-center text-[10px] font-black border-t-2 border-black/5 pt-3"},F8={class:"flex gap-4"},U8={class:"flex items-center gap-1"},N8={class:"flex items-center gap-1 text-pink-500"},O8={class:"flex gap-2"},R8=["onClick","title"],z8=["onClick"],W8={key:0,class:"flex justify-center pt-4"},K8={key:1,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4"},G8={class:"bg-white border-4 border-black rounded-2xl shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] w-full max-w-md max-h-[80vh] flex flex-col"},q8={class:"flex-1 p-4 overflow-y-auto"},Z8={class:"space-y-4"},J8=["value"],Y8={class:"text-xs text-gray-500 mt-1"},X8={class:"text-xs text-gray-500 mt-1"},Q8={class:"p-4 border-t-4 border-black flex gap-3"},e9=["disabled"],t9={__name:"forumcenter",emits:["update:inThread","back","openPostEditor"],setup(t,{expose:s,emit:o}){const n=o,a=h(new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),l=h("ghost"),i=h(!1),r=h(null),c=h([]),d=h(!1),u=h(!1),v=h(!1),b=h(!1),y=h(!1),M=h({category:"ghost",title:"",content:""}),A=[{id:"worldbook",name:"",icon:""},{id:"ghost",name:"",icon:""},{id:"daily",name:"",icon:""},{id:"funny",name:"",icon:""},{id:"rant",name:"",icon:""},{id:"diary",name:"",icon:""},{id:"food",name:"",icon:""}],w=async()=>{try{const K=await rt.getAllThreads();c.value=K.sort((F,x)=>{const L=new Date(F.createdAt||0).getTime();return new Date(x.createdAt||0).getTime()-L})}catch(K){console.error(":",K)}},k=ot(()=>c.value.filter(K=>K.category===l.value&&!K.blocked)),I=ot(()=>u.value?k.value:k.value.slice(0,5)),_=ot(()=>k.value.length>5),$=()=>{u.value=!u.value},T=()=>{v.value=!0,M.value={category:l.value,title:"",content:""}},q=()=>{v.value=!1,M.value={category:"ghost",title:"",content:""}},oe=async()=>{if(!(!M.value.title||!M.value.content)){b.value=!0;try{const K=localStorage.getItem("username")||"",F={id:Date.now(),category:M.value.category,title:M.value.title,replies:0,time:Ys().split(" ")[1],tags:g(M.value.category),color:H(M.value.category),isLive:!0,isUserThread:!0,createdAt:new Date().toISOString(),posts:[{id:Date.now(),user:K,content:M.value.content,date:Ys(),isOP:!0,count:1,idCode:Co()}]};await rt.saveThread(F),await w(),q(),alert("AI ..."),N(F)}catch(K){console.error(":",K),alert(""+K.message)}finally{b.value=!1}}},se=async K=>{try{const F=await rt.favoriteThread(K);await w(),console.log(F?"":"")}catch(F){console.error(":",F)}},J=async K=>{try{const F=await rt.blockThread(K);await w(),alert(F?"":"")}catch(F){console.error(":",F)}},N=K=>{r.value=K,i.value=!0},P=async()=>{i.value=!1,r.value=null,await w()},f=async()=>{if(!d.value){d.value=!0;try{const K=await a$(l.value,3);if(!K||K.length===0)throw new Error("");for(const F of K){const x={id:Date.now()+Math.random(),category:l.value,title:F,replies:0,time:Ys().split(" ")[1],tags:g(l.value),color:H(l.value),isLive:!1,posts:[],aiGenerated:!0,needsContent:!0,createdAt:new Date().toISOString()};await rt.saveThread(x),await new Promise(L=>setTimeout(L,100))}await w(),alert(` ${K.length} `)}catch(K){console.error("AI :",K),alert(""+K.message)}finally{d.value=!1}}},g=K=>({worldbook:"World Event",ghost:"Urban Legend",daily:"Daily Life",funny:"Funny",rant:"Rant",diary:"Diary",food:"Cooking"})[K]||"General",H=K=>({worldbook:"bg-purple-50",ghost:"bg-gray-50",daily:"bg-amber-50",funny:"bg-yellow-50",rant:"bg-red-50",diary:"bg-pink-50",food:"bg-white"})[K]||"bg-white";return Pt(i,K=>{n("update:inThread",K)}),Pt(v,K=>{n("update:inThread",K)}),Pt(y,K=>{n("update:inThread",K)}),s({openPostEditor:T}),nt(async()=>{await rt.initDefaultThreads(),await w(),setInterval(()=>{a.value=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},1e3)}),(K,F)=>(p(),m("div",k8,[F[16]||(F[16]=e("div",{class:"absolute inset-0 pointer-events-none z-[100] opacity-[0.04] scanline-effect"},null,-1)),i.value?U("",!0):(p(),m("div",x8,[e("div",C8,[e("div",$8,[e("button",{onClick:F[0]||(F[0]=x=>K.$emit("back")),class:"p-1 hover:bg-white/10 rounded transition-colors"},[Ge(Ue(er),{size:14,class:"text-pink-400"})]),Ge(Ue(sr),{size:12,class:"text-pink-400 animate-pulse"}),F[6]||(F[6]=e("span",null,"DREAM_OS_DOLLETTE_V2",-1))]),e("div",_8,[e("button",{onClick:f,disabled:d.value,class:"px-2 py-1 bg-pink-500 hover:bg-pink-600 rounded text-[9px] font-black transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},S(d.value?"...":" AI"),9,M8),e("span",null,S(a.value),1),e("button",{onClick:F[1]||(F[1]=x=>y.value=!0),class:"w-3 h-3 border-2 border-white hover:bg-white/20 transition-colors cursor-pointer",title:""})])]),e("div",S8,[F[11]||(F[11]=e("div",{class:"p-6 bg-white border-b-[6px] border-black flex flex-col items-center relative flex-shrink-0"},[e("div",{class:"text-2xl mb-1"},"  "),e("h1",{class:"text-3xl font-black italic tracking-tighter uppercase"},"Dreamy Log"),e("div",{class:"text-[10px] font-black bg-pink-200 px-3 py-1 border-2 border-black rounded-full mt-2 shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] uppercase tracking-widest"}," Restricted Area /  ")],-1)),e("div",I8,[e("div",A8,[(p(),m(Pe,null,Fe(A,x=>e("button",{key:x.id,onClick:L=>l.value=x.id,class:Ie(["flex-shrink-0 px-5 py-2.5 text-xs font-black uppercase transition-all border-2 border-black rounded-xl whitespace-nowrap",l.value===x.id?"bg-black text-white":"bg-white text-black shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] hover:bg-pink-50"])},S(x.icon)+" "+S(x.name),11,L8)),64))])]),e("div",T8,[(p(!0),m(Pe,null,Fe(I.value,x=>(p(),m("div",{key:x.id,class:"relative group"},[F[10]||(F[10]=e("div",{class:"absolute inset-0 bg-black translate-x-1.5 translate-y-1.5 rounded-2xl border-2 border-black"},null,-1)),e("div",{class:Ie(["relative p-5 border-4 border-black rounded-2xl hover:-translate-y-1 transition-transform",x.color])},[x.userReplied||x.isLive?(p(),m("div",j8,[...F[7]||(F[7]=[e("span",{class:"w-2 h-2 bg-red-500 rounded-full animate-ping"},null,-1),e("span",{class:"text-[8px] font-black text-red-500 uppercase italic"},"Live Story",-1)])])):U("",!0),x.favorited?(p(),m("div",P8,[...F[8]||(F[8]=[e("span",{class:"text-yellow-500 text-lg"},"",-1)])])):U("",!0),e("div",E8,[e("span",B8,S(x.tags),1),e("span",V8,S(x.time),1)]),e("h3",{onClick:L=>N(x),class:"text-[16px] font-black leading-tight mb-4 group-hover:underline decoration-pink-300 decoration-2 cursor-pointer"},S(x.title),9,H8),e("div",D8,[e("div",F8,[e("span",U8,[Ge(Ue(tr),{size:12}),Qe(" "+S(x.replies)+" ",1)]),e("span",N8,[Ge(Ue(or),{size:12}),F[9]||(F[9]=Qe(" ",-1))])]),e("div",O8,[e("button",{onClick:je(L=>se(x.id),["stop"]),class:"p-1 hover:bg-black/5 rounded transition-colors",title:x.favorited?"":""},S(x.favorited?"":""),9,R8),e("button",{onClick:je(L=>J(x.id),["stop"]),class:"p-1 hover:bg-black/5 rounded transition-colors",title:""},"  ",8,z8),Ge(Ue(Z6),{size:16,onClick:L=>N(x),class:"cursor-pointer"},null,8,["onClick"])])])],2)]))),128)),_.value?(p(),m("div",W8,[e("button",{onClick:$,class:"px-6 py-3 bg-black text-white font-black text-sm border-2 border-black rounded-xl shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] transition-all"},S(u.value?" ":` (${k.value.length-5}+) `),1)])):U("",!0)])])])),v.value?(p(),m("div",K8,[e("div",G8,[e("div",{class:"p-4 border-b-4 border-black flex justify-between items-center bg-pink-100"},[F[12]||(F[12]=e("h2",{class:"text-xl font-black"}," ",-1)),e("button",{onClick:q,class:"text-2xl font-black hover:text-pink-500 transition-colors"},"")]),e("div",q8,[e("div",Z8,[e("div",null,[F[13]||(F[13]=e("label",{class:"block text-xs font-black mb-2 uppercase"},"",-1)),we(e("select",{"onUpdate:modelValue":F[2]||(F[2]=x=>M.value.category=x),class:"w-full px-4 py-2 border-2 border-black rounded-lg font-bold"},[(p(),m(Pe,null,Fe(A,x=>e("option",{key:x.id,value:x.id},S(x.icon)+" "+S(x.name),9,J8)),64))],512),[[Ls,M.value.category]])]),e("div",null,[F[14]||(F[14]=e("label",{class:"block text-xs font-black mb-2 uppercase"},"",-1)),we(e("input",{"onUpdate:modelValue":F[3]||(F[3]=x=>M.value.title=x),type:"text",placeholder:"...",class:"w-full px-4 py-2 border-2 border-black rounded-lg font-bold",maxlength:"50"},null,512),[[Te,M.value.title]]),e("div",Y8,S(M.value.title.length)+"/50",1)]),e("div",null,[F[15]||(F[15]=e("label",{class:"block text-xs font-black mb-2 uppercase"},"",-1)),we(e("textarea",{"onUpdate:modelValue":F[4]||(F[4]=x=>M.value.content=x),placeholder:"...",class:"w-full px-4 py-2 border-2 border-black rounded-lg font-bold h-32 resize-none",maxlength:"500"},null,512),[[Te,M.value.content]]),e("div",X8,S(M.value.content.length)+"/500",1)])])]),e("div",Q8,[e("button",{onClick:q,class:"flex-1 px-4 py-3 bg-gray-200 text-black font-black border-2 border-black rounded-xl hover:bg-gray-300 transition-colors"},"  "),e("button",{onClick:oe,disabled:!M.value.title||!M.value.content||b.value,class:"flex-1 px-4 py-3 bg-pink-400 text-white font-black border-2 border-black rounded-xl shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] hover:translate-y-0.5 hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)] transition-all disabled:opacity-50 disabled:cursor-not-allowed"},S(b.value?"...":" "),9,e9)])])])):U("",!0),i.value&&r.value?(p(),st(H$,{key:2,threadId:r.value.id,threadTitle:r.value.title,posts:r.value.posts,isUserThread:r.value.isUserThread,category:r.value.category,onBack:P},null,8,["threadId","threadTitle","posts","isUserThread","category"])):U("",!0),y.value?(p(),st(w8,{key:3,onClose:F[5]||(F[5]=x=>y.value=!1),onRefresh:w})):U("",!0)]))}},s9=Ze(t9,[["__scopeId","data-v-e2f0063f"]]),o9={class:"flex flex-col h-full w-full bg-white text-black font-mono selection:bg-pink-100 overflow-hidden relative"},n9={class:"bg-black text-white px-3 py-1.5 flex justify-between items-center text-[10px] font-black tracking-widest z-50 uppercase"},a9={class:"flex items-center gap-2"},l9={class:"flex gap-4 items-center"},i9={class:"flex-1 overflow-hidden relative"},r9={class:"p-4 space-y-8 animate-fade-in pb-24 h-full overflow-y-auto"},c9={class:"bg-black text-white p-6 rounded-[2.5rem] relative overflow-hidden"},d9={class:"relative z-10 flex flex-col items-center gap-4"},u9=["src"],v9={class:"text-center"},p9={class:"space-y-4"},f9={key:0,class:"p-8 border-4 border-dashed border-gray-300 bg-gray-50 rounded-2xl text-center"},m9=["onClick"],g9={class:"absolute -right-4 -bottom-4 opacity-[0.05] group-hover:scale-150 transition-transform"},h9={class:"flex justify-between items-start mb-2"},y9={class:"text-[10px] font-black border-2 border-black px-2 py-0.5 bg-pink-100 font-mono underline italic"},b9={class:"text-[9px] font-bold opacity-30 italic font-mono"},w9={class:"text-[11px] leading-relaxed font-mono relative z-10 italic line-clamp-2"},k9={class:"flex items-center gap-2 mt-3 text-[9px] font-bold text-gray-400"},x9={class:"bg-white border-4 border-black rounded-2xl p-6 max-w-md w-full shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]"},C9={class:"space-y-4"},$9={class:"flex justify-center"},_9=["src"],M9={class:"bg-white border-4 border-black rounded-2xl p-6 max-w-md w-full shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]"},S9={class:"space-y-4"},I9={class:"flex gap-2"},A9={__name:"forumprofie",emits:["back"],setup(t){const s=h(new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),o=h({username:"DollyMoon",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Marshmallow"}),n=h([]),a=h(!1),l=h(!1),i=h("Marshmallow"),r=h(""),c=h(null),d=h(null),u=ot(()=>c.value?c.value:`https://api.dicebear.com/7.x/avataaars/svg?seed=${i.value}`),v=I=>{const _=I.target.files[0];if(!_)return;const $=new FileReader;$.onload=T=>{c.value=T.target.result},$.readAsDataURL(_)},b=()=>{a.value=!1,c.value=null,d.value&&(d.value.value="")},y=async()=>{try{const I=await rt.getUserProfile();o.value=I,i.value=I.avatarSeed||"Marshmallow"}catch(I){console.error(":",I)}},M=async()=>{try{const I=await rt.getAllThreads();n.value=I.filter(_=>_.isUserThread).sort((_,$)=>{const T=new Date(_.createdAt||0).getTime();return new Date($.createdAt||0).getTime()-T})}catch(I){console.error(":",I)}},A=I=>{console.log(":",I)},w=async()=>{try{const I=c.value||`https://api.dicebear.com/7.x/avataaars/svg?seed=${i.value}`;await rt.saveUserProfile({username:o.value.username,avatar:I,avatarSeed:i.value}),o.value.avatar=I,b()}catch(I){console.error(":",I)}},k=async()=>{if(r.value.trim())try{await rt.saveUserProfile({username:r.value.trim(),avatar:o.value.avatar,avatarSeed:i.value}),o.value.username=r.value.trim(),l.value=!1,r.value=""}catch(I){console.error(":",I)}};return nt(()=>{y(),M(),setInterval(()=>{s.value=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},1e3)}),(I,_)=>(p(),m("div",o9,[_[22]||(_[22]=e("div",{class:"absolute inset-0 pointer-events-none z-[100] opacity-[0.04] scanline-effect"},null,-1)),e("div",n9,[e("div",a9,[e("button",{onClick:_[0]||(_[0]=$=>I.$emit("back")),class:"p-1 hover:bg-white/10 rounded transition-colors"},[Ge(Ue(er),{size:14,class:"text-pink-400"})]),Ge(Ue(sr),{size:12,class:"text-pink-400 animate-pulse"}),_[9]||(_[9]=e("span",null,"DREAM_OS_DOLLETTE_V2",-1))]),e("div",l9,[e("span",null,S(s.value),1),_[10]||(_[10]=e("div",{class:"w-3 h-3 border-2 border-white"},null,-1))])]),e("div",i9,[e("div",r9,[e("div",c9,[e("div",d9,[e("button",{onClick:_[1]||(_[1]=$=>a.value=!0),class:"w-24 h-24 rounded-full border-4 border-white overflow-hidden bg-white shadow-xl hover:scale-105 transition-transform cursor-pointer"},[e("img",{src:o.value.avatar,alt:"me",class:"grayscale contrast-125 w-full h-full object-cover"},null,8,u9)]),e("div",v9,[e("button",{onClick:_[2]||(_[2]=$=>l.value=!0),class:"text-2xl font-black italic tracking-tighter uppercase flex items-center gap-2 justify-center hover:text-pink-300 transition-colors cursor-pointer"},[_[11]||(_[11]=e("span",{class:"text-pink-400 font-bold px-1"},"",-1)),Qe(" "+S(o.value.username)+" ",1),_[12]||(_[12]=e("span",{class:"text-pink-400 font-bold px-1"},"",-1))]),_[13]||(_[13]=e("p",{class:"text-[10px] font-bold opacity-60 uppercase tracking-widest mt-1 italic font-mono"}," Status:  429 ... ",-1))])])]),e("div",p9,[_[15]||(_[15]=e("h3",{class:"text-sm font-black italic border-l-8 border-pink-400 pl-3 uppercase"}," / My Echoes",-1)),n.value.length===0?(p(),m("div",f9,[..._[14]||(_[14]=[e("div",{class:"text-4xl mb-3 opacity-30"},"",-1),e("p",{class:"text-sm font-bold text-gray-400 italic"},"",-1),e("p",{class:"text-xs text-gray-300 mt-1"},"",-1)])])):U("",!0),(p(!0),m(Pe,null,Fe(n.value,($,T)=>(p(),m("div",{key:$.id,class:"p-5 border-4 border-black bg-white shadow-[6px_6px_0px_0px_rgba(255,193,214,1)] relative overflow-hidden group cursor-pointer hover:translate-y-[-2px] transition-transform",onClick:q=>A($)},[e("div",g9,[Ge(Ue(J6),{size:80})]),e("div",h9,[e("span",y9," D-LOG #"+S(String(n.value.length-T).padStart(2,"0")),1),e("span",b9,S($.time),1)]),e("p",w9,' "'+S($.title)+'" ',1),e("div",k9,[e("span",null," "+S($.replies)+" ",1),e("span",null,S($.tags),1)])],8,m9))),128))])])]),a.value?(p(),m("div",{key:0,class:"fixed inset-0 bg-black/50 z-[200] flex items-center justify-center p-4",onClick:_[5]||(_[5]=je($=>a.value=!1,["self"]))},[e("div",x9,[_[19]||(_[19]=e("h3",{class:"text-xl font-black mb-4 uppercase"},"",-1)),e("div",C9,[e("div",null,[_[16]||(_[16]=e("label",{class:"text-sm font-bold mb-2 block"},"",-1)),e("input",{ref_key:"fileInput",ref:d,type:"file",accept:"image/*",onChange:v,class:"hidden"},null,544),e("button",{onClick:_[3]||(_[3]=$=>I.$refs.fileInput.click()),class:"w-full px-4 py-2 border-2 border-black rounded-lg font-bold bg-blue-100 hover:bg-blue-200 transition-colors"},"   ")]),_[18]||(_[18]=e("div",{class:"text-center text-xs font-bold opacity-50"},"",-1)),e("div",null,[_[17]||(_[17]=e("label",{class:"text-sm font-bold mb-2 block"},"",-1)),we(e("input",{"onUpdate:modelValue":_[4]||(_[4]=$=>i.value=$),type:"text",class:"w-full px-4 py-2 border-2 border-black rounded-lg font-mono",placeholder:"Marshmallow, Cute, Cool..."},null,512),[[Te,i.value]])]),e("div",$9,[e("img",{src:u.value,class:Ie(["w-24 h-24 rounded-full border-4 border-black object-cover",{"grayscale contrast-125":!c.value}])},null,10,_9)]),e("div",{class:"flex gap-2"},[e("button",{onClick:w,class:"flex-1 bg-pink-200 border-2 border-black rounded-lg py-2 font-black uppercase hover:bg-pink-300 transition-colors shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:translate-x-1 active:translate-y-1 active:shadow-none"},"  "),e("button",{onClick:b,class:"flex-1 bg-gray-200 border-2 border-black rounded-lg py-2 font-black uppercase hover:bg-gray-300 transition-colors shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:translate-x-1 active:translate-y-1 active:shadow-none"},"  ")])])])])):U("",!0),l.value?(p(),m("div",{key:1,class:"fixed inset-0 bg-black/50 z-[200] flex items-center justify-center p-4",onClick:_[8]||(_[8]=je($=>l.value=!1,["self"]))},[e("div",M9,[_[21]||(_[21]=e("h3",{class:"text-xl font-black mb-4 uppercase"},"",-1)),e("div",S9,[e("div",null,[_[20]||(_[20]=e("label",{class:"text-sm font-bold mb-2 block"},"",-1)),we(e("input",{"onUpdate:modelValue":_[6]||(_[6]=$=>r.value=$),type:"text",class:"w-full px-4 py-2 border-2 border-black rounded-lg font-mono",placeholder:"...",maxlength:"20"},null,512),[[Te,r.value]])]),e("div",I9,[e("button",{onClick:k,class:"flex-1 bg-pink-200 border-2 border-black rounded-lg py-2 font-black uppercase hover:bg-pink-300 transition-colors shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:translate-x-1 active:translate-y-1 active:shadow-none"},"  "),e("button",{onClick:_[7]||(_[7]=$=>l.value=!1),class:"flex-1 bg-gray-200 border-2 border-black rounded-lg py-2 font-black uppercase hover:bg-gray-300 transition-colors shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:translate-x-1 active:translate-y-1 active:shadow-none"},"  ")])])])])):U("",!0)]))}},L9=Ze(A9,[["__scopeId","data-v-61155bc8"]]),T9={class:"forum-app h-full w-full flex flex-col relative bg-[#fcfcfc]"},j9={class:"flex-1 overflow-hidden w-full"},P9={class:"fixed bottom-0 left-0 right-0 bg-white border-t-4 border-black z-50"},E9={class:"flex items-center justify-center relative h-20 px-4"},B9={class:"absolute left-4 flex gap-2"},V9={key:0,class:"absolute inset-0 bg-pink-100 border-2 border-black rounded-2xl shadow-[3px_3px_0px_0px_rgba(0,0,0,1)]"},H9=["stroke-width"],D9={class:"absolute right-4 flex gap-2"},F9={key:0,class:"absolute inset-0 bg-pink-100 border-2 border-black rounded-2xl shadow-[3px_3px_0px_0px_rgba(0,0,0,1)]"},U9=["stroke-width"],N9={__name:"ForumApp",emits:["back"],setup(t,{emit:s}){const o=h("home"),n=h(!1),a=h(null),l=r=>{n.value=r},i=()=>{a.value&&a.value.openPostEditor()};return(r,c)=>(p(),m("div",T9,[e("div",j9,[we(Ge(s9,{ref_key:"forumCenterRef",ref:a,"onUpdate:inThread":l,onBack:c[0]||(c[0]=d=>r.$emit("back")),class:"w-full h-full"},null,512),[[vo,o.value==="home"]]),we(Ge(L9,{onBack:c[1]||(c[1]=d=>r.$emit("back")),class:"w-full h-full"},null,512),[[vo,o.value==="profile"]])]),we(e("div",P9,[e("div",E9,[e("div",B9,[e("button",{onClick:c[2]||(c[2]=d=>o.value="home"),class:Ie(["flex flex-col items-center justify-center gap-1 px-6 py-2 transition-all relative",o.value==="home"?"text-black":"text-gray-400"])},[o.value==="home"?(p(),m("div",V9)):U("",!0),(p(),m("svg",{class:"relative z-10 w-6 h-6",fill:"none",stroke:"currentColor","stroke-width":o.value==="home"?2.5:2,viewBox:"0 0 24 24"},[...c[4]||(c[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"},null,-1)])],8,H9)),c[5]||(c[5]=e("span",{class:"relative z-10 text-[10px] font-black uppercase tracking-wider"},"Home",-1))],2)]),e("button",{onClick:i,class:"relative group"},[...c[6]||(c[6]=[e("div",{class:"absolute inset-0 bg-black rounded-full translate-x-1 translate-y-1"},null,-1),e("div",{class:"w-16 h-16 bg-pink-200 border-4 border-black rounded-full flex items-center justify-center relative active:translate-x-1 active:translate-y-1 transition-all shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]"},[e("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor","stroke-width":"3",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})])],-1)])]),e("div",D9,[e("button",{onClick:c[3]||(c[3]=d=>o.value="profile"),class:Ie(["flex flex-col items-center justify-center gap-1 px-6 py-2 transition-all relative",o.value==="profile"?"text-black":"text-gray-400"])},[o.value==="profile"?(p(),m("div",F9)):U("",!0),(p(),m("svg",{class:"relative z-10 w-6 h-6",fill:"none",stroke:"currentColor","stroke-width":o.value==="profile"?2.5:2,viewBox:"0 0 24 24"},[...c[7]||(c[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])],8,U9)),c[8]||(c[8]=e("span",{class:"relative z-10 text-[10px] font-black uppercase tracking-wider"},"User",-1))],2)])])],512),[[vo,!n.value]])]))}},O9=Ze(N9,[["__scopeId","data-v-e29802b1"]]),Ll=["https://files.catbox.moe/0g3kqu.jpg","https://files.catbox.moe/d5b7k6.jpg","https://files.catbox.moe/0yrhh6.jpg","https://files.catbox.moe/8mjvdg.jpg","https://files.catbox.moe/fvidas.jpg","https://files.catbox.moe/q6so2i.jpg","https://files.catbox.moe/5a96cp.jpg","https://files.catbox.moe/0mp6h0.jpg","https://files.catbox.moe/epcn03.jpg","https://files.catbox.moe/7jzdp7.jpg","https://files.catbox.moe/jrmu6w.jpg","https://files.catbox.moe/c0bwhn.jpg","https://files.catbox.moe/0blxme.jpg","https://files.catbox.moe/qicobr.jpg","https://files.catbox.moe/n94ztu.jpg"];function as(){return Ll[Math.floor(Math.random()*Ll.length)]}function $o(){const t=Math.floor(Math.random()*5e4)+100;return t>=1e4?(t/1e3).toFixed(1)+"k":t.toString()}function R9(t){return`6


1. 2-6
2. 10-25
3. 
4. "${t}"
5. 

 | 
|
|
|
|
|
|


|
Melo|
RinRin|

"${t}"6`}function Tl(t){const s=t.personality||t.prompt||t.description||t.bio||"",o=t.name||"";return console.log(" [] :"),console.log("   - :",o),console.log("   - personality:",t.personality),console.log("   - prompt:",t.prompt),console.log("   - description:",t.description),console.log("   - bio:",t.bio),console.log("   - :",s),`1

${o}
${s}


1. 
2. 10-25
3. 
4. 
5. 


${o}|


|

`}function z9(t,s,o=null){const n=t.personality||t.prompt||t.description||t.bio||"",a=t.name||"";console.log(" [] :"),console.log("   - :",a),console.log("   - personality:",t.personality),console.log("   - prompt:",t.prompt),console.log("   - description:",t.description),console.log("   - bio:",t.bio),console.log("   - :",n),console.log("   - :",s);const l=`"${a}"


- ${a}
- ${n}
- ${s}


1. ${a}
2. 


- 
- 
- 
-  5-8 
- 

${o?`

"${o}"`:""}

 ### 
###
[]

###
11
22
...

`;return console.log("   - :",l.length),l}function Zn(t){const s=t.trim().split(`
`).filter(n=>n.trim()),o=[];for(const n of s){if(n.includes("")||n.includes("")||n.includes(""))continue;const a=n.split("|");if(a.length>=2){const l=a[0].trim(),i=a[1].trim();l&&i&&o.push({id:Date.now()+Math.random(),username:l,title:i,viewers:$o(),cover:as(),isFollowing:!1})}}return o}const W9={class:"fixed inset-0 bg-slate-200 font-sans"},K9={class:"phone-container w-full h-full bg-[#F8F9FA] relative flex flex-col"},G9={class:"flex-shrink-0 p-6 pb-4 flex items-center justify-between bg-white/80 backdrop-blur-md z-50 border-b border-gray-100"},q9={class:"flex gap-2"},Z9=["disabled"],J9={class:"w-9 h-9 rounded-full bg-gray-50 flex items-center justify-center active:scale-90 transition-all border border-gray-100"},Y9={class:"w-9 h-9 rounded-full bg-[#FFC0CB]/20 flex items-center justify-center active:scale-90 transition-all border border-[#FFC0CB]"},X9={class:"flex-1 overflow-y-auto no-scrollbar pb-32"},Q9={key:0,class:"px-6 py-4 flex gap-3 overflow-x-auto no-scrollbar"},e_=["onClick"],t_=["onClick"],s_={class:"aspect-[4/5] rounded-[14px] relative overflow-hidden mb-2.5 transition-all bg-gradient-to-br from-gray-100 to-gray-200"},o_=["src","alt"],n_={class:"absolute bottom-2.5 right-2.5 bg-black/20 backdrop-blur-md text-white text-[8px] px-2 py-0.5 rounded-lg font-bold z-20 flex items-center border border-white/10"},a_={class:"px-1.5 pb-2 space-y-1.5"},l_={class:"text-[11px] font-black leading-snug h-8 overflow-hidden text-[#333] group-hover:text-pink-500 transition-colors"},i_={class:"flex items-center gap-2"},r_={class:"w-4 h-4 rounded-md bg-pink-50 flex items-center justify-center text-[10px] border border-gray-200"},c_={class:"text-[9px] font-bold text-gray-400 truncate uppercase tracking-tighter"},d_={class:"floating-nav"},u_=["onClick"],v_={class:"p-2 transition-all active:scale-75"},p_={class:"text-[7px] font-black uppercase tracking-widest leading-none"},f_={key:0,class:"absolute -bottom-1 w-1 h-1 bg-pink-500 rounded-full animate-bounce"},m_={__name:"Livecenter",emits:["close","open-detail"],setup(t,{emit:s}){const o=s,n=h(""),a=h(""),l=h(!1),i=["","","","",""],r=[{name:"",icon:X6},{name:"",icon:Y6},{name:"",icon:tr},{name:"",icon:e$}],c=h([]),d=h([]),u=[{id:1,title:" ",username:"",viewers:"15.4k",cover:as(),isFollowing:!1},{id:2,title:"",username:"Melo",viewers:"8.2k",cover:as(),isFollowing:!1},{id:3,title:"",username:"RinRin",viewers:"12.1k",cover:as(),isFollowing:!1},{id:4,title:"",username:"Ace",viewers:"5.9k",cover:as(),isFollowing:!1},{id:5,title:"",username:"Bunny",viewers:"22.1k",cover:as(),isFollowing:!1},{id:6,title:"",username:"Strum",viewers:"4.8k",cover:as(),isFollowing:!1}];(async()=>{try{console.log(" [] ...");const _=await C.getAllLiveContents();if(console.log("   - :",_.length),_.length===0){console.log("    "),c.value=u;return}const $=[],T=[];_.forEach((q,oe)=>{const se={id:q.contactId||oe+1,title:q.title,username:q.username,viewers:q.viewers,cover:q.cover||as(),isFollowing:!!q.contactId,contactId:q.contactId};q.contactId?$.push(se):T.push(se)}),console.log("   - :",T.length),console.log("   - :",$.length),c.value=T.length>0?T:u,d.value=$,console.log("    ")}catch(_){console.error("    :",_),c.value=u}})();const b=ot(()=>a.value===""?d.value:c.value),y=()=>{o("close")},M=async()=>{if(!l.value)try{if(l.value=!0,a.value===""){await w();return}const _=await C.getSetting("apiConfig");if(!_||!_.apiKey){alert(" API Key");return}const $={provider:_.provider||"deepseek",apiKey:_.apiKey,baseUrl:_.baseUrl||"",model:_.model||"deepseek-chat"};let T=$.baseUrl;T||($.provider==="deepseek"?T="https://api.deepseek.com":$.provider==="openai"?T="https://api.openai.com":$.provider==="gemini"&&(T="https://generativelanguage.googleapis.com")),T=T.replace(/\/v1\/?$/,"").replace(/\/$/,""),T=T+"/v1/chat/completions",console.log(" API URL:",T),console.log(":",$.model),console.log(":",n.value);const q=R9(n.value);console.log(":",q);const oe=await fetch(T,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${$.apiKey}`},body:JSON.stringify({model:$.model,messages:[{role:"user",content:q}],temperature:.9})});if(!oe.ok){const P=await oe.text();throw console.error("API :",P),new Error(`AI : ${oe.status} - ${P}`)}const J=(await oe.json()).choices[0].message.content;console.log("AI :",J);const N=Zn(J);if(N.length>0){console.log(" [] ...");const P=N.map(f=>C.saveLiveContent({title:f.title,username:f.username,viewers:f.viewers,cover:f.cover,contactId:f.contactId,content:"",danmus:[],timestamp:Date.now()}));await Promise.all(P),console.log("    "),c.value=N,alert(` ${N.length} `)}else alert("AI ")}catch(_){console.error(":",_),alert(": "+_.message)}finally{l.value=!1}},A=async()=>{try{const _=await C.getContacts();if(_.length===0){d.value=[];return}const $=await C.getSetting("apiConfig");if(!$||!$.apiKey){d.value=_.map(N=>({id:N.id,username:N.name,title:`${N.name}`,viewers:$o(),cover:as(),isFollowing:!0,contactId:N.id}));return}const T={provider:$.provider||"deepseek",apiKey:$.apiKey,baseUrl:$.baseUrl||"",model:$.model||"deepseek-chat"};let q=T.baseUrl;q||(T.provider==="deepseek"?q="https://api.deepseek.com":T.provider==="openai"&&(q="https://api.openai.com")),q=q.replace(/\/v1\/?$/,"").replace(/\/$/,"")+"/v1/chat/completions";const oe=_.map(async N=>{try{const P=Tl(N),f=await fetch(q,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${T.apiKey}`},body:JSON.stringify({model:T.model,messages:[{role:"user",content:P}],temperature:.9})});if(f.ok){const H=(await f.json()).choices[0].message.content,K=Zn(H);if(K.length>0)return{...K[0],id:N.id,isFollowing:!0,contactId:N.id}}return{id:N.id,username:N.name,title:`${N.name}`,viewers:$o(),cover:as(),isFollowing:!0,contactId:N.id}}catch(P){return console.error(` ${N.name} :`,P),{id:N.id,username:N.name,title:`${N.name}`,viewers:$o(),cover:as(),isFollowing:!0,contactId:N.id}}}),se=await Promise.all(oe);console.log(" [] ...");const J=se.map(N=>C.saveLiveContent({title:N.title,username:N.username,viewers:N.viewers,cover:N.cover,contactId:N.contactId,content:"",danmus:[],timestamp:Date.now()}));await Promise.all(J),console.log("    "),d.value=se}catch(_){console.error(":",_),d.value=[]}},w=async()=>{if(d.value.length===0){await A();return}try{const _=await C.getSetting("apiConfig");if(!_||!_.apiKey){alert(" API Key");return}const $={provider:_.provider||"deepseek",apiKey:_.apiKey,baseUrl:_.baseUrl||"",model:_.model||"deepseek-chat"};let T=$.baseUrl;T||($.provider==="deepseek"?T="https://api.deepseek.com":$.provider==="openai"&&(T="https://api.openai.com")),T=T.replace(/\/v1\/?$/,"").replace(/\/$/,"")+"/v1/chat/completions";const q=d.value.map(async J=>{try{const N=await C.getContact(J.contactId);if(!N)return J;const P=Tl(N),f=await fetch(T,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${$.apiKey}`},body:JSON.stringify({model:$.model,messages:[{role:"user",content:P}],temperature:.9})});if(f.ok){const H=(await f.json()).choices[0].message.content,K=Zn(H);if(K.length>0)return{...J,title:K[0].title,viewers:$o(),cover:as()}}return J}catch(N){return console.error(` ${J.username} :`,N),J}}),oe=await Promise.all(q);console.log(" [] ...");const se=oe.map(J=>C.saveLiveContent({title:J.title,username:J.username,viewers:J.viewers,cover:J.cover,contactId:J.contactId,content:"",danmus:[],timestamp:Date.now()}));await Promise.all(se),console.log("    "),d.value=oe,alert("")}catch(_){console.error(":",_),alert(": "+_.message)}},k=async _=>{a.value=_,_===""&&d.value.length===0&&await A()},I=_=>{o("open-detail",_)};return(_,$)=>(p(),m("div",W9,[e("div",K9,[e("header",G9,[e("div",{class:"flex items-center gap-3"},[e("div",{onClick:y,class:"w-10 h-10 rounded-xl bg-[#4A4A4A] flex items-center justify-center shadow-lg transform rotate-2 cursor-pointer active:scale-95 transition-all"},[...$[1]||($[1]=[e("span",{class:"text-white text-lg brand-font leading-none"},"K",-1)])]),$[2]||($[2]=e("div",{class:"flex flex-col"},[e("h1",{class:"text-base font-black tracking-tight text-[#333] leading-none uppercase"},"miaomiao"),e("span",{class:"text-[8px] font-bold text-pink-400 mt-1 uppercase tracking-[0.2em]"},"Daily Lounge")],-1))]),e("div",q9,[e("button",{onClick:M,disabled:l.value,class:Ie(["w-9 h-9 rounded-full flex items-center justify-center active:scale-90 transition-all border",l.value?"bg-gray-200 border-gray-300":"bg-gradient-to-br from-purple-400 to-pink-400 border-purple-300"])},[Ge(Ue(or),{class:Ie(["w-4 h-4",l.value?"text-gray-400 animate-spin":"text-white animate-pulse"])},null,8,["class"])],10,Z9),e("button",J9,[Ge(Ue(Q6),{class:"w-4 h-4 text-[#4A4A4A]"})]),e("button",Y9,[Ge(Ue(q6),{class:"w-4 h-4 text-pink-500"})])])]),e("div",X9,[a.value===""?(p(),m("nav",Q9,[(p(),m(Pe,null,Fe(i,T=>e("button",{key:T,onClick:q=>n.value=T,class:Ie(["flex-shrink-0 px-5 py-2 rounded-xl font-bold text-[11px] transition-all uppercase tracking-wider",n.value===T?"bg-[#4A4A4A] text-white shadow-md":"bg-white text-[#888] border border-gray-100"])},S(T),11,e_)),64))])):U("",!0),e("main",{class:Ie(["px-6 grid grid-cols-2 gap-5",a.value===""?"":"pt-4"])},[(p(!0),m(Pe,null,Fe(b.value,T=>(p(),m("div",{key:T.id,onClick:q=>I(T),class:"room-card group p-1.5 bg-white border-2 border-[#4A4A4A] rounded-[20px] transition-all cursor-pointer shadow-sm hover:-translate-y-1 hover:border-[#FFC0CB] hover:shadow-[0_10px_20px_rgba(255,192,203,0.15)]"},[e("div",s_,[T.cover?(p(),m("img",{key:0,src:T.cover,alt:T.title,class:"w-full h-full object-cover",onError:$[0]||($[0]=q=>q.target.style.display="none")},null,40,o_)):U("",!0),$[3]||($[3]=e("div",{class:"absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent z-10"},null,-1)),$[4]||($[4]=e("div",{class:"absolute top-2.5 left-2.5 flex items-center gap-1 bg-red-500 text-white text-[8px] px-2 py-0.5 rounded-full font-black z-20 shadow-sm border border-white/30"},[e("span",{class:"w-1 h-1 bg-white rounded-full animate-pulse"}),Qe(" LIVE ")],-1)),e("div",n_,[Ge(Ue(t$),{class:"w-3 h-3 mr-1"}),Qe(" "+S(T.viewers),1)])]),e("div",a_,[e("h3",l_,S(T.title),1),e("div",i_,[e("div",r_,S(T.username?T.username.charAt(0):"?"),1),e("span",c_,S(T.username),1)])])],8,t_))),128))],2)]),e("nav",d_,[(p(),m(Pe,null,Fe(r,T=>e("button",{key:T.name,onClick:q=>k(T.name),class:Ie(["flex flex-col items-center gap-1 group relative transition-all",a.value===T.name?"text-pink-500":"text-gray-400"])},[e("div",v_,[(p(),st(_a(T.icon),{class:"w-5 h-5","stroke-width":a.value===T.name?2.5:2},null,8,["stroke-width"]))]),e("span",p_,S(T.name),1),a.value===T.name?(p(),m("div",f_)):U("",!0)],10,u_)),64))])])]))}},g_=Ze(m_,[["__scopeId","data-v-f8727662"]]),h_={class:"vue-live-container w-full h-screen bg-gray-300 font-sans"},y_={class:"phone-viewport w-full h-full bg-[#FDF6F8] relative flex flex-col overflow-y-auto"},b_={class:"live-section relative w-full aspect-[16/9] bg-[#1a1a1a] overflow-hidden border-b-[1.5px] border-[#8E7B7E] flex-shrink-0"},w_={class:"danmu-container"},k_={key:0,class:"mr-1"},x_={class:"absolute top-5 left-4 z-30"},C_={class:"profile-badge bg-black/30 backdrop-blur-md border border-white/20 p-1 pr-3 rounded-full flex items-center gap-2"},$_={class:"w-8 h-8 rounded-full bg-white flex items-center justify-center text-lg"},__={class:"flex flex-col"},M_={class:"text-white text-[11px] font-bold leading-tight"},S_={class:"absolute bottom-5 left-4 z-30"},I_={class:"live-status-badge bg-black/40 backdrop-blur-md text-white px-3 py-1 rounded-2xl text-[10px] flex items-center gap-1.5 border border-white/10"},A_={class:"title-section bg-white p-5 border-b border-[#FFF0F3] flex-shrink-0"},L_={class:"text-[17px] font-bold text-[#5D4D50] leading-snug"},T_={class:"gift-display-area bg-white px-5 py-2.5 border-b-[1.5px] border-[#FFF0F3] flex items-center gap-2.5 text-xs flex-shrink-0"},j_={class:"font-bold text-[#8E7B7E]"},P_={class:"text-[#FF6B6B] font-bold"},E_={key:1,class:"opacity-30 italic"},B_={class:"thought-section m-2 mx-2.5 p-6 bg-white border-2 border-dashed border-[#FFB7C5] rounded-[20px] h-[320px] flex flex-col shadow-[0_10px_20px_rgba(255,183,197,0.1)] flex-shrink-0 overflow-hidden"},V_={class:"thought-scroll-area flex-1 overflow-y-auto pr-1"},H_={class:"cat-thought text-[15px] leading-[1.8] text-[#7A6669]"},D_={key:0,class:"text-center mt-4 text-gray-400 text-sm"},F_={class:"bottom-ui-container fixed bottom-0 left-0 right-0 p-4 pb-8 bg-gradient-to-t from-white via-white to-transparent flex-shrink-0 z-50"},U_={class:"bottom-ui-pill bg-white border border-[#FFF0F3] p-2 px-2.5 rounded-[40px] flex gap-2.5 items-center shadow-[0_10px_30px_rgba(255,183,197,0.2)]"},N_=["placeholder"],O_={class:"gift-modal w-full max-w-[340px] bg-white rounded-[30px] border-[1.5px] border-[#FFB7C5] p-6 shadow-2xl"},R_={class:"grid grid-cols-2 gap-3 mb-4"},z_=["onClick"],W_={class:"text-2xl mb-1"},K_={class:"text-[12px] font-bold"},G_={class:"space-y-3"},q_={key:0},Z_={class:"text-[10px] font-bold opacity-50 block mb-1"},J_={__name:"Livedetail",props:{liveData:{type:Object,required:!0}},emits:["back"],setup(t,{emit:s}){const o=t,n=s,a=h(""),l=h([]),i=h(!1),r=h(1),c=h(""),d=h(null),u=h(null),v=h("..."),b=h(!1),y=h([]),M=[{name:"",icon:""},{name:"",icon:""},{name:"",icon:""}],A=h({}),w=ot(()=>{var f;return((f=o.liveData)==null?void 0:f.title)||""}),k=ot(()=>{var f;return((f=o.liveData)==null?void 0:f.username)||""}),I=ot(()=>{var f;return((f=o.liveData)==null?void 0:f.viewers)||"0"}),_=()=>{const f=Date.now(),g=40;for(const H in A.value)A.value[H]<f&&delete A.value[H];for(let H=0;H<10;H++){const K=H*g+10;if(!A.value[K]||A.value[K]<f)return K}return Math.floor(Math.random()*10)*g+10},$=(f,g=!1,H="")=>{const K=Date.now()+Math.random(),F=H?`${H}${f}`:f,x=g?8:10+Math.random()*2,L=_();A.value[L]=Date.now()+x*1e3,l.value.push({id:K,text:F,isMine:g,top:L,duration:x,delay:0}),setTimeout(()=>{l.value=l.value.filter(ae=>ae.id!==K)},(x+1)*1e3)},T=async(f=null)=>{var H,K;if(console.log(" [] "),console.log("   - :",o.liveData),console.log("   - contactId:",(H=o.liveData)==null?void 0:H.contactId),(K=o.liveData)!=null&&K.contactId){console.log("     contactId...");const F=await C.getContact(o.liveData.contactId);if(console.log("   - :",F),F){console.log("    "),console.log("   - :",F.name),console.log("   - :",F.personality);const x=z9(F,w.value,f);return console.log("   - :",x.substring(0,200)+"..."),x}else console.warn("    ")}else console.log("     contactId");const g=`"${k.value}""${w.value}" ${I.value} 


1. 
2. 


- 
- 
-  5-8 
- 
- 
- 
- 

${f?`

"${f}"`:""}

 ### 
###
[]

###
11
22
33
...

`;return console.log("   - :",g.substring(0,200)+"..."),g},q=f=>{try{const g=f.split("###");let H="",K=[];for(let F=0;F<g.length;F++){const x=g[F].trim();if(x.includes("")&&F+1<g.length&&(H=g[F+1].trim()),x.includes("")&&F+1<g.length){const ae=g[F+1].trim().split(`
`).filter(de=>de.trim());for(const de of ae)if(de.includes("")||de.includes(":")){const ue=de.includes("")?"":":",[$e,...ne]=de.split(ue),G=ne.join(ue).trim();$e&&G&&K.push({username:$e.trim(),content:G})}}}return{thoughtContent:H,danmuContent:K}}catch(g){return console.error(":",g),{thoughtContent:"...",danmuContent:[]}}},oe=async(f=null)=>{var g,H;if(!b.value)try{b.value=!0;const K=await C.getSetting("apiConfig");if(!K||!K.apiKey){console.warn(" API"),await se(f);return}const F={provider:K.provider||"deepseek",apiKey:K.apiKey,baseUrl:K.baseUrl||"",model:K.model||"deepseek-chat"};let x=F.baseUrl;x||(F.provider==="deepseek"?x="https://api.deepseek.com":F.provider==="openai"&&(x="https://api.openai.com")),x=x.replace(/\/v1\/?$/,"").replace(/\/$/,"")+"/v1/chat/completions";const L=await T(f),ae=[...y.value,{role:"user",content:L}],de=await fetch(x,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F.apiKey}`},body:JSON.stringify({model:F.model,messages:ae,temperature:.9})});if(!de.ok)throw new Error(`AI : ${de.status}`);const $e=(await de.json()).choices[0].message.content;console.log("AI :",$e),y.value.push({role:"user",content:L},{role:"assistant",content:$e}),y.value.length>20&&(y.value=y.value.slice(-20));const{thoughtContent:ne,danmuContent:G}=q($e);ne&&(v.value=ne);const he=[];G.length>0&&G.forEach((j,Q)=>{setTimeout(()=>{$(j.content,!1,j.username)},Q*1500),he.push({username:j.username,content:j.content})});try{console.log(" [] ..."),console.log("   - :",w.value),console.log("   - :",k.value),console.log("   - :",ne.length),console.log("   - :",he.length);const j={title:w.value,username:k.value,viewers:I.value,cover:(g=o.liveData)==null?void 0:g.cover,contactId:(H=o.liveData)==null?void 0:H.contactId,content:ne,danmus:he,timestamp:Date.now()};console.log("   - :",j),await C.saveLiveContent(j),console.log("    ");const Q=await C.getLiveContent(w.value);console.log("   - :",Q)}catch(j){console.error("    :",j)}}catch(K){console.error(":",K),await se(f)}finally{b.value=!1}},se=async f=>{var K,F;let g="";const H=[];f?(g=`"${f}"${k.value}...`,[{username:"",content:"666"},{username:"A",content:""},{username:"1",content:""}].forEach((L,ae)=>{setTimeout(()=>{$(L.content,!1,L.username)},ae*1500),H.push({username:L.username,content:L.content})})):g=`${k.value}...`,v.value=g;try{console.log(" [] ...");const x={title:w.value,username:k.value,viewers:I.value,cover:(K=o.liveData)==null?void 0:K.cover,contactId:(F=o.liveData)==null?void 0:F.contactId,content:g,danmus:H,timestamp:Date.now()};await C.saveLiveContent(x),console.log("    ")}catch(x){console.error("    :",x)}},J=async()=>{if(!a.value.trim())return;const f=a.value;$(f,!0),a.value="",await oe(f)},N=()=>{if(!d.value)return;const f=d.value.name===""?c.value||"":d.value.name;u.value={userName:"",giftName:f,value:r.value},$(` ${f} x${r.value}`,!0),oe(`${f} x${r.value}`),i.value=!1,d.value=null,r.value=1,c.value=""},P=()=>{n("back")};return nt(async()=>{var f;console.log(" [] "),console.log("   - :",o.liveData),console.log("   - :",w.value),console.log("   - :",k.value);try{console.log(" [] ..."),console.log("   -  key:",w.value);const g=await C.getLiveContent(w.value);console.log("   - :",g),g&&g.content?(console.log("    "),console.log("   - :",g.content.length),console.log("   - :",g.content.substring(0,100)+"..."),console.log("   - :",((f=g.danmus)==null?void 0:f.length)||0),v.value=g.content,g.danmus&&g.danmus.length>0&&(console.log("   - ..."),g.danmus.forEach((H,K)=>{setTimeout(()=>{$(H.content,!1,H.username)},K*1500)})),console.log("    ")):(console.log("    "),await oe())}catch(g){console.error("    :",g),console.error("   - :",g.message),console.error("   - :",g.stack),await oe()}}),(f,g)=>(p(),m("div",h_,[e("div",y_,[e("div",b_,[e("div",w_,[(p(!0),m(Pe,null,Fe(l.value,H=>(p(),m("div",{key:H.id,class:Ie(["danmu-item",{"danmu-mine":H.isMine}]),style:Re({top:H.top+"px",animationDuration:H.duration+"s"})},[H.isMine?(p(),m("span",k_,"")):U("",!0),Qe(S(H.text),1)],6))),128))]),e("div",x_,[e("div",C_,[e("div",$_,S(k.value.charAt(0)),1),e("div",__,[e("span",M_,S(k.value),1),g[6]||(g[6]=e("span",{class:"text-pink-200 text-[8px] opacity-80"},"",-1))]),g[7]||(g[7]=e("button",{class:"bg-[#FFB7C5] text-white text-[10px] px-3 py-1 rounded-full font-bold ml-1 active:scale-95 transition-transform"},"  ",-1))])]),e("button",{class:"absolute top-5 right-5 z-30 w-8 h-8 bg-black/20 rounded-full text-white flex items-center justify-center border border-white/30 active:scale-90 transition-all",onClick:P},"  "),e("div",S_,[e("div",I_,[g[8]||(g[8]=e("span",{class:"w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse"},null,-1)),g[9]||(g[9]=e("span",null,"LIVE",-1)),g[10]||(g[10]=e("span",{class:"opacity-30"},"|",-1)),e("span",null,S(I.value)+" ",1)])]),g[11]||(g[11]=dt('<div class="absolute bottom-10 left-1/2 -translate-x-1/2 z-10" data-v-22133211><div class="relative transform scale-[1.3]" data-v-22133211><div class="cat-tail absolute -left-7 bottom-2 w-8 h-16 bg-gray-200 border-[1.5px] border-gray-400 rounded-full -z-10" data-v-22133211></div><div class="w-24 h-24 bg-white border-[1.5px] border-gray-300 rounded-full flex flex-col items-center justify-center shadow-lg relative overflow-hidden" data-v-22133211><div class="flex gap-3 mb-1" data-v-22133211><div class="w-2.5 h-2.5 bg-[#5D4D50] rounded-full" data-v-22133211></div><div class="w-2.5 h-2.5 bg-[#5D4D50] rounded-full" data-v-22133211></div></div><div class="w-4 h-2 border-b-[1.5px] border-[#5D4D50] rounded-full" data-v-22133211></div><div class="absolute bottom-0 w-full h-6 bg-pink-50/50" data-v-22133211></div></div></div></div>',1))]),e("div",A_,[e("h1",L_,S(w.value),1)]),e("div",T_,[u.value?(p(),m(Pe,{key:0},[g[12]||(g[12]=e("span",{class:"bg-pink-100 text-[#FF6B6B] px-2 py-0.5 rounded-md font-bold text-[10px] animate-bounce"},"NEW!",-1)),e("span",j_,S(u.value.userName),1),g[13]||(g[13]=e("span",{class:"opacity-60"},"",-1)),e("span",P_,S(u.value.giftName)+" x"+S(u.value.value),1)],64)):(p(),m("span",E_,"~"))]),e("div",B_,[e("div",V_,[e("p",H_,S(v.value),1),b.value?(p(),m("div",D_,[...g[14]||(g[14]=[e("span",{class:"animate-pulse"},"AI ...",-1)])])):U("",!0)])]),g[19]||(g[19]=e("div",{class:"px-5 py-4 opacity-30 text-[10px] text-center italic"},"  ",-1)),e("div",F_,[e("div",U_,[e("button",{onClick:g[0]||(g[0]=H=>i.value=!0),class:"w-11 h-11 rounded-full bg-[#FFF9FA] border-[1.5px] border-[#FFB7C5] flex items-center justify-center text-[#FF6B6B] active:scale-90 transition-transform"},[...g[15]||(g[15]=[dt('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-22133211><polyline points="20 12 20 22 4 22 4 12" data-v-22133211></polyline><rect x="2" y="7" width="20" height="5" data-v-22133211></rect><line x1="12" y1="22" x2="12" y2="7" data-v-22133211></line><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z" data-v-22133211></path><path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z" data-v-22133211></path></svg>',1)])]),we(e("input",{"onUpdate:modelValue":g[1]||(g[1]=H=>a.value=H),onKeyup:Xt(J,["enter"]),type:"text",placeholder:`${k.value}...`,class:"flex-1 h-11 bg-[#F9F1F3] rounded-[25px] px-5 text-[13px] outline-none border-[1.5px] border-transparent focus:border-[#FFB7C5] focus:bg-white transition-all"},null,40,N_),[[Te,a.value]]),e("button",{onClick:J,class:"w-11 h-11 rounded-full bg-[#FFB7C5] flex items-center justify-center text-white active:scale-90 transition-transform shadow-md"},"  ")])]),Ge(Ki,{name:"fade"},{default:ho(()=>{var H,K,F;return[i.value?(p(),m("div",{key:0,class:"modal-overlay fixed inset-0 bg-black/40 backdrop-blur-[4px] z-[1000] flex items-center justify-center p-5",onClick:g[5]||(g[5]=je(x=>i.value=!1,["self"]))},[e("div",O_,[g[18]||(g[18]=e("h3",{class:"text-center font-bold text-lg mb-4 text-[#5D4D50]"}," ",-1)),e("div",R_,[(p(),m(Pe,null,Fe(M,x=>{var L;return e("div",{key:x.name,onClick:ae=>d.value=x,class:Ie(["gift-card border-[1.5px] p-3 rounded-2xl text-center cursor-pointer transition-all",((L=d.value)==null?void 0:L.name)===x.name?"border-[#FFB7C5] bg-[#FFF0F3]":"border-[#F3E8EA] bg-white"])},[e("div",W_,S(x.icon),1),e("div",K_,S(x.name),1)],10,z_)}),64)),e("div",{onClick:g[2]||(g[2]=x=>d.value={name:"",icon:""}),class:Ie(["gift-card border-[1.5px] p-3 rounded-2xl text-center cursor-pointer transition-all",((H=d.value)==null?void 0:H.name)===""?"border-[#FFB7C5] bg-[#FFF0F3]":"border-[#F3E8EA] bg-white"])},[...g[16]||(g[16]=[e("div",{class:"text-2xl mb-1"},"",-1),e("div",{class:"text-[12px] font-bold"},"",-1)])],2)]),e("div",G_,[((K=d.value)==null?void 0:K.name)===""?(p(),m("div",q_,[g[17]||(g[17]=e("label",{class:"text-[10px] font-bold opacity-50 block mb-1"},"",-1)),we(e("input",{"onUpdate:modelValue":g[3]||(g[3]=x=>c.value=x),type:"text",placeholder:"",class:"w-full bg-gray-50 rounded-xl h-10 px-4 text-sm outline-none border-[1.5px] border-gray-100 focus:border-[#FFB7C5]"},null,512),[[Te,c.value]])])):U("",!0),e("div",null,[e("label",Z_,S(((F=d.value)==null?void 0:F.name)===""?"/":""),1),we(e("input",{"onUpdate:modelValue":g[4]||(g[4]=x=>r.value=x),type:"number",class:"w-full bg-gray-50 rounded-xl h-10 px-4 text-sm outline-none border-[1.5px] border-gray-100 focus:border-[#FFB7C5]"},null,512),[[Te,r.value,void 0,{number:!0}]])])]),e("button",{onClick:N,class:"w-full mt-6 bg-[#FFB7C5] text-white h-12 rounded-2xl font-bold active:scale-95 transition-all shadow-lg shadow-pink-100"}," "+S(k.value)+"  ",1)])])):U("",!0)]}),_:1})])]))}},Y_=Ze(J_,[["__scopeId","data-v-22133211"]]);function X_(t){return`"${t.name}"


${t.prompt||""}


1. 
2. 
3. 
4. 
5. 




10
30
${t.name}@example.com
100-300
""





@example.com

.pdf
2.1 MB  

`}function Q_(){return`
- 
- 
- 
- 
- 


1. 
2. 
3. 
4. 
5. 




GitHubNetflix
15
30

100-300
""



Netflix


service@netflix.com
1.  -  2.  -  3. - 
.zip
15.8 MB  3

`}const e7={class:"mail-app"},t7={class:"bg-[#ffebeb] px-6 pt-8 pb-5 border-b border-[#ffd1d1]"},s7={class:"flex justify-between items-center mb-4"},o7={class:"text-3xl font-black text-[#ff6b6b] tracking-tight"},n7=["disabled"],a7={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},l7={key:1,class:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i7={class:"relative"},r7={key:0,class:"flex-1 overflow-y-auto p-5 no-scrollbar"},c7=["onClick"],d7={key:0,class:"absolute left-2 top-1/2 -translate-y-1/2 w-1.5 h-1.5 bg-[#ff6b6b] rounded-full"},u7={class:"flex justify-between items-start mb-1 ml-2"},v7={class:"font-bold text-[#ff6b6b] text-base"},p7={class:"text-xs text-gray-400"},f7={class:"text-sm font-semibold text-gray-800 mb-1 ml-2"},m7={class:"text-xs text-gray-500 line-clamp-2 ml-2 leading-relaxed"},g7={key:0,class:"flex flex-col items-center justify-center py-20 text-gray-400"},h7={key:1,class:"flex-1 overflow-y-auto p-5 no-scrollbar"},y7={class:"space-y-3"},b7=["onClick"],w7={key:0},k7={class:"flex-1 min-w-0"},x7={class:"font-bold text-gray-800 text-base mb-1"},C7={class:"text-xs text-gray-500 truncate"},$7={key:0,class:"flex flex-col items-center justify-center py-20 text-gray-400"},_7={key:2,class:"flex-1 overflow-y-auto p-5 no-scrollbar"},M7={key:3,class:"flex-1 overflow-y-auto p-5 no-scrollbar"},S7={class:"bg-[#ffebeb] border-t border-[#ffd1d1] px-2 py-4 flex justify-around items-center"},I7=["onClick"],A7={class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},L7=["d"],T7={class:"text-[10px] font-bold"},j7={__name:"mailview",emits:["back","openDetail","openSettings"],setup(t,{emit:s}){const o=s,n=h("inbox"),a=h(""),l=h(!1),i=[{id:"inbox",label:"",icon:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"},{id:"contacts",label:"",icon:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5z"},{id:"archive",label:"",icon:"M19 3H4.99c-1.11 0-1.98.89-1.98 2L3 19c0 1.1.88 2 1.99 2H19c1.1 0 2-.9 2-2V5c0-1.11-.9-2-2-2zm0 12h-4c0 1.66-1.35 3-3 3s-3-1.34-3-3H4.99V5H19v10z"},{id:"settings",label:"",icon:"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65z"}],r=h([]),c=h([]),d=h({autoGenerateEnabled:!1,autoGenerateInterval:30,autoCleanEnabled:!0,maxEmailCount:5});let u=null;const v=N=>{k(),alert(` ${N.name||N.nickname} `)},b=()=>{k(),o("openSettings")},y=ot(()=>{var N;return((N=i.find(P=>P.id===n.value))==null?void 0:N.label)||""}),M=ot(()=>{const N=a.value.toLowerCase();return N?r.value.filter(P=>P.sender.toLowerCase().includes(N)||P.subject.toLowerCase().includes(N)):r.value}),A=N=>{const f=Date.now()-N,g=Math.floor(f/6e4),H=Math.floor(f/36e5),K=Math.floor(f/864e5);if(g<60)return`${g}`;if(H<24)return`${H}`;if(K===1)return"";if(K<7)return`${K}`;const F=new Date(N);return`${F.getMonth()+1}${F.getDate()}`},w=async()=>{var N,P;if(!l.value)try{l.value=!0,k();const f=await C.getContacts();if(console.log(" :",f),!f||f.length===0){alert("");return}const g=Math.min(Math.floor(Math.random()*2)+1,f.length),H=[],K=new Set;for(;H.length<g;){const de=Math.floor(Math.random()*f.length);K.has(de)||(K.add(de),H.push(f[de]))}console.log(" :",H.map(de=>de.name||de.nickname));const F=[];for(const de of H)try{const ue=X_({name:de.name||de.nickname||"",prompt:de.prompt||""});console.log(`  ${de.name||de.nickname} ...`);const $e=await Ut.sendMessage([{role:"user",content:ue}],de.id,de);console.log(" AI :",$e);let ne={};try{const G=$e.match(/\{[\s\S]*\}/);if(G)ne=JSON.parse(G[0]);else throw new Error("JSON")}catch{console.log("");const he=$e.split(`
`).filter(j=>j.trim());for(const j of he)j.includes("")?ne.subject=j.replace("","").trim():j.includes("")?ne.preview=j.replace("","").trim():j.includes("")?ne.email=j.replace("","").trim():j.includes("")?ne.content=j.replace("","").trim():j.includes("")&&!j.includes("")?ne.attachment=j.replace("","").trim():j.includes("")&&(ne.attachmentInfo=j.replace("","").trim());if(!ne.content||ne.content.length<50){const j=$e.indexOf(""),Q=$e.indexOf("");j!==-1&&Q!==-1&&(ne.content=$e.substring(j+3,Q).trim())}}F.push({id:Date.now()+Math.random(),sender:de.name||de.nickname||"",senderAvatar:de.avatar||"",senderEmail:ne.email||`${de.name}@example.com`,time:A(Date.now()),timestamp:Date.now(),subject:ne.subject||"",preview:ne.preview||((N=ne.content)==null?void 0:N.substring(0,50))||"",content:ne.content||$e,attachment:ne.attachment||"",attachmentInfo:ne.attachmentInfo||"",unread:!0,isCharacter:!0}),console.log(" ")}catch(ue){console.error(` (${de.name}):`,ue)}const x=Math.floor(Math.random()*3)+3,L=[];for(let de=0;de<x;de++)try{const ue=Q_();console.log(`  ${de+1} ...`);const $e=await Ut.sendMessage([{role:"user",content:ue}],null,null);console.log(" AI :",$e);let ne={};try{const G=$e.match(/\{[\s\S]*\}/);if(G)ne=JSON.parse(G[0]);else throw new Error("JSON")}catch{console.log("");const he=$e.split(`
`).filter(j=>j.trim());for(const j of he)j.includes("")?ne.sender=j.replace("","").trim():j.includes("")?ne.subject=j.replace("","").trim():j.includes("")?ne.preview=j.replace("","").trim():j.includes("")?ne.email=j.replace("","").trim():j.includes("")?ne.content=j.replace("","").trim():j.includes("")&&!j.includes("")?ne.attachment=j.replace("","").trim():j.includes("")&&(ne.attachmentInfo=j.replace("","").trim());if(!ne.content||ne.content.length<50){const j=$e.indexOf(""),Q=$e.indexOf("");j!==-1&&Q!==-1&&(ne.content=$e.substring(j+3,Q).trim())}}L.push({id:Date.now()+Math.random(),sender:ne.sender||"",senderAvatar:"",senderEmail:ne.email||"service@example.com",time:A(Date.now()-de*36e5),timestamp:Date.now()-de*36e5,subject:ne.subject||"",preview:ne.preview||((P=ne.content)==null?void 0:P.substring(0,50))||"",content:ne.content||$e,attachment:ne.attachment||"",attachmentInfo:ne.attachmentInfo||"",unread:!0,isCharacter:!1}),console.log(" ")}catch(ue){console.error(":",ue)}const ae=[...F,...L].sort((de,ue)=>ue.timestamp-de.timestamp);for(const de of ae)await C.addEmail(de);r.value=[...ae,...r.value],await _(),console.log(`  ${ae.length} `)}catch(f){console.error(":",f),alert(`: ${f.message}`)}finally{l.value=!1}},k=()=>{const N=new Audio("https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3");N.currentTime=0,N.play().catch(()=>{})},I=N=>{k(),N.unread=!1,o("openDetail",N)},_=async()=>{if(!d.value.autoCleanEnabled)return;const N=await C.getEmails(),P=d.value.maxEmailCount;if(N.length>P){const f=N.slice(P);for(const g of f)await C.deleteEmail(g.id);console.log(`  ${f.length} `),await oe()}},$=async()=>{const N=await C.getSetting("mailSettings");N&&(d.value=N),d.value.autoGenerateEnabled&&T()},T=()=>{u&&clearInterval(u);const N=d.value.autoGenerateInterval*60*1e3;u=setInterval(()=>{console.log(" ..."),w()},N),console.log(`  ${d.value.autoGenerateInterval} `)},q=()=>{u&&(clearInterval(u),u=null,console.log(" "))},oe=async()=>{r.value=await C.getEmails(),console.log(" :",r.value.length)},se=N=>{d.value=N.detail,d.value.autoGenerateEnabled?T():q()},J=()=>{r.value=[]};return nt(async()=>{c.value=await C.getContacts(),console.log(" :",c.value.length),await oe(),await $(),window.addEventListener("mail-settings-changed",se),window.addEventListener("emails-cleared",J)}),Dt(()=>{q(),window.removeEventListener("mail-settings-changed",se),window.removeEventListener("emails-cleared",J)}),(N,P)=>(p(),m("div",e7,[e("header",t7,[e("div",s7,[e("button",{onClick:P[0]||(P[0]=f=>o("back")),class:"text-[#ff6b6b] font-medium tap-effect"},[...P[2]||(P[2]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),e("h1",o7,S(y.value),1),e("button",{onClick:w,disabled:l.value,class:Ie(["text-[#ff6b6b] font-medium tap-effect flex items-center gap-1",{"opacity-50":l.value}])},[l.value?(p(),m("svg",l7,[...P[4]||(P[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(p(),m("svg",a7,[...P[3]||(P[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)])])),Qe(" "+S(l.value?"":""),1)],10,n7)]),e("div",i7,[we(e("input",{type:"text","onUpdate:modelValue":P[1]||(P[1]=f=>a.value=f),placeholder:"...",class:"w-full py-3 px-5 rounded-2xl border border-[#ffd1d1] outline-none focus:ring-2 focus:ring-[#ff6b6b]/20 transition-all text-sm",onFocus:k},null,544),[[Te,a.value]]),P[5]||(P[5]=e("div",{class:"absolute right-4 top-3 text-[#ff6b6b]/40"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),n.value==="inbox"?(p(),m("main",r7,[Ge(Hd,{name:"list",tag:"div"},{default:ho(()=>[(p(!0),m(Pe,null,Fe(M.value,f=>(p(),m("div",{key:f.id,class:"bg-white rounded-2xl p-4 mb-4 border border-[#ffd1d1]/30 shadow-sm hover:shadow-md transition-shadow cursor-pointer relative tap-effect",onClick:g=>I(f)},[f.unread?(p(),m("div",d7)):U("",!0),e("div",u7,[e("span",v7,S(f.sender),1),e("span",p7,S(f.time),1)]),e("div",f7,S(f.subject),1),e("div",m7,S(f.preview),1)],8,c7))),128))]),_:1}),M.value.length===0?(p(),m("div",g7,[...P[6]||(P[6]=[e("svg",{class:"w-16 h-16 mb-4 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1),e("p",null,"",-1)])])):U("",!0)])):U("",!0),n.value==="contacts"?(p(),m("main",h7,[e("div",y7,[(p(!0),m(Pe,null,Fe(c.value,f=>(p(),m("div",{key:f.id,class:"bg-white rounded-2xl p-4 border border-[#ffd1d1]/30 shadow-sm hover:shadow-md transition-all cursor-pointer tap-effect flex items-center gap-4",onClick:g=>v(f)},[e("div",{class:"w-14 h-14 rounded-full bg-gradient-to-br from-[#ff6b6b] to-[#ff9999] flex items-center justify-center text-white font-bold text-lg flex-shrink-0",style:Re(f.avatar?{backgroundImage:`url(${f.avatar})`,backgroundSize:"cover",backgroundPosition:"center"}:{})},[f.avatar?U("",!0):(p(),m("span",w7,S((f.name||f.nickname||"?")[0]),1))],4),e("div",k7,[e("div",x7,S(f.name||f.nickname||""),1),e("div",C7,S(f.prompt?f.prompt.substring(0,40)+"...":""),1)]),P[7]||(P[7]=e("svg",{class:"w-5 h-5 text-[#ff6b6b]/40 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,b7))),128))]),c.value.length===0?(p(),m("div",$7,[...P[8]||(P[8]=[e("svg",{class:"w-16 h-16 mb-4 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1),e("p",null,"",-1)])])):U("",!0)])):U("",!0),n.value==="archive"?(p(),m("main",_7,[...P[9]||(P[9]=[e("div",{class:"flex flex-col items-center justify-center py-20 text-gray-400"},[e("svg",{class:"w-16 h-16 mb-4 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})]),e("p",null,"")],-1)])])):U("",!0),n.value==="settings"?(p(),m("main",M7,[e("div",{class:"space-y-3"},[e("div",{class:"bg-white rounded-2xl p-4 border border-[#ffd1d1]/30 shadow-sm hover:shadow-md transition-all cursor-pointer tap-effect flex items-center justify-between",onClick:b},[...P[10]||(P[10]=[dt('<div class="flex items-center gap-3" data-v-5073caad><div class="w-10 h-10 rounded-full bg-gradient-to-br from-[#ff6b6b] to-[#ff9999] flex items-center justify-center" data-v-5073caad><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-5073caad><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" data-v-5073caad></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" data-v-5073caad></path></svg></div><div data-v-5073caad><div class="font-bold text-gray-800 text-base" data-v-5073caad></div><div class="text-xs text-gray-500" data-v-5073caad></div></div></div><svg class="w-5 h-5 text-[#ff6b6b]/40" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-5073caad><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" data-v-5073caad></path></svg>',2)])])])])):U("",!0),P[11]||(P[11]=e("button",{class:"absolute bottom-28 right-6 w-14 h-14 bg-[#ff6b6b] text-white rounded-full shadow-lg flex items-center justify-center tap-effect z-10"},[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})])],-1)),e("nav",S7,[(p(),m(Pe,null,Fe(i,f=>e("div",{key:f.id,onClick:g=>{n.value=f.id,k()},class:Ie(["flex flex-col items-center gap-1 cursor-pointer transition-all duration-300",n.value===f.id?"text-[#ff6b6b] scale-110":"text-[#ff6b6b]/40"])},[(p(),m("svg",A7,[e("path",{d:f.icon},null,8,L7)])),e("span",T7,S(f.label),1)],10,I7)),64))])]))}},P7=Ze(j7,[["__scopeId","data-v-5073caad"]]),E7={class:"email-wrapper"},B7={class:"email-detail-container"},V7={class:"email-detail-header"},H7={class:"email-detail-title"},D7={class:"email-detail-info"},F7={class:"email-detail-sender"},U7={key:0,class:"avatar-text"},N7={class:"sender-name"},O7={class:"sender-email"},R7={class:"email-time"},z7={class:"email-detail-content"},W7=["innerHTML"],K7={class:"attachment-item"},G7={class:"attachment-info"},q7={class:"attachment-name"},Z7={class:"attachment-meta"},J7="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3",Y7={__name:"maildetail",props:{email:{type:Object,required:!0}},emits:["back"],setup(t,{emit:s}){const o=t,n=s,a=h({subject:o.email.subject||"",sender:o.email.sender||"",senderEmail:o.email.senderEmail||"sender@example.com",senderAvatar:o.email.senderAvatar||"",time:o.email.time||"",content:o.email.content||"",attachment:o.email.attachment||"",attachmentInfo:o.email.attachmentInfo||""}),l=b=>b?b.replace(/\n/g,"<br>"):"",i=new Audio(J7),r=()=>{i.currentTime=0,i.play().catch(()=>console.log(""))},c=()=>{r(),n("back")},d=()=>{r(),console.log("")},u=()=>{r(),console.log("")},v=()=>{r(),console.log(":",a.value.attachment)};return(b,y)=>(p(),m("div",E7,[e("div",B7,[e("div",V7,[e("div",{class:"email-detail-back",onClick:c},[...y[0]||(y[0]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24"},[e("path",{fill:"#ff6b6b",d:"M20,11H7.83l5.59-5.59L12,4l-8,8l8,8l1.41-1.41L7.83,13H20V11z"})],-1),Qe("  ",-1)])]),e("h1",H7,S(a.value.subject),1),e("div",D7,[e("div",F7,[e("div",{class:"sender-avatar",style:Re(a.value.senderAvatar?{backgroundImage:`url(${a.value.senderAvatar})`}:{})},[a.value.senderAvatar?U("",!0):(p(),m("span",U7,S((a.value.sender||"?")[0]),1))],4),e("div",null,[e("div",N7,S(a.value.sender),1),e("div",O7,S(a.value.senderEmail),1)])]),e("div",R7,S(a.value.time),1)])]),e("div",z7,[e("div",{innerHTML:l(a.value.content)},null,8,W7),a.value.attachment?(p(),m("div",{key:0,class:"email-attachment",onClick:v},[y[2]||(y[2]=e("div",{class:"attachment-title"},"  (1)",-1)),e("div",K7,[y[1]||(y[1]=e("div",{class:"attachment-icon"},"",-1)),e("div",G7,[e("div",q7,S(a.value.attachment),1),e("div",Z7,S(a.value.attachmentInfo),1)])])])):U("",!0)]),e("div",{class:"email-actions"},[e("button",{class:"action-button",onClick:d},[...y[3]||(y[3]=[e("svg",{class:"action-icon",viewBox:"0 0 24 24"},[e("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),Qe("  ",-1)])]),e("button",{class:"action-button",onClick:u},[...y[4]||(y[4]=[e("svg",{class:"action-icon",viewBox:"0 0 24 24"},[e("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})],-1),Qe("  ",-1)])])])])]))}},X7=Ze(Y7,[["__scopeId","data-v-9394c74f"]]),Q7={class:"mail-settings"},eM={class:"settings-header"},tM={class:"settings-content"},sM={class:"setting-item"},oM={class:"switch"},nM={key:0,class:"setting-item"},aM={class:"setting-item"},lM={class:"switch"},iM={key:1,class:"setting-item"},rM={class:"stats-section"},cM={class:"stats-grid"},dM={class:"stat-item"},uM={class:"stat-value"},vM={class:"stat-item"},pM={class:"stat-value"},fM={__name:"mailsetting",emits:["back"],setup(t){const s=h(!1),o=h(30),n=h(!0),a=h(5),l=h(0),i=h(0),r=async()=>{try{const u=await C.getSetting("mailSettings");u&&(s.value=u.autoGenerateEnabled??!1,o.value=u.autoGenerateInterval??30,n.value=u.autoCleanEnabled??!0,a.value=u.maxEmailCount??5);const v=await C.getEmails();l.value=v.length,i.value=v.filter(b=>b.unread).length}catch(u){console.error(":",u)}},c=async()=>{try{await C.setSetting("mailSettings",{autoGenerateEnabled:s.value,autoGenerateInterval:o.value,autoCleanEnabled:n.value,maxEmailCount:a.value}),console.log(""),window.dispatchEvent(new CustomEvent("mail-settings-changed",{detail:{autoGenerateEnabled:s.value,autoGenerateInterval:o.value,autoCleanEnabled:n.value,maxEmailCount:a.value}}))}catch(u){console.error(":",u)}},d=async()=>{if(confirm(""))try{await C.clearEmails(),l.value=0,i.value=0,alert(""),window.dispatchEvent(new CustomEvent("emails-cleared"))}catch(u){console.error(":",u),alert("")}};return nt(()=>{r()}),(u,v)=>(p(),m("div",Q7,[e("header",eM,[e("button",{onClick:v[0]||(v[0]=b=>u.$emit("back")),class:"back-button"},[...v[5]||(v[5]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),v[6]||(v[6]=e("h1",{class:"settings-title"},"",-1)),v[7]||(v[7]=e("div",{class:"placeholder"},null,-1))]),e("main",tM,[e("div",sM,[v[9]||(v[9]=e("div",{class:"setting-info"},[e("div",{class:"setting-label"},""),e("div",{class:"setting-desc"},"AI")],-1)),e("label",oM,[we(e("input",{type:"checkbox","onUpdate:modelValue":v[1]||(v[1]=b=>s.value=b),onChange:c},null,544),[[es,s.value]]),v[8]||(v[8]=e("span",{class:"slider"},null,-1))])]),s.value?(p(),m("div",nM,[v[11]||(v[11]=e("div",{class:"setting-info"},[e("div",{class:"setting-label"},""),e("div",{class:"setting-desc"},"")],-1)),we(e("select",{"onUpdate:modelValue":v[2]||(v[2]=b=>o.value=b),onChange:c,class:"interval-select"},[...v[10]||(v[10]=[e("option",{value:5},"5",-1),e("option",{value:10},"10",-1),e("option",{value:30},"30",-1),e("option",{value:60},"1",-1),e("option",{value:180},"3",-1)])],544),[[Ls,o.value]])])):U("",!0),e("div",aM,[v[13]||(v[13]=e("div",{class:"setting-info"},[e("div",{class:"setting-label"},""),e("div",{class:"setting-desc"},"5")],-1)),e("label",lM,[we(e("input",{type:"checkbox","onUpdate:modelValue":v[3]||(v[3]=b=>n.value=b),onChange:c},null,544),[[es,n.value]]),v[12]||(v[12]=e("span",{class:"slider"},null,-1))])]),n.value?(p(),m("div",iM,[v[15]||(v[15]=e("div",{class:"setting-info"},[e("div",{class:"setting-label"},""),e("div",{class:"setting-desc"},"")],-1)),we(e("select",{"onUpdate:modelValue":v[4]||(v[4]=b=>a.value=b),onChange:c,class:"interval-select"},[...v[14]||(v[14]=[e("option",{value:5},"5",-1),e("option",{value:10},"10",-1),e("option",{value:20},"20",-1),e("option",{value:50},"50",-1)])],544),[[Ls,a.value]])])):U("",!0),e("div",rM,[v[18]||(v[18]=e("h2",{class:"stats-title"},"",-1)),e("div",cM,[e("div",dM,[e("div",uM,S(l.value),1),v[16]||(v[16]=e("div",{class:"stat-label"},"",-1))]),e("div",vM,[e("div",pM,S(i.value),1),v[17]||(v[17]=e("div",{class:"stat-label"},"",-1))])])]),e("div",{class:"danger-section"},[v[20]||(v[20]=e("h2",{class:"danger-title"},"",-1)),e("button",{onClick:d,class:"danger-button"},[...v[19]||(v[19]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Qe("  ",-1)])])])])]))}},mM=Ze(fM,[["__scopeId","data-v-271c42b9"]]),gM={class:"control-item"},hM={class:"control-item"},yM={class:"size-value"},bM={__name:"GlobalLyrics",setup(t){const s=zo,o=h("#ffffff"),n=h(24),a=h(!1),l=h(!1),i=h({x:window.innerWidth/2-200,y:50}),r=h({x:0,y:0}),c=h({x:0,y:0}),d=ot(()=>{var I;if(!((I=s.currentSong)!=null&&I.lyrics))return[];const w=s.currentSong.lyrics.split(`
`),k=[];for(const _ of w){const $=_.match(/\[(\d{2}):(\d{2})\.(\d{2,3})\](.*)/);if($){const T=parseInt($[1]),q=parseInt($[2]),oe=parseInt($[3].padEnd(3,"0")),se=T*60+q+oe/1e3,J=$[4].trim();J&&k.push({time:se,text:J})}}return k.sort((_,$)=>_.time-$.time)}),u=ot(()=>{var k;if(d.value.length===0)return"";const w=s.currentTime;for(let I=d.value.length-1;I>=0;I--)if(w>=d.value[I].time)return d.value[I].text;return((k=d.value[0])==null?void 0:k.text)||""}),v=()=>{$t.toggleGlobalLyrics()},b=()=>{l.value||(a.value=!a.value)},y=w=>{w.preventDefault(),w.stopPropagation(),l.value=!0;const k=w.type.includes("touch")?w.touches[0].clientX:w.clientX,I=w.type.includes("touch")?w.touches[0].clientY:w.clientY;r.value={x:k,y:I},c.value={x:i.value.x,y:i.value.y},document.addEventListener("mousemove",M),document.addEventListener("mouseup",A),document.addEventListener("touchmove",M),document.addEventListener("touchend",A)},M=w=>{if(!l.value)return;const k=w.type.includes("touch")?w.touches[0].clientX:w.clientX,I=w.type.includes("touch")?w.touches[0].clientY:w.clientY,_=k-r.value.x,$=I-r.value.y;let T=c.value.x+_,q=c.value.y+$;T=Math.max(0,Math.min(T,window.innerWidth-400)),q=Math.max(0,Math.min(q,window.innerHeight-80)),i.value={x:T,y:q}},A=()=>{l.value=!1,document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",A),document.removeEventListener("touchmove",M),document.removeEventListener("touchend",A)};return nt(()=>{const w=localStorage.getItem("lyricColor");w&&(o.value=w);const k=localStorage.getItem("lyricSize");k&&(n.value=parseInt(k));const I=localStorage.getItem("lyricPosition");if(I)try{i.value=JSON.parse(I)}catch(_){console.error(":",_)}}),Dt(()=>{A(),localStorage.setItem("lyricColor",o.value),localStorage.setItem("lyricSize",n.value.toString()),localStorage.setItem("lyricPosition",JSON.stringify(i.value))}),Pt(o,w=>{localStorage.setItem("lyricColor",w)}),Pt(n,w=>{localStorage.setItem("lyricSize",w.toString())}),(w,k)=>(p(),st(gc,{to:"body"},[Ue(s).showGlobalLyrics&&u.value?(p(),m("div",{key:0,class:"global-lyrics",style:Re({left:i.value.x+"px",top:i.value.y+"px",color:o.value,fontSize:n.value+"px"}),onMousedown:y,onTouchstart:y,onClick:b},[Qe(S(u.value)+" ",1),a.value?(p(),m("button",{key:0,class:"close-btn",onClick:je(v,["stop"]),title:""},"")):U("",!0),a.value?(p(),m("div",{key:1,class:"lyric-controls",onClick:k[2]||(k[2]=je(()=>{},["stop"])),onMousedown:k[3]||(k[3]=je(()=>{},["stop"])),onTouchstart:k[4]||(k[4]=je(()=>{},["stop"]))},[e("div",gM,[k[5]||(k[5]=e("label",null,"",-1)),we(e("input",{type:"color","onUpdate:modelValue":k[0]||(k[0]=I=>o.value=I),class:"color-picker"},null,512),[[Te,o.value]])]),e("div",hM,[k[6]||(k[6]=e("label",null,"",-1)),we(e("input",{type:"range","onUpdate:modelValue":k[1]||(k[1]=I=>n.value=I),min:"16",max:"48",step:"1",class:"size-slider"},null,512),[[Te,n.value]]),e("span",yM,S(n.value)+"px",1)])],32)):U("",!0)],36)):U("",!0)]))}},wM=Ze(bM,[["__scopeId","data-v-1c8a0716"]]),kM={class:"app-container"},xM={__name:"App",setup(t){const s=h(null),o=h("desktop"),n=h({contactId:null,contactName:"",contactAvatar:""}),a=h({groupId:null}),l=h(null),i=h(null),r=h(null),c=h(null),d=h(null),u=()=>{o.value="messages"},v=()=>{o.value="desktop"},b=B=>{B.isGroup?(a.value={groupId:B.groupId},o.value="group-chat",Lt.setCurrentPage("chat"),Lt.setCurrentChatId(null)):(n.value=B,o.value="chat",Lt.setCurrentPage("chat"),Lt.setCurrentChatId(B.contactId))},y=async()=>{console.log(" "),o.value="messages",Lt.setCurrentPage("messages"),Lt.setCurrentChatId(null),await zt(),console.log("  refresh-message-list "),window.dispatchEvent(new CustomEvent("refresh-message-list")),console.log(" ")},M=()=>{o.value="diary"},A=()=>{o.value="chat"},w=()=>{o.value="settings"},k=B=>{n.value=B,o.value="chat",Lt.setCurrentPage("chat"),Lt.setCurrentChatId(B.contactId)},I=()=>{o.value="moment-feed"},_=()=>{o.value="worldbook"},$=()=>{o.value="moment-feed"},T=B=>{l.value=B,o.value="friend-profile"},q=B=>{n.value={contactId:B,contactName:"",contactAvatar:"https://via.placeholder.com/50"},o.value="chat"},oe=()=>{console.log("")},se=B=>{console.log("",B)},J=()=>{console.log("App.vue:  Pornhub"),o.value="pornhub",console.log("App.vue: currentView ",o.value)},N=()=>{o.value="pornhub-profile"},P=()=>{o.value="pornhub"},f=()=>{o.value="pornhub-settings"},g=()=>{o.value="pornhub-profile"},H=B=>{i.value=B,o.value="video-detail"},K=()=>{o.value="pornhub"},F=B=>{r.value=B,o.value="character-edit"},x=()=>{o.value="pornhub-settings"},L=()=>{o.value="pornhub-favorites"},ae=()=>{console.log("App.vue: "),o.value="music"},de=()=>{console.log("App.vue:  Forum"),o.value="forum"},ue=()=>{console.log("App.vue:  Live"),o.value="live"},$e=B=>{console.log("App.vue: ",B),d.value=B,o.value="live-detail"},ne=()=>{console.log("App.vue: "),o.value="live"},G=()=>{console.log("App.vue:  Mail"),o.value="mail"},he=B=>{console.log("App.vue: ",B),c.value=B,o.value="mail-detail"},j=()=>{console.log("App.vue: "),o.value="mail"},Q=()=>{console.log("App.vue: "),o.value="mail-settings"},W=B=>{console.log(":",B),B.app==="wechat"?o.value="messages":B.app==="email"&&console.log("")};return Pt(o,B=>{s.value&&s.value.setTriggerAreaVisible(B==="desktop"),B==="chat"?Lt.setCurrentPage("chat"):B==="messages"?(Lt.setCurrentPage("messages"),Lt.setCurrentChatId(null)):(Lt.setCurrentPage(B),Lt.setCurrentChatId(null))}),(B,D)=>(p(),m("div",kM,[o.value==="desktop"?(p(),st(yu,{key:0,onOpenMessages:u,onOpenSettings:w,onOpenMoments:I,onOpenWorldbook:_,onOpenPornhub:J,onOpenMusic:ae,onOpenForum:de,onOpenLive:ue,onOpenMail:G})):U("",!0),o.value==="messages"?(p(),st(j1,{key:1,onBack:v,onOpenChat:b})):U("",!0),o.value==="chat"?(p(),st(xf,{key:2,"contact-id":n.value.contactId,"contact-name":n.value.contactName,"contact-avatar":n.value.contactAvatar,onBack:y,onOpenDiary:M},null,8,["contact-id","contact-name","contact-avatar"])):U("",!0),o.value==="group-chat"?(p(),st(lm,{key:3,"group-id":a.value.groupId,onBack:y},null,8,["group-id"])):U("",!0),o.value==="diary"?(p(),st(Am,{key:4,"contact-id":n.value.contactId,onBack:A},null,8,["contact-id"])):U("",!0),o.value==="settings"?(p(),st(jh,{key:5,onBack:v})):U("",!0),o.value==="moment-feed"?(p(),st(Qb,{key:6,onBack:v,onViewProfile:T,onPost:oe})):U("",!0),o.value==="friend-profile"?(p(),st(yw,{key:7,"friend-id":l.value,onBack:$,onChat:q,onViewMoment:se},null,8,["friend-id"])):U("",!0),o.value==="worldbook"?(p(),st(u4,{key:8,onBack:v})):U("",!0),o.value==="pornhub"?(p(),st(A4,{key:9,"is-visible":o.value==="pornhub",onClose:v,onGoToProfile:N,onOpenVideo:H},null,8,["is-visible"])):U("",!0),o.value==="pornhub-profile"?(p(),st(O4,{key:10,"is-visible":o.value==="pornhub-profile",onBackToHome:P,onGoToSettings:f,onGoToFavorites:L},null,8,["is-visible"])):U("",!0),o.value==="pornhub-favorites"?(p(),st(Dk,{key:11,"is-visible":o.value==="pornhub-favorites",onBack:g,onOpenVideo:H},null,8,["is-visible"])):U("",!0),o.value==="pornhub-settings"?(p(),st(a5,{key:12,"is-visible":o.value==="pornhub-settings",onBack:g,onEditCharacter:F},null,8,["is-visible"])):U("",!0),o.value==="character-edit"?(p(),st(xk,{key:13,character:r.value,onBack:x},null,8,["character"])):U("",!0),o.value==="video-detail"?(p(),st(ak,{key:14,"is-visible":o.value==="video-detail",video:i.value,onBack:K},null,8,["is-visible","video"])):U("",!0),o.value==="music"?(p(),st(O6,{key:15,onBack:v})):U("",!0),o.value==="forum"?(p(),st(O9,{key:16,onBack:v})):U("",!0),o.value==="live"?(p(),st(g_,{key:17,onClose:v,onOpenDetail:$e})):U("",!0),o.value==="live-detail"?(p(),st(Y_,{key:18,"live-data":d.value,onBack:ne},null,8,["live-data"])):U("",!0),o.value==="mail"?(p(),st(P7,{key:19,onBack:v,onOpenDetail:he,onOpenSettings:Q})):U("",!0),o.value==="mail-detail"?(p(),st(X7,{key:20,email:c.value,onBack:j},null,8,["email"])):U("",!0),o.value==="mail-settings"?(p(),st(mM,{key:21,onBack:j})):U("",!0),Ge(Oh,{onNavigateToChat:k}),Ge(Wh),Ge(E2,{ref_key:"notificationPanelRef",ref:s,onNotificationClick:W},null,512),Ge(wM)]))}},CM=Ze(xM,[["__scopeId","data-v-6013117d"]]);"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>console.log(" PWA ")).catch(t=>console.log("Service Worker :",t))});const $M=Yd(CM);$M.mount("#app");(async()=>{try{await _e.init();const t=await C.getSetting("globalFont");t&&(document.documentElement.style.setProperty("--global-font",t),console.log(" :",t));const s=await C.getSetting("customFonts");if(s&&Array.isArray(s)){for(const l of s){const i=document.createElement("style");l.data?i.textContent=`
            @font-face {
              font-family: '${l.family}';
              src: url(${l.data});
            }
          `:l.url&&(i.textContent=`
            @font-face {
              font-family: '${l.family}';
              src: url(${l.url});
            }
          `),document.head.appendChild(i)}console.log(" :",s.length,"")}await C.getSetting("autoDiaryEnabled")&&(await lo.start(),console.log(" ")),await C.getSetting("autoMomentEnabled")&&(await Qt.start(),console.log(" ")),await C.getSetting("backgroundMessagesEnabled")&&(await Ut.startBackgroundMessages(),console.log(" "))}catch(t){console.warn(":",t)}})();
